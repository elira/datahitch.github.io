(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"723k":function(t,e,i){"use strict";i.r(e),i.d(e,"ProfileModule",(function(){return ji}));var r=i("2kYt"),n=i("sEIs"),s=i("D57K"),o=i("EM62");class a{constructor(t){this.base=t}[Symbol.iterator](){return this.base[Symbol.iterator]()}concat(...t){return h(function*(t){for(const e of t)yield*e}([this,...t.map(h)]))}entries(){return h(function*(t){let e=0;for(const i of t)yield[e++,i]}(this))}every(t){return!this.some((e,i)=>!t(e,i))}fill(t){return this.map(()=>t)}filter(t){return h(function*(e){for(const[i,r]of e)t(r,i)&&(yield r)}(this.entries()))}find(t){for(const[e,i]of this.entries())if(t(i,e))return i}findIndex(t){for(const[e,i]of this.entries())if(t(i,e))return e;return-1}flatMap(t){return h(function*(e){for(const[i,r]of e)yield*h(t(r,i))}(this.entries()))}forEach(t){for(const[e,i]of this.entries())t(i,e)}includes(t,e=0){return this.indexOf(t,e)>=0}indexOf(t,e=0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");for(const[i,r]of this.entries())if(i>=e&&r===t)return i;return-1}join(t=","){return[...this].join(t)}keys(){return h(function*(t){let e=0;for(const i of t)yield e++}(this))}lastIndexOf(t,e=1/0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");let i=-1;for(const[r,n]of this.entries())r<=e&&n===t&&(i=r);return i}get length(){return this.reduce(t=>t+1,0)}map(t){return h(function*(e){for(const[i,r]of e)yield t(r,i)}(this.entries()))}reduce(t,e){if(void 0===e){const e=t;let i=!0,r=void 0;for(const[t,n]of this.entries())i?(r=n,i=!1):r=e(r,n,t);if(i)throw new TypeError("Reduce of empty iterable with no initial value");return r}{const i=t;let r=e;for(const[t,e]of this.entries())r=i(r,e,t);return r}}reverse(){return h([...this].reverse())}slice(t=0,e=1/0){return h(function*(i){for(const[r,n]of i)if(r<t);else{if(!(r<e))break;yield n}}(this.entries()))}some(t){for(const[e,i]of this.entries())if(t(i,e))return!0;return!1}sort(t){return h([...this].sort(t))}splice(t,e=0,...i){return h(function*(r){for(const[n,s]of r)n===t&&(yield*i),(n<t||n>=t+e)&&(yield s)}(this.entries()))}values(){return this}}function h(t){return function(t){return"function"==typeof t[Symbol.iterator]}(t)?new a(t):new a({[Symbol.iterator]:()=>t})}function l(t,e){e.size<t.size&&([e,t]=[t,e]);for(const i of t)if(e.has(i))return!0;return!1}class c extends Map{getThrow(t){const e=this.get(t);if(void 0===e)throw new Error("map doesn't contain key: "+t);return e}getDefault(t,e){const i=this.get(t);return void 0===i?e:i}setIfAbsent(t,e){const i=this.get(t);return void 0===i?(this.set(t,e),e):i}}class d{constructor(t,e,i=[]){this.child=t,this.data=e,this.points=i}}class u{constructor(t,e,i,r){this.source=t,this.target=e,this.data=i,this.points=r}}class f{constructor(t,e){this.id=t,this.data=e,this.dataChildren=[]}iroots(){return h([this])}roots(){return[this]}*iterChildren(){for(const{child:t}of this.dataChildren)yield t}ichildren(){return h(this.iterChildren())}children(){return[...this.ichildren()]}*iterChildLinks(){for(const{child:t,data:e,points:i}of this.dataChildren)yield new u(this,t,e,i)}ichildLinks(){return h(this.iterChildLinks())}childLinks(){return[...this.ichildLinks()]}[Symbol.iterator](){return new p([this])[Symbol.iterator]()}idescendants(t="depth"){return new p([this]).idescendants(t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return new p([this]).ilinks()}links(){return[...this.ilinks()]}size(){return new p([this]).size()}sum(t){return new p([this]).sum(t),this}count(){return new p([this]).count(),this}height(){return new p([this]).height(),this}depth(){return new p([this]).depth(),this}split(){return[this]}connected(){return!0}}class p{constructor(t){this.dagRoots=t}[Symbol.iterator](){return this.idepth()}iroots(){return h(this.dagRoots)}roots(){return this.dagRoots.slice()}*idepth(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(e.add(i.id),yield i,t.push(...i.ichildren()))}*ibreadth(){const t=new Set;let e=this.roots(),i=[];do{let r;for(i=e.reverse(),e=[];r=i.pop();)t.has(r.id)||(t.add(r.id),yield r,e.push(...r.ichildren()))}while(e.length)}*ibefore(){const t=new c;for(const r of this)for(const e of r.ichildren())t.set(e.id,t.getDefault(e.id,0)+1);const e=this.roots();let i;for(;i=e.pop();){yield i;for(const r of i.ichildren()){const i=t.getThrow(r.id);i>1?t.set(r.id,i-1):e.push(r)}}}*iafter(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(i.ichildren().every(t=>e.has(t.id))?(e.add(i.id),yield i):(t.push(i),t.push(...i.ichildren())))}idescendants(t="depth"){if("depth"===t)return h(this.idepth());if("breadth"===t)return h(this.ibreadth());if("before"===t)return h(this.ibefore());if("after"===t)return h(this.iafter());throw new Error("unknown iteration style: "+t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return this.idescendants().flatMap(t=>t.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(t=>t+1,0)}sum(t){const e=new c;for(const[i,r]of this.idescendants("after").entries()){const n=t(r,i),s=new c;s.set(r.id,n);for(const t of r.ichildren()){const i=e.getThrow(t.id);for(const[t,e]of i.entries())s.set(t,e)}r.value=h(s.entries()).map(([,t])=>t).reduce((t,e)=>t+e),e.set(r.id,s)}return this}count(){const t=new c;for(const e of this.idescendants("after"))if(e.ichildren()[Symbol.iterator]().next().done)t.set(e.id,new Set([e.id])),e.value=1;else{const i=new Set;for(const r of e.ichildren()){const e=t.getThrow(r.id);for(const t of e)i.add(t)}t.set(e.id,i),e.value=i.size}return this}height(){for(const t of this.idescendants("after"))t.value=Math.max(0,...t.ichildren().map(t=>{if(void 0===t.value)throw new Error("`after` iteration didn't iterate in after order");return t.value+1}));return this}depth(){const t=new c;for(const e of this)for(const i of e.ichildren())t.setIfAbsent(i.id,[]).push(e);for(const e of this.idescendants("before"))e.value=Math.max(0,...t.getDefault(e.id,[]).map(t=>{if(void 0===t.value)throw new Error("`before` iteration didn't iterate in before order");return t.value+1}));return this}split(){const t=new c,e=new c;for(const n of this.iroots())t.set(n.id,[]),e.set(n.id,new Set(n.idescendants().map(t=>t.id)));for(const[n,s]of this.iroots().entries()){const i=e.getThrow(s.id);for(const r of this.iroots().slice(n+1))l(i,e.getThrow(r.id))&&(t.getThrow(s.id).push(r),t.getThrow(r.id).push(s))}const i=[],r=new Set;for(const n of this.iroots())if(!r.has(n.id)){r.add(n.id);const e=[n];i.push(e);const s=t.getThrow(n.id).slice();let o;for(;o=s.pop();)r.has(o.id)||(r.add(o.id),e.push(o),s.push(...t.getThrow(o.id)))}return i.map(t=>t.length>1?new p(t):t[0])}connected(){return 1===this.split().length}}function v(t){function e(e,i){return(t(e,i)||[]).map(t=>[t,void 0])}return e.wrapped=t,e}function b(t){if(function(t){try{return"string"==typeof t.id}catch(e){return!1}}(t))return t.id;throw new Error("default id function expected datum to have an id field but got: "+t)}function g(t){if(function(t){try{const e=t.parentIds;return void 0===e||e instanceof Array&&e.every(t=>"string"==typeof t)}catch(e){return!1}}(t))return t.parentIds;throw new Error("default parentIds function expected datum to have a parentIds field but got: "+t)}let m,y,w=1e-60;do{w+=w,m=1+.1*w,y=1+.2*w}while(m<=1||y<=1);var x=w,_=function(t,e,i,r=[],n=0,s=[0,0]){const o=[],a=[],h=[],l=[],c=[],d=[];let u="";const f=t.length-1,p=i[1].length-1;if(!r)for(let b=1;b<=p;b+=1)r[b]=0;if(f!==t[1].length-1&&(u="Dmat is not symmetric!"),f!==e.length-1&&(u="Dmat and dvec are incompatible!"),f!==i.length-1&&(u="Amat and dvec are incompatible!"),p!==r.length-1&&(u="Amat and bvec are incompatible!"),(n>p||n<0)&&(u="Value of meq is invalid!"),""!==u)return{message:u};for(let b=1;b<=p;b+=1)a[b]=0,l[b]=0;const v=Math.min(f,p);for(let b=1;b<=f;b+=1)h[b]=0;o[1]=0;for(let b=1;b<=2*f+v*(v+5)/2+2*p+1;b+=1)c[b]=0;for(let b=1;b<=2;b+=1)d[b]=0;return function(t,e,i,r,n,s,o,a,h,l,c,d,u,f=0,p,v,b){let g,m,y,w,_,C,I,E,S,O,k,M,B,V;const R=Math.min(r,c);let T=2*r+R*(R+5)/2+2*c+1;for(let x=1;x<=r;x+=1)v[x]=e[x];for(let x=r+1;x<=T;x+=1)v[x]=0;for(let x=1;x<=c;x+=1)u[x]=0,s[x]=0;const j=[];if(0===b[1]){if(function(t,e,i,r){let n,s,o;for(let a=1;a<=i;a+=1){if(r[1]=a,o=0,n=a-1,n<1){if(o=t[a][a]-o,o<=0)break;t[a][a]=Math.sqrt(o)}else{for(let e=1;e<=n;e+=1){s=t[e][a];for(let i=1;i<e;i+=1)s-=t[i][a]*t[i][e];s/=t[e][e],t[e][a]=s,o+=s*s}if(o=t[a][a]-o,o<=0)break;t[a][a]=Math.sqrt(o)}r[1]=0}}(t,0,r,j),0!==j[1])return void(b[1]=2);(function(t,e,i,r){let n,s;for(n=1;n<=i;n+=1){s=0;for(let e=1;e<n;e+=1)s+=t[e][n]*r[e];r[n]=(r[n]-s)/t[n][n]}for(let o=1;o<=i;o+=1){n=i+1-o,r[n]/=t[n][n],s=-r[n];for(let e=1;e<n;e+=1)r[e]+=s*t[e][n]}})(t,0,r,e),function(t,e,i){let r,n;for(let s=1;s<=i;s+=1){t[s][s]=1/t[s][s],n=-t[s][s];for(let e=1;e<s;e+=1)t[e][s]*=n;if(r=s+1,i<r)break;for(let e=r;e<=i;e+=1){n=t[s][e],t[s][e]=0;for(let i=1;i<=s;i+=1)t[i][e]+=n*t[i][s]}}}(t,0,r)}else{for(let i=1;i<=r;i+=1){n[i]=0;for(let r=1;r<=i;r+=1)n[i]+=t[r][i]*e[r]}for(let i=1;i<=r;i+=1){e[i]=0;for(let s=i;s<=r;s+=1)e[i]+=t[i][s]*n[s]}}o[1]=0;for(let x=1;x<=r;x+=1){n[x]=e[x],o[1]+=v[x]*n[x],v[x]=0;for(let e=x+1;e<=r;e+=1)t[e][x]=0}o[1]=-o[1]/2,b[1]=0;const N=r,D=N+r,z=D+R,A=z+R+1,P=A+R*(R+1)/2,L=P+c;for(let x=1;x<=c;x+=1){C=0;for(let t=1;t<=r;t+=1)C+=a[t][x]*a[t][x];v[L+x]=Math.sqrt(C)}function $(){p[1]+=1,T=P;for(let t=1;t<=c;t+=1){T+=1,C=-h[t];for(let e=1;e<=r;e+=1)C+=a[e][t]*n[e];if(Math.abs(C)<x&&(C=0),t>d)v[T]=C;else if(v[T]=-Math.abs(C),C>0){for(let e=1;e<=r;e+=1)a[e][t]=-a[e][t];h[t]=-h[t]}}for(let t=1;t<=w;t+=1)v[P+u[t]]=0;y=0,_=0;for(let t=1;t<=c;t+=1)v[P+t]<_*v[L+t]&&(y=t,_=v[P+t]/v[L+t]);if(0===y){for(let t=1;t<=w;t+=1)s[u[t]]=v[z+t];return 999}return 0}function W(){for(let e=1;e<=r;e+=1){C=0;for(let i=1;i<=r;i+=1)C+=t[i][e]*a[i][y];v[e]=C}g=N;for(let t=1;t<=r;t+=1)v[g+t]=0;for(let e=w+1;e<=r;e+=1)for(let i=1;i<=r;i+=1)v[g+i]=v[g+i]+t[i][e]*v[e];M=!0;for(let t=w;t>=1;t-=1){C=v[t],T=A+t*(t+3)/2,g=T-t;for(let e=t+1;e<=w;e+=1)C-=v[T]*v[D+e],T+=e;C/=v[g],v[D+t]=C,u[t]<=d||C<=0||(M=!1,m=t)}if(!M){I=v[z+m]/v[D+m];for(let t=1;t<=w;t+=1)u[t]<=d||v[D+t]<=0||(_=v[z+t]/v[D+t],_<I&&(I=_,m=t))}C=0;for(let t=N+1;t<=N+r;t+=1)C+=v[t]*v[t];if(Math.abs(C)<=x){if(M)return b[1]=1,999;for(let t=1;t<=w;t+=1)v[z+t]=v[z+t]-I*v[D+t];return v[z+w+1]=v[z+w+1]+I,700}C=0;for(let t=1;t<=r;t+=1)C+=v[N+t]*a[t][y];E=-v[P+y]/C,B=!0,M||I<E&&(E=I,B=!1);for(let t=1;t<=r;t+=1)n[t]+=E*v[N+t],Math.abs(n[t])<x&&(n[t]=0);o[1]+=E*C*(E/2+v[z+w+1]);for(let t=1;t<=w;t+=1)v[z+t]=v[z+t]-E*v[D+t];if(v[z+w+1]=v[z+w+1]+E,!B){C=-h[y];for(let t=1;t<=r;t+=1)C+=n[t]*a[t][y];if(y>d)v[P+y]=C;else if(v[P+y]=-Math.abs(C),C>0){for(let t=1;t<=r;t+=1)a[t][y]=-a[t][y];h[y]=-h[y]}return 700}w+=1,u[w]=y,T=A+(w-1)*w/2+1;for(let t=1;t<=w-1;t+=1)v[T]=v[t],T+=1;if(w===r)v[T]=v[r];else{for(let e=r;e>=w+1;e-=1)if(0!==v[e]&&(S=Math.max(Math.abs(v[e-1]),Math.abs(v[e])),O=Math.min(Math.abs(v[e-1]),Math.abs(v[e])),_=v[e-1]>=0?Math.abs(S*Math.sqrt(1+O*O/(S*S))):-Math.abs(S*Math.sqrt(1+O*O/(S*S))),S=v[e-1]/_,O=v[e]/_,1!==S))if(0===S){v[e-1]=O*_;for(let i=1;i<=r;i+=1)_=t[i][e-1],t[i][e-1]=t[i][e],t[i][e]=_}else{v[e-1]=_,k=O/(1+S);for(let i=1;i<=r;i+=1)_=S*t[i][e-1]+O*t[i][e],t[i][e]=k*(t[i][e-1]+_)-t[i][e],t[i][e-1]=_}v[T]=v[w]}return 0}function F(){if(T=A+m*(m+1)/2+1,g=T+m,0===v[g])return 798;if(S=Math.max(Math.abs(v[g-1]),Math.abs(v[g])),O=Math.min(Math.abs(v[g-1]),Math.abs(v[g])),_=v[g-1]>=0?Math.abs(S*Math.sqrt(1+O*O/(S*S))):-Math.abs(S*Math.sqrt(1+O*O/(S*S))),S=v[g-1]/_,O=v[g]/_,1===S)return 798;if(0===S){for(let t=m+1;t<=w;t+=1)_=v[g-1],v[g-1]=v[g],v[g]=_,g+=t;for(let e=1;e<=r;e+=1)_=t[e][m],t[e][m]=t[e][m+1],t[e][m+1]=_}else{k=O/(1+S);for(let t=m+1;t<=w;t+=1)_=S*v[g-1]+O*v[g],v[g]=k*(v[g-1]+_)-v[g],v[g-1]=_,g+=t;for(let e=1;e<=r;e+=1)_=S*t[e][m]+O*t[e][m+1],t[e][m+1]=k*(t[e][m]+_)-t[e][m+1],t[e][m]=_}return 0}function q(){g=T-m;for(let t=1;t<=m;t+=1)v[g]=v[T],T+=1,g+=1;return v[z+m]=v[z+m+1],u[m]=u[m+1],m+=1,m<w?797:0}function H(){return v[z+w]=v[z+w+1],v[z+w+1]=0,u[w]=0,w-=1,p[2]+=1,0}for(w=f,p[1]=0,p[2]=0,V=0;;){if(V=$(),999===V)return;for(;V=W(),0!==V;){if(999===V)return;if(700===V)if(m===w)H();else{for(;F(),V=q(),797===V;);H()}}}}(t,e,0,f,h,l,o,i,r,0,p,n,a,0,d,c,s),1===s[1]&&(u="constraints are inconsistent, no solution!"),2===s[1]&&(u="matrix D in quadratic function is not positive definite!"),{solution:h,Lagrangian:l,value:o,unconstrained_solution:e,iterations:d,iact:a,message:u}};function C(t,e){let[i,...r]=t,n=i.x=0;for(const s of r)n=s.x=n+e(i,s),i=s;if(n>0)for(const s of t)s.x/=n;else for(const s of t)s.x=.5}function I(t,e,i,r){t[i][i]+=r,t[i][e]-=r,t[e][i]-=r,t[e][e]+=r}function E(t,e,i,r,n){t[r][r]+=n,t[r][i]-=2*n,t[r][e]+=n,t[i][r]-=2*n,t[i][i]+=4*n,t[i][e]-=2*n,t[e][r]+=n,t[e][i]-=2*n,t[e][e]+=n}class S extends f{constructor(t){super(t,void 0)}}function O(t,e,i,r){this.feasible=i,this.evaluation=e,this.bounded=r,this._tableau=t}var k=O;function M(t,e,i,r,n){k.call(this,t,e,i,r),this.iter=n}O.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,r=e.variablesPerIndex,n=e.matrix,s=e.rhsColumn,o=e.height-1,a=Math.round(1/e.precision),h=1;h<=o;h+=1){var l=r[i[h]];void 0!==l&&!0!==l.isSlack&&(t[l.id]=Math.round((Number.EPSILON+n[h][s])*a)/a)}return t};var B=M;function V(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}M.prototype=Object.create(k.prototype),M.constructor=M;var R=V;function T(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}V.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},T.prototype.copy=function(){var t=new T(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},V.prototype.setOptionalObjective=function(t,e,i){var r=this.objectivesByPriority[t];void 0===r&&(r=new T(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=r,this.optionalObjectives.push(r),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),r.reducedCosts[e]=i},V.prototype.initialize=function(t,e,i,r){this.variables=i,this.unrestrictedVars=r,this.width=t,this.height=e;for(var n=new Array(t),s=0;s<t;s++)n[s]=0;this.matrix=new Array(e);for(var o=0;o<e;o++)this.matrix[o]=n.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},V.prototype._resetMatrix=function(){var t,e,i=this.model.variables,r=this.model.constraints,n=i.length,s=r.length,o=this.matrix[0],a=!0===this.model.isMinimization?-1:1;for(t=0;t<n;t+=1){var h=i[t],l=h.priority,c=a*h.cost;0===l?o[t+1]=c:this.setOptionalObjective(l,t+1,c),this.rowByVarIndex[e=i[t].index]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var d=1,u=0;u<s;u+=1){var f,p,v=r[u],b=v.index;this.rowByVarIndex[b]=d,this.colByVarIndex[b]=-1,this.varIndexByRow[d]=b;var g=v.terms,m=g.length,y=this.matrix[d++];if(v.isUpperBound){for(f=0;f<m;f+=1)y[this.colByVarIndex[(p=g[f]).variable.index]]=p.coefficient;y[0]=v.rhs}else{for(f=0;f<m;f+=1)y[this.colByVarIndex[(p=g[f]).variable.index]]=-p.coefficient;y[0]=-v.rhs}}},V.prototype.setModel=function(t){return this.model=t,this.initialize(t.nVariables+1,t.nConstraints+1,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},V.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},V.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var r=e[i],n=0;n<this.width;n++)0!==r[n]&&(t+=1);return t/(this.height*this.width)},V.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*t)/t;this.evaluation=e,0===this.simplexIters&&(this.bestPossibleEval=e)},V.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new B(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new k(this,t,this.feasible,this.bounded)},R.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},R.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,r=this.rhsColumn,n=this.width-1,s=this.height-1,o=0;;){for(var a=0,h=-this.precision,l=1;l<=s;l++){var c=i[l][r];c<h&&(h=c,a=l)}if(0===a)return this.feasible=!0,o;for(var d=0,u=-1/0,f=i[0],p=i[a],v=1;v<=n;v++){var b=p[v];if(!0===this.unrestrictedVars[this.varIndexByCol[v]]||b<-this.precision){var g=-f[v]/b;u<g&&(u=g,d=v)}}if(0===d)return this.feasible=!1,o;if(t){e.push([this.varIndexByRow[a],this.varIndexByCol[d]]);var m=this.checkForCycles(e);if(m.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+m[0]),this.model.messages.push("Length :"+m[1]),this.feasible=!1,o}this.pivot(a,d),o+=1}},R.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,r=[],n=this.matrix,s=this.rhsColumn,o=this.width-1,a=this.height-1,h=this.precision,l=this.optionalObjectives.length,c=null,d=0;;){var u=n[this.costRowIndex];l>0&&(c=[]);for(var f=0,p=h,v=!1,b=1;b<=o;b++)t=u[b],e=!0===this.unrestrictedVars[this.varIndexByCol[b]],l>0&&-h<t&&t<h?c.push(b):e&&t<0?-t>p&&(p=-t,f=b,v=!0):t>p&&(p=t,f=b,v=!1);if(l>0)for(var g=0;0===f&&c.length>0&&g<l;){var m=[],y=this.optionalObjectives[g].reducedCosts;p=h;for(var w=0;w<c.length;w++)e=!0===this.unrestrictedVars[this.varIndexByCol[b=c[w]]],-h<(t=y[b])&&t<h?m.push(b):e&&t<0?-t>p&&(p=-t,f=b,v=!0):t>p&&(p=t,f=b,v=!1);c=m,g+=1}if(0===f)return this.setEvaluation(),this.simplexIters+=1,d;for(var x=0,_=1/0,C=1;C<=a;C++){var I=n[C],E=I[s],S=I[f];if(!(-h<S&&S<h)){if(S>0&&h>E&&E>-h){_=0,x=C;break}var O=v?-E/S:E/S;O>h&&_>O&&(_=O,x=C)}}if(_===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],d;if(i){r.push([this.varIndexByRow[x],this.varIndexByCol[f]]);var k=this.checkForCycles(r);if(k.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+k[0]),this.model.messages.push("Length :"+k[1]),this.feasible=!1,d}this.pivot(x,f,!0),d+=1}};var j=[];function N(t,e,i,r){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=r}function D(t,e,i,r){N.call(this,t,e,i,r)}function z(t,e){N.call(this,t,0,e,0)}function A(t,e){this.variable=t,this.coefficient=e}function P(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function L(t,e,i,r){this.slack=new z("s"+i,i),this.index=i,this.model=r,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function $(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}R.prototype.pivot=function(t,e){var i=this.matrix,r=i[t][e],n=this.height-1,s=this.width-1,o=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=o,this.rowByVarIndex[a]=t,this.rowByVarIndex[o]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[o]=e;for(var h,l,c,d=i[t],u=0,f=0;f<=s;f++)d[f]>=-1e-16&&d[f]<=1e-16?d[f]=0:(d[f]/=r,j[u]=f,u+=1);d[e]=1/r;for(var p=0;p<=n;p++)if(p!==t&&!(i[p][e]>=-1e-16&&i[p][e]<=1e-16)){var v=i[p];if((h=v[e])>=-1e-16&&h<=1e-16)0!==h&&(v[e]=0);else{for(l=0;l<u;l++)(c=d[f=j[l]])>=-1e-16&&c<=1e-16?0!==c&&(d[f]=0):v[f]=v[f]-h*c;v[e]=-h/r}}var b=this.optionalObjectives.length;if(b>0)for(var g=0;g<b;g+=1){var m=this.optionalObjectives[g].reducedCosts;if(0!==(h=m[e])){for(l=0;l<u;l++)0!==(c=d[f=j[l]])&&(m[f]=m[f]-h*c);m[e]=-h/r}}},R.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var r=t[e],n=t[i];if(r[0]===n[0]&&r[1]===n[1]){if(i-e>t.length-i)break;for(var s=!0,o=1;o<i-e;o++){var a=t[e+o],h=t[i+o];if(a[0]!==h[0]||a[1]!==h[1]){s=!1;break}}if(s)return[e,i-e]}}return[]},D.prototype.isInteger=!0,z.prototype.isSlack=!0,L.prototype.addTerm=function(t,e){var i=e.index,r=this.termsByVarIndex[i];return void 0===r?(r=new A(e,t),this.termsByVarIndex[i]=r,this.terms.push(r),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t)):this.setVariableCoefficient(r.coefficient+t,e),this},L.prototype.removeTerm=function(t){return this},L.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},L.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var r=this.termsByVarIndex[i];if(void 0===r)this.addTerm(t,e);else if(t!==r.coefficient){var n=t-r.coefficient;!0===this.isUpperBound&&(n=-n),r.coefficient=t,this.model.updateConstraintCoefficient(this,e,n)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},L.prototype.relax=function(t,e){this.relaxation=P(this.model,t,e),this._relax(this.relaxation)},L.prototype._relax=function(t){null!==t&&this.setVariableCoefficient(this.isUpperBound?-1:1,t)},$.prototype.isEquality=!0,$.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},$.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},$.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},$.prototype.relax=function(t,e){this.relaxation=P(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var W={Constraint:L,Variable:N,IntegerVariable:D,SlackVariable:z,Equality:$,Term:A},F=W.SlackVariable;function q(t,e){this.index=t,this.value=e}R.prototype.addCutConstraints=function(t){for(var e,i=t.length,r=this.height,n=r+i,s=r;s<n;s+=1)void 0===this.matrix[s]&&(this.matrix[s]=this.matrix[s-1].slice());this.height=n,this.nVars=this.width+this.height-2;for(var o=this.width-1,a=0;a<i;a+=1){var h=t[a],l=r+a,c="min"===h.type?-1:1,d=h.varIndex,u=this.rowByVarIndex[d],f=this.matrix[l];if(-1===u){for(f[this.rhsColumn]=c*h.value,e=1;e<=o;e+=1)f[e]=0;f[this.colByVarIndex[d]]=c}else{var p=this.matrix[u];for(f[this.rhsColumn]=c*(h.value-p[this.rhsColumn]),e=1;e<=o;e+=1)f[e]=-c*p[e]}var v=this.getNewElementIndex();this.varIndexByRow[l]=v,this.rowByVarIndex[v]=l,this.colByVarIndex[v]=-1,this.variablesPerIndex[v]=new F("s"+v,v),this.nVars+=1}},R.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],r=i-Math.floor(i);if(r<this.precision||1-this.precision<r)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var s=this.getNewElementIndex();this.varIndexByRow[n]=s,this.rowByVarIndex[s]=n,this.colByVarIndex[s]=-1,this.variablesPerIndex[s]=new F("s"+s,s),e[n][this.rhsColumn]=Math.floor(i);for(var o=1;o<this.varIndexByCol.length;o+=1)if(this.variablesPerIndex[this.varIndexByCol[o]].isInteger){var a=e[t][o],h=Math.floor(a)+Math.max(0,a-Math.floor(a)-r)/(1-r);e[n][o]=h}else e[n][o]=Math.min(0,e[t][o]/(1-r));for(var l=0;l<this.width;l+=1)e[n][l]-=e[t][l];return!0},R.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],r=i-Math.floor(i);if(r<this.precision||1-this.precision<r)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var s=this.getNewElementIndex();this.varIndexByRow[n]=s,this.rowByVarIndex[s]=n,this.colByVarIndex[s]=-1,this.variablesPerIndex[s]=new F("s"+s,s),e[n][this.rhsColumn]=-r;for(var o=1;o<this.varIndexByCol.length;o+=1){var a=this.variablesPerIndex[this.varIndexByCol[o]],h=e[t][o],l=h-Math.floor(h);e[n][o]=a.isInteger?l<=r?-l:-(1-l)*r/l:h>=0?-h:h*r/(1-r)}return!0},R.prototype.applyMIRCuts=function(){},R.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],r=1;r<this.height;r+=1){var n=this.matrix[r][i];if(n<-this.precision||this.precision<n){e=r;break}}this.pivot(e,i)}return e},R.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],r=this.matrix[i],n=1;n<this.height;n+=1){var s=r[n];if(s<-this.precision||this.precision<s){e=n;break}}this.pivot(i,e)}return e},R.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var r=this.variables[i],n=this.rowByVarIndex[r.index];r.value=-1===n?0:Math.round((this.matrix[n][this.rhsColumn]+Number.EPSILON)*e)/e}},R.prototype.updateRightHandSide=function(t,e){var i=this.height-1,r=this.rowByVarIndex[t.index];if(-1===r){for(var n=this.colByVarIndex[t.index],s=0;s<=i;s+=1){var o=this.matrix[s];o[this.rhsColumn]-=e*o[n]}var a=this.optionalObjectives.length;if(a>0)for(var h=0;h<a;h+=1){var l=this.optionalObjectives[h].reducedCosts;l[this.rhsColumn]-=e*l[n]}}else this.matrix[r][this.rhsColumn]-=e},R.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(t.index),n=this.colByVarIndex[e.index];if(-1===n)for(var s=this.rowByVarIndex[e.index],o=0;o<this.width;o+=1)this.matrix[r][o]+=i*this.matrix[s][o];else this.matrix[r][n]-=i},R.prototype.updateCost=function(t,e){var i=t.index,r=this.width-1,n=this.colByVarIndex[i];if(-1===n){var s,o=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var a=this.matrix[0];for(s=0;s<=r;s+=1)a[s]+=e*o[s]}else{var h=this.objectivesByPriority[t.priority].reducedCosts;for(s=0;s<=r;s+=1)h[s]+=e*o[s]}}else this.matrix[0][n]-=e},R.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,r=this.matrix[i];void 0===r&&(r=this.matrix[0].slice(),this.matrix[i]=r);for(var n=this.width-1,s=0;s<=n;s+=1)r[s]=0;r[this.rhsColumn]=e*t.rhs;for(var o=t.terms,a=o.length,h=0;h<a;h+=1){var l=o[h],c=l.coefficient,d=l.variable.index,u=this.rowByVarIndex[d];if(-1===u)r[this.colByVarIndex[d]]+=e*c;else{var f=this.matrix[u];for(s=0;s<=n;s+=1)r[s]-=e*c*f[s]}}var p=t.index;this.varIndexByRow[i]=p,this.rowByVarIndex[p]=i,this.colByVarIndex[p]=-1,this.height+=1},R.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,r=this._putInBase(e),n=this.matrix[i];this.matrix[i]=this.matrix[r],this.matrix[r]=n,this.varIndexByRow[r]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1},R.prototype.addVariable=function(t){var e=this.height-1,i=this.width,r=!0===this.model.isMinimization?-t.cost:t.cost,n=t.priority,s=this.optionalObjectives.length;if(s>0)for(var o=0;o<s;o+=1)this.optionalObjectives[o].reducedCosts[i]=0;0===n?this.matrix[0][i]=r:(this.setOptionalObjective(n,i,r),this.matrix[0][i]=0);for(var a=1;a<=e;a+=1)this.matrix[a][i]=0;var h=t.index;this.varIndexByCol[i]=h,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=i,this.width+=1},R.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),r=this.width-1;if(i!==r){for(var n=this.height-1,s=0;s<=n;s+=1){var o=this.matrix[s];o[i]=o[r]}var a=this.optionalObjectives.length;if(a>0)for(var h=0;h<a;h+=1){var l=this.optionalObjectives[h].reducedCosts;l[i]=l[r]}var c=this.varIndexByCol[r];this.varIndexByCol[i]=c,this.colByVarIndex[c]=i}this.varIndexByCol[r]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1},R.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i,r,n,s,o,a,h,l,c,d,u="",f=[" "];for(r=1;r<this.width;r+=1)h=" ",l="\t",(a=void 0===(s=this.variablesPerIndex[o=this.varIndexByCol[r]])?"c"+o:s.id).length>5?h+=" ":l+="\t",f[r]=h,u+=l+a;console.log(u);var p=this.matrix[this.costRowIndex],v="\t";for(i=1;i<this.width;i+=1)v+="\t",v+=f[i],v+=p[i].toFixed(5);for(v+="\t"+f[0]+p[0].toFixed(5),console.log(v+"\tZ"),n=1;n<this.height;n+=1){for(c=this.matrix[n],d="\t",r=1;r<this.width;r+=1)d+="\t"+f[r]+c[r].toFixed(5);d+="\t"+f[0]+c[0].toFixed(5),a=void 0===(s=this.variablesPerIndex[o=this.varIndexByRow[n]])?"c"+o:s.id,console.log(d+"\t"+a)}console.log("");var b=this.optionalObjectives.length;if(b>0){console.log("    Optional objectives:");for(var g=0;g<b;g+=1){var m=this.optionalObjectives[g].reducedCosts,y="";for(i=1;i<this.width;i+=1)y+=m[i]<0?"":" ",y+=f[i],y+=m[i].toFixed(5);y+=(m[0]<0?"":" ")+f[0]+m[0].toFixed(5),console.log(y+" z"+g)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},R.prototype.copy=function(){var t=new R(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var r=this.matrix,n=new Array(this.height),s=0;s<this.height;s++)n[s]=r[s].slice();return t.matrix=n,t},R.prototype.save=function(){this.savedState=this.copy()},R.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,r=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var n=r[t],s=this.matrix[t];for(e=0;e<this.width;e+=1)s[e]=n[e]}var o=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=o[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=a[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var h=i.rowByVarIndex,l=i.colByVarIndex,c=0;c<this.nVars;c+=1)this.rowByVarIndex[c]=h[c],this.colByVarIndex[c]=l[c];if(i.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var d=0;d<i.optionalObjectives.length;d++){var u=i.optionalObjectives[d].copy();this.optionalObjectives[d]=u,this.optionalObjectivePerPriority[u.priority]=u}}}},R.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,r=this.model.integerVariables,n=r.length,s=0;s<n;s++){var o=r[s].index,a=this.rowByVarIndex[o];if(-1!==a){var h=this.matrix[a][this.rhsColumn],l=Math.abs(h-Math.round(h));t<l&&(t=l,e=o,i=h)}}return new q(e,i)},R.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,r=this.model.integerVariables,n=r.length,s=0;s<n;s++){var o=r[s],a=o.index,h=this.rowByVarIndex[a];if(-1!==h){var l=this.matrix[h][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision){var c=o.cost;t>c&&(t=c,e=a,i=l)}}}return new q(e,i)},R.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},R.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var r=this.rowByVarIndex[t[i].index];if(-1!==r){var n=this.matrix[r][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision)return!1}}return!0},R.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var r=this.matrix[i][this.rhsColumn];if(r=Math.abs(r),Math.min(r-Math.floor(r),Math.floor(r+1))<this.precision){if(!t)return 0}else-1===e?e=r:e*=r}return-1===e?0:e};var H=R;function U(t,e,i){this.type=t,this.varIndex=e,this.value=i}function Z(t,e){this.relaxedEvaluation=t,this.cuts=e}function G(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}R.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*i&&(e=!1)}},R.prototype.branchAndCut=function(){var t=[],e=0,i=this.model.tolerance,r=!0,n=1e99;this.model.timeout&&(n=Date.now()+this.model.timeout);for(var s=1/0,o=null,a=[],h=0;h<this.optionalObjectives.length;h+=1)a.push(1/0);var l=new Z(-1/0,[]);for(t.push(l);t.length>0&&!0===r&&Date.now()<n;)if(i>0&&s<(this.model.isMinimization?this.bestPossibleEval*(1+i):this.bestPossibleEval*(1-i))&&(r=!1),!((l=t.pop()).relaxedEvaluation>s)){var c=l.cuts;if(this.applyCuts(c),e++,!1!==this.feasible){var d=this.evaluation;if(!(d>s)){if(d===s){for(var u=!0,f=0;f<this.optionalObjectives.length&&!(this.optionalObjectives[f].reducedCosts[0]>a[f]);f+=1)if(this.optionalObjectives[f].reducedCosts[0]<a[f]){u=!1;break}if(u)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===e)return void(this.branchAndCutIterations=e);o=l,s=d;for(var p=0;p<this.optionalObjectives.length;p+=1)a[p]=this.optionalObjectives[p].reducedCosts[0]}else{1===e&&this.save();for(var v=this.getMostFractionalVar(),b=v.index,g=[],m=[],y=c.length,w=0;w<y;w+=1){var x=c[w];x.varIndex===b?"min"===x.type?m.push(x):g.push(x):(g.push(x),m.push(x))}var _=Math.ceil(v.value),C=Math.floor(v.value),I=new U("min",b,_);g.push(I);var E=new U("max",b,C);m.push(E),t.push(new Z(d,g)),t.push(new Z(d,m)),t.sort(G)}}}}null!==o&&this.applyCuts(o.cuts),this.branchAndCutIterations=e};var J={},X=W.Constraint,Q=W.Equality,Y=W.Variable,K=W.IntegerVariable;function tt(t,e){this.tableau=new R(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var et=tt;tt.prototype.minimize=function(){return this.isMinimization=!0,this},tt.prototype.maximize=function(){return this.isMinimization=!1,this},tt.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},tt.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},tt.prototype.smallerThan=function(t){var e=new X(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.greaterThan=function(t){var e=new X(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.equal=function(t){var e=new X(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new X(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new Q(e,i)},tt.prototype.addVariable=function(t,e,i,r,n){if("string"==typeof n)switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0}var s,o=this.tableau.getNewElementIndex();return null==e&&(e="v"+o),null==t&&(t=0),null==n&&(n=0),i?(s=new K(e,t,o,n),this.integerVariables.push(s)):s=new Y(e,t,o,n),this.variables.push(s),this.tableau.variablesPerIndex[o]=s,r&&(this.unrestrictedVariables[o]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(s),s},tt.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},tt.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},tt.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},tt.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},tt.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},tt.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},tt.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,r={},n={},s=Object.keys(i),o=s.length,a=0;a<o;a+=1){var h,l,c=s[a],d=i[c],u=d.equal,f=d.weight,p=d.priority,v=void 0!==f||void 0!==p;if(void 0===u){var b=d.min;void 0!==b&&(h=this.greaterThan(b),r[c]=h,v&&h.relax(f,p));var g=d.max;void 0!==g&&(l=this.smallerThan(g),n[c]=l,v&&l.relax(f,p))}else{h=this.greaterThan(u),r[c]=h,l=this.smallerThan(u),n[c]=l;var m=new Q(h,l);v&&m.relax(f,p)}}var y=Object.keys(e),w=y.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),0===this.tolerance&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),this.checkForCycles=void 0===t.options.exitOnCycles||t.options.exitOnCycles);for(var x=t.ints||{},_=t.binaries||{},C=t.unrestricted||{},I=t.optimize,E=0;E<w;E+=1){var S=y[E],O=e[S],k=!!_[S],M=this.addVariable(O[I]||0,S,!!x[S]||k,!!C[S]);k&&this.smallerThan(1).addTerm(1,M);var B=Object.keys(O);for(a=0;a<B.length;a+=1){var V=B[a];if(V!==I){var R=O[V],T=r[V];void 0!==T&&T.addTerm(R,M);var j=n[V];void 0!==j&&j.addTerm(R,M)}}}return this},tt.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},tt.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},tt.prototype.isFeasible=function(){return this.tableau.feasible},tt.prototype.save=function(){return this.tableau.save()},tt.prototype.restore=function(){return this.tableau.restore()},tt.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},tt.prototype.debug=function(t){this.checkForCycles=t},tt.prototype.log=function(t){return this.tableau.log(t)};var it={CleanObjectiveAttributes:function(t){var e,i,r;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(r in t.optimize)if(t.constraints[r])if("equal"===t.constraints[r])delete t.optimize[r];else{for(i in e=Math.random(),t.variables)t.variables[i][r]&&(t.variables[i][e]=t.variables[i][r]);t.constraints[e]=t.constraints[r],delete t.constraints[r]}return t}},rt=function(t){return t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},n="",s=null,o="",a="",h="",l=0;"string"==typeof t&&(t=t.split("\n"));for(var c=0;c<t.length;c++)if(h="__"+c,s=null,e.is_objective.test(n=t[c]))i.opType=n.match(/(max|min)/gi)[0],(s=n.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){o=null===(o=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:o[0],o=parseFloat(o),a=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[a]=i.variables[a]||{},i.variables[a]._obj=o}));else if(e.is_int.test(n))s=n.match(e.parse_int).slice(1),i.ints=i.ints||{},s.forEach((function(t){t=t.replace(";",""),i.ints[t]=1}));else if(e.is_bin.test(n))s=n.match(e.parse_bin).slice(1),i.binaries=i.binaries||{},s.forEach((function(t){t=t.replace(";",""),i.binaries[t]=1}));else if(e.is_constraint.test(n)){var d=n.indexOf(":");(s=(-1===d?n:n.slice(d+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){o=null===(o=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:o[0],o=parseFloat(o),a=t.match(e.get_word)[0],i.variables[a]=i.variables[a]||{},i.variables[a][h]=o})),l=parseFloat(n.match(e.parse_rhs)[0]),n=r[n.match(e.parse_dir)[0]],i.constraints[h]=i.constraints[h]||{},i.constraints[h][n]=l}else e.is_unrestricted.test(n)&&(s=n.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},s.forEach((function(t){t=t.replace(";",""),i.unrestricted[t]=1})));return i}(t):function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType)for(var n in e+=t.opType+":",t.variables)t.variables[n][n]=t.variables[n][n]?t.variables[n][n]:1,t.variables[n][t.optimize]&&(e+=" "+t.variables[n][t.optimize]+" "+n.replace(r,"_"));else e+="max:";for(var s in e+=";\n\n",t.constraints)for(var o in t.constraints[s])if(void 0!==i[o]){for(var a in t.variables)void 0!==t.variables[a][s]&&(e+=" "+t.variables[a][s]+" "+a.replace(r,"_"));e+=" "+i[o]+" "+t.constraints[s][o],e+=";\n"}if(t.ints)for(var h in e+="\n\n",t.ints)e+="int "+h.replace(r,"_")+";\n";if(t.unrestricted)for(var l in e+="\n\n",t.unrestricted)e+="unrestricted "+l.replace(r,"_")+";\n";return e}(t)};function nt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})})),e}var st=nt(Object.freeze({__proto__:null,default:{}}));function ot(t){return(t=(t=t.replace("\\r\\n","\r\n")).split("\r\n")).filter((function(t){return!0!==new RegExp(" 0$","gi").test(t)&&!1!==new RegExp("\\d$","gi").test(t)})).map((function(t){return t.split(/\:{0,1} +(?=\d)/)})).reduce((function(t,e,i){return t[e[0]]=e[1],t}),{})}var at={lpsolve:{reformat:rt,solve:function(t){return new Promise((function(e,i){"undefined"!=typeof window&&i("Function Not Available in Browser");var r=rt(t);t.external||i("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||i("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||i("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||i("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),st.writeFile(t.external.tempName,r,(function(r,n){if(r)i(r);else{var s=st.execFile;t.external.args.push(t.external.tempName),s(t.external.binPath,t.external.args,(function(t,r){t?1===t.code?e(ot(r)):i({code:t.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[t.code],data:r}):e(ot(r))}))}}))}))}}},ht=function(t,e){var i,r,n,s,o,a=e.optimize,h=JSON.parse(JSON.stringify(e.optimize)),l=Object.keys(e.optimize),c=0,d={},u="",f={},p=[];for(delete e.optimize,r=0;r<l.length;r++)h[l[r]]=0;for(r=0;r<l.length;r++){for(o in e.optimize=l[r],e.opType=a[l[r]],i=t.Solve(e,void 0,void 0,!0),l)if(!e.variables[l[o]])for(s in i[l[o]]=i[l[o]]?i[l[o]]:0,e.variables)e.variables[s][l[o]]&&i[s]&&(i[l[o]]+=i[s]*e.variables[s][l[o]]);for(u="base",n=0;n<l.length;n++)u+=i[l[n]]?"-"+(1e3*i[l[n]]|0)/1e3:"-0";if(!d[u]){for(d[u]=1,c++,n=0;n<l.length;n++)i[l[n]]&&(h[l[n]]+=i[l[n]]);delete i.feasible,delete i.result,p.push(i)}}for(r=0;r<l.length;r++)e.constraints[l[r]]={equal:h[l[r]]/c};for(r in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[r].cheater=1;for(r in p)for(s in p[r])f[s]=f[s]||{min:1e99,max:-1e99};for(r in f)for(s in p)p[s][r]?(p[s][r]>f[r].max&&(f[r].max=p[s][r]),p[s][r]<f[r].min&&(f[r].min=p[s][r])):(p[s][r]=0,f[r].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:p,ranges:f}},lt=W.Constraint,ct=W.Variable,dt=W.Numeral,ut=W.Term,ft=function(){this.Model=et,this.branchAndCut=J,this.Constraint=lt,this.Variable=ct,this.Numeral=dt,this.Term=ut,this.Tableau=H,this.lastSolvedModel=null,this.External=at,this.Solve=function(t,e,i,r){if(r)for(var n in it)t=it[n](t);if(!t)throw new Error("Solver requires a model to operate on");if("object"==typeof t.optimize&&Object.keys(t.optimize>1))return ht(this,t);if(t.external){var s=Object.keys(at);if(s=JSON.stringify(s),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+s);if(!at[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+s);return at[t.external.solver].solve(t)}t instanceof et==0&&(t=new et(e).loadJson(t));var o=t.solve();if(this.lastSolvedModel=t,o.solutionSet=o.generateSolutionSet(),i)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,o._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(o.solutionSet).forEach((function(t){0!==o.solutionSet[t]&&(a[t]=o.solutionSet[t])})),a},this.ReformatLP=rt,this.MultiObjective=function(t){return ht(this,t)}};"object"==typeof window?window.solver=new ft:"object"==typeof self&&(self.solver=new ft);var pt=new ft;function vt(){}function bt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function gt(t,e){let i;if(void 0===e)for(const r of t)null!=r&&(i<r||void 0===i&&r>=r)&&(i=r);else{let r=-1;for(let n of t)null!=(n=e(n,++r,t))&&(i<n||void 0===i&&n>=n)&&(i=n)}return i}function mt(t,e){let i;if(void 0===e)for(const r of t)null!=r&&(i>r||void 0===i&&r>=r)&&(i=r);else{let r=-1;for(let n of t)null!=(n=e(n,++r,t))&&(i>n||void 0===i&&n>=n)&&(i=n)}return i}function yt(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function wt(t,e,i){if(r=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(yield i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(r=+r)>=r&&(yield r)}}(t,i))).length){if((e=+e)<=0||r<2)return mt(t);if(e>=1)return gt(t);var r,n=(r-1)*e,s=Math.floor(n),o=gt(function t(e,i,r=0,n=e.length-1,s=bt){for(;n>r;){if(n-r>600){const o=n-r+1,a=i-r+1,h=Math.log(o),l=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*l*(o-l)/o)*(a-o/2<0?-1:1);t(e,i,Math.max(r,Math.floor(i-a*l/o+c)),Math.min(n,Math.floor(i+(o-a)*l/o+c)),s)}const o=e[i];let a=r,h=n;for(yt(e,r,i),s(e[n],o)>0&&yt(e,r,n);a<h;){for(yt(e,a,h),++a,--h;s(e[a],o)<0;)++a;for(;s(e[h],o)>0;)--h}0===s(e[r],o)?yt(e,r,h):(++h,yt(e,h,n)),h<=i&&(r=h+1),i<=h&&(n=h-1)}return e}(t,s).subarray(0,s+1));return o+(mt(t.subarray(s+1))-o)*(n-s)}}function xt(t,e){return+!(t instanceof S)+ +!(e instanceof S)}function _t(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return function t(e,i,r,n,s,o,a){const[h,l]=s;function c(t){e(t);for(const e of t){const t=e.layer;if(void 0===t)throw new Error(`layering did not assign layer to node '${e.id}'`);if(t<0)throw new Error(`layering assigned a negative layer (${t}) to node '${e.id}'`)}const s=function(t){const e=[];for(const i of t.descendants()){const t=i.layer;(e[t]||(e[t]=[])).push(i),i.dataChildren=i.dataChildren.map(r=>{const n=r.child.layer;if(n<=t)throw new Error(`layering left child node "${r.child.id}" (${n}) with a greater or equal layer to parent node "${i.id}" (${t})`);let s=r.child;for(let o=n-1;o>t;o--){let t;t=a?`${i.id}->${r.child.id} (${o})`:`${i.id}\0${r.child.id}\0${o}`;const n=new S(t);n.dataChildren.push(new d(s,void 0)),(e[o]||(e[o]=[])).push(n),s=n}return new d(s,r.data)})}return e}(t);if(1===s.length){const[t]=s;for(const e of t)e.y=l/2}else{const t=n?l:l/(s.length-1);for(const[e,i]of s.entries())for(const r of i)r.y=t*e}if(s.every(t=>1===t.length))for(const[e]of s)e.x=h/2;else if(1===s.length){const[t]=s;C(t,o);const e=t,i=n?e.length-1:1;for(const r of e)r.x*=h*i}else{i(s),r(s,o);for(const i of s)for(const t of i)if(void 0===t.x)throw new Error(`coord didn't assign an x to node '${t.id}'`);const t=s,e=n?Math.max(...s.map(t=>t.length))-1:1;for(const i of t)for(const t of i)t.x*=h*e}const c=t;return function(t){for(const e of t)e instanceof S||(e.dataChildren=e.dataChildren.map(t=>{let i=t.child;const r=[{x:e.x,y:e.y}];for(;i instanceof S;)r.push({x:i.x,y:i.y}),[i]=i.ichildren();return r.push({x:i.x,y:i.y}),new d(i,t.data,r)}))}(c),c}return c.layering=function(h){return void 0===h?e:t(h,i,r,n,s,o,a)},c.decross=function(h){return void 0===h?i:t(e,h,r,n,s,o,a)},c.coord=function(h){return void 0===h?r:t(e,i,h,n,s,o,a)},c.size=function(h){return void 0!==h?t(e,i,r,!1,h,o,a):n?null:s},c.nodeSize=function(h){return void 0!==h?t(e,i,r,!0,h,o,a):n?s:null},c.separation=function(h){return void 0===h?o:t(e,i,r,n,s,h,a)},c.debug=function(h){return void 0===h?a:t(e,i,r,n,s,o,h)},c}(function(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return function t(e,i){const r=i?"":"\0",n=i?"rank: ":"\0",s=i?" -> ":"\0";function o(t){return`${r}${t.id}`}function a(t){return`${t.source.id}${s}${t.target.id}`}function h(t,e){return`${n}${t.id}${s}${e.id}`}function l(t){const i=Object.create(null),r=Object.create(null),n=Object.create(null),s=[];for(const a of t){const t=o(a);r[t]=1,i[t]={opt:a.children.length};const n=e(a);void 0!==n&&s.push([n,a])}for(const e of t.ilinks()){const t=i[o(e.source)],r=i[o(e.target)],s=a(e);n[s]={min:1},t[s]=-1,t.opt++,r[s]=1,r.opt--}let[l,...c]=s.sort(([t],[e])=>t-e);for(const e of c){const[t,r]=l,[s,a]=e,c=i[o(r)],d=i[o(a)],u=h(r,a);if(t<s)n[u]={min:1},c[u]=-1,d[u]=1;else{const t=h(a,r);n[u]={min:0},n[t]={min:0},c[u]=-1,c[t]=1,d[u]=1,d[t]=-1}l=e}const d=pt.Solve({optimize:"opt",opType:"max",constraints:n,variables:i,ints:r}),{feasible:u}=d,f=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}(d,["feasible"]);if(!u)throw s.length?new Error("could not find a feasbile simplex layout, check that rank accessors are not ill-defined"):new Error("could not find feasbile simplex layout, this should not happen");for(const e of t)e.layer=f[o(e)]||0}return l.rank=function(r){return void 0===r?e:t(r,i)},l.debug=function(r){return void 0===r?i:t(e,r)},l}(vt,!1)}(),function(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return function t(e){function i(t){t.slice(0,t.length-1).forEach((i,r)=>e(i,t[r+1]))}return i.order=function(i){return void 0===i?e:t(i)},i}(function(...t){if(t.length)throw new Error(`got arguments to median(${t}), but constructor takes no aruguments.`);return function(t,e){const i=new c;for(const[s,o]of t.entries())for(const t of o.ichildren())i.setIfAbsent(t.id,[]).push(s);const r=new c;let n=-1;for(const s of e){const e=wt(i.getDefault(s.id,[]),.5,void 0);void 0===e?(r.set(s.id,n),n=+!((n+1)/(t.length+1))*(t.length+1)-1):r.set(s.id,e)}e.sort((t,e)=>r.getThrow(t.id)-r.getThrow(e.id))}}())}(),function(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return function t(e,i,r,n,s){function o(t,o,a){const h=function(t){const e=new c;let i=0;for(const r of t)for(const t of r)e.set(t.id,i++);return e}(t),[l,d,u,f]=function(t,e,i){const r=1+Math.max(...e.values()),n=[],s=[];for(const a of t){let[t,...o]=a;for(const a of o){const o=e.getThrow(t.id),h=e.getThrow(a.id),l=new Array(r).fill(0);l[o]=1,l[h]=-1,n.push(l),s.push(-i(t,a)),t=a}}const o=new Array(r).fill(0);return[new Array(r).fill(null).map(()=>new Array(r).fill(0)),o,n,s]}(t,h,o);for(const s of t)for(const t of s){const s=h.getThrow(t.id),o=t instanceof S?i:e;for(const a of t.ichildren()){const t=h.getThrow(a.id),c=a instanceof S?n:r;I(l,s,t,o+(a instanceof S?i:e));for(const e of a.ichildren())E(l,s,t,h.getThrow(e.id),c)}}for(let[e,...i]of t)for(const t of i)a.getThrow(e.id)!==a.getThrow(t.id)&&I(l,h.getThrow(e.id),h.getThrow(t.id),s),e=t;!function(t,e,i){const r=Math.min(...i),n=Math.max(...i)-r;if(n>0)for(const s of t)for(const t of s){const s=e.getThrow(t.id);t.x=(i[s]-r)/n}else for(const s of t)for(const t of s)t.x=.5}(t,h,function(t,e,i,r,n=0){e.pop(),t.pop(),t.forEach(t=>t.pop()),i.forEach(t=>t.pop());const s=function(t,e,i,r,n){const s=[[0]],o=[0],a=[[0]],h=[0];for(const d of t){const t=[0];t.push(...d),s.push(t)}o.push(...e),a.push(...e.map(()=>[0]));for(const d of i)for(const[t,e]of d.entries())a[t+1].push(-e);h.push(...r.map(t=>-t));const{solution:l,message:c}=_(s,o,a,h,n);if(c.length)throw new Error("quadprog failed with: "+c);return l.shift(),l}(t,e,i,r,n);return s.push(0),s}(l,d,u,f))}function a(t,s){if(0===e&&0===r)throw new Error("node vertical weight or node curve weight needs to be positive");if(0===i&&0===n)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");const a=function(t){const e=new c;for(const n of t.slice().reverse())for(const t of n){for(const i of t.ichildren())e.delete(i.id);e.set(t.id,t)}const i=new p([...e.values()]).split(),r=new c;for(const[n,s]of i.entries())for(const t of s)r.set(t.id,n);return r}(t);for(const e of function(t,e){const i=[];let r=[],n=new Set;for(const s of t){const t=new Set(s.map(t=>e.getThrow(t.id)));l(n,t)||i.push(r=[]),r.push(s),n=t}return i}(t,a))if(e.every(t=>1===t.length))for(const[t]of e)t.x=.5;else if(1===e.length){const[t]=e;C(t,s)}else o(e,s,a)}return a.vertical=function(o){if(void 0===o)return[e,i];const[a,h]=o;if(a<0||h<0)throw new Error(`weights must be non-negative, but were ${a} and ${h}`);return t(a,h,r,n,s)},a.curve=function(o){if(void 0===o)return[r,n];const[a,h]=o;if(a<0||h<0)throw new Error(`weights must be non-negative, but were ${a} and ${h}`);return t(e,i,a,h,s)},a.component=function(o){if(void 0===o)return s;if(o<=0)throw new Error("weight must be positive, but was "+o);return t(e,i,r,n,o)},a}(1,0,0,1,1)}(),!1,[1,1],xt,!1)}var Ct=function(t,e){return t<e};function It(t){if(!(this instanceof It))return new It(t);this.array=[],this.size=0,this.compare=t||Ct}It.prototype.clone=function(){var t=new It(this.compare);t.size=this.size;for(var e=0;e<this.size;e++)t.array.push(this.array[e]);return t},It.prototype.add=function(t){var e,i,r=this.size;for(this.array[this.size]=t,this.size+=1;r>0&&this.compare(t,i=this.array[e=r-1>>1]);)this.array[r]=i,r=e;this.array[r]=t},It.prototype.heapify=function(t){var e;for(this.array=t,this.size=t.length,e=this.size>>1;e>=0;e--)this._percolateDown(e)},It.prototype._percolateUp=function(t,e){for(var i,r,n=this.array[t];t>0&&(r=this.array[i=t-1>>1],e||this.compare(n,r));)this.array[t]=r,t=i;this.array[t]=n},It.prototype._percolateDown=function(t){for(var e,i,r,n=this.size,s=this.size>>>1,o=this.array[t];t<s&&(r=this.array[e=1+(t<<1)],(i=e+1)<n&&this.compare(this.array[i],r)&&(e=i,r=this.array[i]),this.compare(r,o));)this.array[t]=r,t=e;this.array[t]=o},It.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},It.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1},It.prototype._batchRemove=function(t,e){var i=new Array(e||this.size),r=0;if("function"==typeof t&&this.size)for(var n=0;n<this.size&&r<i.length;)t(this.array[n])?(i[r]=this._removeAt(n),r++,n>>=1):n++;return i.length=r,i},It.prototype.removeOne=function(t){var e=this._batchRemove(t,1);return e.length>0?e[0]:void 0},It.prototype.removeMany=function(t,e){return this._batchRemove(t,e)},It.prototype.peek=function(){if(0!=this.size)return this.array[0]},It.prototype.poll=function(){if(0!=this.size){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}},It.prototype.replaceTop=function(t){if(0!=this.size){var e=this.array[0];return this.array[0]=t,this._percolateDown(0),e}},It.prototype.trim=function(){this.array=this.array.slice(0,this.size)},It.prototype.isEmpty=function(){return 0===this.size},It.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var e=0,i=this.clone();!i.isEmpty();)t(i.poll(),e++)},It.prototype.kSmallest=function(t){if(0==this.size)return[];var e=this.compare,i=this.array,r=new It((function(t,r){return e(i[t],i[r])}));t=Math.min(this.size,t);var n=new Array(t),s=0;for(r.add(0);s<t;){var o=r.poll();n[s++]=this.array[o];var a=1+(o<<1),h=a+1;a<this.size&&r.add(a),h<this.size&&r.add(h)}return n};var Et=i("ZTXN"),St=i("mWib"),Ot=i("kuMc"),kt=i("Bou+"),Mt=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,r){return t[0]===e&&(i=r,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),r=this.__entries__[i];return r&&r[1]},e.prototype.set=function(e,i){var r=t(this.__entries__,e);~r?this.__entries__[r][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,r=t(i,e);~r&&i.splice(r,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,r=this.__entries__;i<r.length;i++){var n=r[i];t.call(e,n[1],n[0])}},e}()}(),Bt="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Vt="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Rt="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Vt):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},Tt=["top","right","bottom","left","width","height","size","weight"],jt="undefined"!=typeof MutationObserver,Nt=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,r=!1,n=0;function s(){i&&(i=!1,t()),r&&a()}function o(){Rt(s)}function a(){var t=Date.now();if(i){if(t-n<2)return;r=!0}else i=!0,r=!1,setTimeout(o,20);n=t}return a}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Bt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),jt?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Bt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;Tt.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),Dt=function(t,e){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];Object.defineProperty(t,n,{value:e[n],enumerable:!1,writable:!1,configurable:!0})}return t},zt=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Vt},At=Wt(0,0,0,0);function Pt(t){return parseFloat(t)||0}function Lt(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+Pt(t["border-"+i+"-width"])}),0)}var $t="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof zt(t).SVGGraphicsElement}:function(t){return t instanceof zt(t).SVGElement&&"function"==typeof t.getBBox};function Wt(t,e,i,r){return{x:t,y:e,width:i,height:r}}var Ft=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Wt(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t,e=(t=this.target,Bt?$t(t)?function(t){var e=t.getBBox();return Wt(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return At;var r=zt(t).getComputedStyle(t),n=function(t){for(var e={},i=0,r=["top","right","bottom","left"];i<r.length;i++){var n=r[i];e[n]=Pt(t["padding-"+n])}return e}(r),s=n.left+n.right,o=n.top+n.bottom,a=Pt(r.width),h=Pt(r.height);if("border-box"===r.boxSizing&&(Math.round(a+s)!==e&&(a-=Lt(r,"left","right")+s),Math.round(h+o)!==i&&(h-=Lt(r,"top","bottom")+o)),!function(t){return t===zt(t).document.documentElement}(t)){var l=Math.round(a+s)-e,c=Math.round(h+o)-i;1!==Math.abs(l)&&(a-=l),1!==Math.abs(c)&&(h-=c)}return Wt(n.left,n.top,a,h)}(t):At);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),qt=function(t,e){var i,r,n,s,o,a,h,l=(r=(i=e).x,n=i.y,s=i.width,o=i.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,h=Object.create(a.prototype),Dt(h,{x:r,y:n,width:s,height:o,top:n,right:r+s,bottom:o+n,left:r}),h);Dt(this,{target:t,contentRect:l})},Ht=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new Mt,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof zt(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Ft(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof zt(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new qt(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Ut="undefined"!=typeof WeakMap?new WeakMap:new Mt,Zt=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=Nt.getInstance(),r=new Ht(e,i,this);Ut.set(this,r)};["observe","unobserve","disconnect"].forEach((function(t){Zt.prototype[t]=function(){var e;return(e=Ut.get(this))[t].apply(e,arguments)}}));var Gt=void 0!==Vt.ResizeObserver?Vt.ResizeObserver:Zt;let Jt=(()=>{class t{constructor(){this.elementSubjects=new Map,this.resizeObserver=new Gt(t=>{for(const i of t){var e=this.elementSubjects.get(i.target);if(null==e)return;e.next(i.contentRect)}})}listenToElementResize(t){this.resizeObserver.observe(t);const e=new Et.a;return this.elementSubjects.set(t,e),e}unListenToElementResize(t){this.elementSubjects.delete(t),this.resizeObserver.unobserve(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Xt=i("v9BS"),Qt=i("nIj0"),Yt=i("PBFl");const Kt=["chart"],te=["weightSlider"];let ee=(()=>{class t{constructor(t){this.bloomaResizeListenerService=t,this.profileSelected=new o.o,this.weightValueChanged=new o.o,this.linkClicked=new o.o,this.sliderContainerStyle={width:"0",height:"0",padding:"0"},this.unsubscribe$=new Et.a,this.viewInitialized=!1,this.margin={top:10,bottom:20,left:150,right:10},this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.nodeSquareWidth=100,this.nodeSquareHeight=60,this.draggableSquareDimension=10,this.dragX=0,this.dragY=0,this.linkColor="gray",this.selectedNodeColor="green",this.clickedLinkSource=null,this.clickedLinkTarget=null,this.clickedLinkEvent=null,this.sliderElementHeight=124,this.sliderElementWidth=124;const e=new Et.a;e.pipe(Object(St.a)(400),Object(Ot.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=e}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Ot.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},800)}createChart(){if(!this.viewInitialized)return;const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.initSvg(),this.setSvgHeight(),this.drawHierarchy(),this.setUpZoomBehavior())}initSvg(){if(!this.svg){const t=kt.e(this.chartContainer.nativeElement).append("svg");this.svg=t}}setSvgHeight(){this.svg.attr("height",this.totalComponentHeight).attr("width",this.totalComponentWidth)}mouseOverProfile(t){this.dragTargetData=t}mouseLeaveProfile(t){this.dragTargetData=null}getDragBehavior(){const t=this;return kt.a().on("start",(e,i)=>{const r=this.svg.select("rect#r"+i.id);this.dragSourceNode=r;const n=+r.attr("original-x"),s=+r.attr("original-y");this.dragX=this.dragStartX=n,this.dragY=this.dragStartY=s,this.svg.selectAll(".profile-container").attr("pointer-events","mouseover").on("mouseover",(function(e,i){e.target.setAttribute("stroke","red"),t.mouseOverProfile(i)})).on("mouseout",(function(e,i){e.fromElement.parentElement!=e.toElement.parentElement&&(e.target.setAttribute("stroke","black"),t.mouseLeaveProfile(i))})),e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}).on("drag",(t,e)=>{if(this.svg.select("rect#r"+e.id),0==this.dragStartX)return;this.dragX+=t.dx,this.dragY+=t.dy;const i=[[+this.dragStartX,+this.dragStartY],[this.dragX,this.dragY]],r=this.getDragLine(),n=kt.c();r.attr("d",n(i))}).on("end",()=>{if(this.removeDragLine(),this.dragStartX=0,this.dragStartY=0,null==this.dragSourceNode||null==this.dragTargetData)return;const t=this.dragSourceNode.attr("id").substr(1),e=this.dragTargetData.id;if(t==e)return;const i=this.profileMap[e];this.changeIntroducesCycle(this.profileMap[t],e)||i.parentIds.find(e=>e==t)||(i.parentIds.push(t),this.drawHierarchy(),this.setUpZoomBehavior())})}changeIntroducesCycle(t,e){if(null==t.parentIds)return!1;if(null==t?void 0:t.parentIds.find(t=>t==e))return!0;for(const i of null==t?void 0:t.parentIds)return this.changeIntroducesCycle(this.profileMap[i],e)}removeDragLine(){this.svg.select(".drag-line").remove(),this.dragLine=null}getDragLine(){return this.dragLine||(this.dragLine=this.svg.select(".graph-area").append("path").attr("class","drag-line").style("stroke","red").style("fill","none")),this.dragLine}drawHierarchy(){this.svg.select(".graph-area").remove();const t=function(...t){if(t.length)throw Error(`got arguments to dagStratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);return function t(e,i,r){function n(t){if(!t.length)throw new Error("can't stratify empty data");const i=t.map((t,i)=>new f(function(t){if("string"!=typeof t)throw new Error("id is supposed to be string but got type "+typeof t);if(t.indexOf("\0")>=0)throw new Error(`node id ${t} contained null character`);return t}(e(t,i)),t)),n=new Map;i.forEach(t=>{if(n.has(t.id))throw new Error("found a duplicate id: "+t.id);n.set(t.id,t)});const s=[];return i.forEach((t,e)=>{const i=r(t.data,e)||[];i.forEach(([e,i])=>{const r=n.get(e);if(!r)throw new Error("missing id: "+e);return r.dataChildren.push(new d(t,i)),r}),i.length||s.push(t)}),function(t){if(!t.length)throw new Error("dag contained no roots");const e=new Set,i=new Set;let r=null;function n(t){if(e.has(t.id))return[];if(i.has(t.id))return r=t.id,[t.id];{i.add(t.id);let s=[];for(const e of t.ichildren())if(s=n(e),s.length)break;return i.delete(t.id),e.add(t.id),s.length&&null!==r&&s.push(t.id),r===t.id&&(r=null),s}}for(const s of t){const t=n(s);if(t.length)throw new Error("dag contained a cycle: "+t.reverse().join(" -> "))}for(const s of new p(t))if(new Set(s.ichildren().map(t=>t.id)).size!==s.dataChildren.length)throw new Error(`node '${s.id}' contained duplicate children`)}(s),s.length>1?new p(s):s[0]}return n.id=function(n){return void 0===n?e:t(n,i,r)},n.parentData=function(i){return void 0===i?r:t(e,function(t){function e(e,i){return(t(e,i)||[]).map(([t])=>t)}return e.wrapped=t,e}(i),i)},n.parentIds=function(r){return void 0===r?i:t(e,r,v(r))},n}(b,g,v(g))}();if(!this.data)return;const e=t(this.data),i=_t().nodeSize([80,390])(e),r=this.svg.append("g").attr("class","graph-area"),n=i.descendants(),s=this.getDragBehavior(),o=r.append("g").attr("class","links-group"),a=i.links();o.selectAll("line").data(a).enter().append("line").attr("class","line").attr("stroke",this.linkColor).attr("stroke-width","5").attr("data-id-source",t=>"r"+t.source.id).attr("data-id-target",t=>"r"+t.target.id).attr("x1",t=>this.margin.left+t.source.y).attr("x2",t=>this.margin.left+t.target.y).attr("y1",t=>this.margin.top+t.source.x).attr("y2",t=>this.margin.top+t.target.x).on("mouseover",(t,e)=>{kt.e(t.srcElement).attr("stroke","red")}).on("mouseout",(t,e)=>{kt.e(t.srcElement).attr("stroke",this.linkColor)}).on("click",(t,e)=>{this.clickedLinkSource=e.source.id,this.clickedLinkTarget=e.target.data.originalId,this.clickedLinkEvent=t,kt.e(t.srcElement).attr("stroke",this.linkColor),this.linkClicked.next(this.clickedLinkSource)}),r.append("g").attr("class","nodes-group").selectAll("g.node").data(n).enter().append("g").attr("class","node").attr("transform",t=>`translate(${this.margin.left+t.y},${this.margin.top+t.x})`).each((t,e,i)=>{const r=kt.e(i[e]),n=r.append("rect").attr("id","r"+t.id).attr("fill","white").attr("original-x",this.margin.left+t.y).attr("original-y",this.margin.top+t.x).attr("stroke","black").call(s).on("click",(t,e)=>{this.setSelectedProfile(e),kt.f(".profile-container").attr("stroke","black"),kt.e(t.srcElement).attr("stroke",this.selectedNodeColor)}),o=r.append("text").attr("class","svg-text").attr("dx",10).text(t.data.name).on("click",(t,e)=>{var i=new Event("click",{});t.srcElement.parentElement.firstChild.dispatchEvent(i)}),a=o.node().getBBox(),h=kt.d([a.width+20,this.nodeSquareWidth]),l=kt.d([a.height,this.nodeSquareHeight]);n.attr("x",0-h/2).attr("class","profile-container").attr("y",-l/2).attr("width",h).attr("height",l),o.attr("x",0-h/2)})}saveNewWeight(){this.hideWeightSlider(),this.weightValueChanged.next({name:this.clickedLinkTarget,profileId:this.clickedLinkSource,weight:this.selectedWeight})}hideWeightSlider(){kt.e(this.weightSliderContainer.nativeElement).transition().duration(200).style("opacity",0),this.sliderContainerStyle={width:"0",height:"0",padding:"0"}}showWeightSlider(){var t;this.selectedWeight=null!==(t=this.getLinkWeight(this.clickedLinkSource,this.clickedLinkTarget))&&void 0!==t?t:0;const e=kt.e(this.weightSliderContainer.nativeElement);var i=this.selectTopForSlider(),r=this.selectLeftForSlider();this.sliderContainerStyle={width:"300px",left:r+"px",top:i+"px",padding:"10px"},e.transition().duration(200).style("opacity",1),Object(o.lb)(this)}selectTopForSlider(){return this.clickedLinkEvent.y+this.sliderElementHeight>=this.totalComponentHeight?this.totalComponentHeight-130:this.clickedLinkEvent.y}selectLeftForSlider(){return this.clickedLinkEvent.x+this.sliderElementWidth>=this.totalComponentWidth?this.totalComponentWidth-this.sliderElementWidth-10:this.clickedLinkEvent.x}weightChanged(t){this.selectedWeight=t.value}getLinkWeight(t,e){var i=this.weights[t];let r=i[e];r||(r=i[e.toUpperCase()]);const n=e.indexOf("_");return!r&&n>-1&&(r=i[e=e.substr(n+1)]),r}setUpZoomBehavior(){const t=this.svg.select(".graph-area"),e=this.svg.select(".nodes-group").node().getBBox(),i=[[0,0],[this.totalComponentWidth,this.totalComponentHeight]],r=[[0,-100],[e.width+this.margin.left+100,e.height]],n=kt.g().scaleExtent([.1,10]).extent(i).translateExtent(r).on("zoom",e=>{t.attr("transform",e.transform)});this.svg.call(n)}setSelectedProfile(t){this.profileSelected.next(t.id)}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(Jt))},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-hierarchy"]],viewQuery:function(t,e){var i;1&t&&(o.xc(Kt,!0),o.xc(te,!0)),2&t&&(o.ic(i=o.ac())&&(e.chartContainer=i.first),o.ic(i=o.ac())&&(e.weightSliderContainer=i.first))},inputs:{data:"data",weights:"weights",profileMap:"profileMap"},outputs:{profileSelected:"profileSelected",weightValueChanged:"weightValueChanged",linkClicked:"linkClicked"},decls:12,vars:3,consts:[["id","rent-comparable-graph",1,"rent-comparable-graph"],["chart",""],["id","weight-slider",1,"bg-yellow-200","overflow-hidden",3,"ngStyle"],["weightSlider",""],["min","1","max","100","step","1",3,"ngModel","ngModelChange","input"],[1,"flex"],["mat-flat-button","","color","primary",1,"mx-2",3,"click"],["mat-flat-button","","color","warn",1,"mx-2",3,"click"]],template:function(t,e){1&t&&(o.Nb(0,"div",0,1),o.Sb(2,"div",2,3),o.Sb(4,"div"),o.uc(5),o.Rb(),o.Sb(6,"mat-slider",4),o.Zb("ngModelChange",(function(t){return e.selectedWeight=t}))("input",(function(t){return e.weightChanged(t)})),o.Rb(),o.Sb(7,"div",5),o.Sb(8,"button",6),o.Zb("click",(function(){return e.saveNewWeight()})),o.uc(9,"Save"),o.Rb(),o.Sb(10,"button",7),o.Zb("click",(function(){return e.hideWeightSlider()})),o.uc(11,"Cancel"),o.Rb(),o.Rb(),o.Rb()),2&t&&(o.Cb(2),o.hc("ngStyle",e.sliderContainerStyle),o.Cb(3),o.wc("Weight: ",e.selectedWeight,""),o.Cb(1),o.hc("ngModel",e.selectedWeight))},directives:[r.l,Xt.a,Qt.h,Qt.k,Yt.a],styles:[".rent-comparable-graph[_ngcontent-%COMP%]{height:inherit;width:inherit}#weight-slider[_ngcontent-%COMP%]{background-color:#fff;color:#000;position:absolute;opacity:0;width:0}#weight-slider[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:100%}.svg-text[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}"]}),t})();var ie=i("yDe4"),re=i("C9XJ"),ne=i("rxR5"),se=i("PC4E"),oe=i("oYEq"),ae=i("pLgK");let he=(()=>{class t{constructor(t,e){this.store=t,this.actions$=e,this.keyChanged$=new Et.a,this.actions$.pipe(Object(ie.j)(re.a)).subscribe(()=>{this.keyChanged$.next()})}getProfiles(){return Object(s.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ne.b).toPromise(),null==this.store.selectSnapshot(se.a.getGetProfileError)?"success":"error"}))}selectProfile(t){return Object(s.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ne.c(t)).toPromise()}))}getLinkWeight(t){return Object(s.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new oe.a(t)).toPromise()}))}saveLinkWeight(t){return Object(s.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new oe.b(t)).toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(o.Wb(ie.h),o.Wb(ie.b))},t.\u0275prov=o.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(s.b)([Object(ie.e)(se.a.getState)],t.prototype,"profileState$",void 0),Object(s.b)([Object(ie.e)(ae.a.getState)],t.prototype,"weightState$",void 0),t})();var le=i("csyo");let ce=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-loading-component"]],decls:2,vars:0,consts:[[1,"bg-blue-500","bg-opacity-25","flex","h-full","items-center","justify-center","justify-items-center","w-full"]],template:function(t,e){1&t&&(o.Sb(0,"div",0),o.Nb(1,"mat-spinner"),o.Rb())},directives:[le.b],styles:[""]}),t})();var de=i("OZ4H"),ue=i("W1gw");let fe=(()=>{class t{constructor(t,e){this.dialog=t,this._snackBar=e}showLoading(){const t=this.dialog.open(ce,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",panelClass:"custom-dialog",data:{name:"test"}});return this.loadingDialog=t,t}hideLoading(){this.loadingDialog.close()}showMessage(t){this._snackBar.open(t,"close",{duration:5e3})}}return t.\u0275fac=function(e){return new(e||t)(o.Wb(de.b),o.Wb(ue.a))},t.\u0275prov=o.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var pe=i("cqs0"),ve=i("9bRT"),be=i("C05f"),ge=i("ROBh"),me=i("J+dc"),ye=i("xVbo"),we=i("5XID");i("E5oP");class xe extends class{constructor(){this.expansionModel=new pe.c(!0)}toggle(t){this.expansionModel.toggle(this._trackByValue(t))}expand(t){this.expansionModel.select(this._trackByValue(t))}collapse(t){this.expansionModel.deselect(this._trackByValue(t))}isExpanded(t){return this.expansionModel.isSelected(this._trackByValue(t))}toggleDescendants(t){this.expansionModel.isSelected(this._trackByValue(t))?this.collapseDescendants(t):this.expandDescendants(t)}collapseAll(){this.expansionModel.clear()}expandDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.select(...e.map(t=>this._trackByValue(t)))}collapseDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.deselect(...e.map(t=>this._trackByValue(t)))}_trackByValue(t){return this.trackBy?this.trackBy(t):t}}{constructor(t,e){super(),this.getChildren=t,this.options=e,this.options&&(this.trackBy=this.options.trackBy)}expandAll(){this.expansionModel.clear();const t=this.dataNodes.reduce((t,e)=>[...t,...this.getDescendants(e),e],[]);this.expansionModel.select(...t.map(t=>this._trackByValue(t)))}getDescendants(t){const e=[];return this._getDescendants(e,t),e.splice(1)}_getDescendants(t,e){t.push(e);const i=this.getChildren(e);Array.isArray(i)?i.forEach(e=>this._getDescendants(t,e)):Object(ve.a)(i)&&i.pipe(Object(me.a)(1),Object(ye.a)(Boolean)).subscribe(e=>{for(const i of e)this._getDescendants(t,i)})}}const _e=new o.r("CDK_TREE_NODE_OUTLET_NODE");let Ce=(()=>{class t{constructor(t,e){this.viewContainer=t,this._node=e}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.Q),o.Mb(_e,8))},t.\u0275dir=o.Hb({type:t,selectors:[["","cdkTreeNodeOutlet",""]]}),t})();class Ie{constructor(t){this.$implicit=t}}let Ee=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.M))},t.\u0275dir=o.Hb({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),Se=(()=>{class t{constructor(t,e){this._differs=t,this._changeDetectorRef=e,this._onDestroy=new Et.a,this._levels=new Map,this.viewChange=new be.a({start:0,end:Number.MAX_VALUE})}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const t=this._nodeDefs.filter(t=>!t.when);this._defaultNodeDef=t[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(t){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),t||this._nodeOutlet.viewContainer.clear(),this._dataSource=t,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let t;Object(pe.f)(this._dataSource)?t=this._dataSource.connect(this):Object(ve.a)(this._dataSource)?t=this._dataSource:Array.isArray(this._dataSource)&&(t=Object(ge.a)(this._dataSource)),t&&(this._dataSubscription=t.pipe(Object(Ot.a)(this._onDestroy)).subscribe(t=>this.renderNodeChanges(t)))}renderNodeChanges(t,e=this._dataDiffer,i=this._nodeOutlet.viewContainer,r){const n=e.diff(t);n&&(n.forEachOperation((e,n,s)=>{if(null==e.previousIndex)this.insertNode(t[s],s,i,r);else if(null==s)i.remove(n),this._levels.delete(e.item);else{const t=i.get(n);i.move(t,s)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(t,e){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(i=>i.when&&i.when(e,t))||this._defaultNodeDef}insertNode(t,e,i,r){const n=this._getNodeDef(t,e),s=new Ie(t);s.level=this.treeControl.getLevel?this.treeControl.getLevel(t):void 0!==r&&this._levels.has(r)?this._levels.get(r)+1:0,this._levels.set(t,s.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(n.template,s,e),Oe.mostRecentTreeNode&&(Oe.mostRecentTreeNode.data=t)}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.t),o.Mb(o.i))},t.\u0275cmp=o.Gb({type:t,selectors:[["cdk-tree"]],contentQueries:function(t,e,i){var r;1&t&&o.Fb(i,Ee,!0),2&t&&o.ic(r=o.ac())&&(e._nodeDefs=r)},viewQuery:function(t,e){var i;1&t&&o.oc(Ce,!0),2&t&&o.ic(i=o.ac())&&(e._nodeOutlet=i.first)},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,e){1&t&&o.Ob(0,0)},directives:[Ce],encapsulation:2}),t})(),Oe=(()=>{class t{constructor(e,i){this._elementRef=e,this._tree=i,this._destroyed=new Et.a,this._dataChanges=new Et.a,this.role="treeitem",t.mostRecentTreeNode=this}get data(){return this._data}set data(t){t!==this._data&&(this._data=t,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):0}ngOnDestroy(){t.mostRecentTreeNode===this&&(t.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.m),o.Mb(Se))},t.\u0275dir=o.Hb({type:t,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:3,hostBindings:function(t,e){2&t&&o.Db("aria-expanded",e.isExpanded)("aria-level",e.level+1)("role",e.role)},inputs:{role:"role"},exportAs:["cdkTreeNode"]}),t.mostRecentTreeNode=null,t})(),ke=(()=>{class t extends Oe{constructor(t,e,i){super(t,e),this._elementRef=t,this._tree=e,this._differs=i}ngAfterContentInit(){this._dataDiffer=this._differs.find([]).create(this._tree.trackBy);const t=this._tree.treeControl.getChildren(this.data);Array.isArray(t)?this.updateChildrenNodes(t):Object(ve.a)(t)&&t.pipe(Object(Ot.a)(this._destroyed)).subscribe(t=>this.updateChildrenNodes(t)),this.nodeOutlet.changes.pipe(Object(Ot.a)(this._destroyed)).subscribe(()=>this.updateChildrenNodes())}ngOnDestroy(){this._clear(),super.ngOnDestroy()}updateChildrenNodes(t){const e=this._getNodeOutlet();t&&(this._children=t),e&&this._children?this._tree.renderNodeChanges(this._children,this._dataDiffer,e.viewContainer,this._data):this._dataDiffer.diff([])}_clear(){const t=this._getNodeOutlet();t&&(t.viewContainer.clear(),this._dataDiffer.diff([]))}_getNodeOutlet(){const t=this.nodeOutlet;return t&&t.find(t=>!t._node||t._node===this)}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.m),o.Mb(Se),o.Mb(o.t))},t.\u0275dir=o.Hb({type:t,selectors:[["cdk-nested-tree-node"]],contentQueries:function(t,e,i){var r;1&t&&o.Fb(i,Ce,!0),2&t&&o.ic(r=o.ac())&&(e.nodeOutlet=r)},hostAttrs:[1,"cdk-tree-node","cdk-nested-tree-node"],hostVars:2,hostBindings:function(t,e){2&t&&o.Db("aria-expanded",e.isExpanded)("role",e.role)},exportAs:["cdkNestedTreeNode"],features:[o.Bb([{provide:Oe,useExisting:t},{provide:_e,useExisting:t}]),o.zb]}),t})(),Me=(()=>{class t{constructor(t,e){this._tree=t,this._treeNode=e,this._recursive=!1}get recursive(){return this._recursive}set recursive(t){this._recursive=Object(we.b)(t)}_toggle(t){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),t.stopPropagation()}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(Se),o.Mb(Oe))},t.\u0275dir=o.Hb({type:t,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(t,e){1&t&&o.Zb("click",(function(t){return e._toggle(t)}))},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),t})(),Be=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)}}),t})();var Ve=i("mFH5"),Re=i("g6G6"),Te=i("YtkY");const je=Object(Ve.l)(Object(Ve.j)(Oe));let Ne=(()=>{class t extends je{constructor(t,e,i){super(t,e),this._elementRef=t,this._tree=e,this.role="treeitem",this.tabIndex=Number(i)||0}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.m),o.Mb(Se),o.Xb("tabindex"))},t.\u0275dir=o.Hb({type:t,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],hostVars:3,hostBindings:function(t,e){2&t&&o.Db("aria-expanded",e.isExpanded)("aria-level",e.level+1)("role",e.role)},inputs:{disabled:"disabled",tabIndex:"tabIndex",role:"role"},exportAs:["matTreeNode"],features:[o.Bb([{provide:Oe,useExisting:t}]),o.zb]}),t})(),De=(()=>{class t extends Ee{}return t.\u0275fac=function(e){return ze(e||t)},t.\u0275dir=o.Hb({type:t,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[o.Bb([{provide:Ee,useExisting:t}]),o.zb]}),t})();const ze=o.Ub(De);let Ae=(()=>{class t extends ke{constructor(t,e,i,r){super(t,e,i),this._elementRef=t,this._tree=e,this._differs=i,this._disabled=!1,this.tabIndex=Number(r)||0}get disabled(){return this._disabled}set disabled(t){this._disabled=Object(we.b)(t)}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?t:0}ngAfterContentInit(){super.ngAfterContentInit()}ngOnDestroy(){super.ngOnDestroy()}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.m),o.Mb(Se),o.Mb(o.t),o.Xb("tabindex"))},t.\u0275dir=o.Hb({type:t,selectors:[["mat-nested-tree-node"]],hostAttrs:[1,"mat-nested-tree-node"],hostVars:2,hostBindings:function(t,e){2&t&&o.Db("aria-expanded",e.isExpanded)("role",e.role)},inputs:{tabIndex:"tabIndex",disabled:"disabled",node:["matNestedTreeNode","node"]},exportAs:["matNestedTreeNode"],features:[o.Bb([{provide:ke,useExisting:t},{provide:Oe,useExisting:t},{provide:_e,useExisting:t}]),o.zb]}),t})(),Pe=(()=>{class t{constructor(t,e){this.viewContainer=t,this._node=e}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.Q),o.Mb(_e,8))},t.\u0275dir=o.Hb({type:t,selectors:[["","matTreeNodeOutlet",""]],features:[o.Bb([{provide:Ce,useExisting:t}])]}),t})(),Le=(()=>{class t extends Se{}return t.\u0275fac=function(e){return $e(e||t)},t.\u0275cmp=o.Gb({type:t,selectors:[["mat-tree"]],viewQuery:function(t,e){var i;1&t&&o.oc(Pe,!0),2&t&&o.ic(i=o.ac())&&(e._nodeOutlet=i.first)},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[o.Bb([{provide:Se,useExisting:t}]),o.zb],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(t,e){1&t&&o.Ob(0,0)},directives:[Pe],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}\n"],encapsulation:2}),t})();const $e=o.Ub(Le);let We=(()=>{class t extends Me{get recursive(){return this._recursive}set recursive(t){this._recursive=Object(we.b)(t)}}return t.\u0275fac=function(e){return Fe(e||t)},t.\u0275dir=o.Hb({type:t,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[o.Bb([{provide:Me,useExisting:t}]),o.zb]}),t})();const Fe=o.Ub(We);let qe=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},imports:[[Be,Ve.c],Ve.c]}),t})();class He extends pe.b{constructor(){super(...arguments),this._data=new be.a([])}get data(){return this._data.value}set data(t){this._data.next(t)}connect(t){return Object(Re.a)(t.viewChange,this._data).pipe(Object(Te.a)(()=>this.data))}disconnect(){}}const Ue=[{name:"Fruit",children:[{name:"Apple"},{name:"Banana"},{name:"Fruit loops"}]},{name:"Vegetables",children:[{name:"Green",children:[{name:"Broccoli"},{name:"Brussels sprouts"}]},{name:"Orange",children:[{name:"Pumpkins"},{name:"Carrots"}]}]}];var Ze=i("bFHC");function Ge(t,e){if(1&t&&(o.Sb(0,"mat-tree-node",3),o.Sb(1,"li",4),o.Nb(2,"button",5),o.uc(3),o.Rb(),o.Rb()),2&t){const t=e.$implicit;o.Cb(3),o.wc(" ",t.name," ")}}function Je(t,e){if(1&t&&(o.Sb(0,"mat-nested-tree-node"),o.Sb(1,"li"),o.Sb(2,"div",4),o.Sb(3,"button",6),o.Sb(4,"mat-icon",7),o.uc(5),o.Rb(),o.Rb(),o.uc(6),o.Rb(),o.Sb(7,"ul"),o.Ob(8,8),o.Rb(),o.Rb(),o.Rb()),2&t){const t=e.$implicit,i=o.cc();o.Cb(3),o.Db("aria-label","Toggle "+t.name),o.Cb(2),o.wc(" ",i.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),o.Cb(1),o.wc(" ",t.name," "),o.Cb(1),o.Eb("example-tree-invisible",!i.treeControl.isExpanded(t))}}let Xe=(()=>{class t{constructor(){this.treeControl=new xe(t=>t.children),this.dataSource=new He,this.hasChild=(t,e)=>!!e.children&&e.children.length>0,this.dataSource.data=Ue}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-available-fields"]],decls:3,vars:3,consts:[[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["matTreeNodeOutlet",""]],template:function(t,e){1&t&&(o.Sb(0,"mat-tree",0),o.sc(1,Ge,4,1,"mat-tree-node",1),o.sc(2,Je,9,5,"mat-nested-tree-node",2),o.Rb()),2&t&&(o.hc("dataSource",e.dataSource)("treeControl",e.treeControl),o.Cb(2),o.hc("matTreeNodeDefWhen",e.hasChild))},directives:[Le,De,Ne,We,Yt.a,Ae,Ze.a,Pe],styles:[".example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}"]}),t})();var Qe=i("29Wa"),Ye=i("cZZj"),Ke=i("6Oco");i("KTx3"),i("prE9");const ti=Object(Ye.f)({passive:!0});let ei=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return Ke.a;const e=Object(we.d)(t),i=this._monitoredElements.get(e);if(i)return i.subject;const r=new Et.a,n="cdk-text-field-autofilled",s=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(n)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(n)&&(e.classList.remove(n),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!1}))):(e.classList.add(n),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",s,ti),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:r,unlisten:()=>{e.removeEventListener("animationstart",s,ti)}}),r}stopMonitoring(t){const e=Object(we.d)(t),i=this._monitoredElements.get(e);i&&(i.unlisten(),i.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.\u0275fac=function(e){return new(e||t)(o.Wb(Ye.a),o.Wb(o.A))},t.\u0275prov=Object(o.Ib)({factory:function(){return new t(Object(o.Wb)(Ye.a),Object(o.Wb)(o.A))},token:t,providedIn:"root"}),t})(),ii=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},imports:[[Ye.b]]}),t})();const ri=new o.r("MAT_INPUT_VALUE_ACCESSOR"),ni=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let si=0;class oi{constructor(t,e,i,r){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=i,this.ngControl=r}}const ai=Object(Ve.k)(oi);let hi=(()=>{class t extends ai{constructor(t,e,i,r,n,s,o,a,h,l){super(s,r,n,i),this._elementRef=t,this._platform=e,this.ngControl=i,this._autofillMonitor=a,this._formField=l,this._uid="mat-input-"+si++,this.focused=!1,this.stateChanges=new Et.a,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>Object(Ye.e)().has(t));const c=this._elementRef.nativeElement,d=c.nodeName.toLowerCase();this._inputValueAccessor=o||c,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&h.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===d,this._isTextarea="textarea"===d,this._isNativeSelect&&(this.controlType=c.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=Object(we.b)(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=Object(we.b)(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&Object(Ye.e)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=Object(we.b)(t)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){var t,e;const i=(null===(e=null===(t=this._formField)||void 0===t?void 0:t._hideControlPlaceholder)||void 0===e?void 0:e.call(t))?null:this.placeholder;if(i!==this._previousPlaceholder){const t=this._elementRef.nativeElement;this._previousPlaceholder=i,i?t.setAttribute("placeholder",i):t.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){ni.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(o.m),o.Mb(Ye.a),o.Mb(Qt.g,10),o.Mb(Qt.j,8),o.Mb(Qt.d,8),o.Mb(Ve.a),o.Mb(ri,10),o.Mb(ei),o.Mb(o.A),o.Mb(Qe.a,8))},t.\u0275dir=o.Hb({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:9,hostBindings:function(t,e){1&t&&o.Zb("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(o.Vb("disabled",e.disabled)("required",e.required),o.Db("id",e.id)("data-placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),o.Eb("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"]},exportAs:["matInput"],features:[o.Bb([{provide:Qe.c,useExisting:t}]),o.zb,o.Ab]}),t})(),li=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},providers:[Ve.a],imports:[[ii,Qe.d],ii,Qe.d]}),t})();function ci(t,e){if(1&t&&(o.Sb(0,"div",3),o.uc(1),o.Rb()),2&t){const t=o.cc();o.Cb(1),o.wc("Id: ",(null==t.profile?null:t.profile.id)||"No Type","")}}function di(t,e){if(1&t&&(o.Sb(0,"tr"),o.Sb(1,"th",6),o.uc(2),o.Rb(),o.Sb(3,"th",6),o.uc(4),o.Rb(),o.Rb()),2&t){const t=e.$implicit;o.Cb(2),o.vc(t.name),o.Cb(2),o.vc(t.score)}}function ui(t,e){if(1&t&&(o.Sb(0,"table",3),o.Sb(1,"thead"),o.Sb(2,"tr"),o.Sb(3,"th",6),o.uc(4,"Value"),o.Rb(),o.Sb(5,"th",6),o.uc(6,"Score"),o.Rb(),o.Rb(),o.Rb(),o.Sb(7,"tbody"),o.sc(8,di,5,2,"tr",7),o.Rb(),o.Rb()),2&t){const t=o.cc();o.Cb(8),o.hc("ngForOf",null==t.profile?null:t.profile.scores)}}let fi=(()=>{class t{constructor(t){this.formBuilder=t}ngOnInit(){this.form=this.formBuilder.group({name:this.profile.name})}getProfileName(){return this.form.value.name}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(Qt.b))},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-profile-details-edit"]],inputs:{profile:"profile"},decls:9,vars:4,consts:[[1,"bg-gray-300","p-10",3,"formGroup"],[1,"w-full"],["matInput","","placeholder","Profile Item Name","formControlName","name","matInput","","placeholder","Ex. name of the object property"],[1,"mb-5"],["class","mb-5",4,"ngIf"],["class","table-auto","class","mb-5",4,"ngIf"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(o.Sb(0,"form",0),o.Sb(1,"mat-form-field",1),o.Sb(2,"mat-label"),o.uc(3,"Profile Item Name"),o.Rb(),o.Nb(4,"input",2),o.Rb(),o.Sb(5,"div",3),o.uc(6),o.Rb(),o.sc(7,ci,2,1,"div",4),o.sc(8,ui,9,1,"table",5),o.Rb()),2&t&&(o.hc("formGroup",e.form),o.Cb(6),o.wc("Item Type: ",(null==e.profile?null:e.profile.itemType)||"No Type",""),o.Cb(1),o.hc("ngIf",!((null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0)),o.Cb(1),o.hc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0))},directives:[Qt.m,Qt.i,Qt.d,Qe.b,Qe.e,hi,Qt.a,Qt.h,Qt.c,r.k,r.j],styles:[""]}),t})(),pi=(()=>{class t{constructor(t){this.store=t}updateName(t){return Object(s.a)(this,void 0,void 0,(function*(){yield this.store.dispatch(new ne.d(t)).toPromise()}))}deleteProfile(t){return Object(s.a)(this,void 0,void 0,(function*(){yield this.store.dispatch(new ne.a(t)).toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(o.Wb(ie.h))},t.\u0275prov=o.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function vi(t,e){if(1&t&&(o.Sb(0,"div",1),o.uc(1),o.Rb()),2&t){const t=o.cc();o.Cb(1),o.wc("Id: ",(null==t.profile?null:t.profile.id)||"No Type","")}}function bi(t,e){if(1&t&&(o.Sb(0,"tr"),o.Sb(1,"th",4),o.uc(2),o.Rb(),o.Sb(3,"th",4),o.uc(4),o.Rb(),o.Rb()),2&t){const t=e.$implicit;o.Cb(2),o.vc(t.name),o.Cb(2),o.vc(t.score)}}function gi(t,e){if(1&t&&(o.Sb(0,"table",1),o.Sb(1,"thead"),o.Sb(2,"tr"),o.Sb(3,"th",4),o.uc(4,"Value"),o.Rb(),o.Sb(5,"th",4),o.uc(6,"Score"),o.Rb(),o.Rb(),o.Rb(),o.Sb(7,"tbody"),o.sc(8,bi,5,2,"tr",5),o.Rb(),o.Rb()),2&t){const t=o.cc();o.Cb(8),o.hc("ngForOf",null==t.profile?null:t.profile.scores)}}let mi=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-profile-details-view"]],inputs:{profile:"profile"},decls:6,vars:4,consts:[[1,"mb-10"],[1,"mb-5"],["class","mb-5",4,"ngIf"],["class","table-auto","class","mb-5",4,"ngIf"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(o.Sb(0,"h2",0),o.uc(1),o.Rb(),o.Sb(2,"div",1),o.uc(3),o.Rb(),o.sc(4,vi,2,1,"div",2),o.sc(5,gi,9,1,"table",3)),2&t&&(o.Cb(1),o.vc(null==e.profile?null:e.profile.name),o.Cb(2),o.wc("Item Type: ",(null==e.profile?null:e.profile.itemType)||"No Type",""),o.Cb(1),o.hc("ngIf",!((null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0)),o.Cb(1),o.hc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0))},directives:[r.k,r.j],styles:[""]}),t})();function yi(t,e){if(1&t){const t=o.Tb();o.Sb(0,"button",7),o.Zb("click",(function(){return o.kc(t),o.cc(2).isEdit=!0})),o.uc(1,"Edit"),o.Rb()}}function wi(t,e){if(1&t){const t=o.Tb();o.Sb(0,"button",7),o.Zb("click",(function(){return o.kc(t),o.cc(2).saveEdit()})),o.uc(1,"Save"),o.Rb()}}function xi(t,e){if(1&t){const t=o.Tb();o.Sb(0,"button",8),o.Zb("click",(function(){return o.kc(t),o.cc(2).isEdit=!1})),o.uc(1,"Cancel"),o.Rb()}}function _i(t,e){if(1&t){const t=o.Tb();o.Sb(0,"button",9),o.Zb("click",(function(){return o.kc(t),o.cc(2).deleteProfile()})),o.uc(1,"Delete"),o.Rb()}}function Ci(t,e){if(1&t&&o.Nb(0,"dh-profile-details-view",10),2&t){const t=o.cc(2);o.hc("profile",t.profile)}}function Ii(t,e){if(1&t&&o.Nb(0,"dh-profile-details-edit",10),2&t){const t=o.cc(2);o.hc("profile",t.profile)}}function Ei(t,e){if(1&t&&(o.Qb(0),o.Sb(1,"div",2),o.sc(2,yi,2,0,"button",3),o.sc(3,wi,2,0,"button",3),o.sc(4,xi,2,0,"button",4),o.sc(5,_i,2,0,"button",5),o.Rb(),o.sc(6,Ci,1,1,"dh-profile-details-view",6),o.sc(7,Ii,1,1,"dh-profile-details-edit",6),o.Pb()),2&t){const t=o.cc();o.Cb(2),o.hc("ngIf",!t.isEdit),o.Cb(1),o.hc("ngIf",t.isEdit),o.Cb(1),o.hc("ngIf",t.isEdit),o.Cb(1),o.hc("ngIf",!t.isEdit),o.Cb(1),o.hc("ngIf",!t.isEdit),o.Cb(1),o.hc("ngIf",t.isEdit)}}function Si(t,e){1&t&&o.uc(0," No selected profile.\n")}let Oi=(()=>{class t{constructor(t,e){this.profileDetailsService=t,this.dhDialogService=e,this.isEdit=!1,this.pprofile=null}get profile(){return this.pprofile}set profile(t){this.isEdit=!1,this.pprofile=t}ngOnInit(){}saveEdit(){var t=this.profileDetailsEdit.getProfileName();t!=this.profile.name&&this.profileDetailsService.updateName(t),this.isEdit=!1}deleteProfile(){return Object(s.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading(),yield this.profileDetailsService.deleteProfile(this.profile.id),this.dhDialogService.hideLoading()}))}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(pi),o.Mb(fe))},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-profile-details"]],viewQuery:function(t,e){var i;1&t&&o.xc(fi,!0),2&t&&o.ic(i=o.ac())&&(e.profileDetailsEdit=i.first)},inputs:{profile:"profile"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noProfile",""],[1,"flex","justify-end","mb-16","mt-3"],["class","mr-5","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","mr-5","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-5","mat-flat-button","","color","warn",3,"click",4,"ngIf"],[3,"profile",4,"ngIf"],["mat-flat-button","","color","primary",1,"mr-5",3,"click"],["mat-flat-button","",1,"mr-5",3,"click"],["mat-flat-button","","color","warn",1,"mr-5",3,"click"],[3,"profile"]],template:function(t,e){if(1&t&&(o.sc(0,Ei,8,6,"ng-container",0),o.sc(1,Si,1,0,"ng-template",null,1,o.tc)),2&t){const t=o.jc(2);o.hc("ngIf",e.profile)("ngIfElse",t)}},directives:[r.k,Yt.a,mi,fi],styles:[""]}),t})();function ki(t,e){if(1&t){const t=o.Tb();o.Qb(0),o.Nb(1,"dh-available-fields",4),o.Sb(2,"dh-hierarchy",5),o.Zb("profileSelected",(function(e){return o.kc(t),o.cc(3).profileVsService.selectProfile(e)}))("linkClicked",(function(e){return o.kc(t),o.cc(3).linkClicked(e)}))("weightValueChanged",(function(e){return o.kc(t),o.cc(3).weightValueChanged(e)})),o.Rb(),o.Nb(3,"dh-profile-details",6),o.Pb()}if(2&t){const t=e.ngIf,i=o.cc().ngIf;o.Cb(2),o.hc("data",i.profiles)("weights",t.weights)("profileMap",i.profilesMap),o.Cb(1),o.hc("profile",i.selectedProfile)}}function Mi(t,e){if(1&t&&(o.Qb(0),o.sc(1,ki,4,4,"ng-container",3),o.dc(2,"async"),o.Pb()),2&t){const t=o.cc(2);o.Cb(1),o.hc("ngIf",o.ec(2,1,t.profileVsService.weightState$))}}function Bi(t,e){if(1&t&&(o.Qb(0),o.sc(1,Mi,3,3,"ng-container",3),o.dc(2,"async"),o.Pb()),2&t){const t=o.cc();o.Cb(1),o.hc("ngIf",o.ec(2,1,t.profileVsService.profileState$))}}function Vi(t,e){1&t&&o.Nb(0,"div")}const Ri=[{path:"",component:(()=>{class t{constructor(t,e){this.profileVsService=t,this.dhDialogService=e,this.ready=!1}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){this.profileVsService.keyChanged$.subscribe(()=>Object(s.a)(this,void 0,void 0,(function*(){this.ready=!1,this.dhDialogService.showLoading();var t=yield this.profileVsService.getProfiles();this.dhDialogService.hideLoading(),"error"==t&&this.dhDialogService.showMessage("error loading profile"),this.ready=!0})))}))}linkClicked(t){return Object(s.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading(),yield this.profileVsService.getLinkWeight(t),this.dhDialogService.hideLoading(),Object(o.lb)(this),this.hierarchyComponent.showWeightSlider()}))}weightValueChanged(t){return Object(s.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading(),yield this.profileVsService.saveLinkWeight(t),this.dhDialogService.hideLoading()}))}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(he),o.Mb(fe))},t.\u0275cmp=o.Gb({type:t,selectors:[["dh-profile"]],viewQuery:function(t,e){var i;1&t&&o.xc(ee,!0),2&t&&o.ic(i=o.ac())&&(e.hierarchyComponent=i.first)},decls:4,vars:2,consts:[[1,"flex","gap-5"],[4,"ngIf","ngIfElse"],["loading",""],[4,"ngIf"],[1,"block","border-l-4","px-10","text-base",2,"width","490px"],[1,"block","flex-1","overflow-hidden",3,"data","weights","profileMap","profileSelected","linkClicked","weightValueChanged"],[1,"block","border-l-4","px-10","text-base",2,"width","490px",3,"profile"]],template:function(t,e){if(1&t&&(o.Sb(0,"div",0),o.sc(1,Bi,3,3,"ng-container",1),o.sc(2,Vi,1,0,"ng-template",null,2,o.tc),o.Rb()),2&t){const t=o.jc(3);o.Cb(1),o.hc("ngIf",e.ready)("ngIfElse",t)}},directives:[r.k,Xe,ee,Oi],pipes:[r.b],styles:["dh-hierarchy[_ngcontent-%COMP%]{height:calc(100vh - 76px)}"]}),t})()}];let Ti=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},imports:[[n.a.forChild(Ri)],n.a]}),t})(),ji=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[r.c,Ti,Qt.e,Qt.l,Xt.b,Yt.b,Qe.d,li,ue.b,qe,Ze.b]]}),t})()}}]);