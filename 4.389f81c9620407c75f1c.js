(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"723k":function(t,e,i){"use strict";i.r(e),i.d(e,"ProfileModule",(function(){return Da}));var n=i("2kYt"),r=i("sEIs"),o=i("D57K"),s=i("EM62");class a{constructor(t){this.base=t}[Symbol.iterator](){return this.base[Symbol.iterator]()}concat(...t){return l(function*(t){for(const e of t)yield*e}([this,...t.map(l)]))}entries(){return l(function*(t){let e=0;for(const i of t)yield[e++,i]}(this))}every(t){return!this.some((e,i)=>!t(e,i))}fill(t){return this.map(()=>t)}filter(t){return l(function*(e){for(const[i,n]of e)t(n,i)&&(yield n)}(this.entries()))}find(t){for(const[e,i]of this.entries())if(t(i,e))return i}findIndex(t){for(const[e,i]of this.entries())if(t(i,e))return e;return-1}flatMap(t){return l(function*(e){for(const[i,n]of e)yield*l(t(n,i))}(this.entries()))}forEach(t){for(const[e,i]of this.entries())t(i,e)}includes(t,e=0){return this.indexOf(t,e)>=0}indexOf(t,e=0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");for(const[i,n]of this.entries())if(i>=e&&n===t)return i;return-1}join(t=","){return[...this].join(t)}keys(){return l(function*(t){let e=0;for(const i of t)yield e++}(this))}lastIndexOf(t,e=1/0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");let i=-1;for(const[n,r]of this.entries())n<=e&&r===t&&(i=n);return i}get length(){return this.reduce(t=>t+1,0)}map(t){return l(function*(e){for(const[i,n]of e)yield t(n,i)}(this.entries()))}reduce(t,e){if(void 0===e){const e=t;let i=!0,n=void 0;for(const[t,r]of this.entries())i?(n=r,i=!1):n=e(n,r,t);if(i)throw new TypeError("Reduce of empty iterable with no initial value");return n}{const i=t;let n=e;for(const[t,e]of this.entries())n=i(n,e,t);return n}}reverse(){return l([...this].reverse())}slice(t=0,e=1/0){return l(function*(i){for(const[n,r]of i)if(n<t);else{if(!(n<e))break;yield r}}(this.entries()))}some(t){for(const[e,i]of this.entries())if(t(i,e))return!0;return!1}sort(t){return l([...this].sort(t))}splice(t,e=0,...i){return l(function*(n){for(const[r,o]of n)r===t&&(yield*i),(r<t||r>=t+e)&&(yield o)}(this.entries()))}values(){return this}}function l(t){return function(t){return"function"==typeof t[Symbol.iterator]}(t)?new a(t):new a({[Symbol.iterator]:()=>t})}function c(t,e){e.size<t.size&&([e,t]=[t,e]);for(const i of t)if(e.has(i))return!0;return!1}class h extends Map{getThrow(t){const e=this.get(t);if(void 0===e)throw new Error("map doesn't contain key: "+t);return e}getDefault(t,e){const i=this.get(t);return void 0===i?e:i}setIfAbsent(t,e){const i=this.get(t);return void 0===i?(this.set(t,e),e):i}}class u{constructor(t,e,i=[]){this.child=t,this.data=e,this.points=i}}class d{constructor(t,e,i,n){this.source=t,this.target=e,this.data=i,this.points=n}}class f{constructor(t,e){this.id=t,this.data=e,this.dataChildren=[]}iroots(){return l([this])}roots(){return[this]}*iterChildren(){for(const{child:t}of this.dataChildren)yield t}ichildren(){return l(this.iterChildren())}children(){return[...this.ichildren()]}*iterChildLinks(){for(const{child:t,data:e,points:i}of this.dataChildren)yield new d(this,t,e,i)}ichildLinks(){return l(this.iterChildLinks())}childLinks(){return[...this.ichildLinks()]}[Symbol.iterator](){return new p([this])[Symbol.iterator]()}idescendants(t="depth"){return new p([this]).idescendants(t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return new p([this]).ilinks()}links(){return[...this.ilinks()]}size(){return new p([this]).size()}sum(t){return new p([this]).sum(t),this}count(){return new p([this]).count(),this}height(){return new p([this]).height(),this}depth(){return new p([this]).depth(),this}split(){return[this]}connected(){return!0}}class p{constructor(t){this.dagRoots=t}[Symbol.iterator](){return this.idepth()}iroots(){return l(this.dagRoots)}roots(){return this.dagRoots.slice()}*idepth(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(e.add(i.id),yield i,t.push(...i.ichildren()))}*ibreadth(){const t=new Set;let e=this.roots(),i=[];do{let n;for(i=e.reverse(),e=[];n=i.pop();)t.has(n.id)||(t.add(n.id),yield n,e.push(...n.ichildren()))}while(e.length)}*ibefore(){const t=new h;for(const n of this)for(const e of n.ichildren())t.set(e.id,t.getDefault(e.id,0)+1);const e=this.roots();let i;for(;i=e.pop();){yield i;for(const n of i.ichildren()){const i=t.getThrow(n.id);i>1?t.set(n.id,i-1):e.push(n)}}}*iafter(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(i.ichildren().every(t=>e.has(t.id))?(e.add(i.id),yield i):(t.push(i),t.push(...i.ichildren())))}idescendants(t="depth"){if("depth"===t)return l(this.idepth());if("breadth"===t)return l(this.ibreadth());if("before"===t)return l(this.ibefore());if("after"===t)return l(this.iafter());throw new Error("unknown iteration style: "+t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return this.idescendants().flatMap(t=>t.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(t=>t+1,0)}sum(t){const e=new h;for(const[i,n]of this.idescendants("after").entries()){const r=t(n,i),o=new h;o.set(n.id,r);for(const t of n.ichildren()){const i=e.getThrow(t.id);for(const[t,e]of i.entries())o.set(t,e)}n.value=l(o.entries()).map(([,t])=>t).reduce((t,e)=>t+e),e.set(n.id,o)}return this}count(){const t=new h;for(const e of this.idescendants("after"))if(e.ichildren()[Symbol.iterator]().next().done)t.set(e.id,new Set([e.id])),e.value=1;else{const i=new Set;for(const n of e.ichildren()){const e=t.getThrow(n.id);for(const t of e)i.add(t)}t.set(e.id,i),e.value=i.size}return this}height(){for(const t of this.idescendants("after"))t.value=Math.max(0,...t.ichildren().map(t=>{if(void 0===t.value)throw new Error("`after` iteration didn't iterate in after order");return t.value+1}));return this}depth(){const t=new h;for(const e of this)for(const i of e.ichildren())t.setIfAbsent(i.id,[]).push(e);for(const e of this.idescendants("before"))e.value=Math.max(0,...t.getDefault(e.id,[]).map(t=>{if(void 0===t.value)throw new Error("`before` iteration didn't iterate in before order");return t.value+1}));return this}split(){const t=new h,e=new h;for(const r of this.iroots())t.set(r.id,[]),e.set(r.id,new Set(r.idescendants().map(t=>t.id)));for(const[r,o]of this.iroots().entries()){const i=e.getThrow(o.id);for(const n of this.iroots().slice(r+1))c(i,e.getThrow(n.id))&&(t.getThrow(o.id).push(n),t.getThrow(n.id).push(o))}const i=[],n=new Set;for(const r of this.iroots())if(!n.has(r.id)){n.add(r.id);const e=[r];i.push(e);const o=t.getThrow(r.id).slice();let s;for(;s=o.pop();)n.has(s.id)||(n.add(s.id),e.push(s),o.push(...t.getThrow(s.id)))}return i.map(t=>t.length>1?new p(t):t[0])}connected(){return 1===this.split().length}}function m(t){function e(e,i){return(t(e,i)||[]).map(t=>[t,void 0])}return e.wrapped=t,e}function g(t){if(function(t){try{return"string"==typeof t.id}catch(e){return!1}}(t))return t.id;throw new Error("default id function expected datum to have an id field but got: "+t)}function v(t){if(function(t){try{const e=t.parentIds;return void 0===e||e instanceof Array&&e.every(t=>"string"==typeof t)}catch(e){return!1}}(t))return t.parentIds;throw new Error("default parentIds function expected datum to have a parentIds field but got: "+t)}let b,y,_=1e-60;do{_+=_,b=1+.1*_,y=1+.2*_}while(b<=1||y<=1);var w=_,x=function(t,e,i,n=[],r=0,o=[0,0]){const s=[],a=[],l=[],c=[],h=[],u=[];let d="";const f=t.length-1,p=i[1].length-1;if(!n)for(let g=1;g<=p;g+=1)n[g]=0;if(f!==t[1].length-1&&(d="Dmat is not symmetric!"),f!==e.length-1&&(d="Dmat and dvec are incompatible!"),f!==i.length-1&&(d="Amat and dvec are incompatible!"),p!==n.length-1&&(d="Amat and bvec are incompatible!"),(r>p||r<0)&&(d="Value of meq is invalid!"),""!==d)return{message:d};for(let g=1;g<=p;g+=1)a[g]=0,c[g]=0;const m=Math.min(f,p);for(let g=1;g<=f;g+=1)l[g]=0;s[1]=0;for(let g=1;g<=2*f+m*(m+5)/2+2*p+1;g+=1)h[g]=0;for(let g=1;g<=2;g+=1)u[g]=0;return function(t,e,i,n,r,o,s,a,l,c,h,u,d,f=0,p,m,g){let v,b,y,_,x,C,S,I,k,O,E,T,M,j;const N=Math.min(n,h);let P=2*n+N*(N+5)/2+2*h+1;for(let w=1;w<=n;w+=1)m[w]=e[w];for(let w=n+1;w<=P;w+=1)m[w]=0;for(let w=1;w<=h;w+=1)d[w]=0,o[w]=0;const B=[];if(0===g[1]){if(function(t,e,i,n){let r,o,s;for(let a=1;a<=i;a+=1){if(n[1]=a,s=0,r=a-1,r<1){if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}else{for(let e=1;e<=r;e+=1){o=t[e][a];for(let i=1;i<e;i+=1)o-=t[i][a]*t[i][e];o/=t[e][e],t[e][a]=o,s+=o*o}if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}n[1]=0}}(t,0,n,B),0!==B[1])return void(g[1]=2);(function(t,e,i,n){let r,o;for(r=1;r<=i;r+=1){o=0;for(let e=1;e<r;e+=1)o+=t[e][r]*n[e];n[r]=(n[r]-o)/t[r][r]}for(let s=1;s<=i;s+=1){r=i+1-s,n[r]/=t[r][r],o=-n[r];for(let e=1;e<r;e+=1)n[e]+=o*t[e][r]}})(t,0,n,e),function(t,e,i){let n,r;for(let o=1;o<=i;o+=1){t[o][o]=1/t[o][o],r=-t[o][o];for(let e=1;e<o;e+=1)t[e][o]*=r;if(n=o+1,i<n)break;for(let e=n;e<=i;e+=1){r=t[o][e],t[o][e]=0;for(let i=1;i<=o;i+=1)t[i][e]+=r*t[i][o]}}}(t,0,n)}else{for(let i=1;i<=n;i+=1){r[i]=0;for(let n=1;n<=i;n+=1)r[i]+=t[n][i]*e[n]}for(let i=1;i<=n;i+=1){e[i]=0;for(let o=i;o<=n;o+=1)e[i]+=t[i][o]*r[o]}}s[1]=0;for(let w=1;w<=n;w+=1){r[w]=e[w],s[1]+=m[w]*r[w],m[w]=0;for(let e=w+1;e<=n;e+=1)t[e][w]=0}s[1]=-s[1]/2,g[1]=0;const D=n,A=D+n,V=A+N,R=V+N+1,z=R+N*(N+1)/2,L=z+h;for(let w=1;w<=h;w+=1){C=0;for(let t=1;t<=n;t+=1)C+=a[t][w]*a[t][w];m[L+w]=Math.sqrt(C)}function F(){p[1]+=1,P=z;for(let t=1;t<=h;t+=1){P+=1,C=-l[t];for(let e=1;e<=n;e+=1)C+=a[e][t]*r[e];if(Math.abs(C)<w&&(C=0),t>u)m[P]=C;else if(m[P]=-Math.abs(C),C>0){for(let e=1;e<=n;e+=1)a[e][t]=-a[e][t];l[t]=-l[t]}}for(let t=1;t<=_;t+=1)m[z+d[t]]=0;y=0,x=0;for(let t=1;t<=h;t+=1)m[z+t]<x*m[L+t]&&(y=t,x=m[z+t]/m[L+t]);if(0===y){for(let t=1;t<=_;t+=1)o[d[t]]=m[V+t];return 999}return 0}function q(){for(let e=1;e<=n;e+=1){C=0;for(let i=1;i<=n;i+=1)C+=t[i][e]*a[i][y];m[e]=C}v=D;for(let t=1;t<=n;t+=1)m[v+t]=0;for(let e=_+1;e<=n;e+=1)for(let i=1;i<=n;i+=1)m[v+i]=m[v+i]+t[i][e]*m[e];T=!0;for(let t=_;t>=1;t-=1){C=m[t],P=R+t*(t+3)/2,v=P-t;for(let e=t+1;e<=_;e+=1)C-=m[P]*m[A+e],P+=e;C/=m[v],m[A+t]=C,d[t]<=u||C<=0||(T=!1,b=t)}if(!T){S=m[V+b]/m[A+b];for(let t=1;t<=_;t+=1)d[t]<=u||m[A+t]<=0||(x=m[V+t]/m[A+t],x<S&&(S=x,b=t))}C=0;for(let t=D+1;t<=D+n;t+=1)C+=m[t]*m[t];if(Math.abs(C)<=w){if(T)return g[1]=1,999;for(let t=1;t<=_;t+=1)m[V+t]=m[V+t]-S*m[A+t];return m[V+_+1]=m[V+_+1]+S,700}C=0;for(let t=1;t<=n;t+=1)C+=m[D+t]*a[t][y];I=-m[z+y]/C,M=!0,T||S<I&&(I=S,M=!1);for(let t=1;t<=n;t+=1)r[t]+=I*m[D+t],Math.abs(r[t])<w&&(r[t]=0);s[1]+=I*C*(I/2+m[V+_+1]);for(let t=1;t<=_;t+=1)m[V+t]=m[V+t]-I*m[A+t];if(m[V+_+1]=m[V+_+1]+I,!M){C=-l[y];for(let t=1;t<=n;t+=1)C+=r[t]*a[t][y];if(y>u)m[z+y]=C;else if(m[z+y]=-Math.abs(C),C>0){for(let t=1;t<=n;t+=1)a[t][y]=-a[t][y];l[y]=-l[y]}return 700}_+=1,d[_]=y,P=R+(_-1)*_/2+1;for(let t=1;t<=_-1;t+=1)m[P]=m[t],P+=1;if(_===n)m[P]=m[n];else{for(let e=n;e>=_+1;e-=1)if(0!==m[e]&&(k=Math.max(Math.abs(m[e-1]),Math.abs(m[e])),O=Math.min(Math.abs(m[e-1]),Math.abs(m[e])),x=m[e-1]>=0?Math.abs(k*Math.sqrt(1+O*O/(k*k))):-Math.abs(k*Math.sqrt(1+O*O/(k*k))),k=m[e-1]/x,O=m[e]/x,1!==k))if(0===k){m[e-1]=O*x;for(let i=1;i<=n;i+=1)x=t[i][e-1],t[i][e-1]=t[i][e],t[i][e]=x}else{m[e-1]=x,E=O/(1+k);for(let i=1;i<=n;i+=1)x=k*t[i][e-1]+O*t[i][e],t[i][e]=E*(t[i][e-1]+x)-t[i][e],t[i][e-1]=x}m[P]=m[_]}return 0}function W(){if(P=R+b*(b+1)/2+1,v=P+b,0===m[v])return 798;if(k=Math.max(Math.abs(m[v-1]),Math.abs(m[v])),O=Math.min(Math.abs(m[v-1]),Math.abs(m[v])),x=m[v-1]>=0?Math.abs(k*Math.sqrt(1+O*O/(k*k))):-Math.abs(k*Math.sqrt(1+O*O/(k*k))),k=m[v-1]/x,O=m[v]/x,1===k)return 798;if(0===k){for(let t=b+1;t<=_;t+=1)x=m[v-1],m[v-1]=m[v],m[v]=x,v+=t;for(let e=1;e<=n;e+=1)x=t[e][b],t[e][b]=t[e][b+1],t[e][b+1]=x}else{E=O/(1+k);for(let t=b+1;t<=_;t+=1)x=k*m[v-1]+O*m[v],m[v]=E*(m[v-1]+x)-m[v],m[v-1]=x,v+=t;for(let e=1;e<=n;e+=1)x=k*t[e][b]+O*t[e][b+1],t[e][b+1]=E*(t[e][b]+x)-t[e][b+1],t[e][b]=x}return 0}function $(){v=P-b;for(let t=1;t<=b;t+=1)m[v]=m[P],P+=1,v+=1;return m[V+b]=m[V+b+1],d[b]=d[b+1],b+=1,b<_?797:0}function H(){return m[V+_]=m[V+_+1],m[V+_+1]=0,d[_]=0,_-=1,p[2]+=1,0}for(_=f,p[1]=0,p[2]=0,j=0;;){if(j=F(),999===j)return;for(;j=q(),0!==j;){if(999===j)return;if(700===j)if(b===_)H();else{for(;W(),j=$(),797===j;);H()}}}}(t,e,0,f,l,c,s,i,n,0,p,r,a,0,u,h,o),1===o[1]&&(d="constraints are inconsistent, no solution!"),2===o[1]&&(d="matrix D in quadratic function is not positive definite!"),{solution:l,Lagrangian:c,value:s,unconstrained_solution:e,iterations:u,iact:a,message:d}};function C(t,e){let[i,...n]=t,r=i.x=0;for(const o of n)r=o.x=r+e(i,o),i=o;if(r>0)for(const o of t)o.x/=r;else for(const o of t)o.x=.5}function S(t,e,i,n){t[i][i]+=n,t[i][e]-=n,t[e][i]-=n,t[e][e]+=n}function I(t,e,i,n,r){t[n][n]+=r,t[n][i]-=2*r,t[n][e]+=r,t[i][n]-=2*r,t[i][i]+=4*r,t[i][e]-=2*r,t[e][n]+=r,t[e][i]-=2*r,t[e][e]+=r}class k extends f{constructor(t){super(t,void 0)}}function O(t,e,i,n){this.feasible=i,this.evaluation=e,this.bounded=n,this._tableau=t}var E=O;function T(t,e,i,n,r){E.call(this,t,e,i,n),this.iter=r}O.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,n=e.variablesPerIndex,r=e.matrix,o=e.rhsColumn,s=e.height-1,a=Math.round(1/e.precision),l=1;l<=s;l+=1){var c=n[i[l]];void 0!==c&&!0!==c.isSlack&&(t[c.id]=Math.round((Number.EPSILON+r[l][o])*a)/a)}return t};var M=T;function j(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}T.prototype=Object.create(E.prototype),T.constructor=T;var N=j;function P(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}j.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},P.prototype.copy=function(){var t=new P(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},j.prototype.setOptionalObjective=function(t,e,i){var n=this.objectivesByPriority[t];void 0===n&&(n=new P(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=n,this.optionalObjectives.push(n),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),n.reducedCosts[e]=i},j.prototype.initialize=function(t,e,i,n){this.variables=i,this.unrestrictedVars=n,this.width=t,this.height=e;for(var r=new Array(t),o=0;o<t;o++)r[o]=0;this.matrix=new Array(e);for(var s=0;s<e;s++)this.matrix[s]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},j.prototype._resetMatrix=function(){var t,e,i=this.model.variables,n=this.model.constraints,r=i.length,o=n.length,s=this.matrix[0],a=!0===this.model.isMinimization?-1:1;for(t=0;t<r;t+=1){var l=i[t],c=l.priority,h=a*l.cost;0===c?s[t+1]=h:this.setOptionalObjective(c,t+1,h),this.rowByVarIndex[e=i[t].index]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var u=1,d=0;d<o;d+=1){var f,p,m=n[d],g=m.index;this.rowByVarIndex[g]=u,this.colByVarIndex[g]=-1,this.varIndexByRow[u]=g;var v=m.terms,b=v.length,y=this.matrix[u++];if(m.isUpperBound){for(f=0;f<b;f+=1)y[this.colByVarIndex[(p=v[f]).variable.index]]=p.coefficient;y[0]=m.rhs}else{for(f=0;f<b;f+=1)y[this.colByVarIndex[(p=v[f]).variable.index]]=-p.coefficient;y[0]=-m.rhs}}},j.prototype.setModel=function(t){return this.model=t,this.initialize(t.nVariables+1,t.nConstraints+1,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},j.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},j.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var n=e[i],r=0;r<this.width;r++)0!==n[r]&&(t+=1);return t/(this.height*this.width)},j.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*t)/t;this.evaluation=e,0===this.simplexIters&&(this.bestPossibleEval=e)},j.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new M(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new E(this,t,this.feasible,this.bounded)},N.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},N.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,n=this.rhsColumn,r=this.width-1,o=this.height-1,s=0;;){for(var a=0,l=-this.precision,c=1;c<=o;c++){var h=i[c][n];h<l&&(l=h,a=c)}if(0===a)return this.feasible=!0,s;for(var u=0,d=-1/0,f=i[0],p=i[a],m=1;m<=r;m++){var g=p[m];if(!0===this.unrestrictedVars[this.varIndexByCol[m]]||g<-this.precision){var v=-f[m]/g;d<v&&(d=v,u=m)}}if(0===u)return this.feasible=!1,s;if(t){e.push([this.varIndexByRow[a],this.varIndexByCol[u]]);var b=this.checkForCycles(e);if(b.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+b[0]),this.model.messages.push("Length :"+b[1]),this.feasible=!1,s}this.pivot(a,u),s+=1}},N.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,n=[],r=this.matrix,o=this.rhsColumn,s=this.width-1,a=this.height-1,l=this.precision,c=this.optionalObjectives.length,h=null,u=0;;){var d=r[this.costRowIndex];c>0&&(h=[]);for(var f=0,p=l,m=!1,g=1;g<=s;g++)t=d[g],e=!0===this.unrestrictedVars[this.varIndexByCol[g]],c>0&&-l<t&&t<l?h.push(g):e&&t<0?-t>p&&(p=-t,f=g,m=!0):t>p&&(p=t,f=g,m=!1);if(c>0)for(var v=0;0===f&&h.length>0&&v<c;){var b=[],y=this.optionalObjectives[v].reducedCosts;p=l;for(var _=0;_<h.length;_++)e=!0===this.unrestrictedVars[this.varIndexByCol[g=h[_]]],-l<(t=y[g])&&t<l?b.push(g):e&&t<0?-t>p&&(p=-t,f=g,m=!0):t>p&&(p=t,f=g,m=!1);h=b,v+=1}if(0===f)return this.setEvaluation(),this.simplexIters+=1,u;for(var w=0,x=1/0,C=1;C<=a;C++){var S=r[C],I=S[o],k=S[f];if(!(-l<k&&k<l)){if(k>0&&l>I&&I>-l){x=0,w=C;break}var O=m?-I/k:I/k;O>l&&x>O&&(x=O,w=C)}}if(x===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],u;if(i){n.push([this.varIndexByRow[w],this.varIndexByCol[f]]);var E=this.checkForCycles(n);if(E.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+E[0]),this.model.messages.push("Length :"+E[1]),this.feasible=!1,u}this.pivot(w,f,!0),u+=1}};var B=[];function D(t,e,i,n){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=n}function A(t,e,i,n){D.call(this,t,e,i,n)}function V(t,e){D.call(this,t,0,e,0)}function R(t,e){this.variable=t,this.coefficient=e}function z(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function L(t,e,i,n){this.slack=new V("s"+i,i),this.index=i,this.model=n,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function F(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}N.prototype.pivot=function(t,e){var i=this.matrix,n=i[t][e],r=this.height-1,o=this.width-1,s=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=s,this.rowByVarIndex[a]=t,this.rowByVarIndex[s]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[s]=e;for(var l,c,h,u=i[t],d=0,f=0;f<=o;f++)u[f]>=-1e-16&&u[f]<=1e-16?u[f]=0:(u[f]/=n,B[d]=f,d+=1);u[e]=1/n;for(var p=0;p<=r;p++)if(p!==t&&!(i[p][e]>=-1e-16&&i[p][e]<=1e-16)){var m=i[p];if((l=m[e])>=-1e-16&&l<=1e-16)0!==l&&(m[e]=0);else{for(c=0;c<d;c++)(h=u[f=B[c]])>=-1e-16&&h<=1e-16?0!==h&&(u[f]=0):m[f]=m[f]-l*h;m[e]=-l/n}}var g=this.optionalObjectives.length;if(g>0)for(var v=0;v<g;v+=1){var b=this.optionalObjectives[v].reducedCosts;if(0!==(l=b[e])){for(c=0;c<d;c++)0!==(h=u[f=B[c]])&&(b[f]=b[f]-l*h);b[e]=-l/n}}},N.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var n=t[e],r=t[i];if(n[0]===r[0]&&n[1]===r[1]){if(i-e>t.length-i)break;for(var o=!0,s=1;s<i-e;s++){var a=t[e+s],l=t[i+s];if(a[0]!==l[0]||a[1]!==l[1]){o=!1;break}}if(o)return[e,i-e]}}return[]},A.prototype.isInteger=!0,V.prototype.isSlack=!0,L.prototype.addTerm=function(t,e){var i=e.index,n=this.termsByVarIndex[i];return void 0===n?(n=new R(e,t),this.termsByVarIndex[i]=n,this.terms.push(n),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t)):this.setVariableCoefficient(n.coefficient+t,e),this},L.prototype.removeTerm=function(t){return this},L.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},L.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var n=this.termsByVarIndex[i];if(void 0===n)this.addTerm(t,e);else if(t!==n.coefficient){var r=t-n.coefficient;!0===this.isUpperBound&&(r=-r),n.coefficient=t,this.model.updateConstraintCoefficient(this,e,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},L.prototype.relax=function(t,e){this.relaxation=z(this.model,t,e),this._relax(this.relaxation)},L.prototype._relax=function(t){null!==t&&this.setVariableCoefficient(this.isUpperBound?-1:1,t)},F.prototype.isEquality=!0,F.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},F.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},F.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},F.prototype.relax=function(t,e){this.relaxation=z(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var q={Constraint:L,Variable:D,IntegerVariable:A,SlackVariable:V,Equality:F,Term:R},W=q.SlackVariable;function $(t,e){this.index=t,this.value=e}N.prototype.addCutConstraints=function(t){for(var e,i=t.length,n=this.height,r=n+i,o=n;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var s=this.width-1,a=0;a<i;a+=1){var l=t[a],c=n+a,h="min"===l.type?-1:1,u=l.varIndex,d=this.rowByVarIndex[u],f=this.matrix[c];if(-1===d){for(f[this.rhsColumn]=h*l.value,e=1;e<=s;e+=1)f[e]=0;f[this.colByVarIndex[u]]=h}else{var p=this.matrix[d];for(f[this.rhsColumn]=h*(l.value-p[this.rhsColumn]),e=1;e<=s;e+=1)f[e]=-h*p[e]}var m=this.getNewElementIndex();this.varIndexByRow[c]=m,this.rowByVarIndex[m]=c,this.colByVarIndex[m]=-1,this.variablesPerIndex[m]=new W("s"+m,m),this.nVars+=1}},N.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new W("s"+o,o),e[r][this.rhsColumn]=Math.floor(i);for(var s=1;s<this.varIndexByCol.length;s+=1)if(this.variablesPerIndex[this.varIndexByCol[s]].isInteger){var a=e[t][s],l=Math.floor(a)+Math.max(0,a-Math.floor(a)-n)/(1-n);e[r][s]=l}else e[r][s]=Math.min(0,e[t][s]/(1-n));for(var c=0;c<this.width;c+=1)e[r][c]-=e[t][c];return!0},N.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new W("s"+o,o),e[r][this.rhsColumn]=-n;for(var s=1;s<this.varIndexByCol.length;s+=1){var a=this.variablesPerIndex[this.varIndexByCol[s]],l=e[t][s],c=l-Math.floor(l);e[r][s]=a.isInteger?c<=n?-c:-(1-c)*n/c:l>=0?-l:l*n/(1-n)}return!0},N.prototype.applyMIRCuts=function(){},N.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],n=1;n<this.height;n+=1){var r=this.matrix[n][i];if(r<-this.precision||this.precision<r){e=n;break}}this.pivot(e,i)}return e},N.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],n=this.matrix[i],r=1;r<this.height;r+=1){var o=n[r];if(o<-this.precision||this.precision<o){e=r;break}}this.pivot(i,e)}return e},N.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var n=this.variables[i],r=this.rowByVarIndex[n.index];n.value=-1===r?0:Math.round((this.matrix[r][this.rhsColumn]+Number.EPSILON)*e)/e}},N.prototype.updateRightHandSide=function(t,e){var i=this.height-1,n=this.rowByVarIndex[t.index];if(-1===n){for(var r=this.colByVarIndex[t.index],o=0;o<=i;o+=1){var s=this.matrix[o];s[this.rhsColumn]-=e*s[r]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var c=this.optionalObjectives[l].reducedCosts;c[this.rhsColumn]-=e*c[r]}}else this.matrix[n][this.rhsColumn]-=e},N.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var n=this._putInBase(t.index),r=this.colByVarIndex[e.index];if(-1===r)for(var o=this.rowByVarIndex[e.index],s=0;s<this.width;s+=1)this.matrix[n][s]+=i*this.matrix[o][s];else this.matrix[n][r]-=i},N.prototype.updateCost=function(t,e){var i=t.index,n=this.width-1,r=this.colByVarIndex[i];if(-1===r){var o,s=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var a=this.matrix[0];for(o=0;o<=n;o+=1)a[o]+=e*s[o]}else{var l=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=n;o+=1)l[o]+=e*s[o]}}else this.matrix[0][r]-=e},N.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,n=this.matrix[i];void 0===n&&(n=this.matrix[0].slice(),this.matrix[i]=n);for(var r=this.width-1,o=0;o<=r;o+=1)n[o]=0;n[this.rhsColumn]=e*t.rhs;for(var s=t.terms,a=s.length,l=0;l<a;l+=1){var c=s[l],h=c.coefficient,u=c.variable.index,d=this.rowByVarIndex[u];if(-1===d)n[this.colByVarIndex[u]]+=e*h;else{var f=this.matrix[d];for(o=0;o<=r;o+=1)n[o]-=e*h*f[o]}}var p=t.index;this.varIndexByRow[i]=p,this.rowByVarIndex[p]=i,this.colByVarIndex[p]=-1,this.height+=1},N.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,n=this._putInBase(e),r=this.matrix[i];this.matrix[i]=this.matrix[n],this.matrix[n]=r,this.varIndexByRow[n]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1},N.prototype.addVariable=function(t){var e=this.height-1,i=this.width,n=!0===this.model.isMinimization?-t.cost:t.cost,r=t.priority,o=this.optionalObjectives.length;if(o>0)for(var s=0;s<o;s+=1)this.optionalObjectives[s].reducedCosts[i]=0;0===r?this.matrix[0][i]=n:(this.setOptionalObjective(r,i,n),this.matrix[0][i]=0);for(var a=1;a<=e;a+=1)this.matrix[a][i]=0;var l=t.index;this.varIndexByCol[i]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=i,this.width+=1},N.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),n=this.width-1;if(i!==n){for(var r=this.height-1,o=0;o<=r;o+=1){var s=this.matrix[o];s[i]=s[n]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var c=this.optionalObjectives[l].reducedCosts;c[i]=c[n]}var h=this.varIndexByCol[n];this.varIndexByCol[i]=h,this.colByVarIndex[h]=i}this.varIndexByCol[n]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1},N.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i,n,r,o,s,a,l,c,h,u,d="",f=[" "];for(n=1;n<this.width;n+=1)l=" ",c="\t",(a=void 0===(o=this.variablesPerIndex[s=this.varIndexByCol[n]])?"c"+s:o.id).length>5?l+=" ":c+="\t",f[n]=l,d+=c+a;console.log(d);var p=this.matrix[this.costRowIndex],m="\t";for(i=1;i<this.width;i+=1)m+="\t",m+=f[i],m+=p[i].toFixed(5);for(m+="\t"+f[0]+p[0].toFixed(5),console.log(m+"\tZ"),r=1;r<this.height;r+=1){for(h=this.matrix[r],u="\t",n=1;n<this.width;n+=1)u+="\t"+f[n]+h[n].toFixed(5);u+="\t"+f[0]+h[0].toFixed(5),a=void 0===(o=this.variablesPerIndex[s=this.varIndexByRow[r]])?"c"+s:o.id,console.log(u+"\t"+a)}console.log("");var g=this.optionalObjectives.length;if(g>0){console.log("    Optional objectives:");for(var v=0;v<g;v+=1){var b=this.optionalObjectives[v].reducedCosts,y="";for(i=1;i<this.width;i+=1)y+=b[i]<0?"":" ",y+=f[i],y+=b[i].toFixed(5);y+=(b[0]<0?"":" ")+f[0]+b[0].toFixed(5),console.log(y+" z"+v)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},N.prototype.copy=function(){var t=new N(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var n=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=n[o].slice();return t.matrix=r,t},N.prototype.save=function(){this.savedState=this.copy()},N.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,n=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var r=n[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=r[e]}var s=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=s[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=a[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=i.rowByVarIndex,c=i.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=l[h],this.colByVarIndex[h]=c[h];if(i.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var u=0;u<i.optionalObjectives.length;u++){var d=i.optionalObjectives[u].copy();this.optionalObjectives[u]=d,this.optionalObjectivePerPriority[d.priority]=d}}}},N.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,n=this.model.integerVariables,r=n.length,o=0;o<r;o++){var s=n[o].index,a=this.rowByVarIndex[s];if(-1!==a){var l=this.matrix[a][this.rhsColumn],c=Math.abs(l-Math.round(l));t<c&&(t=c,e=s,i=l)}}return new $(e,i)},N.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,n=this.model.integerVariables,r=n.length,o=0;o<r;o++){var s=n[o],a=s.index,l=this.rowByVarIndex[a];if(-1!==l){var c=this.matrix[l][this.rhsColumn];if(Math.abs(c-Math.round(c))>this.precision){var h=s.cost;t>h&&(t=h,e=a,i=c)}}}return new $(e,i)},N.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},N.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var n=this.rowByVarIndex[t[i].index];if(-1!==n){var r=this.matrix[n][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},N.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var n=this.matrix[i][this.rhsColumn];if(n=Math.abs(n),Math.min(n-Math.floor(n),Math.floor(n+1))<this.precision){if(!t)return 0}else-1===e?e=n:e*=n}return-1===e?0:e};var H=N;function Y(t,e,i){this.type=t,this.varIndex=e,this.value=i}function X(t,e){this.relaxedEvaluation=t,this.cuts=e}function U(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}N.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*i&&(e=!1)}},N.prototype.branchAndCut=function(){var t=[],e=0,i=this.model.tolerance,n=!0,r=1e99;this.model.timeout&&(r=Date.now()+this.model.timeout);for(var o=1/0,s=null,a=[],l=0;l<this.optionalObjectives.length;l+=1)a.push(1/0);var c=new X(-1/0,[]);for(t.push(c);t.length>0&&!0===n&&Date.now()<r;)if(i>0&&o<(this.model.isMinimization?this.bestPossibleEval*(1+i):this.bestPossibleEval*(1-i))&&(n=!1),!((c=t.pop()).relaxedEvaluation>o)){var h=c.cuts;if(this.applyCuts(h),e++,!1!==this.feasible){var u=this.evaluation;if(!(u>o)){if(u===o){for(var d=!0,f=0;f<this.optionalObjectives.length&&!(this.optionalObjectives[f].reducedCosts[0]>a[f]);f+=1)if(this.optionalObjectives[f].reducedCosts[0]<a[f]){d=!1;break}if(d)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===e)return void(this.branchAndCutIterations=e);s=c,o=u;for(var p=0;p<this.optionalObjectives.length;p+=1)a[p]=this.optionalObjectives[p].reducedCosts[0]}else{1===e&&this.save();for(var m=this.getMostFractionalVar(),g=m.index,v=[],b=[],y=h.length,_=0;_<y;_+=1){var w=h[_];w.varIndex===g?"min"===w.type?b.push(w):v.push(w):(v.push(w),b.push(w))}var x=Math.ceil(m.value),C=Math.floor(m.value),S=new Y("min",g,x);v.push(S);var I=new Y("max",g,C);b.push(I),t.push(new X(u,v)),t.push(new X(u,b)),t.sort(U)}}}}null!==s&&this.applyCuts(s.cuts),this.branchAndCutIterations=e};var G={},K=q.Constraint,Q=q.Equality,Z=q.Variable,J=q.IntegerVariable;function tt(t,e){this.tableau=new N(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var et=tt;tt.prototype.minimize=function(){return this.isMinimization=!0,this},tt.prototype.maximize=function(){return this.isMinimization=!1,this},tt.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},tt.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},tt.prototype.smallerThan=function(t){var e=new K(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.greaterThan=function(t){var e=new K(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.equal=function(t){var e=new K(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new K(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new Q(e,i)},tt.prototype.addVariable=function(t,e,i,n,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,s=this.tableau.getNewElementIndex();return null==e&&(e="v"+s),null==t&&(t=0),null==r&&(r=0),i?(o=new J(e,t,s,r),this.integerVariables.push(o)):o=new Z(e,t,s,r),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,n&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},tt.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},tt.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},tt.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},tt.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},tt.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},tt.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},tt.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,n={},r={},o=Object.keys(i),s=o.length,a=0;a<s;a+=1){var l,c,h=o[a],u=i[h],d=u.equal,f=u.weight,p=u.priority,m=void 0!==f||void 0!==p;if(void 0===d){var g=u.min;void 0!==g&&(l=this.greaterThan(g),n[h]=l,m&&l.relax(f,p));var v=u.max;void 0!==v&&(c=this.smallerThan(v),r[h]=c,m&&c.relax(f,p))}else{l=this.greaterThan(d),n[h]=l,c=this.smallerThan(d),r[h]=c;var b=new Q(l,c);m&&b.relax(f,p)}}var y=Object.keys(e),_=y.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),0===this.tolerance&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),this.checkForCycles=void 0===t.options.exitOnCycles||t.options.exitOnCycles);for(var w=t.ints||{},x=t.binaries||{},C=t.unrestricted||{},S=t.optimize,I=0;I<_;I+=1){var k=y[I],O=e[k],E=!!x[k],T=this.addVariable(O[S]||0,k,!!w[k]||E,!!C[k]);E&&this.smallerThan(1).addTerm(1,T);var M=Object.keys(O);for(a=0;a<M.length;a+=1){var j=M[a];if(j!==S){var N=O[j],P=n[j];void 0!==P&&P.addTerm(N,T);var B=r[j];void 0!==B&&B.addTerm(N,T)}}}return this},tt.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},tt.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},tt.prototype.isFeasible=function(){return this.tableau.feasible},tt.prototype.save=function(){return this.tableau.save()},tt.prototype.restore=function(){return this.tableau.restore()},tt.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},tt.prototype.debug=function(t){this.checkForCycles=t},tt.prototype.log=function(t){return this.tableau.log(t)};var it={CleanObjectiveAttributes:function(t){var e,i,n;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(n in t.optimize)if(t.constraints[n])if("equal"===t.constraints[n])delete t.optimize[n];else{for(i in e=Math.random(),t.variables)t.variables[i][n]&&(t.variables[i][e]=t.variables[i][n]);t.constraints[e]=t.constraints[n],delete t.constraints[n]}return t}},nt=function(t){return t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},n={">=":"min","<=":"max","=":"equal"},r="",o=null,s="",a="",l="",c=0;"string"==typeof t&&(t=t.split("\n"));for(var h=0;h<t.length;h++)if(l="__"+h,o=null,e.is_objective.test(r=t[h]))i.opType=r.match(/(max|min)/gi)[0],(o=r.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[a]=i.variables[a]||{},i.variables[a]._obj=s}));else if(e.is_int.test(r))o=r.match(e.parse_int).slice(1),i.ints=i.ints||{},o.forEach((function(t){t=t.replace(";",""),i.ints[t]=1}));else if(e.is_bin.test(r))o=r.match(e.parse_bin).slice(1),i.binaries=i.binaries||{},o.forEach((function(t){t=t.replace(";",""),i.binaries[t]=1}));else if(e.is_constraint.test(r)){var u=r.indexOf(":");(o=(-1===u?r:r.slice(u+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0],i.variables[a]=i.variables[a]||{},i.variables[a][l]=s})),c=parseFloat(r.match(e.parse_rhs)[0]),r=n[r.match(e.parse_dir)[0]],i.constraints[l]=i.constraints[l]||{},i.constraints[l][r]=c}else e.is_unrestricted.test(r)&&(o=r.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},o.forEach((function(t){t=t.replace(";",""),i.unrestricted[t]=1})));return i}(t):function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},n=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType)for(var r in e+=t.opType+":",t.variables)t.variables[r][r]=t.variables[r][r]?t.variables[r][r]:1,t.variables[r][t.optimize]&&(e+=" "+t.variables[r][t.optimize]+" "+r.replace(n,"_"));else e+="max:";for(var o in e+=";\n\n",t.constraints)for(var s in t.constraints[o])if(void 0!==i[s]){for(var a in t.variables)void 0!==t.variables[a][o]&&(e+=" "+t.variables[a][o]+" "+a.replace(n,"_"));e+=" "+i[s]+" "+t.constraints[o][s],e+=";\n"}if(t.ints)for(var l in e+="\n\n",t.ints)e+="int "+l.replace(n,"_")+";\n";if(t.unrestricted)for(var c in e+="\n\n",t.unrestricted)e+="unrestricted "+c.replace(n,"_")+";\n";return e}(t)};function rt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})})),e}var ot=rt(Object.freeze({__proto__:null,default:{}}));function st(t){return(t=(t=t.replace("\\r\\n","\r\n")).split("\r\n")).filter((function(t){return!0!==new RegExp(" 0$","gi").test(t)&&!1!==new RegExp("\\d$","gi").test(t)})).map((function(t){return t.split(/\:{0,1} +(?=\d)/)})).reduce((function(t,e,i){return t[e[0]]=e[1],t}),{})}var at={lpsolve:{reformat:nt,solve:function(t){return new Promise((function(e,i){"undefined"!=typeof window&&i("Function Not Available in Browser");var n=nt(t);t.external||i("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||i("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||i("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||i("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),ot.writeFile(t.external.tempName,n,(function(n,r){if(n)i(n);else{var o=ot.execFile;t.external.args.push(t.external.tempName),o(t.external.binPath,t.external.args,(function(t,n){t?1===t.code?e(st(n)):i({code:t.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[t.code],data:n}):e(st(n))}))}}))}))}}},lt=function(t,e){var i,n,r,o,s,a=e.optimize,l=JSON.parse(JSON.stringify(e.optimize)),c=Object.keys(e.optimize),h=0,u={},d="",f={},p=[];for(delete e.optimize,n=0;n<c.length;n++)l[c[n]]=0;for(n=0;n<c.length;n++){for(s in e.optimize=c[n],e.opType=a[c[n]],i=t.Solve(e,void 0,void 0,!0),c)if(!e.variables[c[s]])for(o in i[c[s]]=i[c[s]]?i[c[s]]:0,e.variables)e.variables[o][c[s]]&&i[o]&&(i[c[s]]+=i[o]*e.variables[o][c[s]]);for(d="base",r=0;r<c.length;r++)d+=i[c[r]]?"-"+(1e3*i[c[r]]|0)/1e3:"-0";if(!u[d]){for(u[d]=1,h++,r=0;r<c.length;r++)i[c[r]]&&(l[c[r]]+=i[c[r]]);delete i.feasible,delete i.result,p.push(i)}}for(n=0;n<c.length;n++)e.constraints[c[n]]={equal:l[c[n]]/h};for(n in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[n].cheater=1;for(n in p)for(o in p[n])f[o]=f[o]||{min:1e99,max:-1e99};for(n in f)for(o in p)p[o][n]?(p[o][n]>f[n].max&&(f[n].max=p[o][n]),p[o][n]<f[n].min&&(f[n].min=p[o][n])):(p[o][n]=0,f[n].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:p,ranges:f}},ct=q.Constraint,ht=q.Variable,ut=q.Numeral,dt=q.Term,ft=function(){this.Model=et,this.branchAndCut=G,this.Constraint=ct,this.Variable=ht,this.Numeral=ut,this.Term=dt,this.Tableau=H,this.lastSolvedModel=null,this.External=at,this.Solve=function(t,e,i,n){if(n)for(var r in it)t=it[r](t);if(!t)throw new Error("Solver requires a model to operate on");if("object"==typeof t.optimize&&Object.keys(t.optimize>1))return lt(this,t);if(t.external){var o=Object.keys(at);if(o=JSON.stringify(o),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+o);if(!at[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+o);return at[t.external.solver].solve(t)}t instanceof et==0&&(t=new et(e).loadJson(t));var s=t.solve();if(this.lastSolvedModel=t,s.solutionSet=s.generateSolutionSet(),i)return s;var a={};return a.feasible=s.feasible,a.result=s.evaluation,a.bounded=s.bounded,s._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(s.solutionSet).forEach((function(t){0!==s.solutionSet[t]&&(a[t]=s.solutionSet[t])})),a},this.ReformatLP=nt,this.MultiObjective=function(t){return lt(this,t)}};"object"==typeof window?window.solver=new ft:"object"==typeof self&&(self.solver=new ft);var pt=new ft;function mt(){}function gt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function vt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function bt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i>n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}function yt(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function _t(t,e,i){if(n=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(yield i);else{let i=-1;for(let n of t)null!=(n=e(n,++i,t))&&(n=+n)>=n&&(yield n)}}(t,i))).length){if((e=+e)<=0||n<2)return bt(t);if(e>=1)return vt(t);var n,r=(n-1)*e,o=Math.floor(r),s=vt(function t(e,i,n=0,r=e.length-1,o=gt){for(;r>n;){if(r-n>600){const s=r-n+1,a=i-n+1,l=Math.log(s),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);t(e,i,Math.max(n,Math.floor(i-a*c/s+h)),Math.min(r,Math.floor(i+(s-a)*c/s+h)),o)}const s=e[i];let a=n,l=r;for(yt(e,n,i),o(e[r],s)>0&&yt(e,n,r);a<l;){for(yt(e,a,l),++a,--l;o(e[a],s)<0;)++a;for(;o(e[l],s)>0;)--l}0===o(e[n],s)?yt(e,n,l):(++l,yt(e,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}return e}(t,o).subarray(0,o+1));return s+(bt(t.subarray(o+1))-s)*(r-o)}}function wt(t,e){return+!(t instanceof k)+ +!(e instanceof k)}function xt(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return function t(e,i,n,r,o,s,a){const[l,c]=o;function h(t){e(t);for(const e of t){const t=e.layer;if(void 0===t)throw new Error(`layering did not assign layer to node '${e.id}'`);if(t<0)throw new Error(`layering assigned a negative layer (${t}) to node '${e.id}'`)}const o=function(t){const e=[];for(const i of t.descendants()){const t=i.layer;(e[t]||(e[t]=[])).push(i),i.dataChildren=i.dataChildren.map(n=>{const r=n.child.layer;if(r<=t)throw new Error(`layering left child node "${n.child.id}" (${r}) with a greater or equal layer to parent node "${i.id}" (${t})`);let o=n.child;for(let s=r-1;s>t;s--){let t;t=a?`${i.id}->${n.child.id} (${s})`:`${i.id}\0${n.child.id}\0${s}`;const r=new k(t);r.dataChildren.push(new u(o,void 0)),(e[s]||(e[s]=[])).push(r),o=r}return new u(o,n.data)})}return e}(t);if(1===o.length){const[t]=o;for(const e of t)e.y=c/2}else{const t=r?c:c/(o.length-1);for(const[e,i]of o.entries())for(const n of i)n.y=t*e}if(o.every(t=>1===t.length))for(const[e]of o)e.x=l/2;else if(1===o.length){const[t]=o;C(t,s);const e=t,i=r?e.length-1:1;for(const n of e)n.x*=l*i}else{i(o),n(o,s);for(const i of o)for(const t of i)if(void 0===t.x)throw new Error(`coord didn't assign an x to node '${t.id}'`);const t=o,e=r?Math.max(...o.map(t=>t.length))-1:1;for(const i of t)for(const t of i)t.x*=l*e}const h=t;return function(t){for(const e of t)e instanceof k||(e.dataChildren=e.dataChildren.map(t=>{let i=t.child;const n=[{x:e.x,y:e.y}];for(;i instanceof k;)n.push({x:i.x,y:i.y}),[i]=i.ichildren();return n.push({x:i.x,y:i.y}),new u(i,t.data,n)}))}(h),h}return h.layering=function(l){return void 0===l?e:t(l,i,n,r,o,s,a)},h.decross=function(l){return void 0===l?i:t(e,l,n,r,o,s,a)},h.coord=function(l){return void 0===l?n:t(e,i,l,r,o,s,a)},h.size=function(l){return void 0!==l?t(e,i,n,!1,l,s,a):r?null:o},h.nodeSize=function(l){return void 0!==l?t(e,i,n,!0,l,s,a):r?o:null},h.separation=function(l){return void 0===l?s:t(e,i,n,r,o,l,a)},h.debug=function(l){return void 0===l?a:t(e,i,n,r,o,s,l)},h}(function(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return function t(e,i){const n=i?"":"\0",r=i?"rank: ":"\0",o=i?" -> ":"\0";function s(t){return`${n}${t.id}`}function a(t){return`${t.source.id}${o}${t.target.id}`}function l(t,e){return`${r}${t.id}${o}${e.id}`}function c(t){const i=Object.create(null),n=Object.create(null),r=Object.create(null),o=[];for(const a of t){const t=s(a);n[t]=1,i[t]={opt:a.children.length};const r=e(a);void 0!==r&&o.push([r,a])}for(const e of t.ilinks()){const t=i[s(e.source)],n=i[s(e.target)],o=a(e);r[o]={min:1},t[o]=-1,t.opt++,n[o]=1,n.opt--}let[c,...h]=o.sort(([t],[e])=>t-e);for(const e of h){const[t,n]=c,[o,a]=e,h=i[s(n)],u=i[s(a)],d=l(n,a);if(t<o)r[d]={min:1},h[d]=-1,u[d]=1;else{const t=l(a,n);r[d]={min:0},r[t]={min:0},h[d]=-1,h[t]=1,u[d]=1,u[t]=-1}c=e}const u=pt.Solve({optimize:"opt",opType:"max",constraints:r,variables:i,ints:n}),{feasible:d}=u,f=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}(u,["feasible"]);if(!d)throw o.length?new Error("could not find a feasbile simplex layout, check that rank accessors are not ill-defined"):new Error("could not find feasbile simplex layout, this should not happen");for(const e of t)e.layer=f[s(e)]||0}return c.rank=function(n){return void 0===n?e:t(n,i)},c.debug=function(n){return void 0===n?i:t(e,n)},c}(mt,!1)}(),function(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return function t(e){function i(t){t.slice(0,t.length-1).forEach((i,n)=>e(i,t[n+1]))}return i.order=function(i){return void 0===i?e:t(i)},i}(function(...t){if(t.length)throw new Error(`got arguments to median(${t}), but constructor takes no aruguments.`);return function(t,e){const i=new h;for(const[o,s]of t.entries())for(const t of s.ichildren())i.setIfAbsent(t.id,[]).push(o);const n=new h;let r=-1;for(const o of e){const e=_t(i.getDefault(o.id,[]),.5,void 0);void 0===e?(n.set(o.id,r),r=+!((r+1)/(t.length+1))*(t.length+1)-1):n.set(o.id,e)}e.sort((t,e)=>n.getThrow(t.id)-n.getThrow(e.id))}}())}(),function(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return function t(e,i,n,r,o){function s(t,s,a){const l=function(t){const e=new h;let i=0;for(const n of t)for(const t of n)e.set(t.id,i++);return e}(t),[c,u,d,f]=function(t,e,i){const n=1+Math.max(...e.values()),r=[],o=[];for(const a of t){let[t,...s]=a;for(const a of s){const s=e.getThrow(t.id),l=e.getThrow(a.id),c=new Array(n).fill(0);c[s]=1,c[l]=-1,r.push(c),o.push(-i(t,a)),t=a}}const s=new Array(n).fill(0);return[new Array(n).fill(null).map(()=>new Array(n).fill(0)),s,r,o]}(t,l,s);for(const o of t)for(const t of o){const o=l.getThrow(t.id),s=t instanceof k?i:e;for(const a of t.ichildren()){const t=l.getThrow(a.id),h=a instanceof k?r:n;S(c,o,t,s+(a instanceof k?i:e));for(const e of a.ichildren())I(c,o,t,l.getThrow(e.id),h)}}for(let[e,...i]of t)for(const t of i)a.getThrow(e.id)!==a.getThrow(t.id)&&S(c,l.getThrow(e.id),l.getThrow(t.id),o),e=t;!function(t,e,i){const n=Math.min(...i),r=Math.max(...i)-n;if(r>0)for(const o of t)for(const t of o){const o=e.getThrow(t.id);t.x=(i[o]-n)/r}else for(const o of t)for(const t of o)t.x=.5}(t,l,function(t,e,i,n,r=0){e.pop(),t.pop(),t.forEach(t=>t.pop()),i.forEach(t=>t.pop());const o=function(t,e,i,n,r){const o=[[0]],s=[0],a=[[0]],l=[0];for(const u of t){const t=[0];t.push(...u),o.push(t)}s.push(...e),a.push(...e.map(()=>[0]));for(const u of i)for(const[t,e]of u.entries())a[t+1].push(-e);l.push(...n.map(t=>-t));const{solution:c,message:h}=x(o,s,a,l,r);if(h.length)throw new Error("quadprog failed with: "+h);return c.shift(),c}(t,e,i,n,r);return o.push(0),o}(c,u,d,f))}function a(t,o){if(0===e&&0===n)throw new Error("node vertical weight or node curve weight needs to be positive");if(0===i&&0===r)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");const a=function(t){const e=new h;for(const r of t.slice().reverse())for(const t of r){for(const i of t.ichildren())e.delete(i.id);e.set(t.id,t)}const i=new p([...e.values()]).split(),n=new h;for(const[r,o]of i.entries())for(const t of o)n.set(t.id,r);return n}(t);for(const e of function(t,e){const i=[];let n=[],r=new Set;for(const o of t){const t=new Set(o.map(t=>e.getThrow(t.id)));c(r,t)||i.push(n=[]),n.push(o),r=t}return i}(t,a))if(e.every(t=>1===t.length))for(const[t]of e)t.x=.5;else if(1===e.length){const[t]=e;C(t,o)}else s(e,o,a)}return a.vertical=function(s){if(void 0===s)return[e,i];const[a,l]=s;if(a<0||l<0)throw new Error(`weights must be non-negative, but were ${a} and ${l}`);return t(a,l,n,r,o)},a.curve=function(s){if(void 0===s)return[n,r];const[a,l]=s;if(a<0||l<0)throw new Error(`weights must be non-negative, but were ${a} and ${l}`);return t(e,i,a,l,o)},a.component=function(s){if(void 0===s)return o;if(s<=0)throw new Error("weight must be positive, but was "+s);return t(e,i,n,r,s)},a}(1,0,0,1,1)}(),!1,[1,1],wt,!1)}var Ct=function(t,e){return t<e};function St(t){if(!(this instanceof St))return new St(t);this.array=[],this.size=0,this.compare=t||Ct}St.prototype.clone=function(){var t=new St(this.compare);t.size=this.size;for(var e=0;e<this.size;e++)t.array.push(this.array[e]);return t},St.prototype.add=function(t){var e,i,n=this.size;for(this.array[this.size]=t,this.size+=1;n>0&&this.compare(t,i=this.array[e=n-1>>1]);)this.array[n]=i,n=e;this.array[n]=t},St.prototype.heapify=function(t){var e;for(this.array=t,this.size=t.length,e=this.size>>1;e>=0;e--)this._percolateDown(e)},St.prototype._percolateUp=function(t,e){for(var i,n,r=this.array[t];t>0&&(n=this.array[i=t-1>>1],e||this.compare(r,n));)this.array[t]=n,t=i;this.array[t]=r},St.prototype._percolateDown=function(t){for(var e,i,n,r=this.size,o=this.size>>>1,s=this.array[t];t<o&&(n=this.array[e=1+(t<<1)],(i=e+1)<r&&this.compare(this.array[i],n)&&(e=i,n=this.array[i]),this.compare(n,s));)this.array[t]=n,t=e;this.array[t]=s},St.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},St.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1},St.prototype._batchRemove=function(t,e){var i=new Array(e||this.size),n=0;if("function"==typeof t&&this.size)for(var r=0;r<this.size&&n<i.length;)t(this.array[r])?(i[n]=this._removeAt(r),n++,r>>=1):r++;return i.length=n,i},St.prototype.removeOne=function(t){var e=this._batchRemove(t,1);return e.length>0?e[0]:void 0},St.prototype.removeMany=function(t,e){return this._batchRemove(t,e)},St.prototype.peek=function(){if(0!=this.size)return this.array[0]},St.prototype.poll=function(){if(0!=this.size){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}},St.prototype.replaceTop=function(t){if(0!=this.size){var e=this.array[0];return this.array[0]=t,this._percolateDown(0),e}},St.prototype.trim=function(){this.array=this.array.slice(0,this.size)},St.prototype.isEmpty=function(){return 0===this.size},St.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var e=0,i=this.clone();!i.isEmpty();)t(i.poll(),e++)},St.prototype.kSmallest=function(t){if(0==this.size)return[];var e=this.compare,i=this.array,n=new St((function(t,n){return e(i[t],i[n])}));t=Math.min(this.size,t);var r=new Array(t),o=0;for(n.add(0);o<t;){var s=n.poll();r[o++]=this.array[s];var a=1+(s<<1),l=a+1;a<this.size&&n.add(a),l<this.size&&n.add(l)}return r};var It=i("ZTXN"),kt=i("mWib"),Ot=i("kuMc");function Et(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}var Tt={value:()=>{}};function Mt(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new jt(n)}function jt(t){this._=t}function Nt(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}function Pt(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function Bt(t,e,i){for(var n=0,r=t.length;n<r;++n)if(t[n].name===e){t[n]=Tt,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}jt.prototype=Mt.prototype={constructor:jt,on:function(t,e){var i,n=this._,r=Nt(t+"",n),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=Bt(n[i],t.name,e);else if(null==e)for(i in n)n[i]=Bt(n[i],t.name,null);return this}for(;++o<s;)if((i=(t=r[o]).type)&&(i=Pt(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new jt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,r=new Array(i),o=0;o<i;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,i=(n=this._[t]).length;o<i;++o)n[o].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],r=0,o=n.length;r<o;++r)n[r].value.apply(e,i)}};var Dt=Mt;function At(){}var Vt=function(t){return null==t?At:function(){return this.querySelector(t)}},Rt=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)};function zt(){return[]}var Lt=function(t){return null==t?zt:function(){return this.querySelectorAll(t)}},Ft=function(t){return function(){return this.matches(t)}};function qt(t){return function(e){return e.matches(t)}}var Wt=Array.prototype.find;function $t(){return this.firstElementChild}var Ht=Array.prototype.filter;function Yt(){return this.children}var Xt=function(t){return new Array(t.length)};function Ut(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ut.prototype={constructor:Ut,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Gt=function(t){return function(){return t}};function Kt(t,e,i,n,r,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],n[a]=s):i[a]=new Ut(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function Qt(t,e,i,n,r,o,s){var a,l,c,h=new Map,u=e.length,d=o.length,f=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(f[a]=c=s.call(l,l.__data__,a,e)+"",h.has(c)?r[a]=l:h.set(c,l));for(a=0;a<d;++a)c=s.call(t,o[a],a,o)+"",(l=h.get(c))?(n[a]=l,l.__data__=o[a],h.delete(c)):i[a]=new Ut(t,o[a]);for(a=0;a<u;++a)(l=e[a])&&h.get(f[a])===l&&(r[a]=l)}function Zt(t){return t.__data__}function Jt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var te="http://www.w3.org/1999/xhtml",ee={svg:"http://www.w3.org/2000/svg",xhtml:te,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ie=function(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),ee.hasOwnProperty(e)?{space:ee[e],local:t}:t};function ne(t){return function(){this.removeAttribute(t)}}function re(t){return function(){this.removeAttributeNS(t.space,t.local)}}function oe(t,e){return function(){this.setAttribute(t,e)}}function se(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ae(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function le(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}var ce=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function he(t){return function(){this.style.removeProperty(t)}}function ue(t,e,i){return function(){this.style.setProperty(t,e,i)}}function de(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function fe(t,e){return t.style.getPropertyValue(e)||ce(t).getComputedStyle(t,null).getPropertyValue(e)}function pe(t){return function(){delete this[t]}}function me(t,e){return function(){this[t]=e}}function ge(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function ve(t){return t.trim().split(/^|\s+/)}function be(t){return t.classList||new ye(t)}function ye(t){this._node=t,this._names=ve(t.getAttribute("class")||"")}function _e(t,e){for(var i=be(t),n=-1,r=e.length;++n<r;)i.add(e[n])}function we(t,e){for(var i=be(t),n=-1,r=e.length;++n<r;)i.remove(e[n])}function xe(t){return function(){_e(this,t)}}function Ce(t){return function(){we(this,t)}}function Se(t,e){return function(){(e.apply(this,arguments)?_e:we)(this,t)}}function Ie(){this.textContent=""}function ke(t){return function(){this.textContent=t}}function Oe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ee(){this.innerHTML=""}function Te(t){return function(){this.innerHTML=t}}function Me(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function je(){this.nextSibling&&this.parentNode.appendChild(this)}function Ne(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Pe(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===te&&e.documentElement.namespaceURI===te?e.createElement(t):e.createElementNS(i,t)}}function Be(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}ye.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var De=function(t){var e=ie(t);return(e.local?Be:Pe)(e)};function Ae(){return null}function Ve(){var t=this.parentNode;t&&t.removeChild(this)}function Re(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ze(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Le(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}function Fe(t){return function(){var e=this.__on;if(e){for(var i,n=0,r=-1,o=e.length;n<o;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function qe(t,e,i){return function(){var n,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((n=r[s]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=o,n.options=i),void(n.value=e);this.addEventListener(t.type,o,i),n={type:t.type,name:t.name,value:e,listener:o,options:i},r?r.push(n):this.__on=[n]}}function We(t,e,i){var n=ce(t),r=n.CustomEvent;"function"==typeof r?r=new r(e,i):(r=n.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function $e(t,e){return function(){return We(this,t,e)}}function He(t,e){return function(){return We(this,t,e.apply(this,arguments))}}var Ye=[null];function Xe(t,e){this._groups=t,this._parents=e}function Ue(){return new Xe([[document.documentElement]],Ye)}Xe.prototype=Ue.prototype={constructor:Xe,select:function(t){"function"!=typeof t&&(t=Vt(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s,a=e[r],l=a.length,c=n[r]=new Array(l),h=0;h<l;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),c[h]=s);return new Xe(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:Rt(e)}}(t):Lt(t);for(var e=this._groups,i=e.length,n=[],r=[],o=0;o<i;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(n.push(t.call(s,s.__data__,c,a)),r.push(s));return new Xe(n,r)},selectChild:function(t){return this.select(null==t?$t:function(t){return function(){return Wt.call(this.children,t)}}("function"==typeof t?t:qt(t)))},selectChildren:function(t){return this.selectAll(null==t?Yt:function(t){return function(){return Ht.call(this.children,t)}}("function"==typeof t?t:qt(t)))},filter:function(t){"function"!=typeof t&&(t=Ft(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s=e[r],a=s.length,l=n[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Xe(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Zt);var i=e?Qt:Kt,n=this._parents,r=this._groups;"function"!=typeof t&&(t=Gt(t));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var h=n[c],u=r[c],d=u.length,f=Rt(t.call(h,h&&h.__data__,c,n)),p=f.length,m=a[c]=new Array(p),g=s[c]=new Array(p),v=l[c]=new Array(d);i(h,u,m,g,v,f,e);for(var b,y,_=0,w=0;_<p;++_)if(b=m[_]){for(_>=w&&(w=_+1);!(y=g[w])&&++w<p;);b._next=y||null}}return(s=new Xe(s,n))._enter=a,s._exit=l,s},enter:function(){return new Xe(this._enter||this._groups.map(Xt),this._parents)},exit:function(){return new Xe(this._exit||this._groups.map(Xt),this._parents)},join:function(t,e,i){var n=this.enter(),r=this,o=this.exit();return n="function"==typeof t?t(n):n.append(t+""),null!=e&&(r=e(r)),null==i?o.remove():i(o),n&&r?n.merge(r).order():r},merge:function(t){if(!(t instanceof Xe))throw new Error("invalid merge");for(var e=this._groups,i=t._groups,n=e.length,r=Math.min(n,i.length),o=new Array(n),s=0;s<r;++s)for(var a,l=e[s],c=i[s],h=l.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=l[d]||c[d])&&(u[d]=a);for(;s<n;++s)o[s]=e[s];return new Xe(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,r=t[e],o=r.length-1,s=r[o];--o>=0;)(n=r[o])&&(s&&4^n.compareDocumentPosition(s)&&s.parentNode.insertBefore(n,s),s=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=Jt);for(var i=this._groups,n=i.length,r=new Array(n),o=0;o<n;++o){for(var s,a=i[o],l=a.length,c=r[o]=new Array(l),h=0;h<l;++h)(s=a[h])&&(c[h]=s);c.sort(e)}return new Xe(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],r=0,o=n.length;r<o;++r){var s=n[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var r,o=e[i],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var i=ie(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?re:ne:"function"==typeof e?i.local?le:ae:i.local?se:oe)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?he:"function"==typeof e?de:ue)(t,e,null==i?"":i)):fe(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?pe:"function"==typeof e?ge:me)(t,e)):this.node()[t]},classed:function(t,e){var i=ve(t+"");if(arguments.length<2){for(var n=be(this.node()),r=-1,o=i.length;++r<o;)if(!n.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?Se:e?xe:Ce)(i,e))},text:function(t){return arguments.length?this.each(null==t?Ie:("function"==typeof t?Oe:ke)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ee:("function"==typeof t?Me:Te)(t)):this.node().innerHTML},raise:function(){return this.each(je)},lower:function(){return this.each(Ne)},append:function(t){var e="function"==typeof t?t:De(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:De(t),n=null==e?Ae:"function"==typeof e?e:Vt(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(Ve)},clone:function(t){return this.select(t?ze:Re)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,r,o=Le(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?qe:Fe,n=0;n<s;++n)this.each(a(o[n],e,i));return this}var a=this.node().__on;if(a)for(var l,c=0,h=a.length;c<h;++c)for(n=0,l=a[c];n<s;++n)if((r=o[n]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?He:$e)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,r=t[e],o=0,s=r.length;o<s;++o)(n=r[o])&&(yield n)}};var Ge=Ue,Ke=function(t){return"string"==typeof t?new Xe([[document.querySelector(t)]],[document.documentElement]):new Xe([[t]],Ye)};function Qe(t){t.stopImmediatePropagation()}var Ze=function(t){t.preventDefault(),t.stopImmediatePropagation()},Je=function(t){var e=t.document.documentElement,i=Ke(t).on("dragstart.drag",Ze,!0);"onselectstart"in e?i.on("selectstart.drag",Ze,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function ti(t,e){var i=t.document.documentElement,n=Ke(t).on("dragstart.drag",null);e&&(n.on("click.drag",Ze,!0),setTimeout((function(){n.on("click.drag",null)}),0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}var ei=function(t,e,i){t.prototype=e.prototype=i,i.constructor=t};function ii(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function ni(){}var ri=.7,oi=1/ri,si="\\s*([+-]?\\d+)\\s*",ai="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",li="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ci=/^#([0-9a-f]{3,8})$/,hi=new RegExp("^rgb\\("+[si,si,si]+"\\)$"),ui=new RegExp("^rgb\\("+[li,li,li]+"\\)$"),di=new RegExp("^rgba\\("+[si,si,si,ai]+"\\)$"),fi=new RegExp("^rgba\\("+[li,li,li,ai]+"\\)$"),pi=new RegExp("^hsl\\("+[ai,li,li]+"\\)$"),mi=new RegExp("^hsla\\("+[ai,li,li,ai]+"\\)$"),gi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function vi(){return this.rgb().formatHex()}function bi(){return this.rgb().formatRgb()}function yi(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=ci.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?_i(e):3===i?new Si(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?wi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?wi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=hi.exec(t))?new Si(e[1],e[2],e[3],1):(e=ui.exec(t))?new Si(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=di.exec(t))?wi(e[1],e[2],e[3],e[4]):(e=fi.exec(t))?wi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=pi.exec(t))?Ei(e[1],e[2]/100,e[3]/100,1):(e=mi.exec(t))?Ei(e[1],e[2]/100,e[3]/100,e[4]):gi.hasOwnProperty(t)?_i(gi[t]):"transparent"===t?new Si(NaN,NaN,NaN,0):null}function _i(t){return new Si(t>>16&255,t>>8&255,255&t,1)}function wi(t,e,i,n){return n<=0&&(t=e=i=NaN),new Si(t,e,i,n)}function xi(t){return t instanceof ni||(t=yi(t)),t?new Si((t=t.rgb()).r,t.g,t.b,t.opacity):new Si}function Ci(t,e,i,n){return 1===arguments.length?xi(t):new Si(t,e,i,null==n?1:n)}function Si(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function Ii(){return"#"+Oi(this.r)+Oi(this.g)+Oi(this.b)}function ki(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Oi(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ei(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new Mi(t,e,i,n)}function Ti(t){if(t instanceof Mi)return new Mi(t.h,t.s,t.l,t.opacity);if(t instanceof ni||(t=yi(t)),!t)return new Mi;if(t instanceof Mi)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),o=Math.max(e,i,n),s=NaN,a=o-r,l=(o+r)/2;return a?(s=e===o?(i-n)/a+6*(i<n):i===o?(n-e)/a+2:(e-i)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new Mi(s,a,l,t.opacity)}function Mi(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function ji(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function Ni(t,e,i,n,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*i+(1+3*t+3*o-3*s)*n+s*r)/6}ei(ni,yi,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:vi,formatHex:vi,formatHsl:function(){return Ti(this).formatHsl()},formatRgb:bi,toString:bi}),ei(Si,Ci,ii(ni,{brighter:function(t){return t=null==t?oi:Math.pow(oi,t),new Si(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ri:Math.pow(ri,t),new Si(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ii,formatHex:Ii,formatRgb:ki,toString:ki})),ei(Mi,(function(t,e,i,n){return 1===arguments.length?Ti(t):new Mi(t,e,i,null==n?1:n)}),ii(ni,{brighter:function(t){return t=null==t?oi:Math.pow(oi,t),new Mi(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ri:Math.pow(ri,t),new Mi(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new Si(ji(t>=240?t-240:t+120,r,n),ji(t,r,n),ji(t<120?t+240:t-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Pi=t=>()=>t;function Bi(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):Pi(isNaN(t)?e:t)}var Di=function t(e){var i=function(t){return 1==(t=+t)?Bi:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):Pi(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=Ci(t)).r,(e=Ci(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),s=Bi(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return n.gamma=t,n}(1);function Ai(t){return function(e){var i,n,r=e.length,o=new Array(r),s=new Array(r),a=new Array(r);for(i=0;i<r;++i)n=Ci(e[i]),o[i]=n.r||0,s[i]=n.g||0,a[i]=n.b||0;return o=t(o),s=t(s),a=t(a),n.opacity=1,function(t){return n.r=o(t),n.g=s(t),n.b=a(t),n+""}}}Ai((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[n],o=t[n+1];return Ni((i-n/e)*e,n>0?t[n-1]:2*r-o,r,o,n<e-1?t[n+2]:2*o-r)}})),Ai((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e);return Ni((i-n/e)*e,t[(n+e-1)%e],t[n%e],t[(n+1)%e],t[(n+2)%e])}}));var Vi,Ri,zi=function(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}},Li=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fi=new RegExp(Li.source,"g"),qi=function(t,e){var i,n,r,o=Li.lastIndex=Fi.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(i=Li.exec(t))&&(n=Fi.exec(e));)(r=n.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(i=i[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,l.push({i:s,x:zi(i,n)})),o=Fi.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})},Wi=function(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]},$i=0,Hi=0,Yi=0,Xi=0,Ui=0,Gi=0,Ki="object"==typeof performance&&performance.now?performance:Date,Qi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Zi(){return Ui||(Qi(Ji),Ui=Ki.now()+Gi)}function Ji(){Ui=0}function tn(){this._call=this._time=this._next=null}function en(t,e,i){var n=new tn;return n.restart(t,e,i),n}function nn(){Ui=(Xi=Ki.now())+Gi,$i=Hi=0;try{!function(){Zi(),++$i;for(var t,e=Vi;e;)(t=Ui-e._time)>=0&&e._call.call(null,t),e=e._next;--$i}()}finally{$i=0,function(){for(var t,e,i=Vi,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Vi=e);Ri=t,on(n)}(),Ui=0}}function rn(){var t=Ki.now(),e=t-Xi;e>1e3&&(Gi-=e,Xi=t)}function on(t){$i||(Hi&&(Hi=clearTimeout(Hi)),t-Ui>24?(t<1/0&&(Hi=setTimeout(nn,t-Ki.now()-Gi)),Yi&&(Yi=clearInterval(Yi))):(Yi||(Xi=Ki.now(),Yi=setInterval(rn,1e3)),$i=1,Qi(nn)))}tn.prototype=en.prototype={constructor:tn,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?Zi():+i)+(null==e?0:+e),this._next||Ri===this||(Ri?Ri._next=this:Vi=this,Ri=this),this._call=t,this._time=i,on()},stop:function(){this._call&&(this._call=null,this._time=1/0,on())}};var sn=function(t,e,i){var n=new tn;return n.restart(i=>{n.stop(),t(i+e)},e=null==e?0:+e,i),n},an=Dt("start","end","cancel","interrupt"),ln=[],cn=function(t,e,i,n,r,o){var s=t.__transition;if(s){if(i in s)return}else t.__transition={};!function(t,e,i){var n,r=t.__transition;function o(l){var c,h,u,d;if(1!==i.state)return a();for(c in r)if((d=r[c]).name===i.name){if(3===d.state)return sn(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(sn((function(){3===i.state&&(i.state=4,i.timer.restart(s,i.delay,i.time),s(l))})),i.state=2,i.on.call("start",t,t.__data__,i.index,i.group),2===i.state){for(i.state=3,n=new Array(u=i.tween.length),c=0,h=-1;c<u;++c)(d=i.tween[c].value.call(t,t.__data__,i.index,i.group))&&(n[++h]=d);n.length=h+1}}function s(e){for(var r=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=5,1),o=-1,s=n.length;++o<s;)n[o].call(t,r);5===i.state&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=6,i.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=i,i.timer=en((function(t){i.state=1,i.timer.restart(o,i.delay,i.time),i.delay<=t&&o(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:r,on:an,tween:ln,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function hn(t,e){var i=dn(t,e);if(i.state>0)throw new Error("too late; already scheduled");return i}function un(t,e){var i=dn(t,e);if(i.state>3)throw new Error("too late; already running");return i}function dn(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}var fn,pn=function(t,e){var i,n,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(i=o[r]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete o[r]):s=!1;s&&delete t.__transition}},mn=180/Math.PI,gn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},vn=function(t,e,i,n,r,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*i+e*n)&&(i-=t*l,n-=e*l),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,l/=a),t*n<e*i&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*mn,skewX:Math.atan(l)*mn,scaleX:s,scaleY:a}};function bn(t,e,i,n){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,n,r,o,s,a){if(t!==r||n!==o){var l=s.push("translate(",null,e,null,i);a.push({i:l-4,x:zi(t,r)},{i:l-2,x:zi(n,o)})}else(r||o)&&s.push("translate("+r+e+o+i)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,i,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:i.push(r(i)+"rotate(",null,n)-2,x:zi(t,e)})):e&&i.push(r(i)+"rotate("+e+n)}(o.rotate,s.rotate,a,l),function(t,e,i,o){t!==e?o.push({i:i.push(r(i)+"skewX(",null,n)-2,x:zi(t,e)}):e&&i.push(r(i)+"skewX("+e+n)}(o.skewX,s.skewX,a,l),function(t,e,i,n,o,s){if(t!==i||e!==n){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:zi(t,i)},{i:a-2,x:zi(e,n)})}else 1===i&&1===n||o.push(r(o)+"scale("+i+","+n+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,i=-1,n=l.length;++i<n;)a[(e=l[i]).i]=e.x(t);return a.join("")}}}var yn=bn((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gn:vn(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),_n=bn((function(t){return null==t?gn:(fn||(fn=document.createElementNS("http://www.w3.org/2000/svg","g")),fn.setAttribute("transform",t),(t=fn.transform.baseVal.consolidate())?vn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):gn)}),", ",")",")");function wn(t,e){var i,n;return function(){var r=un(this,t),o=r.tween;if(o!==i)for(var s=0,a=(n=i=o).length;s<a;++s)if(n[s].name===e){(n=n.slice()).splice(s,1);break}r.tween=n}}function xn(t,e,i){var n,r;if("function"!=typeof i)throw new Error;return function(){var o=un(this,t),s=o.tween;if(s!==n){r=(n=s).slice();for(var a={name:e,value:i},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function Cn(t,e,i){var n=t._id;return t.each((function(){var t=un(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return dn(t,n).value[e]}}var Sn=function(t,e){var i;return("number"==typeof e?zi:e instanceof yi?Di:(i=yi(e))?(e=i,Di):qi)(t,e)};function In(t){return function(){this.removeAttribute(t)}}function kn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function On(t,e,i){var n,r,o=i+"";return function(){var s=this.getAttribute(t);return s===o?null:s===n?r:r=e(n=s,i)}}function En(t,e,i){var n,r,o=i+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===n?r:r=e(n=s,i)}}function Tn(t,e,i){var n,r,o;return function(){var s,a,l=i(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===n&&a===r?o:(r=a,o=e(n=s,l));this.removeAttribute(t)}}function Mn(t,e,i){var n,r,o;return function(){var s,a,l=i(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===n&&a===r?o:(r=a,o=e(n=s,l));this.removeAttributeNS(t.space,t.local)}}function jn(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function Nn(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function Pn(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&Nn(t,r)),i}return r._value=e,r}function Bn(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&jn(t,r)),i}return r._value=e,r}function Dn(t,e){return function(){hn(this,t).delay=+e.apply(this,arguments)}}function An(t,e){return e=+e,function(){hn(this,t).delay=e}}function Vn(t,e){return function(){un(this,t).duration=+e.apply(this,arguments)}}function Rn(t,e){return e=+e,function(){un(this,t).duration=e}}function zn(t,e){if("function"!=typeof e)throw new Error;return function(){un(this,t).ease=e}}function Ln(t,e,i){var n,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?hn:un;return function(){var s=o(this,t),a=s.on;a!==n&&(r=(n=a).copy()).on(e,i),s.on=r}}var Fn=Ge.prototype.constructor;function qn(t){return function(){this.style.removeProperty(t)}}function Wn(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}function $n(t,e,i){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Wn(t,o,i)),n}return o._value=e,o}function Hn(t){return function(e){this.textContent=t.call(this,e)}}function Yn(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&Hn(n)),e}return n._value=t,n}var Xn=0;function Un(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function Gn(){return++Xn}var Kn=Ge.prototype;Un.prototype=(function(t){return Ge().transition(t)}).prototype={constructor:Un,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Vt(t));for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=n[s],h=c.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),u[d]=l,cn(u[d],e,i,d,u,dn(a,i)));return new Un(o,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Lt(t));for(var n=this._groups,r=n.length,o=[],s=[],a=0;a<r;++a)for(var l,c=n[a],h=c.length,u=0;u<h;++u)if(l=c[u]){for(var d,f=t.call(l,l.__data__,u,c),p=dn(l,i),m=0,g=f.length;m<g;++m)(d=f[m])&&cn(d,e,i,m,f,p);o.push(f),s.push(l)}return new Un(o,s,e,i)},filter:function(t){"function"!=typeof t&&(t=Ft(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s=e[r],a=s.length,l=n[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Un(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,r=Math.min(n,i.length),o=new Array(n),s=0;s<r;++s)for(var a,l=e[s],c=i[s],h=l.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=l[d]||c[d])&&(u[d]=a);for(;s<n;++s)o[s]=e[s];return new Un(o,this._parents,this._name,this._id)},selection:function(){return new Fn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=Gn(),n=this._groups,r=n.length,o=0;o<r;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var h=dn(s,e);cn(s,t,i,c,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Un(n,this._parents,t,i)},call:Kn.call,nodes:Kn.nodes,node:Kn.node,size:Kn.size,empty:Kn.empty,each:Kn.each,on:function(t,e){var i=this._id;return arguments.length<2?dn(this.node(),i).on.on(t):this.each(Ln(i,t,e))},attr:function(t,e){var i=ie(t),n="transform"===i?_n:Sn;return this.attrTween(t,"function"==typeof e?(i.local?Mn:Tn)(i,n,Cn(this,"attr."+t,e)):null==e?(i.local?kn:In)(i):(i.local?En:On)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=ie(t);return this.tween(i,(n.local?Pn:Bn)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?yn:Sn;return null==e?this.styleTween(t,function(t,e){var i,n,r;return function(){var o=fe(this,t),s=(this.style.removeProperty(t),fe(this,t));return o===s?null:o===i&&s===n?r:r=e(i=o,n=s)}}(t,n)).on("end.style."+t,qn(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,r,o;return function(){var s=fe(this,t),a=i(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=fe(this,t)),s===l?null:s===n&&l===r?o:(r=l,o=e(n=s,a))}}(t,n,Cn(this,"style."+t,e))).each(function(t,e){var i,n,r,o,s="style."+e,a="end."+s;return function(){var l=un(this,t),c=l.on,h=null==l.value[s]?o||(o=qn(e)):void 0;c===i&&r===h||(n=(i=c).copy()).on(a,r=h),l.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,r,o=i+"";return function(){var s=fe(this,t);return s===o?null:s===n?r:r=e(n=s,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,$n(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Cn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Yn(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,r=dn(this.node(),i).tween,o=0,s=r.length;o<s;++o)if((n=r[o]).name===t)return n.value;return null}return this.each((null==e?wn:xn)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Dn:An)(e,t)):dn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Vn:Rn)(e,t)):dn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(zn(e,t)):dn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;un(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,r=i.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--r&&o()}};i.each((function(){var i=un(this,n),r=i.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),i.on=e})),0===r&&o()}))},[Symbol.iterator]:Kn[Symbol.iterator]};var Qn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Zn(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function Jn(t){return{type:t}}Ge.prototype.interrupt=function(t){return this.each((function(){pn(this,t)}))},Ge.prototype.transition=function(t){var e,i;t instanceof Un?(e=t._id,t=t._name):(e=Gn(),(i=Qn).time=Zi(),t=null==t?null:t+"");for(var n=this._groups,r=n.length,o=0;o<r;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)(s=a[c])&&cn(s,t,e,c,a,i||Zn(s,e));return new Un(n,this._parents,t,e)},Math,["w","e"].map(Jn),["n","s"].map(Jn),["n","w","e","s","nw","ne","sw","se"].map(Jn);var tr=t=>()=>t;function er(t,{sourceEvent:e,subject:i,target:n,identifier:r,active:o,x:s,y:a,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function ir(t){return!t.ctrlKey&&!t.button}function nr(){return this.parentNode}function rr(t,e){return null==e?{x:t.x,y:t.y}:e}function or(){return navigator.maxTouchPoints||"ontouchstart"in this}er.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const sr=Math.PI,ar=2*sr,lr=1e-6,cr=ar-lr;function hr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ur(){return new hr}hr.prototype=ur.prototype={constructor:hr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,i,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+i)+","+(this._y1=+n)},bezierCurveTo:function(t,e,i,n,r,o){this._+="C"+ +t+","+ +e+","+ +i+","+ +n+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,i,n,r){var o=this._x1,s=this._y1,a=(i=+i)-(t=+t),l=(n=+n)-(e=+e),c=o-t,h=s-e,u=c*c+h*h;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>lr)if(Math.abs(h*a-l*c)>lr&&r){var d=i-o,f=n-s,p=a*a+l*l,m=d*d+f*f,g=Math.sqrt(p),v=Math.sqrt(u),b=r*Math.tan((sr-Math.acos((p+u-m)/(2*g*v)))/2),y=b/v,_=b/g;Math.abs(y-1)>lr&&(this._+="L"+(t+y*c)+","+(e+y*h)),this._+="A"+r+","+r+",0,0,"+ +(h*d>c*f)+","+(this._x1=t+_*a)+","+(this._y1=e+_*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,i,n,r,o){t=+t,e=+e,o=!!o;var s=(i=+i)*Math.cos(n),a=i*Math.sin(n),l=t+s,c=e+a,h=1^o,u=o?n-r:r-n;if(i<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>lr||Math.abs(this._y1-c)>lr)&&(this._+="L"+l+","+c),i&&(u<0&&(u=u%ar+ar),u>cr?this._+="A"+i+","+i+",0,1,"+h+","+(t-s)+","+(e-a)+"A"+i+","+i+",0,1,"+h+","+(this._x1=l)+","+(this._y1=c):u>lr&&(this._+="A"+i+","+i+",0,"+ +(u>=sr)+","+h+","+(this._x1=t+i*Math.cos(r))+","+(this._y1=e+i*Math.sin(r))))},rect:function(t,e,i,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +i+"v"+ +n+"h"+-i+"Z"},toString:function(){return this._}};var dr=ur,fr=function(t){return function(){return t}};function pr(t){this._context=t}pr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var mr=function(t){return new pr(t)};function gr(t){return t[0]}function vr(t){return t[1]}function br(t){return((t=Math.exp(t))+1/t)/2}var yr=function t(e,i,n){function r(t,r){var o,s,a=t[0],l=t[1],c=t[2],h=r[2],u=r[0]-a,d=r[1]-l,f=u*u+d*d;if(f<1e-12)s=Math.log(h/c)/e,o=function(t){return[a+t*u,l+t*d,c*Math.exp(e*t*s)]};else{var p=Math.sqrt(f),m=(h*h-c*c+n*f)/(2*c*i*p),g=(h*h-c*c-n*f)/(2*h*i*p),v=Math.log(Math.sqrt(m*m+1)-m),b=Math.log(Math.sqrt(g*g+1)-g);s=(b-v)/e,o=function(t){var n,r=t*s,o=br(v),h=c/(i*p)*(o*(n=e*r+v,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[a+h*u,l+h*d,c*o/br(e*r+v)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return r.rho=function(e){var i=Math.max(.001,+e),n=i*i;return t(i,n,n*n)},r}(Math.SQRT2,2,4),_r=t=>()=>t;function wr(t,{sourceEvent:e,target:i,transform:n,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:r}})}function xr(t,e,i){this.k=t,this.x=e,this.y=i}xr.prototype={constructor:xr,scale:function(t){return 1===t?this:new xr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new xr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Cr=new xr(1,0,0);function Sr(t){t.stopImmediatePropagation()}var Ir=function(t){t.preventDefault(),t.stopImmediatePropagation()};function kr(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Or(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Er(){return this.__zoom||Cr}function Tr(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Mr(){return navigator.maxTouchPoints||"ontouchstart"in this}function jr(t,e,i){var n=t.invertX(e[0][0])-i[0][0],r=t.invertX(e[1][0])-i[1][0],o=t.invertY(e[0][1])-i[0][1],s=t.invertY(e[1][1])-i[1][1];return t.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}var Nr=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var r=n[i];t.call(e,r[1],r[0])}},e}()}(),Pr="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Br="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Dr="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Br):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},Ar=["top","right","bottom","left","width","height","size","weight"],Vr="undefined"!=typeof MutationObserver,Rr=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,r=0;function o(){i&&(i=!1,t()),n&&a()}function s(){Dr(o)}function a(){var t=Date.now();if(i){if(t-r<2)return;n=!0}else i=!0,n=!1,setTimeout(s,20);r=t}return a}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Pr&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Vr?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Pr&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;Ar.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),zr=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},Lr=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Br},Fr=Hr(0,0,0,0);function qr(t){return parseFloat(t)||0}function Wr(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+qr(t["border-"+i+"-width"])}),0)}var $r="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof Lr(t).SVGGraphicsElement}:function(t){return t instanceof Lr(t).SVGElement&&"function"==typeof t.getBBox};function Hr(t,e,i,n){return{x:t,y:e,width:i,height:n}}var Yr=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Hr(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t,e=(t=this.target,Pr?$r(t)?function(t){var e=t.getBBox();return Hr(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return Fr;var n=Lr(t).getComputedStyle(t),r=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var r=n[i];e[r]=qr(t["padding-"+r])}return e}(n),o=r.left+r.right,s=r.top+r.bottom,a=qr(n.width),l=qr(n.height);if("border-box"===n.boxSizing&&(Math.round(a+o)!==e&&(a-=Wr(n,"left","right")+o),Math.round(l+s)!==i&&(l-=Wr(n,"top","bottom")+s)),!function(t){return t===Lr(t).document.documentElement}(t)){var c=Math.round(a+o)-e,h=Math.round(l+s)-i;1!==Math.abs(c)&&(a-=c),1!==Math.abs(h)&&(l-=h)}return Hr(r.left,r.top,a,l)}(t):Fr);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Xr=function(t,e){var i,n,r,o,s,a,l,c=(n=(i=e).x,r=i.y,o=i.width,s=i.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),zr(l,{x:n,y:r,width:o,height:s,top:r,right:n+o,bottom:s+r,left:n}),l);zr(this,{target:t,contentRect:c})},Ur=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new Nr,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Lr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Yr(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Lr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new Xr(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Gr="undefined"!=typeof WeakMap?new WeakMap:new Nr,Kr=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=Rr.getInstance(),n=new Ur(e,i,this);Gr.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){Kr.prototype[t]=function(){var e;return(e=Gr.get(this))[t].apply(e,arguments)}}));var Qr=void 0!==Br.ResizeObserver?Br.ResizeObserver:Kr;let Zr=(()=>{class t{constructor(){this.elementSubjects=new Map,this.resizeObserver=new Qr(t=>{for(const i of t){var e=this.elementSubjects.get(i.target);if(null==e)return;e.next(i.contentRect)}})}listenToElementResize(t){this.resizeObserver.observe(t);const e=new It.a;return this.elementSubjects.set(t,e),e}unListenToElementResize(t){this.elementSubjects.delete(t),this.resizeObserver.unobserve(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Jr=i("v9BS"),to=i("nIj0"),eo=i("PBFl");const io=["chart"],no=["weightSlider"];let ro=(()=>{class t{constructor(t){this.bloomaResizeListenerService=t,this.profileSelected=new s.o,this.itemWeightChanged=new s.o,this.childProfileWeightChanged=new s.o,this.linkClicked=new s.o,this.disconnectLinkClicked=new s.o,this._data=null,this.sliderContainerStyle={width:"0",height:"0",padding:"0"},this.unsubscribe$=new It.a,this.viewInitialized=!1,this.margin={top:10,bottom:20,left:150,right:10},this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.nodeSquareWidth=100,this.nodeSquareHeight=60,this.draggableSquareDimension=10,this.dragX=0,this.dragY=0,this.linkColor="gray",this.selectedNodeColor="green",this.clickedLinkSource=null,this.clickedLinkTarget=null,this.weightTargetType=null,this.clickedLinkEvent=null,this.sliderElementHeight=124,this.sliderElementWidth=124;const e=new It.a;e.pipe(Object(kt.a)(400),Object(Ot.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=e}get data(){return this._data}set data(t){this._data=t,this.createSubject.next()}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Ot.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},800)}createChart(){if(!this.viewInitialized)return;if(!this.data)return;const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.initSvg(),this.setSvgHeight(),this.drawHierarchy(),this.setUpZoomBehavior())}initSvg(){if(!this.svg){const t=Ke(this.chartContainer.nativeElement).append("svg");this.svg=t}}setSvgHeight(){this.svg.attr("height",this.totalComponentHeight).attr("width",this.totalComponentWidth)}mouseOverProfile(t){this.dragTargetData=t}mouseLeaveProfile(t){this.dragTargetData=null}getDragBehavior(){const t=this;return function(){var t,e,i,n,r=ir,o=nr,s=rr,a=or,l={},c=Dt("start","drag","end"),h=0,u=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",g).on("touchmove.drag",v).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!n&&r.call(this,s,a)){var l=y(this,o.call(this,s,a),s,a,"mouse");l&&(Ke(s.view).on("mousemove.drag",p,!0).on("mouseup.drag",m,!0),Je(s.view),Qe(s),i=!1,t=s.clientX,e=s.clientY,l("start",s))}}function p(n){if(Ze(n),!i){var r=n.clientX-t,o=n.clientY-e;i=r*r+o*o>u}l.mouse("drag",n)}function m(t){Ke(t.view).on("mousemove.drag mouseup.drag",null),ti(t.view,i),Ze(t),l.mouse("end",t)}function g(t,e){if(r.call(this,t,e)){var i,n,s=t.changedTouches,a=o.call(this,t,e),l=s.length;for(i=0;i<l;++i)(n=y(this,a,t,e,s[i].identifier,s[i]))&&(Qe(t),n("start",t,s[i]))}}function v(t){var e,i,n=t.changedTouches,r=n.length;for(e=0;e<r;++e)(i=l[n[e].identifier])&&(Ze(t),i("drag",t,n[e]))}function b(t){var e,i,r=t.changedTouches,o=r.length;for(n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),e=0;e<o;++e)(i=l[r[e].identifier])&&(Qe(t),i("end",t,r[e]))}function y(t,e,i,n,r,o){var a,u,f,p=c.copy(),m=Wi(o||i,e);if(null!=(f=s.call(t,new er("beforestart",{sourceEvent:i,target:d,identifier:r,active:h,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),n)))return a=f.x-m[0]||0,u=f.y-m[1]||0,function i(o,s,c){var g,v=m;switch(o){case"start":l[r]=i,g=h++;break;case"end":delete l[r],--h;case"drag":m=Wi(c||s,e),g=h}p.call(o,t,new er(o,{sourceEvent:s,subject:f,target:d,identifier:r,active:g,x:m[0]+a,y:m[1]+u,dx:m[0]-v[0],dy:m[1]-v[1],dispatch:p}),n)}}return d.filter=function(t){return arguments.length?(r="function"==typeof t?t:tr(!!t),d):r},d.container=function(t){return arguments.length?(o="function"==typeof t?t:tr(t),d):o},d.subject=function(t){return arguments.length?(s="function"==typeof t?t:tr(t),d):s},d.touchable=function(t){return arguments.length?(a="function"==typeof t?t:tr(!!t),d):a},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,d):Math.sqrt(u)},d}().on("start",(e,i)=>{this.setSelectedNode(i,e.sourceEvent);const n=this.svg.select("rect#r"+i.id);if(null==n)return;this.dragSourceNode=n;const r=+n.attr("original-x"),o=+n.attr("original-y");this.dragX=this.dragStartX=r,this.dragY=this.dragStartY=o,this.svg.selectAll(".profile-container").attr("pointer-events","mouseover").on("mouseover",(function(e,i){e.target.setAttribute("stroke","red"),t.mouseOverProfile(i)})).on("mouseout",(function(e,i){var n;null!=e.fromElement&&null!=e.toElement&&e.fromElement.parentElement!=e.toElement.parentElement&&(i.id!==(null===(n=t.selectedProfile)||void 0===n?void 0:n.id)&&e.target.setAttribute("stroke","black"),t.mouseLeaveProfile(i))})),e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}).on("drag",(t,e)=>{if(this.svg.select("rect#r"+e.id),0==this.dragStartX)return;this.dragX+=t.dx,this.dragY+=t.dy;const i=[[+this.dragStartX,+this.dragStartY],[this.dragX,this.dragY]],n=this.getDragLine(),r=function(t,e){var i=fr(!0),n=null,r=mr,o=null;function s(s){var a,l,c,h=(s=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(s)).length,u=!1;for(null==n&&(o=r(c=dr())),a=0;a<=h;++a)!(a<h&&i(l=s[a],a,s))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(l,a,s),+e(l,a,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?gr:fr(t),e="function"==typeof e?e:void 0===e?vr:fr(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:fr(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:fr(+t),s):e},s.defined=function(t){return arguments.length?(i="function"==typeof t?t:fr(!!t),s):i},s.curve=function(t){return arguments.length?(r=t,null!=n&&(o=r(n)),s):r},s.context=function(t){return arguments.length?(null==t?n=o=null:o=r(n=t),s):n},s}();n.attr("d",r(i))}).on("end",()=>{if(this.removeDragLine(),this.dragStartX=0,this.dragStartY=0,null==this.dragSourceNode||null==this.dragTargetData)return;const t=this.dragSourceNode.attr("id").substr(1),e=this.dragTargetData.id;if(t==e)return;const i=this.profileMap[e];this.changeIntroducesCycle(this.profileMap[t],e)||i.parentIds.find(e=>e==t)})}changeIntroducesCycle(t,e){if(null==t.parentIds)return!1;if(null==t?void 0:t.parentIds.find(t=>t==e))return!0;for(const i of null==t?void 0:t.parentIds)return this.changeIntroducesCycle(this.profileMap[i],e)}removeDragLine(){this.svg.select(".drag-line").remove(),this.dragLine=null}getDragLine(){return this.dragLine||(this.dragLine=this.svg.select(".graph-area").append("path").attr("class","drag-line").style("stroke","red").style("fill","none")),this.dragLine}drawHierarchy(){this.svg.select(".graph-area").remove();const t=function(...t){if(t.length)throw Error(`got arguments to dagStratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);return function t(e,i,n){function r(t){if(!t.length)throw new Error("can't stratify empty data");const i=t.map((t,i)=>new f(function(t){if("string"!=typeof t)throw new Error("id is supposed to be string but got type "+typeof t);if(t.indexOf("\0")>=0)throw new Error(`node id ${t} contained null character`);return t}(e(t,i)),t)),r=new Map;i.forEach(t=>{if(r.has(t.id))throw new Error("found a duplicate id: "+t.id);r.set(t.id,t)});const o=[];return i.forEach((t,e)=>{const i=n(t.data,e)||[];i.forEach(([e,i])=>{const n=r.get(e);if(!n)throw new Error("missing id: "+e);return n.dataChildren.push(new u(t,i)),n}),i.length||o.push(t)}),function(t){if(!t.length)throw new Error("dag contained no roots");const e=new Set,i=new Set;let n=null;function r(t){if(e.has(t.id))return[];if(i.has(t.id))return n=t.id,[t.id];{i.add(t.id);let o=[];for(const e of t.ichildren())if(o=r(e),o.length)break;return i.delete(t.id),e.add(t.id),o.length&&null!==n&&o.push(t.id),n===t.id&&(n=null),o}}for(const o of t){const t=r(o);if(t.length)throw new Error("dag contained a cycle: "+t.reverse().join(" -> "))}for(const o of new p(t))if(new Set(o.ichildren().map(t=>t.id)).size!==o.dataChildren.length)throw new Error(`node '${o.id}' contained duplicate children`)}(o),o.length>1?new p(o):o[0]}return r.id=function(r){return void 0===r?e:t(r,i,n)},r.parentData=function(i){return void 0===i?n:t(e,function(t){function e(e,i){return(t(e,i)||[]).map(([t])=>t)}return e.wrapped=t,e}(i),i)},r.parentIds=function(n){return void 0===n?i:t(e,n,m(n))},r}(g,v,m(v))}();if(!this.data)return;const e=t(this.data),i=xt().nodeSize([80,390])(e),n=this.svg.append("g").attr("class","graph-area"),r=i.descendants(),o=this.getDragBehavior(),s=n.append("g").attr("class","links-group"),a=i.links();s.selectAll("line").data(a).enter().append("line").attr("class","line").attr("stroke",this.linkColor).attr("stroke-width","5").attr("data-id-source",t=>"r"+t.source.id).attr("data-id-target",t=>"r"+t.target.id).attr("x1",t=>this.margin.left+t.source.y).attr("x2",t=>this.margin.left+t.target.y).attr("y1",t=>this.margin.top+t.source.x).attr("y2",t=>this.margin.top+t.target.x).on("mouseover",(t,e)=>{Ke(t.srcElement).attr("stroke","red")}).on("mouseout",(t,e)=>{Ke(t.srcElement).attr("stroke",this.linkColor)}).on("click",(t,e)=>{this.clickedLinkSource=e.source.id,this.clickedLinkTarget=e.target.data.originalId,this.weightTargetType=e.target.data.scores?"item":"childProfile",this.clickedLinkEvent=t,Ke(t.srcElement).attr("stroke",this.linkColor),this.linkClicked.next(this.clickedLinkSource)}),n.append("g").attr("class","nodes-group").selectAll("g.node").data(r).enter().append("g").attr("class","node").attr("transform",t=>`translate(${this.margin.left+t.y},${this.margin.top+t.x})`).each((t,e,i)=>{const n=Ke(i[e]),r=n.append("rect").attr("id","r"+t.id).attr("fill","white").attr("original-x",this.margin.left+t.y).attr("original-y",this.margin.top+t.x).attr("stroke","black").call(o).on("click",(t,e)=>{this.setSelectedNode(e,t)}),s=n.append("text").attr("class","svg-text").attr("dx",10).text(t.data.name).on("click",(t,e)=>{var i=new Event("click",{});t.srcElement.parentElement.firstChild.dispatchEvent(i)}),a=s.node().getBBox(),l=Et([a.width+20,this.nodeSquareWidth]),c=Et([a.height,this.nodeSquareHeight]);r.attr("x",0-l/2).attr("class","profile-container").attr("y",-c/2).attr("width",l).attr("height",c),s.attr("x",0-l/2)})}setSelectedNode(t,e){this.setSelectedProfile(t),(".profile-container",new Xe([document.querySelectorAll(".profile-container")],[document.documentElement])).attr("stroke","black"),Ke(e.srcElement).attr("stroke",this.selectedNodeColor)}saveNewWeight(){this.hideWeightSlider(),"item"==this.weightTargetType?this.itemWeightChanged.next({profileId:this.clickedLinkSource,updateProfileItemWeightDto:{newWeight:this.selectedWeight,profileItemName:this.clickedLinkTarget}}):this.childProfileWeightChanged.next({profileId:this.clickedLinkSource,subProfileId:this.clickedLinkTarget,updateSubProfileWeightDto:{newWeight:this.selectedWeight}})}hideWeightSlider(){Ke(this.weightSliderContainer.nativeElement).transition().duration(200).style("opacity",0),this.sliderContainerStyle={width:"0",height:"0",padding:"0"}}disconnect(){this.hideWeightSlider(),this.disconnectLinkClicked.next({profileId:this.clickedLinkSource,childProfileToDelete:this.clickedLinkTarget})}showWeightSlider(){var t;this.selectedWeight=null!==(t=this.getLinkWeight(this.clickedLinkSource,this.clickedLinkTarget))&&void 0!==t?t:0;const e=Ke(this.weightSliderContainer.nativeElement);var i=this.selectTopForSlider(),n=this.selectLeftForSlider();this.sliderContainerStyle={width:"300px",left:n+"px",top:i+"px",padding:"10px"},e.transition().duration(200).style("opacity",1),Object(s.lb)(this)}selectTopForSlider(){return this.clickedLinkEvent.y+this.sliderElementHeight>=this.totalComponentHeight?this.totalComponentHeight-130:this.clickedLinkEvent.y}selectLeftForSlider(){return this.clickedLinkEvent.x+this.sliderElementWidth>=this.totalComponentWidth?this.totalComponentWidth-this.sliderElementWidth-10:this.clickedLinkEvent.x}weightChanged(t){this.selectedWeight=t.value}getLinkWeight(t,e){var i=this.weights[t];let n=i[e];n||(n=i[e.toUpperCase()]);const r=e.indexOf("_");return!n&&r>-1&&(n=i[e=e.substr(r+1)]),n}setUpZoomBehavior(){const t=this.svg.select(".graph-area"),e=this.svg.select(".nodes-group").node().getBBox(),i=[[0,0],[this.totalComponentWidth,this.totalComponentHeight]],n=[[0,-100],[e.width+this.margin.left+100,e.height]],r=function(){var t,e,i,n=kr,r=Or,o=jr,s=Tr,a=Mr,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],h=250,u=yr,d=Dt("start","zoom","end"),f=500,p=0,m=10;function g(t){t.property("__zoom",Er).on("wheel.zoom",C).on("mousedown.zoom",S).on("dblclick.zoom",I).filter(a).on("touchstart.zoom",k).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new xr(e,t.x,t.y)}function b(t,e,i){var n=e[0]-i[0]*t.k,r=e[1]-i[1]*t.k;return n===t.x&&r===t.y?t:new xr(t.k,n,r)}function y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function _(t,e,i,n){t.on("start.zoom",(function(){w(this,arguments).event(n).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(n).end()})).tween("zoom",(function(){var t=this,o=arguments,s=w(t,o).event(n),a=r.apply(t,o),l=null==i?y(a):"function"==typeof i?i.apply(t,o):i,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),h=t.__zoom,d="function"==typeof e?e.apply(t,o):e,f=u(h.invert(l).concat(c/h.k),d.invert(l).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=f(t),i=c/e[2];t=new xr(i,l[0]-e[0]*i,l[1]-e[1]*i)}s.zoom(null,t)}}))}function w(t,e,i){return!i&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function C(t,...e){if(n.apply(this,arguments)){var i=w(this,e).event(t),r=this.__zoom,a=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,s.apply(this,arguments)))),h=Wi(t);if(i.wheel)i.mouse[0][0]===h[0]&&i.mouse[0][1]===h[1]||(i.mouse[1]=r.invert(i.mouse[0]=h)),clearTimeout(i.wheel);else{if(r.k===a)return;i.mouse=[h,r.invert(h)],pn(this),i.start()}Ir(t),i.wheel=setTimeout(u,150),i.zoom("mouse",o(b(v(r,a),i.mouse[0],i.mouse[1]),i.extent,c))}function u(){i.wheel=null,i.end()}}function S(t,...e){if(!i&&n.apply(this,arguments)){var r=w(this,e,!0).event(t),s=Ke(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",f,!0),a=Wi(t,l),l=t.currentTarget,h=t.clientX,u=t.clientY;Je(t.view),Sr(t),r.mouse=[a,this.__zoom.invert(a)],pn(this),r.start()}function d(t){if(Ir(t),!r.moved){var e=t.clientX-h,i=t.clientY-u;r.moved=e*e+i*i>p}r.event(t).zoom("mouse",o(b(r.that.__zoom,r.mouse[0]=Wi(t,l),r.mouse[1]),r.extent,c))}function f(t){s.on("mousemove.zoom mouseup.zoom",null),ti(t.view,r.moved),Ir(t),r.event(t).end()}}function I(t,...e){if(n.apply(this,arguments)){var i=this.__zoom,s=Wi(t.changedTouches?t.changedTouches[0]:t,this),a=i.invert(s),l=o(b(v(i,i.k*(t.shiftKey?.5:2)),s,a),r.apply(this,e),c);Ir(t),h>0?Ke(this).transition().duration(h).call(_,l,s,t):Ke(this).call(g.transform,l,s,t)}}function k(i,...r){if(n.apply(this,arguments)){var o,s,a,l,c=i.touches,h=c.length,u=w(this,r,i.changedTouches.length===h).event(i);for(Sr(i),s=0;s<h;++s)l=[l=Wi(a=c[s],this),this.__zoom.invert(l),a.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,o=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(u.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),f)),pn(this),u.start())}}function O(t,...e){if(this.__zooming){var i,n,r,s,a=w(this,e).event(t),l=t.changedTouches,h=l.length;for(Ir(t),i=0;i<h;++i)r=Wi(n=l[i],this),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var u=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],m=(m=f[0]-u[0])*m+(m=f[1]-u[1])*m,g=(g=p[0]-d[0])*g+(g=p[1]-d[1])*g;n=v(n,Math.sqrt(m/g)),r=[(u[0]+f[0])/2,(u[1]+f[1])/2],s=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(b(n,r,s),a.extent,c))}}function E(t,...n){if(this.__zooming){var r,o,s=w(this,n).event(t),a=t.changedTouches,l=a.length;for(Sr(t),i&&clearTimeout(i),i=setTimeout((function(){i=null}),f),r=0;r<l;++r)o=a[r],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=Wi(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<m)){var c=Ke(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return g.transform=function(t,e,i,n){var r=t.selection?t.selection():t;r.property("__zoom",Er),t!==r?_(t,e,i,n):r.interrupt().each((function(){w(this,arguments).event(n).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},g.scaleBy=function(t,e,i,n){g.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),i,n)},g.scaleTo=function(t,e,i,n){g.transform(t,(function(){var t=r.apply(this,arguments),n=this.__zoom,s=null==i?y(t):"function"==typeof i?i.apply(this,arguments):i,a=n.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return o(b(v(n,l),s,a),t,c)}),i,n)},g.translateBy=function(t,e,i,n){g.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof i?i.apply(this,arguments):i),r.apply(this,arguments),c)}),null,n)},g.translateTo=function(t,e,i,n,s){g.transform(t,(function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==n?y(t):"function"==typeof n?n.apply(this,arguments):n;return o(Cr.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof i?-i.apply(this,arguments):-i),t,c)}),n,s)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Ke(this.that).datum();d.call(t,this.that,new wr(t,{sourceEvent:this.sourceEvent,target:g,type:t,transform:this.that.__zoom,dispatch:d}),e)}},g.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:_r(+t),g):s},g.filter=function(t){return arguments.length?(n="function"==typeof t?t:_r(!!t),g):n},g.touchable=function(t){return arguments.length?(a="function"==typeof t?t:_r(!!t),g):a},g.extent=function(t){return arguments.length?(r="function"==typeof t?t:_r([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):r},g.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],g):[l[0],l[1]]},g.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],g):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},g.constrain=function(t){return arguments.length?(o=t,g):o},g.duration=function(t){return arguments.length?(h=+t,g):h},g.interpolate=function(t){return arguments.length?(u=t,g):u},g.on=function(){var t=d.on.apply(d,arguments);return t===d?g:t},g.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,g):Math.sqrt(p)},g.tapDistance=function(t){return arguments.length?(m=+t,g):m},g}().scaleExtent([.1,10]).extent(i).translateExtent(n).on("zoom",e=>{t.attr("transform",e.transform)});this.svg.call(r)}setSelectedProfile(t){this.profileSelected.next({selectedNodeId:t.id,nodeType:t.data.itemType})}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(Zr))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-hierarchy"]],viewQuery:function(t,e){var i;1&t&&(s.zc(io,!0),s.zc(no,!0)),2&t&&(s.kc(i=s.bc())&&(e.chartContainer=i.first),s.kc(i=s.bc())&&(e.weightSliderContainer=i.first))},inputs:{data:"data",weights:"weights",profileMap:"profileMap",selectedProfile:"selectedProfile"},outputs:{profileSelected:"profileSelected",itemWeightChanged:"itemWeightChanged",childProfileWeightChanged:"childProfileWeightChanged",linkClicked:"linkClicked",disconnectLinkClicked:"disconnectLinkClicked"},decls:14,vars:3,consts:[["id","rent-comparable-graph",1,"rent-comparable-graph"],["chart",""],["id","weight-slider",1,"bg-yellow-200","overflow-hidden",3,"ngStyle"],["weightSlider",""],["min","1","max","100","step","1",3,"ngModel","ngModelChange","input"],[1,"flex"],["mat-flat-button","","color","primary",1,"mx-2",3,"click"],["mat-flat-button","","color","warn",1,"mx-2",3,"click"]],template:function(t,e){1&t&&(s.Ob(0,"div",0,1),s.Tb(2,"div",2,3),s.Tb(4,"div"),s.wc(5),s.Sb(),s.Tb(6,"mat-slider",4),s.ac("ngModelChange",(function(t){return e.selectedWeight=t}))("input",(function(t){return e.weightChanged(t)})),s.Sb(),s.Tb(7,"div",5),s.Tb(8,"button",6),s.ac("click",(function(){return e.saveNewWeight()})),s.wc(9,"Save"),s.Sb(),s.Tb(10,"button",7),s.ac("click",(function(){return e.hideWeightSlider()})),s.wc(11,"Cancel"),s.Sb(),s.Tb(12,"button",7),s.ac("click",(function(){return e.disconnect()})),s.wc(13,"Disconnect"),s.Sb(),s.Sb(),s.Sb()),2&t&&(s.Cb(2),s.jc("ngStyle",e.sliderContainerStyle),s.Cb(3),s.yc("Weight: ",e.selectedWeight,""),s.Cb(1),s.jc("ngModel",e.selectedWeight))},directives:[n.l,Jr.a,to.j,to.m,eo.a],styles:[".rent-comparable-graph[_ngcontent-%COMP%]{height:inherit;width:inherit}#weight-slider[_ngcontent-%COMP%]{background-color:#fff;color:#000;position:absolute;opacity:0;width:0}#weight-slider[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:100%}.svg-text[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}"]}),t})();var oo=i("yDe4"),so=i("C9XJ"),ao=i("rxR5"),lo=i("PC4E"),co=i("oYEq"),ho=i("pLgK");let uo=(()=>{class t{constructor(t,e){this.store=t,this.actions$=e,this.keyChanged$=new It.a,this.actions$.pipe(Object(oo.j)(so.a)).subscribe(()=>{this.keyChanged$.next()})}getProfiles(){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.e).toPromise(),null==this.store.selectSnapshot(lo.a.getGetProfileError)?"success":"error"}))}selectProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.g(t)).toPromise()}))}updateChildProfileLinkWeight(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new co.c(t)).toPromise(),!!this.store.selectSnapshot(ho.a.getUpdateSubChildWeightStatus)}))}disconectSubProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.f(t)).toPromise(),!!this.store.selectSnapshot(lo.a.getDisconnectSubProfileError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(oo.h),s.Xb(oo.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(oo.e)(lo.a.getState)],t.prototype,"profileState$",void 0),Object(o.b)([Object(oo.e)(ho.a.getState)],t.prototype,"weightState$",void 0),t})(),fo=(()=>{class t{constructor(t){this.store=t}updateItemLinkWeight(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new co.d(t)).toPromise(),!!this.store.selectSnapshot(ho.a.getUpdateItemWeightStatus)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(oo.h))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(oo.e)(ho.a.getState)],t.prototype,"weightState$",void 0),t})();var po=i("EmTj"),mo=i("OZ4H"),go=i("29Wa"),vo=i("cZZj"),bo=i("5XID"),yo=i("6Oco");i("KTx3"),i("prE9");const _o=Object(vo.f)({passive:!0});let wo=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return yo.a;const e=Object(bo.d)(t),i=this._monitoredElements.get(e);if(i)return i.subject;const n=new It.a,r="cdk-text-field-autofilled",o=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(r)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(r)&&(e.classList.remove(r),this._ngZone.run(()=>n.next({target:t.target,isAutofilled:!1}))):(e.classList.add(r),this._ngZone.run(()=>n.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",o,_o),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:n,unlisten:()=>{e.removeEventListener("animationstart",o,_o)}}),n}stopMonitoring(t){const e=Object(bo.d)(t),i=this._monitoredElements.get(e);i&&(i.unlisten(),i.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(vo.a),s.Xb(s.A))},t.\u0275prov=Object(s.Jb)({factory:function(){return new t(Object(s.Xb)(vo.a),Object(s.Xb)(s.A))},token:t,providedIn:"root"}),t})(),xo=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[vo.b]]}),t})();var Co=i("mFH5");const So=new s.r("MAT_INPUT_VALUE_ACCESSOR"),Io=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let ko=0;class Oo{constructor(t,e,i,n){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=i,this.ngControl=n}}const Eo=Object(Co.q)(Oo);let To=(()=>{class t extends Eo{constructor(t,e,i,n,r,o,s,a,l,c){super(o,n,r,i),this._elementRef=t,this._platform=e,this.ngControl=i,this._autofillMonitor=a,this._formField=c,this._uid="mat-input-"+ko++,this.focused=!1,this.stateChanges=new It.a,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>Object(vo.e)().has(t));const h=this._elementRef.nativeElement,u=h.nodeName.toLowerCase();this._inputValueAccessor=s||h,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&l.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===u,this._isTextarea="textarea"===u,this._isNativeSelect&&(this.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=Object(bo.b)(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=Object(bo.b)(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&Object(vo.e)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=Object(bo.b)(t)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){var t,e;const i=(null===(e=null===(t=this._formField)||void 0===t?void 0:t._hideControlPlaceholder)||void 0===e?void 0:e.call(t))?null:this.placeholder;if(i!==this._previousPlaceholder){const t=this._elementRef.nativeElement;this._previousPlaceholder=i,i?t.setAttribute("placeholder",i):t.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){Io.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.m),s.Nb(vo.a),s.Nb(to.i,10),s.Nb(to.l,8),s.Nb(to.e,8),s.Nb(Co.a),s.Nb(So,10),s.Nb(wo),s.Nb(s.A),s.Nb(go.a,8))},t.\u0275dir=s.Ib({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:9,hostBindings:function(t,e){1&t&&s.ac("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(s.Wb("disabled",e.disabled)("required",e.required),s.Db("id",e.id)("data-placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),s.Fb("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"]},exportAs:["matInput"],features:[s.Bb([{provide:go.c,useExisting:t}]),s.zb,s.Ab]}),t})(),Mo=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},providers:[Co.a],imports:[[xo,go.d],xo,go.d]}),t})(),jo=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(mo.g),s.Nb(mo.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-prompt"]],decls:12,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(s.Tb(0,"h1",0),s.wc(1),s.Sb(),s.Tb(2,"div",1),s.Tb(3,"mat-form-field"),s.Tb(4,"mat-label"),s.wc(5),s.Sb(),s.Tb(6,"input",2),s.ac("ngModelChange",(function(t){return e.data.inputValue=t})),s.Sb(),s.Sb(),s.Sb(),s.Tb(7,"div",3),s.Tb(8,"button",4),s.ac("click",(function(){return e.onNoClick()})),s.wc(9,"Cancel"),s.Sb(),s.Tb(10,"button",5),s.wc(11,"Create"),s.Sb(),s.Sb()),2&t&&(s.Cb(1),s.xc(e.data.title),s.Cb(4),s.xc(e.data.label),s.Cb(1),s.jc("ngModel",e.data.inputValue),s.Cb(4),s.jc("mat-dialog-close",e.data.inputValue))},directives:[mo.h,mo.e,go.b,go.e,To,to.a,to.j,to.m,mo.c,eo.a,mo.d],styles:[""]}),t})(),No=(()=>{class t{constructor(t){this.store=t}addRootProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.b(t)).toPromise(),this.store.selectSnapshot(lo.a.getCreateRootProfileError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(oo.h))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Po=(()=>{class t{constructor(t,e){this.dhDialogService=t,this.hierarchyActionsService=e}ngOnInit(){}addRootProfile(){return Object(o.a)(this,void 0,void 0,(function*(){let t=yield this.dhDialogService.openDialog(jo,300,{title:"Enter new Root Profile data",label:"Profile Name",inputValue:""}).toPromise();if(null!=t){this.dhDialogService.showLoading();var e=this.hierarchyActionsService.addRootProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Root Profile Added.":"Error adding Root Profile.")}}))}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(po.a),s.Nb(No))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-hierarchy-actions"]],decls:2,vars:0,consts:[["mat-flat-button","","color","primary",1,"mb-4","w-full",3,"click"]],template:function(t,e){1&t&&(s.Tb(0,"button",0),s.ac("click",(function(){return e.addRootProfile()})),s.wc(1,"Add Root Profile"),s.Sb())},directives:[eo.a],styles:[""]}),t})();var Bo=i("cqs0"),Do=i("9bRT"),Ao=i("C05f"),Vo=i("ROBh"),Ro=i("J+dc"),zo=i("xVbo"),Lo=i("E5oP");class Fo extends class{constructor(){this.expansionModel=new Bo.c(!0)}toggle(t){this.expansionModel.toggle(this._trackByValue(t))}expand(t){this.expansionModel.select(this._trackByValue(t))}collapse(t){this.expansionModel.deselect(this._trackByValue(t))}isExpanded(t){return this.expansionModel.isSelected(this._trackByValue(t))}toggleDescendants(t){this.expansionModel.isSelected(this._trackByValue(t))?this.collapseDescendants(t):this.expandDescendants(t)}collapseAll(){this.expansionModel.clear()}expandDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.select(...e.map(t=>this._trackByValue(t)))}collapseDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.deselect(...e.map(t=>this._trackByValue(t)))}_trackByValue(t){return this.trackBy?this.trackBy(t):t}}{constructor(t,e){super(),this.getChildren=t,this.options=e,this.options&&(this.trackBy=this.options.trackBy)}expandAll(){this.expansionModel.clear();const t=this.dataNodes.reduce((t,e)=>[...t,...this.getDescendants(e),e],[]);this.expansionModel.select(...t.map(t=>this._trackByValue(t)))}getDescendants(t){const e=[];return this._getDescendants(e,t),e.splice(1)}_getDescendants(t,e){t.push(e);const i=this.getChildren(e);Array.isArray(i)?i.forEach(e=>this._getDescendants(t,e)):Object(Do.a)(i)&&i.pipe(Object(Ro.a)(1),Object(zo.a)(Boolean)).subscribe(e=>{for(const i of e)this._getDescendants(t,i)})}}const qo=new s.r("CDK_TREE_NODE_OUTLET_NODE");let Wo=(()=>{class t{constructor(t,e){this.viewContainer=t,this._node=e}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.Q),s.Nb(qo,8))},t.\u0275dir=s.Ib({type:t,selectors:[["","cdkTreeNodeOutlet",""]]}),t})();class $o{constructor(t){this.$implicit=t}}let Ho=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.M))},t.\u0275dir=s.Ib({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),Yo=(()=>{class t{constructor(t,e){this._differs=t,this._changeDetectorRef=e,this._onDestroy=new It.a,this._levels=new Map,this.viewChange=new Ao.a({start:0,end:Number.MAX_VALUE})}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const t=this._nodeDefs.filter(t=>!t.when);this._defaultNodeDef=t[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(t){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),t||this._nodeOutlet.viewContainer.clear(),this._dataSource=t,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let t;Object(Bo.f)(this._dataSource)?t=this._dataSource.connect(this):Object(Do.a)(this._dataSource)?t=this._dataSource:Array.isArray(this._dataSource)&&(t=Object(Vo.a)(this._dataSource)),t&&(this._dataSubscription=t.pipe(Object(Ot.a)(this._onDestroy)).subscribe(t=>this.renderNodeChanges(t)))}renderNodeChanges(t,e=this._dataDiffer,i=this._nodeOutlet.viewContainer,n){const r=e.diff(t);r&&(r.forEachOperation((e,r,o)=>{if(null==e.previousIndex)this.insertNode(t[o],o,i,n);else if(null==o)i.remove(r),this._levels.delete(e.item);else{const t=i.get(r);i.move(t,o)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(t,e){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(i=>i.when&&i.when(e,t))||this._defaultNodeDef}insertNode(t,e,i,n){const r=this._getNodeDef(t,e),o=new $o(t);o.level=this.treeControl.getLevel?this.treeControl.getLevel(t):void 0!==n&&this._levels.has(n)?this._levels.get(n)+1:0,this._levels.set(t,o.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(r.template,o,e),Xo.mostRecentTreeNode&&(Xo.mostRecentTreeNode.data=t)}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.t),s.Nb(s.i))},t.\u0275cmp=s.Hb({type:t,selectors:[["cdk-tree"]],contentQueries:function(t,e,i){var n;1&t&&s.Gb(i,Ho,!0),2&t&&s.kc(n=s.bc())&&(e._nodeDefs=n)},viewQuery:function(t,e){var i;1&t&&s.qc(Wo,!0),2&t&&s.kc(i=s.bc())&&(e._nodeOutlet=i.first)},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,e){1&t&&s.Pb(0,0)},directives:[Wo],encapsulation:2}),t})(),Xo=(()=>{class t{constructor(e,i){this._elementRef=e,this._tree=i,this._destroyed=new It.a,this._dataChanges=new It.a,this.role="treeitem",t.mostRecentTreeNode=this}get data(){return this._data}set data(t){t!==this._data&&(this._data=t,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):0}ngOnDestroy(){t.mostRecentTreeNode===this&&(t.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.m),s.Nb(Yo))},t.\u0275dir=s.Ib({type:t,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:3,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("aria-level",e.level+1)("role",e.role)},inputs:{role:"role"},exportAs:["cdkTreeNode"]}),t.mostRecentTreeNode=null,t})(),Uo=(()=>{class t extends Xo{constructor(t,e,i){super(t,e),this._elementRef=t,this._tree=e,this._differs=i}ngAfterContentInit(){this._dataDiffer=this._differs.find([]).create(this._tree.trackBy);const t=this._tree.treeControl.getChildren(this.data);Array.isArray(t)?this.updateChildrenNodes(t):Object(Do.a)(t)&&t.pipe(Object(Ot.a)(this._destroyed)).subscribe(t=>this.updateChildrenNodes(t)),this.nodeOutlet.changes.pipe(Object(Ot.a)(this._destroyed)).subscribe(()=>this.updateChildrenNodes())}ngOnDestroy(){this._clear(),super.ngOnDestroy()}updateChildrenNodes(t){const e=this._getNodeOutlet();t&&(this._children=t),e&&this._children?this._tree.renderNodeChanges(this._children,this._dataDiffer,e.viewContainer,this._data):this._dataDiffer.diff([])}_clear(){const t=this._getNodeOutlet();t&&(t.viewContainer.clear(),this._dataDiffer.diff([]))}_getNodeOutlet(){const t=this.nodeOutlet;return t&&t.find(t=>!t._node||t._node===this)}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.m),s.Nb(Yo),s.Nb(s.t))},t.\u0275dir=s.Ib({type:t,selectors:[["cdk-nested-tree-node"]],contentQueries:function(t,e,i){var n;1&t&&s.Gb(i,Wo,!0),2&t&&s.kc(n=s.bc())&&(e.nodeOutlet=n)},hostAttrs:[1,"cdk-tree-node","cdk-nested-tree-node"],hostVars:2,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("role",e.role)},exportAs:["cdkNestedTreeNode"],features:[s.Bb([{provide:Xo,useExisting:t},{provide:qo,useExisting:t}]),s.zb]}),t})(),Go=(()=>{class t{constructor(t,e){this._tree=t,this._treeNode=e,this._recursive=!1}get recursive(){return this._recursive}set recursive(t){this._recursive=Object(bo.b)(t)}_toggle(t){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),t.stopPropagation()}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(Yo),s.Nb(Xo))},t.\u0275dir=s.Ib({type:t,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(t,e){1&t&&s.ac("click",(function(t){return e._toggle(t)}))},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),t})(),Ko=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)}}),t})();var Qo=i("g6G6"),Zo=i("YtkY");const Jo=Object(Co.r)(Object(Co.p)(Xo));let ts=(()=>{class t extends Jo{constructor(t,e,i){super(t,e),this._elementRef=t,this._tree=e,this.role="treeitem",this.tabIndex=Number(i)||0}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.m),s.Nb(Yo),s.Yb("tabindex"))},t.\u0275dir=s.Ib({type:t,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],hostVars:3,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("aria-level",e.level+1)("role",e.role)},inputs:{disabled:"disabled",tabIndex:"tabIndex",role:"role"},exportAs:["matTreeNode"],features:[s.Bb([{provide:Xo,useExisting:t}]),s.zb]}),t})(),es=(()=>{class t extends Ho{}return t.\u0275fac=function(e){return is(e||t)},t.\u0275dir=s.Ib({type:t,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[s.Bb([{provide:Ho,useExisting:t}]),s.zb]}),t})();const is=s.Vb(es);let ns=(()=>{class t extends Uo{constructor(t,e,i,n){super(t,e,i),this._elementRef=t,this._tree=e,this._differs=i,this._disabled=!1,this.tabIndex=Number(n)||0}get disabled(){return this._disabled}set disabled(t){this._disabled=Object(bo.b)(t)}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?t:0}ngAfterContentInit(){super.ngAfterContentInit()}ngOnDestroy(){super.ngOnDestroy()}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.m),s.Nb(Yo),s.Nb(s.t),s.Yb("tabindex"))},t.\u0275dir=s.Ib({type:t,selectors:[["mat-nested-tree-node"]],hostAttrs:[1,"mat-nested-tree-node"],hostVars:2,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("role",e.role)},inputs:{tabIndex:"tabIndex",disabled:"disabled",node:["matNestedTreeNode","node"]},exportAs:["matNestedTreeNode"],features:[s.Bb([{provide:Uo,useExisting:t},{provide:Xo,useExisting:t},{provide:qo,useExisting:t}]),s.zb]}),t})(),rs=(()=>{class t{constructor(t,e){this.viewContainer=t,this._node=e}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(s.Q),s.Nb(qo,8))},t.\u0275dir=s.Ib({type:t,selectors:[["","matTreeNodeOutlet",""]],features:[s.Bb([{provide:Wo,useExisting:t}])]}),t})(),os=(()=>{class t extends Yo{}return t.\u0275fac=function(e){return ss(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["mat-tree"]],viewQuery:function(t,e){var i;1&t&&s.qc(rs,!0),2&t&&s.kc(i=s.bc())&&(e._nodeOutlet=i.first)},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[s.Bb([{provide:Yo,useExisting:t}]),s.zb],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(t,e){1&t&&s.Pb(0,0)},directives:[rs],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}\n"],encapsulation:2}),t})();const ss=s.Vb(os);let as=(()=>{class t extends Go{get recursive(){return this._recursive}set recursive(t){this._recursive=Object(bo.b)(t)}}return t.\u0275fac=function(e){return ls(e||t)},t.\u0275dir=s.Ib({type:t,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[s.Bb([{provide:Go,useExisting:t}]),s.zb]}),t})();const ls=s.Vb(as);let cs=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[Ko,Co.e],Co.e]}),t})();class hs extends Bo.b{constructor(){super(...arguments),this._data=new Ao.a([])}get data(){return this._data.value}set data(t){this._data.next(t)}connect(t){return Object(Qo.a)(t.viewChange,this._data).pipe(Object(Zo.a)(()=>this.data))}disconnect(){}}const us=[{name:"Fruit",children:[{name:"Apple"},{name:"Banana"},{name:"Fruit loops"}]},{name:"Vegetables",children:[{name:"Green",children:[{name:"Broccoli"},{name:"Brussels sprouts"}]},{name:"Orange",children:[{name:"Pumpkins"},{name:"Carrots"}]}]}];var ds=i("bFHC");function fs(t,e){if(1&t&&(s.Tb(0,"mat-tree-node",3),s.Tb(1,"li",4),s.Ob(2,"button",5),s.wc(3),s.Sb(),s.Sb()),2&t){const t=e.$implicit;s.Cb(3),s.yc(" ",t.name," ")}}function ps(t,e){if(1&t&&(s.Tb(0,"mat-nested-tree-node"),s.Tb(1,"li"),s.Tb(2,"div",4),s.Tb(3,"button",6),s.Tb(4,"mat-icon",7),s.wc(5),s.Sb(),s.Sb(),s.wc(6),s.Sb(),s.Tb(7,"ul"),s.Pb(8,8),s.Sb(),s.Sb(),s.Sb()),2&t){const t=e.$implicit,i=s.dc();s.Cb(3),s.Db("aria-label","Toggle "+t.name),s.Cb(2),s.yc(" ",i.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),s.Cb(1),s.yc(" ",t.name," "),s.Cb(1),s.Fb("example-tree-invisible",!i.treeControl.isExpanded(t))}}let ms=(()=>{class t{constructor(){this.treeControl=new Fo(t=>t.children),this.dataSource=new hs,this.hasChild=(t,e)=>!!e.children&&e.children.length>0,this.dataSource.data=us}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-available-fields"]],decls:3,vars:3,consts:[[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["matTreeNodeOutlet",""]],template:function(t,e){1&t&&(s.Tb(0,"mat-tree",0),s.uc(1,fs,4,1,"mat-tree-node",1),s.uc(2,ps,9,5,"mat-nested-tree-node",2),s.Sb()),2&t&&(s.jc("dataSource",e.dataSource)("treeControl",e.treeControl),s.Cb(2),s.jc("matTreeNodeDefWhen",e.hasChild))},directives:[os,es,ts,as,eo.a,ns,ds.a,rs],styles:[".example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}"]}),t})();var gs=i("HYj3"),vs=i("qvOF"),bs=i("sg/T"),ys=i("fAiE"),_s=i("i9xl"),ws=i("jIqt"),xs=i("TLy2"),Cs=i("Ohay"),Ss=i("f7+R");const Is=["trigger"],ks=["panel"];function Os(t,e){if(1&t&&(s.Tb(0,"span",8),s.wc(1),s.Sb()),2&t){const t=s.dc();s.Cb(1),s.xc(t.placeholder||"\xa0")}}function Es(t,e){if(1&t&&(s.Tb(0,"span"),s.wc(1),s.Sb()),2&t){const t=s.dc(2);s.Cb(1),s.xc(t.triggerValue||"\xa0")}}function Ts(t,e){1&t&&s.hc(0,0,["*ngSwitchCase","true"])}function Ms(t,e){if(1&t&&(s.Tb(0,"span",9),s.uc(1,Es,2,1,"span",10),s.uc(2,Ts,1,0,"ng-content",11),s.Sb()),2&t){const t=s.dc();s.jc("ngSwitch",!!t.customTrigger),s.Cb(2),s.jc("ngSwitchCase",!0)}}function js(t,e){if(1&t){const t=s.Ub();s.Tb(0,"div",12),s.Tb(1,"div",13,14),s.ac("@transformPanel.done",(function(e){return s.mc(t),s.dc()._panelDoneAnimatingStream.next(e.toState)}))("keydown",(function(e){return s.mc(t),s.dc()._handleKeydown(e)})),s.hc(3,1),s.Sb(),s.Sb()}if(2&t){const t=s.dc();s.jc("@transformPanelWrap",void 0),s.Cb(1),s.Eb("mat-select-panel ",t._getPanelTheme(),""),s.rc("transform-origin",t._transformOrigin)("font-size",t._triggerFontSize,"px"),s.jc("ngClass",t.panelClass)("@transformPanel",t.multiple?"showing-multiple":"showing"),s.Db("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}}const Ns=[[["mat-select-trigger"]],"*"],Ps=["mat-select-trigger","*"],Bs={transformPanelWrap:Object(Ss.m)("transformPanelWrap",[Object(Ss.l)("* => void",Object(Ss.h)("@transformPanel",[Object(Ss.f)()],{optional:!0}))]),transformPanel:Object(Ss.m)("transformPanel",[Object(Ss.j)("void",Object(Ss.k)({transform:"scaleY(0.8)",minWidth:"100%",opacity:0})),Object(Ss.j)("showing",Object(Ss.k)({opacity:1,minWidth:"calc(100% + 32px)",transform:"scaleY(1)"})),Object(Ss.j)("showing-multiple",Object(Ss.k)({opacity:1,minWidth:"calc(100% + 64px)",transform:"scaleY(1)"})),Object(Ss.l)("void => *",Object(Ss.e)("120ms cubic-bezier(0, 0, 0.2, 1)")),Object(Ss.l)("* => void",Object(Ss.e)("100ms 25ms linear",Object(Ss.k)({opacity:0})))])};let Ds=0;const As=256,Vs=new s.r("mat-select-scroll-strategy"),Rs=new s.r("MAT_SELECT_CONFIG"),zs={provide:Vs,deps:[gs.c],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};class Ls{constructor(t,e){this.source=t,this.value=e}}class Fs{constructor(t,e,i,n,r){this._elementRef=t,this._defaultErrorStateMatcher=e,this._parentForm=i,this._parentFormGroup=n,this.ngControl=r}}const qs=Object(Co.o)(Object(Co.r)(Object(Co.p)(Object(Co.q)(Fs)))),Ws=new s.r("MatSelectTrigger");let $s=(()=>{class t extends qs{constructor(t,e,i,n,r,o,a,l,c,h,u,d,f,p){super(r,n,a,l,h),this._viewportRuler=t,this._changeDetectorRef=e,this._ngZone=i,this._dir=o,this._parentFormField=c,this.ngControl=h,this._liveAnnouncer=f,this._panelOpen=!1,this._required=!1,this._scrollTop=0,this._multiple=!1,this._compareWith=(t,e)=>t===e,this._uid="mat-select-"+Ds++,this._triggerAriaLabelledBy=null,this._destroy=new It.a,this._triggerFontSize=0,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+Ds++,this._transformOrigin="top",this._panelDoneAnimatingStream=new It.a,this._offsetY=0,this._positions=[{originX:"start",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"bottom",overlayX:"start",overlayY:"bottom"}],this._disableOptionCentering=!1,this._focused=!1,this.controlType="mat-select",this.ariaLabel="",this.optionSelectionChanges=Object(_s.a)(()=>{const t=this.options;return t?t.changes.pipe(Object(ws.a)(t),Object(xs.a)(()=>Object(Qo.a)(...t.map(t=>t.onSelectionChange)))):this._ngZone.onStable.pipe(Object(Ro.a)(1),Object(xs.a)(()=>this.optionSelectionChanges))}),this.openedChange=new s.o,this._openedStream=this.openedChange.pipe(Object(zo.a)(t=>t),Object(Zo.a)(()=>{})),this._closedStream=this.openedChange.pipe(Object(zo.a)(t=>!t),Object(Zo.a)(()=>{})),this.selectionChange=new s.o,this.valueChange=new s.o,this.ngControl&&(this.ngControl.valueAccessor=this),this._scrollStrategyFactory=d,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(u)||0,this.id=this.id,p&&(null!=p.disableOptionCentering&&(this.disableOptionCentering=p.disableOptionCentering),null!=p.typeaheadDebounceInterval&&(this.typeaheadDebounceInterval=p.typeaheadDebounceInterval))}get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}get required(){return this._required}set required(t){this._required=Object(bo.b)(t),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(t){this._multiple=Object(bo.b)(t)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(t){this._disableOptionCentering=Object(bo.b)(t)}get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){t!==this._value&&(this.options&&this._setSelectionByValue(t),this._value=t)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(t){this._typeaheadDebounceInterval=Object(bo.e)(t)}get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}ngOnInit(){this._selectionModel=new Bo.c(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Object(Cs.a)(),Object(Ot.a)(this._destroy)).subscribe(()=>{this.panelOpen?(this._scrollTop=0,this.openedChange.emit(!0)):(this.openedChange.emit(!1),this.overlayDir.offsetX=0,this._changeDetectorRef.markForCheck())}),this._viewportRuler.change().pipe(Object(Ot.a)(this._destroy)).subscribe(()=>{this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._changeDetectorRef.markForCheck())})}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(Object(Ot.a)(this._destroy)).subscribe(t=>{t.added.forEach(t=>t.select()),t.removed.forEach(t=>t.deselect())}),this.options.changes.pipe(Object(ws.a)(null),Object(Ot.a)(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby();if(t!==this._triggerAriaLabelledBy){const e=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?e.setAttribute("aria-labelledby",t):e.removeAttribute("aria-labelledby")}this.ngControl&&this.updateErrorState()}ngOnChanges(t){t.disabled&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){!this.disabled&&this.options&&this.options.length&&!this._panelOpen&&(this._triggerRect=this.trigger.nativeElement.getBoundingClientRect(),this._triggerFontSize=parseInt(getComputedStyle(this.trigger.nativeElement).fontSize||"0"),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._calculateOverlayPosition(),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this._ngZone.onStable.pipe(Object(Ro.a)(1)).subscribe(()=>{this._triggerFontSize&&this.overlayDir.overlayRef&&this.overlayDir.overlayRef.overlayElement&&(this.overlayDir.overlayRef.overlayElement.style.fontSize=this._triggerFontSize+"px")}))}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(t){this.value=t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(t=>t.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const e=t.keyCode,i=e===ys.b||e===ys.n||e===ys.g||e===ys.k,n=e===ys.d||e===ys.l,r=this._keyManager;if(!r.isTyping()&&n&&!Object(ys.q)(t)||(this.multiple||t.altKey)&&i)t.preventDefault(),this.open();else if(!this.multiple){const e=this.selected;r.onKeydown(t);const i=this.selected;i&&e!==i&&this._liveAnnouncer.announce(i.viewValue,1e4)}}_handleOpenKeydown(t){const e=this._keyManager,i=t.keyCode,n=i===ys.b||i===ys.n,r=e.isTyping();if(n&&t.altKey)t.preventDefault(),this.close();else if(r||i!==ys.d&&i!==ys.l||!e.activeItem||Object(ys.q)(t))if(!r&&this._multiple&&i===ys.a&&t.ctrlKey){t.preventDefault();const e=this.options.some(t=>!t.disabled&&!t.selected);this.options.forEach(t=>{t.disabled||(e?t.select():t.deselect())})}else{const i=e.activeItemIndex;e.onKeydown(t),this._multiple&&n&&t.shiftKey&&e.activeItem&&e.activeItemIndex!==i&&e.activeItem._selectViaInteraction()}else t.preventDefault(),e.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this.disabled||this.panelOpen||(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this.overlayDir.positionChange.pipe(Object(Ro.a)(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._calculateOverlayOffsetX(),this.panel.nativeElement.scrollTop=this._scrollTop})}_getPanelTheme(){return this._parentFormField?"mat-"+this._parentFormField.color:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this._setSelectionByValue(this.ngControl?this.ngControl.value:this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.multiple&&t)Array.isArray(t),this._selectionModel.clear(),t.forEach(t=>this._selectValue(t)),this._sortValues();else{this._selectionModel.clear();const e=this._selectValue(t);e?this._keyManager.updateActiveItem(e):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectValue(t){const e=this.options.find(e=>{try{return null!=e.value&&this._compareWith(e.value,t)}catch(i){return!1}});return e&&this._selectionModel.select(e),e}_initKeyManager(){this._keyManager=new bs.a(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.pipe(Object(Ot.a)(this._destroy)).subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.pipe(Object(Ot.a)(this._destroy)).subscribe(()=>{this._panelOpen&&this.panel?this._scrollActiveOptionIntoView():this._panelOpen||this.multiple||!this._keyManager.activeItem||this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=Object(Qo.a)(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Object(Ot.a)(t)).subscribe(t=>{this._onSelect(t.source,t.isUserInput),t.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Object(Qo.a)(...this.options.map(t=>t._stateChanges)).pipe(Object(Ot.a)(t)).subscribe(()=>{this._changeDetectorRef.markForCheck(),this.stateChanges.next()})}_onSelect(t,e){const i=this._selectionModel.isSelected(t);null!=t.value||this._multiple?(i!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),e&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),e&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),i!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((e,i)=>this.sortComparator?this.sortComparator(e,i,t):t.indexOf(e)-t.indexOf(i)),this.stateChanges.next()}}_propagateChanges(t){let e=null;e=this.multiple?this.selected.map(t=>t.value):this.selected?this.selected.value:t,this._value=e,this.valueChange.emit(e),this._onChange(e),this.selectionChange.emit(new Ls(this,e)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_scrollActiveOptionIntoView(){const t=this._keyManager.activeItemIndex||0,e=Object(Co.l)(t,this.options,this.optionGroups),i=this._getItemHeight();this.panel.nativeElement.scrollTop=Object(Co.m)((t+e)*i,i,this.panel.nativeElement.scrollTop,As)}focus(t){this._elementRef.nativeElement.focus(t)}_getOptionIndex(t){return this.options.reduce((e,i,n)=>void 0!==e?e:t===i?n:void 0,void 0)}_calculateOverlayPosition(){const t=this._getItemHeight(),e=this._getItemCount(),i=Math.min(e*t,As),n=e*t-i;let r=this.empty?0:this._getOptionIndex(this._selectionModel.selected[0]);r+=Object(Co.l)(r,this.options,this.optionGroups);const o=i/2;this._scrollTop=this._calculateOverlayScroll(r,o,n),this._offsetY=this._calculateOverlayOffsetY(r,o,n),this._checkOverlayWithinViewport(n)}_calculateOverlayScroll(t,e,i){const n=this._getItemHeight();return Math.min(Math.max(0,n*t-e+n/2),i)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._getLabelId();return this.ariaLabelledby?t+" "+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getLabelId(){var t;return(null===(t=this._parentFormField)||void 0===t?void 0:t.getLabelId())||""}_calculateOverlayOffsetX(){const t=this.overlayDir.overlayRef.overlayElement.getBoundingClientRect(),e=this._viewportRuler.getViewportSize(),i=this._isRtl(),n=this.multiple?56:32;let r;if(this.multiple)r=40;else{let t=this._selectionModel.selected[0]||this.options.first;r=t&&t.group?32:16}i||(r*=-1);const o=0-(t.left+r-(i?n:0)),s=t.right+r-e.width+(i?0:n);o>0?r+=o+8:s>0&&(r-=s+8),this.overlayDir.offsetX=Math.round(r),this.overlayDir.overlayRef.updatePosition()}_calculateOverlayOffsetY(t,e,i){const n=this._getItemHeight(),r=(n-this._triggerRect.height)/2,o=Math.floor(As/n);let s;return this._disableOptionCentering?0:(s=0===this._scrollTop?t*n:this._scrollTop===i?(t-(this._getItemCount()-o))*n+(n-(this._getItemCount()*n-As)%n):e-n/2,Math.round(-1*s-r))}_checkOverlayWithinViewport(t){const e=this._getItemHeight(),i=this._viewportRuler.getViewportSize(),n=this._triggerRect.top-8,r=i.height-this._triggerRect.bottom-8,o=Math.abs(this._offsetY),s=Math.min(this._getItemCount()*e,As)-o-this._triggerRect.height;s>r?this._adjustPanelUp(s,r):o>n?this._adjustPanelDown(o,n,t):this._transformOrigin=this._getOriginBasedOnOption()}_adjustPanelUp(t,e){const i=Math.round(t-e);this._scrollTop-=i,this._offsetY-=i,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop<=0&&(this._scrollTop=0,this._offsetY=0,this._transformOrigin="50% bottom 0px")}_adjustPanelDown(t,e,i){const n=Math.round(t-e);if(this._scrollTop+=n,this._offsetY+=n,this._transformOrigin=this._getOriginBasedOnOption(),this._scrollTop>=i)return this._scrollTop=i,this._offsetY=0,void(this._transformOrigin="50% top 0px")}_getOriginBasedOnOption(){const t=this._getItemHeight(),e=(t-this._triggerRect.height)/2;return`50% ${Math.abs(this._offsetY)-e+t/2}px 0px`}_getItemCount(){return this.options.length+this.optionGroups.length}_getItemHeight(){return 3*this._triggerFontSize}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;let t=this._getLabelId()+" "+this._valueId;return this.ariaLabelledby&&(t+=" "+this.ariaLabelledby),t}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(vs.d),s.Nb(s.i),s.Nb(s.A),s.Nb(Co.a),s.Nb(s.m),s.Nb(Lo.b,8),s.Nb(to.l,8),s.Nb(to.e,8),s.Nb(go.a,8),s.Nb(to.i,10),s.Yb("tabindex"),s.Nb(Vs),s.Nb(bs.f),s.Nb(Rs,8))},t.\u0275cmp=s.Hb({type:t,selectors:[["mat-select"]],contentQueries:function(t,e,i){var n;1&t&&(s.Gb(i,Ws,!0),s.Gb(i,Co.h,!0),s.Gb(i,Co.c,!0)),2&t&&(s.kc(n=s.bc())&&(e.customTrigger=n.first),s.kc(n=s.bc())&&(e.options=n),s.kc(n=s.bc())&&(e.optionGroups=n))},viewQuery:function(t,e){var i;1&t&&(s.zc(Is,!0),s.zc(ks,!0),s.zc(gs.a,!0)),2&t&&(s.kc(i=s.bc())&&(e.trigger=i.first),s.kc(i=s.bc())&&(e.panel=i.first),s.kc(i=s.bc())&&(e.overlayDir=i.first))},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","true",1,"mat-select"],hostVars:20,hostBindings:function(t,e){1&t&&s.ac("keydown",(function(t){return e._handleKeydown(t)}))("focus",(function(){return e._onFocus()}))("blur",(function(){return e._onBlur()})),2&t&&(s.Db("id",e.id)("tabindex",e.tabIndex)("aria-controls",e.panelOpen?e.id+"-panel":null)("aria-expanded",e.panelOpen)("aria-label",e.ariaLabel||null)("aria-required",e.required.toString())("aria-disabled",e.disabled.toString())("aria-invalid",e.errorState)("aria-describedby",e._ariaDescribedby||null)("aria-activedescendant",e._getAriaActiveDescendant()),s.Fb("mat-select-disabled",e.disabled)("mat-select-invalid",e.errorState)("mat-select-required",e.required)("mat-select-empty",e.empty)("mat-select-multiple",e.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],id:"id",disableOptionCentering:"disableOptionCentering",typeaheadDebounceInterval:"typeaheadDebounceInterval",placeholder:"placeholder",required:"required",multiple:"multiple",compareWith:"compareWith",value:"value",panelClass:"panelClass",ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",sortComparator:"sortComparator"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[s.Bb([{provide:go.c,useExisting:t},{provide:Co.d,useExisting:t}]),s.zb,s.Ab],ngContentSelectors:Ps,decls:9,vars:10,consts:[["cdk-overlay-origin","",1,"mat-select-trigger",3,"click"],["origin","cdkOverlayOrigin","trigger",""],[1,"mat-select-value",3,"ngSwitch"],["class","mat-select-placeholder",4,"ngSwitchCase"],["class","mat-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayMinWidth","cdkConnectedOverlayOffsetY","backdropClick","attach","detach"],[1,"mat-select-placeholder"],[1,"mat-select-value-text",3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-select-panel-wrap"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(t,e){if(1&t&&(s.ic(Ns),s.Tb(0,"div",0,1),s.ac("click",(function(){return e.toggle()})),s.Tb(3,"div",2),s.uc(4,Os,2,1,"span",3),s.uc(5,Ms,3,2,"span",4),s.Sb(),s.Tb(6,"div",5),s.Ob(7,"div",6),s.Sb(),s.Sb(),s.uc(8,js,4,14,"ng-template",7),s.ac("backdropClick",(function(){return e.close()}))("attach",(function(){return e._onAttached()}))("detach",(function(){return e.close()}))),2&t){const t=s.lc(1);s.Cb(3),s.jc("ngSwitch",e.empty),s.Db("id",e._valueId),s.Cb(1),s.jc("ngSwitchCase",!0),s.Cb(1),s.jc("ngSwitchCase",!1),s.Cb(3),s.jc("cdkConnectedOverlayScrollStrategy",e._scrollStrategy)("cdkConnectedOverlayOrigin",t)("cdkConnectedOverlayOpen",e.panelOpen)("cdkConnectedOverlayPositions",e._positions)("cdkConnectedOverlayMinWidth",null==e._triggerRect?null:e._triggerRect.width)("cdkConnectedOverlayOffsetY",e._offsetY)}},directives:[gs.b,n.m,n.n,gs.a,n.o,n.i],styles:[".mat-select{display:inline-block;width:100%;outline:none}.mat-select-trigger{display:inline-table;cursor:pointer;position:relative;box-sizing:border-box}.mat-select-disabled .mat-select-trigger{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.mat-select-value{display:table-cell;max-width:0;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-select-arrow-wrapper{display:table-cell;vertical-align:middle}.mat-form-field-appearance-fill .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-outline .mat-select-arrow-wrapper{transform:translateY(-25%)}.mat-form-field-appearance-standard.mat-form-field-has-label .mat-select:not(.mat-select-empty) .mat-select-arrow-wrapper{transform:translateY(-50%)}.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable.mat-form-field-appearance-standard .mat-select.mat-select-empty .mat-select-arrow-wrapper{transition:none}.mat-select-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;margin:0 4px}.mat-select-panel-wrap{flex-basis:100%}.mat-select-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;padding-top:0;padding-bottom:0;max-height:256px;min-width:100%;border-radius:4px}.cdk-high-contrast-active .mat-select-panel{outline:solid 1px}.mat-select-panel .mat-optgroup-label,.mat-select-panel .mat-option{font-size:inherit;line-height:3em;height:3em}.mat-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-form-field-flex{cursor:pointer}.mat-form-field-type-mat-select .mat-form-field-label{width:calc(100% - 18px)}.mat-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-select-placeholder{color:transparent;-webkit-text-fill-color:transparent;transition:none;display:block}\n"],encapsulation:2,data:{animation:[Bs.transformPanelWrap,Bs.transformPanel]},changeDetection:0}),t})(),Hs=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},providers:[zs],imports:[[n.c,gs.f,Co.i,Co.e],vs.a,go.d,Co.i,Co.e]}),t})();function Ys(t,e){if(1&t&&(s.Tb(0,"mat-option",11),s.wc(1),s.Sb()),2&t){const t=e.$implicit;s.jc("value",t.value),s.Cb(1),s.yc(" ",t.viewValue," ")}}function Xs(t,e){if(1&t&&(s.Rb(0),s.Rb(1,14),s.Tb(2,"tr"),s.Tb(3,"td",7),s.Tb(4,"mat-form-field",15),s.Tb(5,"mat-label"),s.wc(6,"Name"),s.Sb(),s.Ob(7,"input",2),s.Sb(),s.Sb(),s.Tb(8,"td",7),s.Tb(9,"mat-form-field",15),s.Tb(10,"mat-label"),s.wc(11,"Score"),s.Sb(),s.Ob(12,"input",16),s.Sb(),s.Sb(),s.Tb(13,"td",7),s.Tb(14,"button",17),s.Tb(15,"mat-icon"),s.wc(16,"clear"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Qb(),s.Qb()),2&t){const t=e.index;s.Cb(1),s.jc("formGroupName",t)}}function Us(t,e){if(1&t&&(s.Rb(0,12),s.uc(1,Xs,17,1,"ng-container",13),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngForOf",t.valueScores.controls)}}let Gs=(()=>{class t{constructor(t){this.formBuilder=t,this.profileItemTypes=[{value:"geo",viewValue:"geo"},{value:"list",viewValue:"list"},{value:"numeric",viewValue:"numeric"},{value:"diff",viewValue:"diff"},{value:"diffpercentage",viewValue:"diffpercentage"}]}ngOnInit(){this.profile&&(this.form=this.formBuilder.group({name:this.profile.name,itemType:this.profile.itemType,valueScores:this.formBuilder.array(this.getFormGroupsForValueScores())}))}getFormGroupsForValueScores(){return this.profile.scores.map(t=>this.createFormGroupForRow(t.name,t.score))}createFormGroupForRow(t,e){return this.formBuilder.group({score:[e,[]],name:[t,[]]})}get valueScores(){return this.form.get("valueScores")}getProfileItemData(){return{name:this.form.value.name,itemType:this.form.value.itemType,valueScores:this.getValueScores()}}getValueScores(){return this.valueScores.controls.map(t=>t.value).map(t=>({name:t.name,score:t.score}))}addRow(){this.valueScores.push(this.createFormGroupForRow(null,0))}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(to.c))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-item-form"]],inputs:{profile:"profile"},decls:28,vars:3,consts:[[3,"formGroup"],["appearance","standard",1,"w-full"],["matInput","","placeholder","Name","formControlName","name"],["appearance","fill"],["formControlName","itemType","name","itemType"],[3,"value",4,"ngFor","ngForOf"],[1,"mb-5","w-full"],[1,"py-2"],["formArrayName","valueScores","class","mt-10",4,"ngIf"],[1,"flex","justify-center","align-middle"],["mat-icon-button","","aria-label","Add new value/score pairs",3,"click"],[3,"value"],["formArrayName","valueScores",1,"mt-10"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["appearance","standard"],["matInput","","placeholder","Score","formControlName","score","type","number"],["mat-icon-button","","aria-label","Delete score"]],template:function(t,e){1&t&&(s.Tb(0,"form",0),s.Tb(1,"p"),s.Tb(2,"mat-form-field",1),s.Tb(3,"mat-label"),s.wc(4,"Profile Item Name"),s.Sb(),s.Ob(5,"input",2),s.Sb(),s.Sb(),s.Tb(6,"div"),s.Tb(7,"mat-form-field",3),s.Tb(8,"mat-label"),s.wc(9,"Profile Item Type"),s.Sb(),s.Tb(10,"mat-select",4),s.uc(11,Ys,2,2,"mat-option",5),s.Sb(),s.Sb(),s.Sb(),s.Tb(12,"div"),s.Tb(13,"table",6),s.Tb(14,"thead"),s.Tb(15,"tr"),s.Tb(16,"th",7),s.wc(17,"Value"),s.Sb(),s.Tb(18,"th",7),s.wc(19,"Score"),s.Sb(),s.Tb(20,"th",7),s.wc(21,"Actions"),s.Sb(),s.Sb(),s.Sb(),s.Tb(22,"tbody"),s.uc(23,Us,2,1,"ng-container",8),s.Sb(),s.Sb(),s.Sb(),s.Tb(24,"div",9),s.Tb(25,"button",10),s.ac("click",(function(){return e.addRow()})),s.Tb(26,"mat-icon"),s.wc(27,"add"),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&t&&(s.jc("formGroup",e.form),s.Cb(11),s.jc("ngForOf",e.profileItemTypes),s.Cb(12),s.jc("ngIf",e.valueScores))},directives:[to.p,to.k,to.e,go.b,go.e,To,to.a,to.j,to.d,$s,n.j,n.k,eo.a,ds.a,Co.h,to.b,to.f,to.n],styles:[""]}),t})(),Ks=(()=>{class t{constructor(t){this.dialogRef=t,this.profile={scores:[],childrenIds:[],id:"",itemType:"",name:"",originalId:"",parentIds:[]}}onNoClick(){this.dialogRef.close()}ok(){if(!this.profileItemForm.form.invalid){var t=this.profileItemForm.getProfileItemData();this.dialogRef.close(t)}}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(mo.g))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-new-profile-item-dialog"]],viewQuery:function(t,e){var i;1&t&&s.zc(Gs,!0),2&t&&s.kc(i=s.bc())&&(e.profileItemForm=i.first)},decls:11,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"profile"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(t,e){1&t&&(s.Tb(0,"h1",0),s.wc(1,"Create New Profile Item"),s.Sb(),s.Tb(2,"div",1),s.Tb(3,"p"),s.wc(4,"Enter New Profile Item Data"),s.Sb(),s.Ob(5,"dh-profile-item-form",2),s.Sb(),s.Tb(6,"div",3),s.Tb(7,"button",4),s.ac("click",(function(){return e.onNoClick()})),s.wc(8,"Cancel"),s.Sb(),s.Tb(9,"button",5),s.ac("click",(function(){return e.ok()})),s.wc(10,"Create"),s.Sb(),s.Sb()),2&t&&(s.Cb(5),s.jc("profile",e.profile))},directives:[mo.h,mo.e,Gs,mo.c,eo.a],styles:[""]}),t})(),Qs=(()=>{class t{transform(t,e){return null==t||null==e?null:0!=t.indexOf(e)?t:t.substr(e.length+1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Mb({name:"removeParentIdFromSubProfile",type:t,pure:!0}),t})();const Zs={provide:to.h,useExisting:Object(s.U)(()=>Js),multi:!0};let Js=(()=>{class t{constructor(){this.isDisabled=!1,this.propagateChange=t=>{},this.propagateTouched=t=>{}}writeValue(t){void 0!==t&&(this.value=t,this.propagateChange(this.value),this.propagateTouched(this.value))}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){this.propagateTouched=t}changeMade(t){this.propagateChange(t.value)}setDisabledState(t){this.isDisabled=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-slider-control"]],features:[s.Bb([Zs])],decls:1,vars:2,consts:[["thumbLabel","","tickInterval","1","min","1","max","100",3,"ngModel","disabled","ngModelChange","change"]],template:function(t,e){1&t&&(s.Tb(0,"mat-slider",0),s.ac("ngModelChange",(function(t){return e.value=t}))("change",(function(t){return e.changeMade(t)})),s.Sb()),2&t&&s.jc("ngModel",e.value)("disabled",e.isDisabled)},directives:[Jr.a,to.j,to.m],styles:[""]}),t})();function ta(t,e){if(1&t&&(s.Tb(0,"div",4),s.Rb(1,5),s.Tb(2,"label"),s.wc(3),s.ec(4,"removeParentIdFromSubProfile"),s.Sb(),s.Ob(5,"dh-slider-control",6),s.Qb(),s.Sb()),2&t){const t=e.index,i=s.dc();s.Cb(1),s.jc("formGroupName",t),s.Cb(2),s.xc(s.gc(4,2,i.subProfiles.controls[t].get("id").value,i.parentProfileId))}}let ea=(()=>{class t{constructor(t){this.formBuilder=t,this.removeParentIdFromSubProfile=new Qs}ngOnInit(){this.form=this.formBuilder.group({subProfiles:this.formBuilder.array(this.getFormGroupsForIds())})}get subProfiles(){return this.form.get("subProfiles")}getFormGroupsForIds(){return this.ids.map(t=>{const e=this.removeParentIdFromSubProfile.transform(t,this.parentProfileId);return this.formBuilder.group({id:[t,[]],weight:[this.weights[e],[]]})})}getChanges(){const t=this.subProfiles.controls.map(t=>t.value).reduce((t,e)=>(t[e.id]=e.weight,t),{});return this.ids.reduce((e,i)=>{const n=this.removeParentIdFromSubProfile.transform(i,this.parentProfileId),r=t[i];return r!=this.weights[n]&&(e[n]=r),e},{})}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(to.c))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-sub-profiles-edit"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights"},decls:5,vars:2,consts:[[1,"mt-10"],[3,"formGroup"],["formArrayName","subProfiles",1,"mt-10"],["class","mb-10",4,"ngFor","ngForOf"],[1,"mb-10"],[3,"formGroupName"],["formControlName","weight"]],template:function(t,e){1&t&&(s.Tb(0,"h3",0),s.wc(1,"Sub-Profiles:"),s.Sb(),s.Rb(2,1),s.Tb(3,"div",2),s.uc(4,ta,6,5,"div",3),s.Sb(),s.Qb()),2&t&&(s.Cb(2),s.jc("formGroup",e.form),s.Cb(2),s.jc("ngForOf",e.subProfiles.controls))},directives:[to.k,to.e,to.b,n.j,to.f,Js,to.j,to.d],pipes:[Qs],styles:[""]}),t})(),ia=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-item-score-chart"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t})();function na(t,e){if(1&t&&(s.Tb(0,"form",2),s.Tb(1,"mat-form-field",3),s.Tb(2,"mat-label"),s.wc(3,"Profile Item Name"),s.Sb(),s.Ob(4,"input",4),s.Sb(),s.Sb()),2&t){const t=s.dc();s.jc("formGroup",t.form)}}function ra(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"dh-profile-item-form",5),s.Ob(2,"dh-profile-item-score-chart"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("profile",t.profile)}}function oa(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"dh-sub-profiles-edit",6),s.Qb()),2&t){const t=e.ngIf,i=s.dc(2);s.Cb(1),s.jc("ids",null==i.profile?null:i.profile.childrenIds)("parentProfileId",null==i.profile?null:i.profile.id)("weights",t.weights[null==i.profile?null:i.profile.id])}}function sa(t,e){if(1&t&&(s.Rb(0),s.uc(1,oa,2,3,"ng-container",1),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngIf",s.fc(2,1,t.weightStateService.weightState$))}}let aa=(()=>{class t{constructor(t,e){this.formBuilder=t,this.weightStateService=e}ngOnInit(){this.form=this.formBuilder.group({name:this.profile.name})}getProfileName(){return this.form.value.name}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(to.c),s.Nb(fo))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-details-edit"]],viewQuery:function(t,e){var i;1&t&&(s.zc(ea,!0),s.zc(Gs,!0)),2&t&&(s.kc(i=s.bc())&&(e.subProfilesEditComponent=i.first),s.kc(i=s.bc())&&(e.profileItemFormComponent=i.first))},inputs:{profile:"profile"},decls:3,vars:3,consts:[["class","bg-gray-300 p-10",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"bg-gray-300","p-10",3,"formGroup"],[1,"w-full"],["matInput","","placeholder","Profile Item Name","formControlName","name","matInput","","placeholder","Ex. name of the object property"],[3,"profile"],[3,"ids","parentProfileId","weights"]],template:function(t,e){1&t&&(s.uc(0,na,5,1,"form",0),s.uc(1,ra,3,1,"ng-container",1),s.uc(2,sa,3,3,"ng-container",1)),2&t&&(s.jc("ngIf",null==(null==e.profile?null:e.profile.scores)||(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)<0),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[n.k,to.p,to.k,to.e,go.b,go.e,To,to.a,to.j,to.d,Gs,ia,ea],pipes:[n.b],styles:[""]}),t})(),la=(()=>{class t{constructor(t){this.store=t}updateName(t,e){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.i({profileId:t,updateProfileDto:{name:e}})).toPromise(),this.store.selectSnapshot(lo.a.getUpdateProfileNameError)}))}deleteProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.d(t)).toPromise(),null!=this.store.selectSnapshot(lo.a.getDeleteProfileError)}))}addSubProfile(t,e){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.c(t,e)).toPromise(),this.store.selectSnapshot(lo.a.getCreateChildProfileError)}))}addProfileItem(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.a(t)).toPromise(),this.store.selectSnapshot(lo.a.getErrorCreatingProfileItem)}))}updateProfileItem(t,e){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.h(t,e)).toPromise(),this.store.selectSnapshot(lo.a.getErrorUpdatingProfileItem)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(oo.h))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ca(t,e){if(1&t&&(s.Rb(0),s.Tb(1,"div"),s.wc(2),s.Sb(),s.Tb(3,"div"),s.wc(4),s.Sb(),s.Qb()),2&t){const t=e.ngIf,i=s.dc(2);s.Cb(2),s.yc(" ",t," "),s.Cb(2),s.yc(" ",i.weights[t]," ")}}function ha(t,e){if(1&t&&(s.Tb(0,"li"),s.uc(1,ca,5,2,"ng-container",1),s.ec(2,"removeParentIdFromSubProfile"),s.Sb()),2&t){const t=e.$implicit,i=s.dc();s.Cb(1),s.jc("ngIf",s.gc(2,1,t,i.parentProfileId))}}let ua=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-sub-profiles"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights"},decls:4,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(s.Tb(0,"h3"),s.wc(1,"Sub-Profiles:"),s.Sb(),s.Tb(2,"ul"),s.uc(3,ha,3,4,"li",0),s.Sb()),2&t&&(s.Cb(3),s.jc("ngForOf",e.ids))},directives:[n.j,n.k],pipes:[Qs],styles:[""]}),t})();function da(t,e){if(1&t&&(s.Tb(0,"div",4),s.wc(1),s.Sb()),2&t){const t=s.dc();s.Cb(1),s.yc("Id: ",(null==t.profile?null:t.profile.id)||"No Type","")}}function fa(t,e){if(1&t&&(s.Tb(0,"tr"),s.Tb(1,"th",6),s.wc(2),s.Sb(),s.Tb(3,"th",6),s.wc(4),s.Sb(),s.Sb()),2&t){const t=e.$implicit;s.Cb(2),s.xc(t.name),s.Cb(2),s.xc(t.score)}}function pa(t,e){if(1&t&&(s.Rb(0),s.Tb(1,"div",5),s.Tb(2,"table",4),s.Tb(3,"thead"),s.Tb(4,"tr"),s.Tb(5,"th",6),s.wc(6,"Value"),s.Sb(),s.Tb(7,"th",6),s.wc(8,"Score"),s.Sb(),s.Sb(),s.Sb(),s.Tb(9,"tbody"),s.uc(10,fa,5,2,"tr",7),s.Sb(),s.Sb(),s.Ob(11,"dh-profile-item-score-chart"),s.Sb(),s.Qb()),2&t){const t=s.dc();s.Cb(10),s.jc("ngForOf",null==t.profile?null:t.profile.scores)}}function ma(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"dh-sub-profiles",8),s.Qb()),2&t){const t=e.ngIf,i=s.dc(2);s.Cb(1),s.jc("ids",null==i.profile?null:i.profile.childrenIds)("parentProfileId",null==i.profile?null:i.profile.id)("weights",t.weights[null==i.profile?null:i.profile.id])}}function ga(t,e){if(1&t&&(s.Rb(0),s.uc(1,ma,2,3,"ng-container",3),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngIf",s.fc(2,1,t.weightStateService.weightState$))}}let va=(()=>{class t{constructor(t){this.weightStateService=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(fo))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-details-view"]],inputs:{profile:"profile"},decls:7,vars:5,consts:[[1,"mb-10","truncate"],[1,"mb-5","truncate"],["class","mb-5",4,"ngIf"],[4,"ngIf"],[1,"mb-5"],[1,"overflow-y-auto","limit-height"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"],[3,"ids","parentProfileId","weights"]],template:function(t,e){1&t&&(s.Tb(0,"h2",0),s.wc(1),s.Sb(),s.Tb(2,"div",1),s.wc(3),s.Sb(),s.uc(4,da,2,1,"div",2),s.uc(5,pa,12,1,"ng-container",3),s.uc(6,ga,3,3,"ng-container",3)),2&t&&(s.Cb(1),s.xc(null==e.profile?null:e.profile.name),s.Cb(2),s.yc("Item Type: ",(null==e.profile?null:e.profile.itemType)||"No Type",""),s.Cb(1),s.jc("ngIf",!((null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0)),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[n.k,n.j,ia,ua],pipes:[n.b],styles:[".limit-height[_ngcontent-%COMP%]{height:calc(100vh - 400px);max-height:calc(100vh - 400px)}"]}),t})();function ba(t,e){if(1&t){const t=s.Ub();s.Tb(0,"button",7),s.ac("click",(function(){return s.mc(t),s.dc(2).addChildProfile()})),s.wc(1,"Add Sub-Profile"),s.Sb()}}function ya(t,e){if(1&t){const t=s.Ub();s.Tb(0,"button",7),s.ac("click",(function(){return s.mc(t),s.dc(2).addProfileItem()})),s.wc(1,"Add Item"),s.Sb()}}function _a(t,e){if(1&t){const t=s.Ub();s.Tb(0,"button",7),s.ac("click",(function(){return s.mc(t),s.dc(2).isEdit=!0})),s.wc(1,"Edit"),s.Sb()}}function wa(t,e){if(1&t){const t=s.Ub();s.Tb(0,"button",7),s.ac("click",(function(){return s.mc(t),s.dc(2).saveEdit()})),s.wc(1,"Save"),s.Sb()}}function xa(t,e){if(1&t){const t=s.Ub();s.Tb(0,"button",8),s.ac("click",(function(){return s.mc(t),s.dc(2).isEdit=!1})),s.wc(1,"Cancel"),s.Sb()}}function Ca(t,e){if(1&t){const t=s.Ub();s.Tb(0,"button",9),s.ac("click",(function(){return s.mc(t),s.dc(2).deleteProfile()})),s.wc(1,"Delete"),s.Sb()}}function Sa(t,e){if(1&t&&s.Ob(0,"dh-profile-details-view",10),2&t){const t=s.dc(2);s.jc("profile",t.profile)}}function Ia(t,e){if(1&t&&s.Ob(0,"dh-profile-details-edit",10),2&t){const t=s.dc(2);s.jc("profile",t.profile)}}function ka(t,e){if(1&t&&(s.Rb(0),s.Tb(1,"div",2),s.uc(2,ba,2,0,"button",3),s.uc(3,ya,2,0,"button",3),s.uc(4,_a,2,0,"button",3),s.uc(5,wa,2,0,"button",3),s.uc(6,xa,2,0,"button",4),s.uc(7,Ca,2,0,"button",5),s.Sb(),s.uc(8,Sa,1,1,"dh-profile-details-view",6),s.uc(9,Ia,1,1,"dh-profile-details-edit",6),s.Qb()),2&t){const t=s.dc();s.Cb(2),s.jc("ngIf",!t.isEdit&&"profile"==(null==t.profile?null:t.profile.itemType)),s.Cb(1),s.jc("ngIf",!t.isEdit&&"profile"==(null==t.profile?null:t.profile.itemType)),s.Cb(1),s.jc("ngIf",!t.isEdit),s.Cb(1),s.jc("ngIf",t.isEdit),s.Cb(1),s.jc("ngIf",t.isEdit),s.Cb(1),s.jc("ngIf",!t.isEdit),s.Cb(1),s.jc("ngIf",!t.isEdit),s.Cb(1),s.jc("ngIf",t.isEdit)}}function Oa(t,e){1&t&&s.wc(0," No selected profile.\n")}let Ea=(()=>{class t{constructor(t,e,i){this.profileDetailsService=t,this.dhDialogService=e,this.weightStateService=i,this.isEdit=!1,this.pprofile=null}get profile(){return this.pprofile}set profile(t){this.isEdit=!1,this.pprofile=t}ngOnInit(){}saveEdit(){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const t=this.profileDetailsEdit.getProfileName();t!=this.profile.name&&null!=(yield this.profileDetailsService.updateName(this.profile.id,t))&&this.dhDialogService.showMessage("Failed updating profile name"),"profile"==this.profile.itemType?yield this.updateProfile():yield this.updateProfileItem(),this.isEdit=!1,this.dhDialogService.hideLoading()}))}updateProfileItem(){return Object(o.a)(this,void 0,void 0,(function*(){const t=this.profileDetailsEdit.profileItemFormComponent.getProfileItemData();null!=(yield this.profileDetailsService.updateProfileItem({profileId:this.profile.parentIds[0],profileItemUpdateDto:{itemType:t.itemType,name:t.name,values:t.valueScores}},this.profile.id))&&this.dhDialogService.showMessage("Failed updating profile item")}))}updateProfile(){return Object(o.a)(this,void 0,void 0,(function*(){const t=this.profileDetailsEdit.subProfilesEditComponent.getChanges(),e=Object.keys(t);if(e.length>0)for(const i of e){const e=t[i];null!=(yield this.weightStateService.updateItemLinkWeight({profileId:this.profile.id,updateProfileItemWeightDto:{profileItemName:i,newWeight:e}}))&&this.dhDialogService.showMessage(`Failed updating ${i} weight`)}}))}deleteProfile(){return Object(o.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({title:"Confirm Delete",message:"Are you sure you want to delete this profile?"}).toPromise()))return;this.dhDialogService.showLoading();const t=yield this.profileDetailsService.deleteProfile(this.profile.id);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(t?"Error deleting profile.":"Profile Deleted.")}))}addChildProfile(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.dhDialogService.openDialog(jo,300,{title:"Enter new Child Profile Name",label:"Profile Name",inputValue:""}).toPromise();if(null==t)return;this.dhDialogService.showLoading();const e=yield this.profileDetailsService.addSubProfile(this.profile.id,t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Sub Profile Added.":"Error adding Sub Profile.")}))}addProfileItem(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.dhDialogService.openDialog(Ks,700,null).toPromise();if(null==t)return;this.dhDialogService.showLoading();const e=yield this.profileDetailsService.addProfileItem({profileId:this.profile.id,profileItemCreateDto:{name:t.name,itemType:t.itemType,values:t.valueScores}});this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Profile Item Added.":"Error adding Profile Item.")}))}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(la),s.Nb(po.a),s.Nb(fo))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-details"]],viewQuery:function(t,e){var i;1&t&&s.zc(aa,!0),2&t&&s.kc(i=s.bc())&&(e.profileDetailsEdit=i.first)},inputs:{profile:"profile"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noProfile",""],[1,"flex","justify-end","mb-16","mt-3"],["class","mr-5","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","mr-5","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-5","mat-flat-button","","color","warn",3,"click",4,"ngIf"],[3,"profile",4,"ngIf"],["mat-flat-button","","color","primary",1,"mr-5",3,"click"],["mat-flat-button","",1,"mr-5",3,"click"],["mat-flat-button","","color","warn",1,"mr-5",3,"click"],[3,"profile"]],template:function(t,e){if(1&t&&(s.uc(0,ka,10,8,"ng-container",0),s.uc(1,Oa,1,0,"ng-template",null,1,s.vc)),2&t){const t=s.lc(2);s.jc("ngIf",e.profile)("ngIfElse",t)}},directives:[n.k,eo.a,va,aa],styles:[""]}),t})();function Ta(t,e){if(1&t){const t=s.Ub();s.Rb(0),s.Tb(1,"div",2),s.Ob(2,"dh-hierarchy-actions"),s.Ob(3,"dh-available-fields"),s.Sb(),s.Tb(4,"dh-hierarchy",3),s.ac("profileSelected",(function(e){return s.mc(t),s.dc(2).selectProfile(e)}))("linkClicked",(function(e){return s.mc(t),s.dc(2).linkClicked(e)}))("itemWeightChanged",(function(e){return s.mc(t),s.dc(2).itemWeightValueChanged(e)}))("childProfileWeightChanged",(function(e){return s.mc(t),s.dc(2).childProfileWeightValueChanged(e)}))("disconnectLinkClicked",(function(e){return s.mc(t),s.dc(2).disconnectLinkClicked(e)})),s.Sb(),s.Ob(5,"dh-profile-details",4),s.Qb()}if(2&t){const t=e.ngIf,i=s.dc().ngIf;s.Cb(4),s.jc("data",i.profiles)("weights",t.weights)("profileMap",i.profilesMap)("selectedProfile",i.selectedProfile),s.Cb(1),s.jc("profile",i.selectedProfile)}}function Ma(t,e){if(1&t&&(s.Rb(0),s.uc(1,Ta,6,5,"ng-container",1),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngIf",s.fc(2,1,t.profileVsService.weightState$))}}const ja=[{path:"",component:(()=>{class t{constructor(t,e,i){this.profileVsService=t,this.weightStateService=e,this.dhDialogService=i}ngOnInit(){return Object(o.a)(this,void 0,void 0,(function*(){this.profileVsService.keyChanged$.subscribe(()=>Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var t=yield this.profileVsService.getProfiles();this.dhDialogService.hideLoading(),"error"==t&&this.dhDialogService.showMessage("error loading profile")})))}))}selectProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){yield this.profileVsService.selectProfile(t.selectedNodeId),Object(s.lb)(this)}))}linkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){this.hierarchyComponent.showWeightSlider()}))}itemWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var e=yield this.weightStateService.updateItemLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating item weight":"Item weight updated")}))}childProfileWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var e=yield this.profileVsService.updateChildProfileLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating child profile weight":"Child profile weight updated")}))}disconnectLinkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){if(yield this.dhDialogService.showConfirmation({title:"Disconnect Sub Profile",message:"Are you sure you want to disconnect these profiles?"}).toPromise()){var e=yield this.profileVsService.disconectSubProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error disconnecting sub profile":"Sub Profile Disconnected")}}))}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(uo),s.Nb(fo),s.Nb(po.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile"]],viewQuery:function(t,e){var i;1&t&&s.zc(ro,!0),2&t&&s.kc(i=s.bc())&&(e.hierarchyComponent=i.first)},decls:3,vars:3,consts:[[1,"flex"],[4,"ngIf"],[1,"block","border-r-4","px-10","text-base",2,"width","290px"],[1,"block","flex-1","overflow-hidden",3,"data","weights","profileMap","selectedProfile","profileSelected","linkClicked","itemWeightChanged","childProfileWeightChanged","disconnectLinkClicked"],[1,"block","border-l-4","px-10","text-base",2,"width","490px",3,"profile"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.uc(1,Ma,3,3,"ng-container",1),s.ec(2,"async"),s.Sb()),2&t&&(s.Cb(1),s.jc("ngIf",s.fc(2,1,e.profileVsService.profileState$)))},directives:[n.k,Po,ms,ro,Ea],pipes:[n.b],styles:["dh-hierarchy[_ngcontent-%COMP%]{height:calc(100vh - 76px)}"]}),t})()}];let Na=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[r.a.forChild(ja)],r.a]}),t})();var Pa=i("W1gw");let Ba=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[n.c,Jr.b,to.g,to.o]]}),t})(),Da=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},providers:[po.a],imports:[[n.c,Na,to.g,to.o,Jr.b,eo.b,go.d,Mo,Pa.b,cs,ds.b,mo.f,Ba,Hs]]}),t})()}}]);