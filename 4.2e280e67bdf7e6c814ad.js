(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"723k":function(t,e,n){"use strict";n.r(e),n.d(e,"ProfileModule",(function(){return fs}));var i=n("2kYt"),r=n("sEIs"),o=n("D57K"),s=n("EM62");class a{constructor(t){this.base=t}[Symbol.iterator](){return this.base[Symbol.iterator]()}concat(...t){return h(function*(t){for(const e of t)yield*e}([this,...t.map(h)]))}entries(){return h(function*(t){let e=0;for(const n of t)yield[e++,n]}(this))}every(t){return!this.some((e,n)=>!t(e,n))}fill(t){return this.map(()=>t)}filter(t){return h(function*(e){for(const[n,i]of e)t(i,n)&&(yield i)}(this.entries()))}find(t){for(const[e,n]of this.entries())if(t(n,e))return n}findIndex(t){for(const[e,n]of this.entries())if(t(n,e))return e;return-1}flatMap(t){return h(function*(e){for(const[n,i]of e)yield*h(t(i,n))}(this.entries()))}forEach(t){for(const[e,n]of this.entries())t(n,e)}includes(t,e=0){return this.indexOf(t,e)>=0}indexOf(t,e=0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");for(const[n,i]of this.entries())if(n>=e&&i===t)return n;return-1}join(t=","){return[...this].join(t)}keys(){return h(function*(t){let e=0;for(const n of t)yield e++}(this))}lastIndexOf(t,e=1/0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");let n=-1;for(const[i,r]of this.entries())i<=e&&r===t&&(n=i);return n}get length(){return this.reduce(t=>t+1,0)}map(t){return h(function*(e){for(const[n,i]of e)yield t(i,n)}(this.entries()))}reduce(t,e){if(void 0===e){const e=t;let n=!0,i=void 0;for(const[t,r]of this.entries())n?(i=r,n=!1):i=e(i,r,t);if(n)throw new TypeError("Reduce of empty iterable with no initial value");return i}{const n=t;let i=e;for(const[t,e]of this.entries())i=n(i,e,t);return i}}reverse(){return h([...this].reverse())}slice(t=0,e=1/0){return h(function*(n){for(const[i,r]of n)if(i<t);else{if(!(i<e))break;yield r}}(this.entries()))}some(t){for(const[e,n]of this.entries())if(t(n,e))return!0;return!1}sort(t){return h([...this].sort(t))}splice(t,e=0,...n){return h(function*(i){for(const[r,o]of i)r===t&&(yield*n),(r<t||r>=t+e)&&(yield o)}(this.entries()))}values(){return this}}function h(t){return function(t){return"function"==typeof t[Symbol.iterator]}(t)?new a(t):new a({[Symbol.iterator]:()=>t})}function l(t,e){e.size<t.size&&([e,t]=[t,e]);for(const n of t)if(e.has(n))return!0;return!1}class c extends Map{getThrow(t){const e=this.get(t);if(void 0===e)throw new Error("map doesn't contain key: "+t);return e}getDefault(t,e){const n=this.get(t);return void 0===n?e:n}setIfAbsent(t,e){const n=this.get(t);return void 0===n?(this.set(t,e),e):n}}class u{constructor(t,e,n=[]){this.child=t,this.data=e,this.points=n}}class f{constructor(t,e,n,i){this.source=t,this.target=e,this.data=n,this.points=i}}class d{constructor(t,e){this.id=t,this.data=e,this.dataChildren=[]}iroots(){return h([this])}roots(){return[this]}*iterChildren(){for(const{child:t}of this.dataChildren)yield t}ichildren(){return h(this.iterChildren())}children(){return[...this.ichildren()]}*iterChildLinks(){for(const{child:t,data:e,points:n}of this.dataChildren)yield new f(this,t,e,n)}ichildLinks(){return h(this.iterChildLinks())}childLinks(){return[...this.ichildLinks()]}[Symbol.iterator](){return new p([this])[Symbol.iterator]()}idescendants(t="depth"){return new p([this]).idescendants(t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return new p([this]).ilinks()}links(){return[...this.ilinks()]}size(){return new p([this]).size()}sum(t){return new p([this]).sum(t),this}count(){return new p([this]).count(),this}height(){return new p([this]).height(),this}depth(){return new p([this]).depth(),this}split(){return[this]}connected(){return!0}}class p{constructor(t){this.dagRoots=t}[Symbol.iterator](){return this.idepth()}iroots(){return h(this.dagRoots)}roots(){return this.dagRoots.slice()}*idepth(){const t=this.roots(),e=new Set;let n;for(;n=t.pop();)e.has(n.id)||(e.add(n.id),yield n,t.push(...n.ichildren()))}*ibreadth(){const t=new Set;let e=this.roots(),n=[];do{let i;for(n=e.reverse(),e=[];i=n.pop();)t.has(i.id)||(t.add(i.id),yield i,e.push(...i.ichildren()))}while(e.length)}*ibefore(){const t=new c;for(const i of this)for(const e of i.ichildren())t.set(e.id,t.getDefault(e.id,0)+1);const e=this.roots();let n;for(;n=e.pop();){yield n;for(const i of n.ichildren()){const n=t.getThrow(i.id);n>1?t.set(i.id,n-1):e.push(i)}}}*iafter(){const t=this.roots(),e=new Set;let n;for(;n=t.pop();)e.has(n.id)||(n.ichildren().every(t=>e.has(t.id))?(e.add(n.id),yield n):(t.push(n),t.push(...n.ichildren())))}idescendants(t="depth"){if("depth"===t)return h(this.idepth());if("breadth"===t)return h(this.ibreadth());if("before"===t)return h(this.ibefore());if("after"===t)return h(this.iafter());throw new Error("unknown iteration style: "+t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return this.idescendants().flatMap(t=>t.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(t=>t+1,0)}sum(t){const e=new c;for(const[n,i]of this.idescendants("after").entries()){const r=t(i,n),o=new c;o.set(i.id,r);for(const t of i.ichildren()){const n=e.getThrow(t.id);for(const[t,e]of n.entries())o.set(t,e)}i.value=h(o.entries()).map(([,t])=>t).reduce((t,e)=>t+e),e.set(i.id,o)}return this}count(){const t=new c;for(const e of this.idescendants("after"))if(e.ichildren()[Symbol.iterator]().next().done)t.set(e.id,new Set([e.id])),e.value=1;else{const n=new Set;for(const i of e.ichildren()){const e=t.getThrow(i.id);for(const t of e)n.add(t)}t.set(e.id,n),e.value=n.size}return this}height(){for(const t of this.idescendants("after"))t.value=Math.max(0,...t.ichildren().map(t=>{if(void 0===t.value)throw new Error("`after` iteration didn't iterate in after order");return t.value+1}));return this}depth(){const t=new c;for(const e of this)for(const n of e.ichildren())t.setIfAbsent(n.id,[]).push(e);for(const e of this.idescendants("before"))e.value=Math.max(0,...t.getDefault(e.id,[]).map(t=>{if(void 0===t.value)throw new Error("`before` iteration didn't iterate in before order");return t.value+1}));return this}split(){const t=new c,e=new c;for(const r of this.iroots())t.set(r.id,[]),e.set(r.id,new Set(r.idescendants().map(t=>t.id)));for(const[r,o]of this.iroots().entries()){const n=e.getThrow(o.id);for(const i of this.iroots().slice(r+1))l(n,e.getThrow(i.id))&&(t.getThrow(o.id).push(i),t.getThrow(i.id).push(o))}const n=[],i=new Set;for(const r of this.iroots())if(!i.has(r.id)){i.add(r.id);const e=[r];n.push(e);const o=t.getThrow(r.id).slice();let s;for(;s=o.pop();)i.has(s.id)||(i.add(s.id),e.push(s),o.push(...t.getThrow(s.id)))}return n.map(t=>t.length>1?new p(t):t[0])}connected(){return 1===this.split().length}}function v(t){function e(e,n){return(t(e,n)||[]).map(t=>[t,void 0])}return e.wrapped=t,e}function g(t){if(function(t){try{return"string"==typeof t.id}catch(e){return!1}}(t))return t.id;throw new Error("default id function expected datum to have an id field but got: "+t)}function m(t){if(function(t){try{const e=t.parentIds;return void 0===e||e instanceof Array&&e.every(t=>"string"==typeof t)}catch(e){return!1}}(t))return t.parentIds;throw new Error("default parentIds function expected datum to have a parentIds field but got: "+t)}let y,b,w=1e-60;do{w+=w,y=1+.1*w,b=1+.2*w}while(y<=1||b<=1);var x=w,_=function(t,e,n,i=[],r=0,o=[0,0]){const s=[],a=[],h=[],l=[],c=[],u=[];let f="";const d=t.length-1,p=n[1].length-1;if(!i)for(let g=1;g<=p;g+=1)i[g]=0;if(d!==t[1].length-1&&(f="Dmat is not symmetric!"),d!==e.length-1&&(f="Dmat and dvec are incompatible!"),d!==n.length-1&&(f="Amat and dvec are incompatible!"),p!==i.length-1&&(f="Amat and bvec are incompatible!"),(r>p||r<0)&&(f="Value of meq is invalid!"),""!==f)return{message:f};for(let g=1;g<=p;g+=1)a[g]=0,l[g]=0;const v=Math.min(d,p);for(let g=1;g<=d;g+=1)h[g]=0;s[1]=0;for(let g=1;g<=2*d+v*(v+5)/2+2*p+1;g+=1)c[g]=0;for(let g=1;g<=2;g+=1)u[g]=0;return function(t,e,n,i,r,o,s,a,h,l,c,u,f,d=0,p,v,g){let m,y,b,w,_,I,C,S,k,E,M,T,O,B;const j=Math.min(i,c);let z=2*i+j*(j+5)/2+2*c+1;for(let x=1;x<=i;x+=1)v[x]=e[x];for(let x=i+1;x<=z;x+=1)v[x]=0;for(let x=1;x<=c;x+=1)f[x]=0,o[x]=0;const P=[];if(0===g[1]){if(function(t,e,n,i){let r,o,s;for(let a=1;a<=n;a+=1){if(i[1]=a,s=0,r=a-1,r<1){if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}else{for(let e=1;e<=r;e+=1){o=t[e][a];for(let n=1;n<e;n+=1)o-=t[n][a]*t[n][e];o/=t[e][e],t[e][a]=o,s+=o*o}if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}i[1]=0}}(t,0,i,P),0!==P[1])return void(g[1]=2);(function(t,e,n,i){let r,o;for(r=1;r<=n;r+=1){o=0;for(let e=1;e<r;e+=1)o+=t[e][r]*i[e];i[r]=(i[r]-o)/t[r][r]}for(let s=1;s<=n;s+=1){r=n+1-s,i[r]/=t[r][r],o=-i[r];for(let e=1;e<r;e+=1)i[e]+=o*t[e][r]}})(t,0,i,e),function(t,e,n){let i,r;for(let o=1;o<=n;o+=1){t[o][o]=1/t[o][o],r=-t[o][o];for(let e=1;e<o;e+=1)t[e][o]*=r;if(i=o+1,n<i)break;for(let e=i;e<=n;e+=1){r=t[o][e],t[o][e]=0;for(let n=1;n<=o;n+=1)t[n][e]+=r*t[n][o]}}}(t,0,i)}else{for(let n=1;n<=i;n+=1){r[n]=0;for(let i=1;i<=n;i+=1)r[n]+=t[i][n]*e[i]}for(let n=1;n<=i;n+=1){e[n]=0;for(let o=n;o<=i;o+=1)e[n]+=t[n][o]*r[o]}}s[1]=0;for(let x=1;x<=i;x+=1){r[x]=e[x],s[1]+=v[x]*r[x],v[x]=0;for(let e=x+1;e<=i;e+=1)t[e][x]=0}s[1]=-s[1]/2,g[1]=0;const V=i,A=V+i,N=A+j,R=N+j+1,L=R+j*(j+1)/2,D=L+c;for(let x=1;x<=c;x+=1){I=0;for(let t=1;t<=i;t+=1)I+=a[t][x]*a[t][x];v[D+x]=Math.sqrt(I)}function W(){p[1]+=1,z=L;for(let t=1;t<=c;t+=1){z+=1,I=-h[t];for(let e=1;e<=i;e+=1)I+=a[e][t]*r[e];if(Math.abs(I)<x&&(I=0),t>u)v[z]=I;else if(v[z]=-Math.abs(I),I>0){for(let e=1;e<=i;e+=1)a[e][t]=-a[e][t];h[t]=-h[t]}}for(let t=1;t<=w;t+=1)v[L+f[t]]=0;b=0,_=0;for(let t=1;t<=c;t+=1)v[L+t]<_*v[D+t]&&(b=t,_=v[L+t]/v[D+t]);if(0===b){for(let t=1;t<=w;t+=1)o[f[t]]=v[N+t];return 999}return 0}function $(){for(let e=1;e<=i;e+=1){I=0;for(let n=1;n<=i;n+=1)I+=t[n][e]*a[n][b];v[e]=I}m=V;for(let t=1;t<=i;t+=1)v[m+t]=0;for(let e=w+1;e<=i;e+=1)for(let n=1;n<=i;n+=1)v[m+n]=v[m+n]+t[n][e]*v[e];T=!0;for(let t=w;t>=1;t-=1){I=v[t],z=R+t*(t+3)/2,m=z-t;for(let e=t+1;e<=w;e+=1)I-=v[z]*v[A+e],z+=e;I/=v[m],v[A+t]=I,f[t]<=u||I<=0||(T=!1,y=t)}if(!T){C=v[N+y]/v[A+y];for(let t=1;t<=w;t+=1)f[t]<=u||v[A+t]<=0||(_=v[N+t]/v[A+t],_<C&&(C=_,y=t))}I=0;for(let t=V+1;t<=V+i;t+=1)I+=v[t]*v[t];if(Math.abs(I)<=x){if(T)return g[1]=1,999;for(let t=1;t<=w;t+=1)v[N+t]=v[N+t]-C*v[A+t];return v[N+w+1]=v[N+w+1]+C,700}I=0;for(let t=1;t<=i;t+=1)I+=v[V+t]*a[t][b];S=-v[L+b]/I,O=!0,T||C<S&&(S=C,O=!1);for(let t=1;t<=i;t+=1)r[t]+=S*v[V+t],Math.abs(r[t])<x&&(r[t]=0);s[1]+=S*I*(S/2+v[N+w+1]);for(let t=1;t<=w;t+=1)v[N+t]=v[N+t]-S*v[A+t];if(v[N+w+1]=v[N+w+1]+S,!O){I=-h[b];for(let t=1;t<=i;t+=1)I+=r[t]*a[t][b];if(b>u)v[L+b]=I;else if(v[L+b]=-Math.abs(I),I>0){for(let t=1;t<=i;t+=1)a[t][b]=-a[t][b];h[b]=-h[b]}return 700}w+=1,f[w]=b,z=R+(w-1)*w/2+1;for(let t=1;t<=w-1;t+=1)v[z]=v[t],z+=1;if(w===i)v[z]=v[i];else{for(let e=i;e>=w+1;e-=1)if(0!==v[e]&&(k=Math.max(Math.abs(v[e-1]),Math.abs(v[e])),E=Math.min(Math.abs(v[e-1]),Math.abs(v[e])),_=v[e-1]>=0?Math.abs(k*Math.sqrt(1+E*E/(k*k))):-Math.abs(k*Math.sqrt(1+E*E/(k*k))),k=v[e-1]/_,E=v[e]/_,1!==k))if(0===k){v[e-1]=E*_;for(let n=1;n<=i;n+=1)_=t[n][e-1],t[n][e-1]=t[n][e],t[n][e]=_}else{v[e-1]=_,M=E/(1+k);for(let n=1;n<=i;n+=1)_=k*t[n][e-1]+E*t[n][e],t[n][e]=M*(t[n][e-1]+_)-t[n][e],t[n][e-1]=_}v[z]=v[w]}return 0}function F(){if(z=R+y*(y+1)/2+1,m=z+y,0===v[m])return 798;if(k=Math.max(Math.abs(v[m-1]),Math.abs(v[m])),E=Math.min(Math.abs(v[m-1]),Math.abs(v[m])),_=v[m-1]>=0?Math.abs(k*Math.sqrt(1+E*E/(k*k))):-Math.abs(k*Math.sqrt(1+E*E/(k*k))),k=v[m-1]/_,E=v[m]/_,1===k)return 798;if(0===k){for(let t=y+1;t<=w;t+=1)_=v[m-1],v[m-1]=v[m],v[m]=_,m+=t;for(let e=1;e<=i;e+=1)_=t[e][y],t[e][y]=t[e][y+1],t[e][y+1]=_}else{M=E/(1+k);for(let t=y+1;t<=w;t+=1)_=k*v[m-1]+E*v[m],v[m]=M*(v[m-1]+_)-v[m],v[m-1]=_,m+=t;for(let e=1;e<=i;e+=1)_=k*t[e][y]+E*t[e][y+1],t[e][y+1]=M*(t[e][y]+_)-t[e][y+1],t[e][y]=_}return 0}function q(){m=z-y;for(let t=1;t<=y;t+=1)v[m]=v[z],z+=1,m+=1;return v[N+y]=v[N+y+1],f[y]=f[y+1],y+=1,y<w?797:0}function H(){return v[N+w]=v[N+w+1],v[N+w+1]=0,f[w]=0,w-=1,p[2]+=1,0}for(w=d,p[1]=0,p[2]=0,B=0;;){if(B=W(),999===B)return;for(;B=$(),0!==B;){if(999===B)return;if(700===B)if(y===w)H();else{for(;F(),B=q(),797===B;);H()}}}}(t,e,0,d,h,l,s,n,i,0,p,r,a,0,u,c,o),1===o[1]&&(f="constraints are inconsistent, no solution!"),2===o[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:h,Lagrangian:l,value:s,unconstrained_solution:e,iterations:u,iact:a,message:f}};function I(t,e){let[n,...i]=t,r=n.x=0;for(const o of i)r=o.x=r+e(n,o),n=o;if(r>0)for(const o of t)o.x/=r;else for(const o of t)o.x=.5}function C(t,e,n,i){t[n][n]+=i,t[n][e]-=i,t[e][n]-=i,t[e][e]+=i}function S(t,e,n,i,r){t[i][i]+=r,t[i][n]-=2*r,t[i][e]+=r,t[n][i]-=2*r,t[n][n]+=4*r,t[n][e]-=2*r,t[e][i]+=r,t[e][n]-=2*r,t[e][e]+=r}class k extends d{constructor(t){super(t,void 0)}}function E(t,e,n,i){this.feasible=n,this.evaluation=e,this.bounded=i,this._tableau=t}var M=E;function T(t,e,n,i,r){M.call(this,t,e,n,i),this.iter=r}E.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,n=e.varIndexByRow,i=e.variablesPerIndex,r=e.matrix,o=e.rhsColumn,s=e.height-1,a=Math.round(1/e.precision),h=1;h<=s;h+=1){var l=i[n[h]];void 0!==l&&!0!==l.isSlack&&(t[l.id]=Math.round((Number.EPSILON+r[h][o])*a)/a)}return t};var O=T;function B(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}T.prototype=Object.create(M.prototype),T.constructor=T;var j=B;function z(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var n=0;n<e;n+=1)this.reducedCosts[n]=0}B.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},z.prototype.copy=function(){var t=new z(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},B.prototype.setOptionalObjective=function(t,e,n){var i=this.objectivesByPriority[t];void 0===i&&(i=new z(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=i,this.optionalObjectives.push(i),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),i.reducedCosts[e]=n},B.prototype.initialize=function(t,e,n,i){this.variables=n,this.unrestrictedVars=i,this.width=t,this.height=e;for(var r=new Array(t),o=0;o<t;o++)r[o]=0;this.matrix=new Array(e);for(var s=0;s<e;s++)this.matrix[s]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},B.prototype._resetMatrix=function(){var t,e,n=this.model.variables,i=this.model.constraints,r=n.length,o=i.length,s=this.matrix[0],a=!0===this.model.isMinimization?-1:1;for(t=0;t<r;t+=1){var h=n[t],l=h.priority,c=a*h.cost;0===l?s[t+1]=c:this.setOptionalObjective(l,t+1,c),this.rowByVarIndex[e=n[t].index]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var u=1,f=0;f<o;f+=1){var d,p,v=i[f],g=v.index;this.rowByVarIndex[g]=u,this.colByVarIndex[g]=-1,this.varIndexByRow[u]=g;var m=v.terms,y=m.length,b=this.matrix[u++];if(v.isUpperBound){for(d=0;d<y;d+=1)b[this.colByVarIndex[(p=m[d]).variable.index]]=p.coefficient;b[0]=v.rhs}else{for(d=0;d<y;d+=1)b[this.colByVarIndex[(p=m[d]).variable.index]]=-p.coefficient;b[0]=-v.rhs}}},B.prototype.setModel=function(t){return this.model=t,this.initialize(t.nVariables+1,t.nConstraints+1,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},B.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},B.prototype.density=function(){for(var t=0,e=this.matrix,n=0;n<this.height;n++)for(var i=e[n],r=0;r<this.width;r++)0!==i[r]&&(t+=1);return t/(this.height*this.width)},B.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*t)/t;this.evaluation=e,0===this.simplexIters&&(this.bestPossibleEval=e)},B.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new O(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new M(this,t,this.feasible,this.bounded)},j.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},j.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],n=this.matrix,i=this.rhsColumn,r=this.width-1,o=this.height-1,s=0;;){for(var a=0,h=-this.precision,l=1;l<=o;l++){var c=n[l][i];c<h&&(h=c,a=l)}if(0===a)return this.feasible=!0,s;for(var u=0,f=-1/0,d=n[0],p=n[a],v=1;v<=r;v++){var g=p[v];if(!0===this.unrestrictedVars[this.varIndexByCol[v]]||g<-this.precision){var m=-d[v]/g;f<m&&(f=m,u=v)}}if(0===u)return this.feasible=!1,s;if(t){e.push([this.varIndexByRow[a],this.varIndexByCol[u]]);var y=this.checkForCycles(e);if(y.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+y[0]),this.model.messages.push("Length :"+y[1]),this.feasible=!1,s}this.pivot(a,u),s+=1}},j.prototype.phase2=function(){for(var t,e,n=this.model.checkForCycles,i=[],r=this.matrix,o=this.rhsColumn,s=this.width-1,a=this.height-1,h=this.precision,l=this.optionalObjectives.length,c=null,u=0;;){var f=r[this.costRowIndex];l>0&&(c=[]);for(var d=0,p=h,v=!1,g=1;g<=s;g++)t=f[g],e=!0===this.unrestrictedVars[this.varIndexByCol[g]],l>0&&-h<t&&t<h?c.push(g):e&&t<0?-t>p&&(p=-t,d=g,v=!0):t>p&&(p=t,d=g,v=!1);if(l>0)for(var m=0;0===d&&c.length>0&&m<l;){var y=[],b=this.optionalObjectives[m].reducedCosts;p=h;for(var w=0;w<c.length;w++)e=!0===this.unrestrictedVars[this.varIndexByCol[g=c[w]]],-h<(t=b[g])&&t<h?y.push(g):e&&t<0?-t>p&&(p=-t,d=g,v=!0):t>p&&(p=t,d=g,v=!1);c=y,m+=1}if(0===d)return this.setEvaluation(),this.simplexIters+=1,u;for(var x=0,_=1/0,I=1;I<=a;I++){var C=r[I],S=C[o],k=C[d];if(!(-h<k&&k<h)){if(k>0&&h>S&&S>-h){_=0,x=I;break}var E=v?-S/k:S/k;E>h&&_>E&&(_=E,x=I)}}if(_===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[d],u;if(n){i.push([this.varIndexByRow[x],this.varIndexByCol[d]]);var M=this.checkForCycles(i);if(M.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+M[0]),this.model.messages.push("Length :"+M[1]),this.feasible=!1,u}this.pivot(x,d,!0),u+=1}};var P=[];function V(t,e,n,i){this.id=t,this.cost=e,this.index=n,this.value=0,this.priority=i}function A(t,e,n,i){V.call(this,t,e,n,i)}function N(t,e){V.call(this,t,0,e,0)}function R(t,e){this.variable=t,this.coefficient=e}function L(t,e,n){return 0===n||"required"===n?null:(e=e||1,n=n||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,n))}function D(t,e,n,i){this.slack=new N("s"+n,n),this.index=n,this.model=i,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function W(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}j.prototype.pivot=function(t,e){var n=this.matrix,i=n[t][e],r=this.height-1,o=this.width-1,s=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=s,this.rowByVarIndex[a]=t,this.rowByVarIndex[s]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[s]=e;for(var h,l,c,u=n[t],f=0,d=0;d<=o;d++)u[d]>=-1e-16&&u[d]<=1e-16?u[d]=0:(u[d]/=i,P[f]=d,f+=1);u[e]=1/i;for(var p=0;p<=r;p++)if(p!==t&&!(n[p][e]>=-1e-16&&n[p][e]<=1e-16)){var v=n[p];if((h=v[e])>=-1e-16&&h<=1e-16)0!==h&&(v[e]=0);else{for(l=0;l<f;l++)(c=u[d=P[l]])>=-1e-16&&c<=1e-16?0!==c&&(u[d]=0):v[d]=v[d]-h*c;v[e]=-h/i}}var g=this.optionalObjectives.length;if(g>0)for(var m=0;m<g;m+=1){var y=this.optionalObjectives[m].reducedCosts;if(0!==(h=y[e])){for(l=0;l<f;l++)0!==(c=u[d=P[l]])&&(y[d]=y[d]-h*c);y[e]=-h/i}}},j.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var n=e+1;n<t.length;n++){var i=t[e],r=t[n];if(i[0]===r[0]&&i[1]===r[1]){if(n-e>t.length-n)break;for(var o=!0,s=1;s<n-e;s++){var a=t[e+s],h=t[n+s];if(a[0]!==h[0]||a[1]!==h[1]){o=!1;break}}if(o)return[e,n-e]}}return[]},A.prototype.isInteger=!0,N.prototype.isSlack=!0,D.prototype.addTerm=function(t,e){var n=e.index,i=this.termsByVarIndex[n];return void 0===i?(i=new R(e,t),this.termsByVarIndex[n]=i,this.terms.push(i),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t)):this.setVariableCoefficient(i.coefficient+t,e),this},D.prototype.removeTerm=function(t){return this},D.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},D.prototype.setVariableCoefficient=function(t,e){var n=e.index;if(-1!==n){var i=this.termsByVarIndex[n];if(void 0===i)this.addTerm(t,e);else if(t!==i.coefficient){var r=t-i.coefficient;!0===this.isUpperBound&&(r=-r),i.coefficient=t,this.model.updateConstraintCoefficient(this,e,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},D.prototype.relax=function(t,e){this.relaxation=L(this.model,t,e),this._relax(this.relaxation)},D.prototype._relax=function(t){null!==t&&this.setVariableCoefficient(this.isUpperBound?-1:1,t)},W.prototype.isEquality=!0,W.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},W.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},W.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},W.prototype.relax=function(t,e){this.relaxation=L(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var $={Constraint:D,Variable:V,IntegerVariable:A,SlackVariable:N,Equality:W,Term:R},F=$.SlackVariable;function q(t,e){this.index=t,this.value=e}j.prototype.addCutConstraints=function(t){for(var e,n=t.length,i=this.height,r=i+n,o=i;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var s=this.width-1,a=0;a<n;a+=1){var h=t[a],l=i+a,c="min"===h.type?-1:1,u=h.varIndex,f=this.rowByVarIndex[u],d=this.matrix[l];if(-1===f){for(d[this.rhsColumn]=c*h.value,e=1;e<=s;e+=1)d[e]=0;d[this.colByVarIndex[u]]=c}else{var p=this.matrix[f];for(d[this.rhsColumn]=c*(h.value-p[this.rhsColumn]),e=1;e<=s;e+=1)d[e]=-c*p[e]}var v=this.getNewElementIndex();this.varIndexByRow[l]=v,this.rowByVarIndex[v]=l,this.colByVarIndex[v]=-1,this.variablesPerIndex[v]=new F("s"+v,v),this.nVars+=1}},j.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var n=e[t][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new F("s"+o,o),e[r][this.rhsColumn]=Math.floor(n);for(var s=1;s<this.varIndexByCol.length;s+=1)if(this.variablesPerIndex[this.varIndexByCol[s]].isInteger){var a=e[t][s],h=Math.floor(a)+Math.max(0,a-Math.floor(a)-i)/(1-i);e[r][s]=h}else e[r][s]=Math.min(0,e[t][s]/(1-i));for(var l=0;l<this.width;l+=1)e[r][l]-=e[t][l];return!0},j.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var n=e[t][this.rhsColumn],i=n-Math.floor(n);if(i<this.precision||1-this.precision<i)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new F("s"+o,o),e[r][this.rhsColumn]=-i;for(var s=1;s<this.varIndexByCol.length;s+=1){var a=this.variablesPerIndex[this.varIndexByCol[s]],h=e[t][s],l=h-Math.floor(h);e[r][s]=a.isInteger?l<=i?-l:-(1-l)*i/l:h>=0?-h:h*i/(1-i)}return!0},j.prototype.applyMIRCuts=function(){},j.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var n=this.colByVarIndex[t],i=1;i<this.height;i+=1){var r=this.matrix[i][n];if(r<-this.precision||this.precision<r){e=i;break}}this.pivot(e,n)}return e},j.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var n=this.rowByVarIndex[t],i=this.matrix[n],r=1;r<this.height;r+=1){var o=i[r];if(o<-this.precision||this.precision<o){e=r;break}}this.pivot(n,e)}return e},j.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),n=0;n<t;n+=1){var i=this.variables[n],r=this.rowByVarIndex[i.index];i.value=-1===r?0:Math.round((this.matrix[r][this.rhsColumn]+Number.EPSILON)*e)/e}},j.prototype.updateRightHandSide=function(t,e){var n=this.height-1,i=this.rowByVarIndex[t.index];if(-1===i){for(var r=this.colByVarIndex[t.index],o=0;o<=n;o+=1){var s=this.matrix[o];s[this.rhsColumn]-=e*s[r]}var a=this.optionalObjectives.length;if(a>0)for(var h=0;h<a;h+=1){var l=this.optionalObjectives[h].reducedCosts;l[this.rhsColumn]-=e*l[r]}}else this.matrix[i][this.rhsColumn]-=e},j.prototype.updateConstraintCoefficient=function(t,e,n){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(t.index),r=this.colByVarIndex[e.index];if(-1===r)for(var o=this.rowByVarIndex[e.index],s=0;s<this.width;s+=1)this.matrix[i][s]+=n*this.matrix[o][s];else this.matrix[i][r]-=n},j.prototype.updateCost=function(t,e){var n=t.index,i=this.width-1,r=this.colByVarIndex[n];if(-1===r){var o,s=this.matrix[this.rowByVarIndex[n]];if(0===t.priority){var a=this.matrix[0];for(o=0;o<=i;o+=1)a[o]+=e*s[o]}else{var h=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=i;o+=1)h[o]+=e*s[o]}}else this.matrix[0][r]-=e},j.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,n=this.height,i=this.matrix[n];void 0===i&&(i=this.matrix[0].slice(),this.matrix[n]=i);for(var r=this.width-1,o=0;o<=r;o+=1)i[o]=0;i[this.rhsColumn]=e*t.rhs;for(var s=t.terms,a=s.length,h=0;h<a;h+=1){var l=s[h],c=l.coefficient,u=l.variable.index,f=this.rowByVarIndex[u];if(-1===f)i[this.colByVarIndex[u]]+=e*c;else{var d=this.matrix[f];for(o=0;o<=r;o+=1)i[o]-=e*c*d[o]}}var p=t.index;this.varIndexByRow[n]=p,this.rowByVarIndex[p]=n,this.colByVarIndex[p]=-1,this.height+=1},j.prototype.removeConstraint=function(t){var e=t.index,n=this.height-1,i=this._putInBase(e),r=this.matrix[n];this.matrix[n]=this.matrix[i],this.matrix[i]=r,this.varIndexByRow[i]=this.varIndexByRow[n],this.varIndexByRow[n]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1},j.prototype.addVariable=function(t){var e=this.height-1,n=this.width,i=!0===this.model.isMinimization?-t.cost:t.cost,r=t.priority,o=this.optionalObjectives.length;if(o>0)for(var s=0;s<o;s+=1)this.optionalObjectives[s].reducedCosts[n]=0;0===r?this.matrix[0][n]=i:(this.setOptionalObjective(r,n,i),this.matrix[0][n]=0);for(var a=1;a<=e;a+=1)this.matrix[a][n]=0;var h=t.index;this.varIndexByCol[n]=h,this.rowByVarIndex[h]=-1,this.colByVarIndex[h]=n,this.width+=1},j.prototype.removeVariable=function(t){var e=t.index,n=this._takeOutOfBase(e),i=this.width-1;if(n!==i){for(var r=this.height-1,o=0;o<=r;o+=1){var s=this.matrix[o];s[n]=s[i]}var a=this.optionalObjectives.length;if(a>0)for(var h=0;h<a;h+=1){var l=this.optionalObjectives[h].reducedCosts;l[n]=l[i]}var c=this.varIndexByCol[i];this.varIndexByCol[n]=c,this.colByVarIndex[c]=n}this.varIndexByCol[i]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1},j.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var n,i,r,o,s,a,h,l,c,u,f="",d=[" "];for(i=1;i<this.width;i+=1)h=" ",l="\t",(a=void 0===(o=this.variablesPerIndex[s=this.varIndexByCol[i]])?"c"+s:o.id).length>5?h+=" ":l+="\t",d[i]=h,f+=l+a;console.log(f);var p=this.matrix[this.costRowIndex],v="\t";for(n=1;n<this.width;n+=1)v+="\t",v+=d[n],v+=p[n].toFixed(5);for(v+="\t"+d[0]+p[0].toFixed(5),console.log(v+"\tZ"),r=1;r<this.height;r+=1){for(c=this.matrix[r],u="\t",i=1;i<this.width;i+=1)u+="\t"+d[i]+c[i].toFixed(5);u+="\t"+d[0]+c[0].toFixed(5),a=void 0===(o=this.variablesPerIndex[s=this.varIndexByRow[r]])?"c"+s:o.id,console.log(u+"\t"+a)}console.log("");var g=this.optionalObjectives.length;if(g>0){console.log("    Optional objectives:");for(var m=0;m<g;m+=1){var y=this.optionalObjectives[m].reducedCosts,b="";for(n=1;n<this.width;n+=1)b+=y[n]<0?"":" ",b+=d[n],b+=y[n].toFixed(5);b+=(y[0]<0?"":" ")+d[0]+y[0].toFixed(5),console.log(b+" z"+m)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},j.prototype.copy=function(){var t=new j(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],n=0;n<this.optionalObjectives.length;n++)e[n]=this.optionalObjectives[n].copy();t.optionalObjectives=e;for(var i=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=i[o].slice();return t.matrix=r,t},j.prototype.save=function(){this.savedState=this.copy()},j.prototype.restore=function(){if(null!==this.savedState){var t,e,n=this.savedState,i=n.matrix;for(this.nVars=n.nVars,this.model=n.model,this.variables=n.variables,this.variablesPerIndex=n.variablesPerIndex,this.unrestrictedVars=n.unrestrictedVars,this.lastElementIndex=n.lastElementIndex,this.width=n.width,this.height=n.height,t=0;t<this.height;t+=1){var r=i[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=r[e]}var s=n.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=s[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=n.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=a[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var h=n.rowByVarIndex,l=n.colByVarIndex,c=0;c<this.nVars;c+=1)this.rowByVarIndex[c]=h[c],this.colByVarIndex[c]=l[c];if(n.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var u=0;u<n.optionalObjectives.length;u++){var f=n.optionalObjectives[u].copy();this.optionalObjectives[u]=f,this.optionalObjectivePerPriority[f.priority]=f}}}},j.prototype.getMostFractionalVar=function(){for(var t=0,e=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var s=i[o].index,a=this.rowByVarIndex[s];if(-1!==a){var h=this.matrix[a][this.rhsColumn],l=Math.abs(h-Math.round(h));t<l&&(t=l,e=s,n=h)}}return new q(e,n)},j.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,n=null,i=this.model.integerVariables,r=i.length,o=0;o<r;o++){var s=i[o],a=s.index,h=this.rowByVarIndex[a];if(-1!==h){var l=this.matrix[h][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision){var c=s.cost;t>c&&(t=c,e=a,n=l)}}}return new q(e,n)},j.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var n=this.matrix[e][this.rhsColumn];(n-=Math.floor(n))<this.precision&&-n<this.precision&&(t+=1)}return t},j.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,n=0;n<e;n++){var i=this.rowByVarIndex[t[n].index];if(-1!==i){var r=this.matrix[i][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},j.prototype.computeFractionalVolume=function(t){for(var e=-1,n=1;n<this.height;n+=1)if(this.variablesPerIndex[this.varIndexByRow[n]].isInteger){var i=this.matrix[n][this.rhsColumn];if(i=Math.abs(i),Math.min(i-Math.floor(i),Math.floor(i+1))<this.precision){if(!t)return 0}else-1===e?e=i:e*=i}return-1===e?0:e};var H=j;function X(t,e,n){this.type=t,this.varIndex=e,this.value=n}function Y(t,e){this.relaxedEvaluation=t,this.cuts=e}function U(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}j.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var n=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*n&&(e=!1)}},j.prototype.branchAndCut=function(){var t=[],e=0,n=this.model.tolerance,i=!0,r=1e99;this.model.timeout&&(r=Date.now()+this.model.timeout);for(var o=1/0,s=null,a=[],h=0;h<this.optionalObjectives.length;h+=1)a.push(1/0);var l=new Y(-1/0,[]);for(t.push(l);t.length>0&&!0===i&&Date.now()<r;)if(n>0&&o<(this.model.isMinimization?this.bestPossibleEval*(1+n):this.bestPossibleEval*(1-n))&&(i=!1),!((l=t.pop()).relaxedEvaluation>o)){var c=l.cuts;if(this.applyCuts(c),e++,!1!==this.feasible){var u=this.evaluation;if(!(u>o)){if(u===o){for(var f=!0,d=0;d<this.optionalObjectives.length&&!(this.optionalObjectives[d].reducedCosts[0]>a[d]);d+=1)if(this.optionalObjectives[d].reducedCosts[0]<a[d]){f=!1;break}if(f)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===e)return void(this.branchAndCutIterations=e);s=l,o=u;for(var p=0;p<this.optionalObjectives.length;p+=1)a[p]=this.optionalObjectives[p].reducedCosts[0]}else{1===e&&this.save();for(var v=this.getMostFractionalVar(),g=v.index,m=[],y=[],b=c.length,w=0;w<b;w+=1){var x=c[w];x.varIndex===g?"min"===x.type?y.push(x):m.push(x):(m.push(x),y.push(x))}var _=Math.ceil(v.value),I=Math.floor(v.value),C=new X("min",g,_);m.push(C);var S=new X("max",g,I);y.push(S),t.push(new Y(u,m)),t.push(new Y(u,y)),t.sort(U)}}}}null!==s&&this.applyCuts(s.cuts),this.branchAndCutIterations=e};var G={},Q=$.Constraint,K=$.Equality,J=$.Variable,Z=$.IntegerVariable;function tt(t,e){this.tableau=new j(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var et=tt;tt.prototype.minimize=function(){return this.isMinimization=!0,this},tt.prototype.maximize=function(){return this.isMinimization=!1,this},tt.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},tt.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},tt.prototype.smallerThan=function(t){var e=new Q(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.greaterThan=function(t){var e=new Q(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.equal=function(t){var e=new Q(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var n=new Q(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(n),new K(e,n)},tt.prototype.addVariable=function(t,e,n,i,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,s=this.tableau.getNewElementIndex();return null==e&&(e="v"+s),null==t&&(t=0),null==r&&(r=0),n?(o=new Z(e,t,s,r),this.integerVariables.push(o)):o=new J(e,t,s,r),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,i&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},tt.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},tt.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},tt.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},tt.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},tt.prototype.updateConstraintCoefficient=function(t,e,n){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,n),this},tt.prototype.setCost=function(t,e){var n=t-e.cost;return!1===this.isMinimization&&(n=-n),e.cost=t,this.tableau.updateCost(e,n),this},tt.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,n=t.constraints,i={},r={},o=Object.keys(n),s=o.length,a=0;a<s;a+=1){var h,l,c=o[a],u=n[c],f=u.equal,d=u.weight,p=u.priority,v=void 0!==d||void 0!==p;if(void 0===f){var g=u.min;void 0!==g&&(h=this.greaterThan(g),i[c]=h,v&&h.relax(d,p));var m=u.max;void 0!==m&&(l=this.smallerThan(m),r[c]=l,v&&l.relax(d,p))}else{h=this.greaterThan(f),i[c]=h,l=this.smallerThan(f),r[c]=l;var y=new K(h,l);v&&y.relax(d,p)}}var b=Object.keys(e),w=b.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),0===this.tolerance&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),this.checkForCycles=void 0===t.options.exitOnCycles||t.options.exitOnCycles);for(var x=t.ints||{},_=t.binaries||{},I=t.unrestricted||{},C=t.optimize,S=0;S<w;S+=1){var k=b[S],E=e[k],M=!!_[k],T=this.addVariable(E[C]||0,k,!!x[k]||M,!!I[k]);M&&this.smallerThan(1).addTerm(1,T);var O=Object.keys(E);for(a=0;a<O.length;a+=1){var B=O[a];if(B!==C){var j=E[B],z=i[B];void 0!==z&&z.addTerm(j,T);var P=r[B];void 0!==P&&P.addTerm(j,T)}}}return this},tt.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},tt.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},tt.prototype.isFeasible=function(){return this.tableau.feasible},tt.prototype.save=function(){return this.tableau.save()},tt.prototype.restore=function(){return this.tableau.restore()},tt.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},tt.prototype.debug=function(t){this.checkForCycles=t},tt.prototype.log=function(t){return this.tableau.log(t)};var nt={CleanObjectiveAttributes:function(t){var e,n,i;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(n in e=Math.random(),t.variables)t.variables[n][t.optimize]&&(t.variables[n][e]=t.variables[n][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(i in t.optimize)if(t.constraints[i])if("equal"===t.constraints[i])delete t.optimize[i];else{for(n in e=Math.random(),t.variables)t.variables[n][i]&&(t.variables[n][e]=t.variables[n][i]);t.constraints[e]=t.constraints[i],delete t.constraints[i]}return t}},it=function(t){return t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},n={opType:"",optimize:"_obj",constraints:{},variables:{}},i={">=":"min","<=":"max","=":"equal"},r="",o=null,s="",a="",h="",l=0;"string"==typeof t&&(t=t.split("\n"));for(var c=0;c<t.length;c++)if(h="__"+c,o=null,e.is_objective.test(r=t[c]))n.opType=r.match(/(max|min)/gi)[0],(o=r.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0].replace(/\;$/,""),n.variables[a]=n.variables[a]||{},n.variables[a]._obj=s}));else if(e.is_int.test(r))o=r.match(e.parse_int).slice(1),n.ints=n.ints||{},o.forEach((function(t){t=t.replace(";",""),n.ints[t]=1}));else if(e.is_bin.test(r))o=r.match(e.parse_bin).slice(1),n.binaries=n.binaries||{},o.forEach((function(t){t=t.replace(";",""),n.binaries[t]=1}));else if(e.is_constraint.test(r)){var u=r.indexOf(":");(o=(-1===u?r:r.slice(u+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0],n.variables[a]=n.variables[a]||{},n.variables[a][h]=s})),l=parseFloat(r.match(e.parse_rhs)[0]),r=i[r.match(e.parse_dir)[0]],n.constraints[h]=n.constraints[h]||{},n.constraints[h][r]=l}else e.is_unrestricted.test(r)&&(o=r.match(e.parse_int).slice(1),n.unrestricted=n.unrestricted||{},o.forEach((function(t){t=t.replace(";",""),n.unrestricted[t]=1})));return n}(t):function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",n={max:"<=",min:">=",equal:"="},i=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType)for(var r in e+=t.opType+":",t.variables)t.variables[r][r]=t.variables[r][r]?t.variables[r][r]:1,t.variables[r][t.optimize]&&(e+=" "+t.variables[r][t.optimize]+" "+r.replace(i,"_"));else e+="max:";for(var o in e+=";\n\n",t.constraints)for(var s in t.constraints[o])if(void 0!==n[s]){for(var a in t.variables)void 0!==t.variables[a][o]&&(e+=" "+t.variables[a][o]+" "+a.replace(i,"_"));e+=" "+n[s]+" "+t.constraints[o][s],e+=";\n"}if(t.ints)for(var h in e+="\n\n",t.ints)e+="int "+h.replace(i,"_")+";\n";if(t.unrestricted)for(var l in e+="\n\n",t.unrestricted)e+="unrestricted "+l.replace(i,"_")+";\n";return e}(t)};function rt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})})),e}var ot=rt(Object.freeze({__proto__:null,default:{}}));function st(t){return(t=(t=t.replace("\\r\\n","\r\n")).split("\r\n")).filter((function(t){return!0!==new RegExp(" 0$","gi").test(t)&&!1!==new RegExp("\\d$","gi").test(t)})).map((function(t){return t.split(/\:{0,1} +(?=\d)/)})).reduce((function(t,e,n){return t[e[0]]=e[1],t}),{})}var at={lpsolve:{reformat:it,solve:function(t){return new Promise((function(e,n){"undefined"!=typeof window&&n("Function Not Available in Browser");var i=it(t);t.external||n("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||n("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||n("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||n("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),ot.writeFile(t.external.tempName,i,(function(i,r){if(i)n(i);else{var o=ot.execFile;t.external.args.push(t.external.tempName),o(t.external.binPath,t.external.args,(function(t,i){t?1===t.code?e(st(i)):n({code:t.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[t.code],data:i}):e(st(i))}))}}))}))}}},ht=function(t,e){var n,i,r,o,s,a=e.optimize,h=JSON.parse(JSON.stringify(e.optimize)),l=Object.keys(e.optimize),c=0,u={},f="",d={},p=[];for(delete e.optimize,i=0;i<l.length;i++)h[l[i]]=0;for(i=0;i<l.length;i++){for(s in e.optimize=l[i],e.opType=a[l[i]],n=t.Solve(e,void 0,void 0,!0),l)if(!e.variables[l[s]])for(o in n[l[s]]=n[l[s]]?n[l[s]]:0,e.variables)e.variables[o][l[s]]&&n[o]&&(n[l[s]]+=n[o]*e.variables[o][l[s]]);for(f="base",r=0;r<l.length;r++)f+=n[l[r]]?"-"+(1e3*n[l[r]]|0)/1e3:"-0";if(!u[f]){for(u[f]=1,c++,r=0;r<l.length;r++)n[l[r]]&&(h[l[r]]+=n[l[r]]);delete n.feasible,delete n.result,p.push(n)}}for(i=0;i<l.length;i++)e.constraints[l[i]]={equal:h[l[i]]/c};for(i in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[i].cheater=1;for(i in p)for(o in p[i])d[o]=d[o]||{min:1e99,max:-1e99};for(i in d)for(o in p)p[o][i]?(p[o][i]>d[i].max&&(d[i].max=p[o][i]),p[o][i]<d[i].min&&(d[i].min=p[o][i])):(p[o][i]=0,d[i].min=0);return{midpoint:n=t.Solve(e,void 0,void 0,!0),vertices:p,ranges:d}},lt=$.Constraint,ct=$.Variable,ut=$.Numeral,ft=$.Term,dt=function(){this.Model=et,this.branchAndCut=G,this.Constraint=lt,this.Variable=ct,this.Numeral=ut,this.Term=ft,this.Tableau=H,this.lastSolvedModel=null,this.External=at,this.Solve=function(t,e,n,i){if(i)for(var r in nt)t=nt[r](t);if(!t)throw new Error("Solver requires a model to operate on");if("object"==typeof t.optimize&&Object.keys(t.optimize>1))return ht(this,t);if(t.external){var o=Object.keys(at);if(o=JSON.stringify(o),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+o);if(!at[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+o);return at[t.external.solver].solve(t)}t instanceof et==0&&(t=new et(e).loadJson(t));var s=t.solve();if(this.lastSolvedModel=t,s.solutionSet=s.generateSolutionSet(),n)return s;var a={};return a.feasible=s.feasible,a.result=s.evaluation,a.bounded=s.bounded,s._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(s.solutionSet).forEach((function(t){0!==s.solutionSet[t]&&(a[t]=s.solutionSet[t])})),a},this.ReformatLP=it,this.MultiObjective=function(t){return ht(this,t)}};"object"==typeof window?window.solver=new dt:"object"==typeof self&&(self.solver=new dt);var pt=new dt;function vt(){}function gt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mt(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function yt(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function bt(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function wt(t,e,n){if(i=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(i=+i)>=i&&(yield i)}}(t,n))).length){if((e=+e)<=0||i<2)return yt(t);if(e>=1)return mt(t);var i,r=(i-1)*e,o=Math.floor(r),s=mt(function t(e,n,i=0,r=e.length-1,o=gt){for(;r>i;){if(r-i>600){const s=r-i+1,a=n-i+1,h=Math.log(s),l=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*l*(s-l)/s)*(a-s/2<0?-1:1);t(e,n,Math.max(i,Math.floor(n-a*l/s+c)),Math.min(r,Math.floor(n+(s-a)*l/s+c)),o)}const s=e[n];let a=i,h=r;for(bt(e,i,n),o(e[r],s)>0&&bt(e,i,r);a<h;){for(bt(e,a,h),++a,--h;o(e[a],s)<0;)++a;for(;o(e[h],s)>0;)--h}0===o(e[i],s)?bt(e,i,h):(++h,bt(e,h,r)),h<=n&&(i=h+1),n<=h&&(r=h-1)}return e}(t,o).subarray(0,o+1));return s+(yt(t.subarray(o+1))-s)*(r-o)}}function xt(t,e){return+!(t instanceof k)+ +!(e instanceof k)}function _t(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return function t(e,n,i,r,o,s,a){const[h,l]=o;function c(t){e(t);for(const e of t){const t=e.layer;if(void 0===t)throw new Error(`layering did not assign layer to node '${e.id}'`);if(t<0)throw new Error(`layering assigned a negative layer (${t}) to node '${e.id}'`)}const o=function(t){const e=[];for(const n of t.descendants()){const t=n.layer;(e[t]||(e[t]=[])).push(n),n.dataChildren=n.dataChildren.map(i=>{const r=i.child.layer;if(r<=t)throw new Error(`layering left child node "${i.child.id}" (${r}) with a greater or equal layer to parent node "${n.id}" (${t})`);let o=i.child;for(let s=r-1;s>t;s--){let t;t=a?`${n.id}->${i.child.id} (${s})`:`${n.id}\0${i.child.id}\0${s}`;const r=new k(t);r.dataChildren.push(new u(o,void 0)),(e[s]||(e[s]=[])).push(r),o=r}return new u(o,i.data)})}return e}(t);if(1===o.length){const[t]=o;for(const e of t)e.y=l/2}else{const t=r?l:l/(o.length-1);for(const[e,n]of o.entries())for(const i of n)i.y=t*e}if(o.every(t=>1===t.length))for(const[e]of o)e.x=h/2;else if(1===o.length){const[t]=o;I(t,s);const e=t,n=r?e.length-1:1;for(const i of e)i.x*=h*n}else{n(o),i(o,s);for(const n of o)for(const t of n)if(void 0===t.x)throw new Error(`coord didn't assign an x to node '${t.id}'`);const t=o,e=r?Math.max(...o.map(t=>t.length))-1:1;for(const n of t)for(const t of n)t.x*=h*e}const c=t;return function(t){for(const e of t)e instanceof k||(e.dataChildren=e.dataChildren.map(t=>{let n=t.child;const i=[{x:e.x,y:e.y}];for(;n instanceof k;)i.push({x:n.x,y:n.y}),[n]=n.ichildren();return i.push({x:n.x,y:n.y}),new u(n,t.data,i)}))}(c),c}return c.layering=function(h){return void 0===h?e:t(h,n,i,r,o,s,a)},c.decross=function(h){return void 0===h?n:t(e,h,i,r,o,s,a)},c.coord=function(h){return void 0===h?i:t(e,n,h,r,o,s,a)},c.size=function(h){return void 0!==h?t(e,n,i,!1,h,s,a):r?null:o},c.nodeSize=function(h){return void 0!==h?t(e,n,i,!0,h,s,a):r?o:null},c.separation=function(h){return void 0===h?s:t(e,n,i,r,o,h,a)},c.debug=function(h){return void 0===h?a:t(e,n,i,r,o,s,h)},c}(function(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return function t(e,n){const i=n?"":"\0",r=n?"rank: ":"\0",o=n?" -> ":"\0";function s(t){return`${i}${t.id}`}function a(t){return`${t.source.id}${o}${t.target.id}`}function h(t,e){return`${r}${t.id}${o}${e.id}`}function l(t){const n=Object.create(null),i=Object.create(null),r=Object.create(null),o=[];for(const a of t){const t=s(a);i[t]=1,n[t]={opt:a.children.length};const r=e(a);void 0!==r&&o.push([r,a])}for(const e of t.ilinks()){const t=n[s(e.source)],i=n[s(e.target)],o=a(e);r[o]={min:1},t[o]=-1,t.opt++,i[o]=1,i.opt--}let[l,...c]=o.sort(([t],[e])=>t-e);for(const e of c){const[t,i]=l,[o,a]=e,c=n[s(i)],u=n[s(a)],f=h(i,a);if(t<o)r[f]={min:1},c[f]=-1,u[f]=1;else{const t=h(a,i);r[f]={min:0},r[t]={min:0},c[f]=-1,c[t]=1,u[f]=1,u[t]=-1}l=e}const u=pt.Solve({optimize:"opt",opType:"max",constraints:r,variables:n,ints:i}),{feasible:f}=u,d=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(u,["feasible"]);if(!f)throw o.length?new Error("could not find a feasbile simplex layout, check that rank accessors are not ill-defined"):new Error("could not find feasbile simplex layout, this should not happen");for(const e of t)e.layer=d[s(e)]||0}return l.rank=function(i){return void 0===i?e:t(i,n)},l.debug=function(i){return void 0===i?n:t(e,i)},l}(vt,!1)}(),function(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return function t(e){function n(t){t.slice(0,t.length-1).forEach((n,i)=>e(n,t[i+1]))}return n.order=function(n){return void 0===n?e:t(n)},n}(function(...t){if(t.length)throw new Error(`got arguments to median(${t}), but constructor takes no aruguments.`);return function(t,e){const n=new c;for(const[o,s]of t.entries())for(const t of s.ichildren())n.setIfAbsent(t.id,[]).push(o);const i=new c;let r=-1;for(const o of e){const e=wt(n.getDefault(o.id,[]),.5,void 0);void 0===e?(i.set(o.id,r),r=+!((r+1)/(t.length+1))*(t.length+1)-1):i.set(o.id,e)}e.sort((t,e)=>i.getThrow(t.id)-i.getThrow(e.id))}}())}(),function(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return function t(e,n,i,r,o){function s(t,s,a){const h=function(t){const e=new c;let n=0;for(const i of t)for(const t of i)e.set(t.id,n++);return e}(t),[l,u,f,d]=function(t,e,n){const i=1+Math.max(...e.values()),r=[],o=[];for(const a of t){let[t,...s]=a;for(const a of s){const s=e.getThrow(t.id),h=e.getThrow(a.id),l=new Array(i).fill(0);l[s]=1,l[h]=-1,r.push(l),o.push(-n(t,a)),t=a}}const s=new Array(i).fill(0);return[new Array(i).fill(null).map(()=>new Array(i).fill(0)),s,r,o]}(t,h,s);for(const o of t)for(const t of o){const o=h.getThrow(t.id),s=t instanceof k?n:e;for(const a of t.ichildren()){const t=h.getThrow(a.id),c=a instanceof k?r:i;C(l,o,t,s+(a instanceof k?n:e));for(const e of a.ichildren())S(l,o,t,h.getThrow(e.id),c)}}for(let[e,...n]of t)for(const t of n)a.getThrow(e.id)!==a.getThrow(t.id)&&C(l,h.getThrow(e.id),h.getThrow(t.id),o),e=t;!function(t,e,n){const i=Math.min(...n),r=Math.max(...n)-i;if(r>0)for(const o of t)for(const t of o){const o=e.getThrow(t.id);t.x=(n[o]-i)/r}else for(const o of t)for(const t of o)t.x=.5}(t,h,function(t,e,n,i,r=0){e.pop(),t.pop(),t.forEach(t=>t.pop()),n.forEach(t=>t.pop());const o=function(t,e,n,i,r){const o=[[0]],s=[0],a=[[0]],h=[0];for(const u of t){const t=[0];t.push(...u),o.push(t)}s.push(...e),a.push(...e.map(()=>[0]));for(const u of n)for(const[t,e]of u.entries())a[t+1].push(-e);h.push(...i.map(t=>-t));const{solution:l,message:c}=_(o,s,a,h,r);if(c.length)throw new Error("quadprog failed with: "+c);return l.shift(),l}(t,e,n,i,r);return o.push(0),o}(l,u,f,d))}function a(t,o){if(0===e&&0===i)throw new Error("node vertical weight or node curve weight needs to be positive");if(0===n&&0===r)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");const a=function(t){const e=new c;for(const r of t.slice().reverse())for(const t of r){for(const n of t.ichildren())e.delete(n.id);e.set(t.id,t)}const n=new p([...e.values()]).split(),i=new c;for(const[r,o]of n.entries())for(const t of o)i.set(t.id,r);return i}(t);for(const e of function(t,e){const n=[];let i=[],r=new Set;for(const o of t){const t=new Set(o.map(t=>e.getThrow(t.id)));l(r,t)||n.push(i=[]),i.push(o),r=t}return n}(t,a))if(e.every(t=>1===t.length))for(const[t]of e)t.x=.5;else if(1===e.length){const[t]=e;I(t,o)}else s(e,o,a)}return a.vertical=function(s){if(void 0===s)return[e,n];const[a,h]=s;if(a<0||h<0)throw new Error(`weights must be non-negative, but were ${a} and ${h}`);return t(a,h,i,r,o)},a.curve=function(s){if(void 0===s)return[i,r];const[a,h]=s;if(a<0||h<0)throw new Error(`weights must be non-negative, but were ${a} and ${h}`);return t(e,n,a,h,o)},a.component=function(s){if(void 0===s)return o;if(s<=0)throw new Error("weight must be positive, but was "+s);return t(e,n,i,r,s)},a}(1,0,0,1,1)}(),!1,[1,1],xt,!1)}var It=function(t,e){return t<e};function Ct(t){if(!(this instanceof Ct))return new Ct(t);this.array=[],this.size=0,this.compare=t||It}Ct.prototype.clone=function(){var t=new Ct(this.compare);t.size=this.size;for(var e=0;e<this.size;e++)t.array.push(this.array[e]);return t},Ct.prototype.add=function(t){var e,n,i=this.size;for(this.array[this.size]=t,this.size+=1;i>0&&this.compare(t,n=this.array[e=i-1>>1]);)this.array[i]=n,i=e;this.array[i]=t},Ct.prototype.heapify=function(t){var e;for(this.array=t,this.size=t.length,e=this.size>>1;e>=0;e--)this._percolateDown(e)},Ct.prototype._percolateUp=function(t,e){for(var n,i,r=this.array[t];t>0&&(i=this.array[n=t-1>>1],e||this.compare(r,i));)this.array[t]=i,t=n;this.array[t]=r},Ct.prototype._percolateDown=function(t){for(var e,n,i,r=this.size,o=this.size>>>1,s=this.array[t];t<o&&(i=this.array[e=1+(t<<1)],(n=e+1)<r&&this.compare(this.array[n],i)&&(e=n,i=this.array[n]),this.compare(i,s));)this.array[t]=i,t=e;this.array[t]=s},Ct.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},Ct.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1},Ct.prototype._batchRemove=function(t,e){var n=new Array(e||this.size),i=0;if("function"==typeof t&&this.size)for(var r=0;r<this.size&&i<n.length;)t(this.array[r])?(n[i]=this._removeAt(r),i++,r>>=1):r++;return n.length=i,n},Ct.prototype.removeOne=function(t){var e=this._batchRemove(t,1);return e.length>0?e[0]:void 0},Ct.prototype.removeMany=function(t,e){return this._batchRemove(t,e)},Ct.prototype.peek=function(){if(0!=this.size)return this.array[0]},Ct.prototype.poll=function(){if(0!=this.size){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}},Ct.prototype.replaceTop=function(t){if(0!=this.size){var e=this.array[0];return this.array[0]=t,this._percolateDown(0),e}},Ct.prototype.trim=function(){this.array=this.array.slice(0,this.size)},Ct.prototype.isEmpty=function(){return 0===this.size},Ct.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var e=0,n=this.clone();!n.isEmpty();)t(n.poll(),e++)},Ct.prototype.kSmallest=function(t){if(0==this.size)return[];var e=this.compare,n=this.array,i=new Ct((function(t,i){return e(n[t],n[i])}));t=Math.min(this.size,t);var r=new Array(t),o=0;for(i.add(0);o<t;){var s=i.poll();r[o++]=this.array[s];var a=1+(s<<1),h=a+1;a<this.size&&i.add(a),h<this.size&&i.add(h)}return r};var St=n("ZTXN"),kt=n("mWib"),Et=n("kuMc");function Mt(t,e){let n;if(void 0===e)for(const i of t)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}var Tt={value:()=>{}};function Ot(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Bt(i)}function Bt(t){this._=t}function jt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function zt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Pt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Tt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Bt.prototype=Ot.prototype={constructor:Bt,on:function(t,e){var n,i=this._,r=jt(t+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=r[o]).type)i[n]=Pt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Pt(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=r[o]).type)&&(n=zt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Bt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var Vt=Ot;function At(){}var Nt=function(t){return null==t?At:function(){return this.querySelector(t)}},Rt=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)};function Lt(){return[]}var Dt=function(t){return null==t?Lt:function(){return this.querySelectorAll(t)}},Wt=function(t){return function(){return this.matches(t)}};function $t(t){return function(e){return e.matches(t)}}var Ft=Array.prototype.find;function qt(){return this.firstElementChild}var Ht=Array.prototype.filter;function Xt(){return this.children}var Yt=function(t){return new Array(t.length)};function Ut(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ut.prototype={constructor:Ut,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Gt=function(t){return function(){return t}};function Qt(t,e,n,i,r,o){for(var s,a=0,h=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],i[a]=s):n[a]=new Ut(t,o[a]);for(;a<h;++a)(s=e[a])&&(r[a]=s)}function Kt(t,e,n,i,r,o,s){var a,h,l,c=new Map,u=e.length,f=o.length,d=new Array(u);for(a=0;a<u;++a)(h=e[a])&&(d[a]=l=s.call(h,h.__data__,a,e)+"",c.has(l)?r[a]=h:c.set(l,h));for(a=0;a<f;++a)l=s.call(t,o[a],a,o)+"",(h=c.get(l))?(i[a]=h,h.__data__=o[a],c.delete(l)):n[a]=new Ut(t,o[a]);for(a=0;a<u;++a)(h=e[a])&&c.get(d[a])===h&&(r[a]=h)}function Jt(t){return t.__data__}function Zt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var te="http://www.w3.org/1999/xhtml",ee={svg:"http://www.w3.org/2000/svg",xhtml:te,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ne=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),ee.hasOwnProperty(e)?{space:ee[e],local:t}:t};function ie(t){return function(){this.removeAttribute(t)}}function re(t){return function(){this.removeAttributeNS(t.space,t.local)}}function oe(t,e){return function(){this.setAttribute(t,e)}}function se(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ae(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function he(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var le=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function ce(t){return function(){this.style.removeProperty(t)}}function ue(t,e,n){return function(){this.style.setProperty(t,e,n)}}function fe(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function de(t,e){return t.style.getPropertyValue(e)||le(t).getComputedStyle(t,null).getPropertyValue(e)}function pe(t){return function(){delete this[t]}}function ve(t,e){return function(){this[t]=e}}function ge(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function me(t){return t.trim().split(/^|\s+/)}function ye(t){return t.classList||new be(t)}function be(t){this._node=t,this._names=me(t.getAttribute("class")||"")}function we(t,e){for(var n=ye(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function xe(t,e){for(var n=ye(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function _e(t){return function(){we(this,t)}}function Ie(t){return function(){xe(this,t)}}function Ce(t,e){return function(){(e.apply(this,arguments)?we:xe)(this,t)}}function Se(){this.textContent=""}function ke(t){return function(){this.textContent=t}}function Ee(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Me(){this.innerHTML=""}function Te(t){return function(){this.innerHTML=t}}function Oe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Be(){this.nextSibling&&this.parentNode.appendChild(this)}function je(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ze(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===te&&e.documentElement.namespaceURI===te?e.createElement(t):e.createElementNS(n,t)}}function Pe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}be.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Ve=function(t){var e=ne(t);return(e.local?Pe:ze)(e)};function Ae(){return null}function Ne(){var t=this.parentNode;t&&t.removeChild(this)}function Re(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Le(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function De(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function We(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function $e(t,e,n){return function(){var i,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=e);this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Fe(t,e,n){var i=le(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function qe(t,e){return function(){return Fe(this,t,e)}}function He(t,e){return function(){return Fe(this,t,e.apply(this,arguments))}}var Xe=[null];function Ye(t,e){this._groups=t,this._parents=e}function Ue(){return new Ye([[document.documentElement]],Xe)}Ye.prototype=Ue.prototype={constructor:Ye,select:function(t){"function"!=typeof t&&(t=Nt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s,a=e[r],h=a.length,l=i[r]=new Array(h),c=0;c<h;++c)(o=a[c])&&(s=t.call(o,o.__data__,c,a))&&("__data__"in o&&(s.__data__=o.__data__),l[c]=s);return new Ye(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:Rt(e)}}(t):Dt(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var s,a=e[o],h=a.length,l=0;l<h;++l)(s=a[l])&&(i.push(t.call(s,s.__data__,l,a)),r.push(s));return new Ye(i,r)},selectChild:function(t){return this.select(null==t?qt:function(t){return function(){return Ft.call(this.children,t)}}("function"==typeof t?t:$t(t)))},selectChildren:function(t){return this.selectAll(null==t?Xt:function(t){return function(){return Ht.call(this.children,t)}}("function"==typeof t?t:$t(t)))},filter:function(t){"function"!=typeof t&&(t=Wt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,h=i[r]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&h.push(o);return new Ye(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Jt);var n=e?Kt:Qt,i=this._parents,r=this._groups;"function"!=typeof t&&(t=Gt(t));for(var o=r.length,s=new Array(o),a=new Array(o),h=new Array(o),l=0;l<o;++l){var c=i[l],u=r[l],f=u.length,d=Rt(t.call(c,c&&c.__data__,l,i)),p=d.length,v=a[l]=new Array(p),g=s[l]=new Array(p),m=h[l]=new Array(f);n(c,u,v,g,m,d,e);for(var y,b,w=0,x=0;w<p;++w)if(y=v[w]){for(w>=x&&(x=w+1);!(b=g[x])&&++x<p;);y._next=b||null}}return(s=new Ye(s,i))._enter=a,s._exit=h,s},enter:function(){return new Ye(this._enter||this._groups.map(Yt),this._parents)},exit:function(){return new Ye(this._exit||this._groups.map(Yt),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){if(!(t instanceof Ye))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,i=e.length,r=Math.min(i,n.length),o=new Array(i),s=0;s<r;++s)for(var a,h=e[s],l=n[s],c=h.length,u=o[s]=new Array(c),f=0;f<c;++f)(a=h[f]||l[f])&&(u[f]=a);for(;s<i;++s)o[s]=e[s];return new Ye(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Zt);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],h=a.length,l=r[o]=new Array(h),c=0;c<h;++c)(s=a[c])&&(l[c]=s);l.sort(e)}return new Ye(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var n=ne(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?re:ie:"function"==typeof e?n.local?he:ae:n.local?se:oe)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ce:"function"==typeof e?fe:ue)(t,e,null==n?"":n)):de(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?pe:"function"==typeof e?ge:ve)(t,e)):this.node()[t]},classed:function(t,e){var n=me(t+"");if(arguments.length<2){for(var i=ye(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?Ce:e?_e:Ie)(n,e))},text:function(t){return arguments.length?this.each(null==t?Se:("function"==typeof t?Ee:ke)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Me:("function"==typeof t?Oe:Te)(t)):this.node().innerHTML},raise:function(){return this.each(Be)},lower:function(){return this.each(je)},append:function(t){var e="function"==typeof t?t:Ve(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Ve(t),i=null==e?Ae:"function"==typeof e?e:Nt(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(Ne)},clone:function(t){return this.select(t?Le:Re)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=De(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?$e:We,i=0;i<s;++i)this.each(a(o[i],e,n));return this}var a=this.node().__on;if(a)for(var h,l=0,c=a.length;l<c;++l)for(i=0,h=a[l];i<s;++i)if((r=o[i]).type===h.type&&r.name===h.name)return h.value},dispatch:function(t,e){return this.each(("function"==typeof e?He:qe)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],o=0,s=r.length;o<s;++o)(i=r[o])&&(yield i)}};var Ge=Ue,Qe=function(t){return"string"==typeof t?new Ye([[document.querySelector(t)]],[document.documentElement]):new Ye([[t]],Xe)};function Ke(t){t.stopImmediatePropagation()}var Je=function(t){t.preventDefault(),t.stopImmediatePropagation()},Ze=function(t){var e=t.document.documentElement,n=Qe(t).on("dragstart.drag",Je,!0);"onselectstart"in e?n.on("selectstart.drag",Je,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function tn(t,e){var n=t.document.documentElement,i=Qe(t).on("dragstart.drag",null);e&&(i.on("click.drag",Je,!0),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var en=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function nn(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function rn(){}var on=.7,sn=1/on,an="\\s*([+-]?\\d+)\\s*",hn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ln="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cn=/^#([0-9a-f]{3,8})$/,un=new RegExp("^rgb\\("+[an,an,an]+"\\)$"),fn=new RegExp("^rgb\\("+[ln,ln,ln]+"\\)$"),dn=new RegExp("^rgba\\("+[an,an,an,hn]+"\\)$"),pn=new RegExp("^rgba\\("+[ln,ln,ln,hn]+"\\)$"),vn=new RegExp("^hsl\\("+[hn,ln,ln]+"\\)$"),gn=new RegExp("^hsla\\("+[hn,ln,ln,hn]+"\\)$"),mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function yn(){return this.rgb().formatHex()}function bn(){return this.rgb().formatRgb()}function wn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=cn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?xn(e):3===n?new Sn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?_n(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?_n(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=un.exec(t))?new Sn(e[1],e[2],e[3],1):(e=fn.exec(t))?new Sn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=dn.exec(t))?_n(e[1],e[2],e[3],e[4]):(e=pn.exec(t))?_n(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=vn.exec(t))?Tn(e[1],e[2]/100,e[3]/100,1):(e=gn.exec(t))?Tn(e[1],e[2]/100,e[3]/100,e[4]):mn.hasOwnProperty(t)?xn(mn[t]):"transparent"===t?new Sn(NaN,NaN,NaN,0):null}function xn(t){return new Sn(t>>16&255,t>>8&255,255&t,1)}function _n(t,e,n,i){return i<=0&&(t=e=n=NaN),new Sn(t,e,n,i)}function In(t){return t instanceof rn||(t=wn(t)),t?new Sn((t=t.rgb()).r,t.g,t.b,t.opacity):new Sn}function Cn(t,e,n,i){return 1===arguments.length?In(t):new Sn(t,e,n,null==i?1:i)}function Sn(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function kn(){return"#"+Mn(this.r)+Mn(this.g)+Mn(this.b)}function En(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Mn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Tn(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Bn(t,e,n,i)}function On(t){if(t instanceof Bn)return new Bn(t.h,t.s,t.l,t.opacity);if(t instanceof rn||(t=wn(t)),!t)return new Bn;if(t instanceof Bn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,h=(o+r)/2;return a?(s=e===o?(n-i)/a+6*(n<i):n===o?(i-e)/a+2:(e-n)/a+4,a/=h<.5?o+r:2-o-r,s*=60):a=h>0&&h<1?0:s,new Bn(s,a,h,t.opacity)}function Bn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function jn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function zn(t,e,n,i,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*i+s*r)/6}en(rn,wn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:yn,formatHex:yn,formatHsl:function(){return On(this).formatHsl()},formatRgb:bn,toString:bn}),en(Sn,Cn,nn(rn,{brighter:function(t){return t=null==t?sn:Math.pow(sn,t),new Sn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?on:Math.pow(on,t),new Sn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kn,formatHex:kn,formatRgb:En,toString:En})),en(Bn,(function(t,e,n,i){return 1===arguments.length?On(t):new Bn(t,e,n,null==i?1:i)}),nn(rn,{brighter:function(t){return t=null==t?sn:Math.pow(sn,t),new Bn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?on:Math.pow(on,t),new Bn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Sn(jn(t>=240?t-240:t+120,r,i),jn(t,r,i),jn(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Pn=t=>()=>t;function Vn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Pn(isNaN(t)?e:t)}var An=function t(e){var n=function(t){return 1==(t=+t)?Vn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):Pn(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=Cn(t)).r,(e=Cn(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),s=Vn(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function Nn(t){return function(e){var n,i,r=e.length,o=new Array(r),s=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=Cn(e[n]),o[n]=i.r||0,s[n]=i.g||0,a[n]=i.b||0;return o=t(o),s=t(s),a=t(a),i.opacity=1,function(t){return i.r=o(t),i.g=s(t),i.b=a(t),i+""}}}Nn((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1];return zn((n-i/e)*e,i>0?t[i-1]:2*r-o,r,o,i<e-1?t[i+2]:2*o-r)}})),Nn((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e);return zn((n-i/e)*e,t[(i+e-1)%e],t[i%e],t[(i+1)%e],t[(i+2)%e])}}));var Rn,Ln,Dn=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Wn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$n=new RegExp(Wn.source,"g"),Fn=function(t,e){var n,i,r,o=Wn.lastIndex=$n.lastIndex=0,s=-1,a=[],h=[];for(t+="",e+="";(n=Wn.exec(t))&&(i=$n.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,h.push({i:s,x:Dn(n,i)})),o=$n.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,i=0;i<e;++i)a[(n=h[i]).i]=n.x(t);return a.join("")})},qn=function(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]},Hn=0,Xn=0,Yn=0,Un=0,Gn=0,Qn=0,Kn="object"==typeof performance&&performance.now?performance:Date,Jn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Zn(){return Gn||(Jn(ti),Gn=Kn.now()+Qn)}function ti(){Gn=0}function ei(){this._call=this._time=this._next=null}function ni(t,e,n){var i=new ei;return i.restart(t,e,n),i}function ii(){Gn=(Un=Kn.now())+Qn,Hn=Xn=0;try{!function(){Zn(),++Hn;for(var t,e=Rn;e;)(t=Gn-e._time)>=0&&e._call.call(null,t),e=e._next;--Hn}()}finally{Hn=0,function(){for(var t,e,n=Rn,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Rn=e);Ln=t,oi(i)}(),Gn=0}}function ri(){var t=Kn.now(),e=t-Un;e>1e3&&(Qn-=e,Un=t)}function oi(t){Hn||(Xn&&(Xn=clearTimeout(Xn)),t-Gn>24?(t<1/0&&(Xn=setTimeout(ii,t-Kn.now()-Qn)),Yn&&(Yn=clearInterval(Yn))):(Yn||(Un=Kn.now(),Yn=setInterval(ri,1e3)),Hn=1,Jn(ii)))}ei.prototype=ni.prototype={constructor:ei,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Zn():+n)+(null==e?0:+e),this._next||Ln===this||(Ln?Ln._next=this:Rn=this,Ln=this),this._call=t,this._time=n,oi()},stop:function(){this._call&&(this._call=null,this._time=1/0,oi())}};var si=function(t,e,n){var i=new ei;return i.restart(n=>{i.stop(),t(n+e)},e=null==e?0:+e,n),i},ai=Vt("start","end","cancel","interrupt"),hi=[],li=function(t,e,n,i,r,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(h){var l,c,u,f;if(1!==n.state)return a();for(l in r)if((f=r[l]).name===n.name){if(3===f.state)return si(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[l]):+l<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[l])}if(si((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(h))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(u=n.tween.length),l=0,c=-1;l<u;++l)(f=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=f);i.length=c+1}}function s(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=i.length;++o<s;)i[o].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=ni((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:ai,tween:hi,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function ci(t,e){var n=fi(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function ui(t,e){var n=fi(t,e);if(n.state>3)throw new Error("too late; already running");return n}function fi(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var di,pi=function(t,e){var n,i,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete t.__transition}},vi=180/Math.PI,gi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},mi=function(t,e,n,i,r,o){var s,a,h;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(h=t*n+e*i)&&(n-=t*h,i-=e*h),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,h/=a),t*i<e*n&&(t=-t,e=-e,h=-h,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*vi,skewX:Math.atan(h)*vi,scaleX:s,scaleY:a}};function yi(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],h=[];return o=t(o),s=t(s),function(t,i,r,o,s,a){if(t!==r||i!==o){var h=s.push("translate(",null,e,null,n);a.push({i:h-4,x:Dn(t,r)},{i:h-2,x:Dn(i,o)})}else(r||o)&&s.push("translate("+r+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,h),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:Dn(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(o.rotate,s.rotate,a,h),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:Dn(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(o.skewX,s.skewX,a,h),function(t,e,n,i,o,s){if(t!==n||e!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Dn(t,n)},{i:a-2,x:Dn(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,h),o=s=null,function(t){for(var e,n=-1,i=h.length;++n<i;)a[(e=h[n]).i]=e.x(t);return a.join("")}}}var bi=yi((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gi:mi(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),wi=yi((function(t){return null==t?gi:(di||(di=document.createElementNS("http://www.w3.org/2000/svg","g")),di.setAttribute("transform",t),(t=di.transform.baseVal.consolidate())?mi((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):gi)}),", ",")",")");function xi(t,e){var n,i;return function(){var r=ui(this,t),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}r.tween=i}}function _i(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=ui(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},h=0,l=r.length;h<l;++h)if(r[h].name===e){r[h]=a;break}h===l&&r.push(a)}o.tween=r}}function Ii(t,e,n){var i=t._id;return t.each((function(){var t=ui(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return fi(t,i).value[e]}}var Ci=function(t,e){var n;return("number"==typeof e?Dn:e instanceof wn?An:(n=wn(e))?(e=n,An):Fn)(t,e)};function Si(t){return function(){this.removeAttribute(t)}}function ki(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ei(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===i?r:r=e(i=s,n)}}function Mi(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===i?r:r=e(i=s,n)}}function Ti(t,e,n){var i,r,o;return function(){var s,a,h=n(this);if(null!=h)return(s=this.getAttribute(t))===(a=h+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,h));this.removeAttribute(t)}}function Oi(t,e,n){var i,r,o;return function(){var s,a,h=n(this);if(null!=h)return(s=this.getAttributeNS(t.space,t.local))===(a=h+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,h));this.removeAttributeNS(t.space,t.local)}}function Bi(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ji(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function zi(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&ji(t,r)),n}return r._value=e,r}function Pi(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Bi(t,r)),n}return r._value=e,r}function Vi(t,e){return function(){ci(this,t).delay=+e.apply(this,arguments)}}function Ai(t,e){return e=+e,function(){ci(this,t).delay=e}}function Ni(t,e){return function(){ui(this,t).duration=+e.apply(this,arguments)}}function Ri(t,e){return e=+e,function(){ui(this,t).duration=e}}function Li(t,e){if("function"!=typeof e)throw new Error;return function(){ui(this,t).ease=e}}function Di(t,e,n){var i,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?ci:ui;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}var Wi=Ge.prototype.constructor;function $i(t){return function(){this.style.removeProperty(t)}}function Fi(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function qi(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&Fi(t,o,n)),i}return o._value=e,o}function Hi(t){return function(e){this.textContent=t.call(this,e)}}function Xi(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Hi(i)),e}return i._value=t,i}var Yi=0;function Ui(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Gi(){return++Yi}var Qi=Ge.prototype;Ui.prototype=(function(t){return Ge().transition(t)}).prototype={constructor:Ui,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Nt(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,h,l=i[s],c=l.length,u=o[s]=new Array(c),f=0;f<c;++f)(a=l[f])&&(h=t.call(a,a.__data__,f,l))&&("__data__"in a&&(h.__data__=a.__data__),u[f]=h,li(u[f],e,n,f,u,fi(a,n)));return new Ui(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Dt(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var h,l=i[a],c=l.length,u=0;u<c;++u)if(h=l[u]){for(var f,d=t.call(h,h.__data__,u,l),p=fi(h,n),v=0,g=d.length;v<g;++v)(f=d[v])&&li(f,e,n,v,d,p);o.push(d),s.push(h)}return new Ui(o,s,e,n)},filter:function(t){"function"!=typeof t&&(t=Wt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,h=i[r]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&h.push(o);return new Ui(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=Math.min(i,n.length),o=new Array(i),s=0;s<r;++s)for(var a,h=e[s],l=n[s],c=h.length,u=o[s]=new Array(c),f=0;f<c;++f)(a=h[f]||l[f])&&(u[f]=a);for(;s<i;++s)o[s]=e[s];return new Ui(o,this._parents,this._name,this._id)},selection:function(){return new Wi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Gi(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],h=a.length,l=0;l<h;++l)if(s=a[l]){var c=fi(s,e);li(s,t,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ui(i,this._parents,t,n)},call:Qi.call,nodes:Qi.nodes,node:Qi.node,size:Qi.size,empty:Qi.empty,each:Qi.each,on:function(t,e){var n=this._id;return arguments.length<2?fi(this.node(),n).on.on(t):this.each(Di(n,t,e))},attr:function(t,e){var n=ne(t),i="transform"===n?wi:Ci;return this.attrTween(t,"function"==typeof e?(n.local?Oi:Ti)(n,i,Ii(this,"attr."+t,e)):null==e?(n.local?ki:Si)(n):(n.local?Mi:Ei)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=ne(t);return this.tween(n,(i.local?zi:Pi)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?bi:Ci;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=de(this,t),s=(this.style.removeProperty(t),de(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}(t,i)).on("end.style."+t,$i(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var s=de(this,t),a=n(this),h=a+"";return null==a&&(this.style.removeProperty(t),h=a=de(this,t)),s===h?null:s===i&&h===r?o:(r=h,o=e(i=s,a))}}(t,i,Ii(this,"style."+t,e))).each(function(t,e){var n,i,r,o,s="style."+e,a="end."+s;return function(){var h=ui(this,t),l=h.on,c=null==h.value[s]?o||(o=$i(e)):void 0;l===n&&r===c||(i=(n=l).copy()).on(a,r=c),h.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+"";return function(){var s=de(this,t);return s===o?null:s===i?r:r=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,qi(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Ii(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Xi(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=fi(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?xi:_i)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Vi:Ai)(e,t)):fi(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Ni:Ri)(e,t)):fi(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Li(e,t)):fi(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;ui(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,s){var a={value:s},h={value:function(){0==--r&&o()}};n.each((function(){var n=ui(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(h)),n.on=e})),0===r&&o()}))},[Symbol.iterator]:Qi[Symbol.iterator]};var Ki={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Ji(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Zi(t){return{type:t}}Ge.prototype.interrupt=function(t){return this.each((function(){pi(this,t)}))},Ge.prototype.transition=function(t){var e,n;t instanceof Ui?(e=t._id,t=t._name):(e=Gi(),(n=Ki).time=Zn(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],h=a.length,l=0;l<h;++l)(s=a[l])&&li(s,t,e,l,a,n||Ji(s,e));return new Ui(i,this._parents,t,e)},Math,["w","e"].map(Zi),["n","s"].map(Zi),["n","w","e","s","nw","ne","sw","se"].map(Zi);var tr=t=>()=>t;function er(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:o,x:s,y:a,dx:h,dy:l,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:c}})}function nr(t){return!t.ctrlKey&&!t.button}function ir(){return this.parentNode}function rr(t,e){return null==e?{x:t.x,y:t.y}:e}function or(){return navigator.maxTouchPoints||"ontouchstart"in this}er.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const sr=Math.PI,ar=2*sr,hr=1e-6,lr=ar-hr;function cr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ur(){return new cr}cr.prototype=ur.prototype={constructor:cr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){var o=this._x1,s=this._y1,a=(n=+n)-(t=+t),h=(i=+i)-(e=+e),l=o-t,c=s-e,u=l*l+c*c;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>hr)if(Math.abs(c*a-h*l)>hr&&r){var f=n-o,d=i-s,p=a*a+h*h,v=f*f+d*d,g=Math.sqrt(p),m=Math.sqrt(u),y=r*Math.tan((sr-Math.acos((p+u-v)/(2*g*m)))/2),b=y/m,w=y/g;Math.abs(b-1)>hr&&(this._+="L"+(t+b*l)+","+(e+b*c)),this._+="A"+r+","+r+",0,0,"+ +(c*f>l*d)+","+(this._x1=t+w*a)+","+(this._y1=e+w*h)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(i),a=n*Math.sin(i),h=t+s,l=e+a,c=1^o,u=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+h+","+l:(Math.abs(this._x1-h)>hr||Math.abs(this._y1-l)>hr)&&(this._+="L"+h+","+l),n&&(u<0&&(u=u%ar+ar),u>lr?this._+="A"+n+","+n+",0,1,"+c+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=h)+","+(this._y1=l):u>hr&&(this._+="A"+n+","+n+",0,"+ +(u>=sr)+","+c+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var fr=ur,dr=function(t){return function(){return t}};function pr(t){this._context=t}pr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var vr=function(t){return new pr(t)};function gr(t){return t[0]}function mr(t){return t[1]}function yr(t){return((t=Math.exp(t))+1/t)/2}var br=function t(e,n,i){function r(t,r){var o,s,a=t[0],h=t[1],l=t[2],c=r[2],u=r[0]-a,f=r[1]-h,d=u*u+f*f;if(d<1e-12)s=Math.log(c/l)/e,o=function(t){return[a+t*u,h+t*f,l*Math.exp(e*t*s)]};else{var p=Math.sqrt(d),v=(c*c-l*l+i*d)/(2*l*n*p),g=(c*c-l*l-i*d)/(2*c*n*p),m=Math.log(Math.sqrt(v*v+1)-v),y=Math.log(Math.sqrt(g*g+1)-g);s=(y-m)/e,o=function(t){var i,r=t*s,o=yr(m),c=l/(n*p)*(o*(i=e*r+m,((i=Math.exp(2*i))-1)/(i+1))-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[a+c*u,h+c*f,l*o/yr(e*r+m)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return r.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},r}(Math.SQRT2,2,4),wr=t=>()=>t;function xr(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function _r(t,e,n){this.k=t,this.x=e,this.y=n}_r.prototype={constructor:_r,scale:function(t){return 1===t?this:new _r(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new _r(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ir=new _r(1,0,0);function Cr(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ir;return t.__zoom}function Sr(t){t.stopImmediatePropagation()}Cr.prototype=_r.prototype;var kr=function(t){t.preventDefault(),t.stopImmediatePropagation()};function Er(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Mr(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Tr(){return this.__zoom||Ir}function Or(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Br(){return navigator.maxTouchPoints||"ontouchstart"in this}function jr(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}var zr=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,i){return t[0]===e&&(n=i,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(e,n){var i=t(this.__entries__,e);~i?this.__entries__[i][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,i=t(n,e);~i&&n.splice(i,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,i=this.__entries__;n<i.length;n++){var r=i[n];t.call(e,r[1],r[0])}},e}()}(),Pr="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Vr="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Ar="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Vr):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},Nr=["top","right","bottom","left","width","height","size","weight"],Rr="undefined"!=typeof MutationObserver,Lr=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,i=!1,r=0;function o(){n&&(n=!1,t()),i&&a()}function s(){Ar(o)}function a(){var t=Date.now();if(n){if(t-r<2)return;i=!0}else n=!0,i=!1,setTimeout(s,20);r=t}return a}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Pr&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Rr?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Pr&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;Nr.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),Dr=function(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},Wr=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Vr},$r=Xr(0,0,0,0);function Fr(t){return parseFloat(t)||0}function qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+Fr(t["border-"+n+"-width"])}),0)}var Hr="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof Wr(t).SVGGraphicsElement}:function(t){return t instanceof Wr(t).SVGElement&&"function"==typeof t.getBBox};function Xr(t,e,n,i){return{x:t,y:e,width:n,height:i}}var Yr=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Xr(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t,e=(t=this.target,Pr?Hr(t)?function(t){var e=t.getBBox();return Xr(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return $r;var i=Wr(t).getComputedStyle(t),r=function(t){for(var e={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var r=i[n];e[r]=Fr(t["padding-"+r])}return e}(i),o=r.left+r.right,s=r.top+r.bottom,a=Fr(i.width),h=Fr(i.height);if("border-box"===i.boxSizing&&(Math.round(a+o)!==e&&(a-=qr(i,"left","right")+o),Math.round(h+s)!==n&&(h-=qr(i,"top","bottom")+s)),!function(t){return t===Wr(t).document.documentElement}(t)){var l=Math.round(a+o)-e,c=Math.round(h+s)-n;1!==Math.abs(l)&&(a-=l),1!==Math.abs(c)&&(h-=c)}return Xr(r.left,r.top,a,h)}(t):$r);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Ur=function(t,e){var n,i,r,o,s,a,h,l=(i=(n=e).x,r=n.y,o=n.width,s=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,h=Object.create(a.prototype),Dr(h,{x:i,y:r,width:o,height:s,top:r,right:i+o,bottom:s+r,left:i}),h);Dr(this,{target:t,contentRect:l})},Gr=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new zr,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Wr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Yr(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Wr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new Ur(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Qr="undefined"!=typeof WeakMap?new WeakMap:new zr,Kr=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Lr.getInstance(),i=new Gr(e,n,this);Qr.set(this,i)};["observe","unobserve","disconnect"].forEach((function(t){Kr.prototype[t]=function(){var e;return(e=Qr.get(this))[t].apply(e,arguments)}}));var Jr=void 0!==Vr.ResizeObserver?Vr.ResizeObserver:Kr;let Zr=(()=>{class t{constructor(){this.elementSubjects=new Map,this.resizeObserver=new Jr(t=>{for(const n of t){var e=this.elementSubjects.get(n.target);if(null==e)return;e.next(n.contentRect)}})}listenToElementResize(t){this.resizeObserver.observe(t);const e=new St.a;return this.elementSubjects.set(t,e),e}unListenToElementResize(t){this.elementSubjects.delete(t),this.resizeObserver.unobserve(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var to=n("SwbK"),eo=n("EmTj"),no=n("v9BS"),io=n("nIj0"),ro=n("PBFl");const oo=["chart"],so=["weightSlider"];let ao=(()=>{class t{constructor(t,e,n){this.bloomaResizeListenerService=t,this.profileHelperService=e,this.dhDialogService=n,this.profileSelected=new s.o,this.itemWeightChanged=new s.o,this.childProfileWeightChanged=new s.o,this.linkClicked=new s.o,this.disconnectLinkClicked=new s.o,this._data=null,this.sliderContainerStyle={width:"0",height:"0",padding:"0"},this.unsubscribe$=new St.a,this.viewInitialized=!1,this.margin={top:10,bottom:20,left:150,right:10},this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.nodeSquareWidth=100,this.nodeSquareHeight=60,this.draggableSquareDimension=10,this.dragX=0,this.dragY=0,this.linkColor="gray",this.selectedNodeColor="green",this.clickedLinkSource=null,this.clickedLinkTarget=null,this.weightTargetType=null,this.clickedLinkEvent=null,this.sliderElementHeight=124,this.sliderElementWidth=124,this.previousGraphAreaTransform=null,this.defaultRectColor="black",this.profileRectColor="blue",this.profileItemRectColor="black";const i=new St.a;i.pipe(Object(kt.a)(400),Object(Et.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=i}get data(){return this._data}set data(t){this._data=t,this.createSubject.next()}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Et.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},800)}createChart(){if(!this.viewInitialized)return;if(!this.data)return;const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.initSvg(),this.setSvgHeight(),this.drawHierarchy(),this.setUpZoomBehavior(),setTimeout(()=>{Object(s.lb)(this)},50))}initSvg(){if(!this.svg){const t=Qe(this.chartContainer.nativeElement).append("svg");this.svg=t}}setSvgHeight(){this.svg.attr("height",this.totalComponentHeight).attr("width",this.totalComponentWidth)}mouseOverProfile(t){this.dragTargetData=t}mouseLeaveProfile(t){this.dragTargetData=null}getDragBehavior(){const t=this;return function(){var t,e,n,i,r=nr,o=ir,s=rr,a=or,h={},l=Vt("start","drag","end"),c=0,u=0;function f(t){t.on("mousedown.drag",d).filter(a).on("touchstart.drag",g).on("touchmove.drag",m).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(s,a){if(!i&&r.call(this,s,a)){var h=b(this,o.call(this,s,a),s,a,"mouse");h&&(Qe(s.view).on("mousemove.drag",p,!0).on("mouseup.drag",v,!0),Ze(s.view),Ke(s),n=!1,t=s.clientX,e=s.clientY,h("start",s))}}function p(i){if(Je(i),!n){var r=i.clientX-t,o=i.clientY-e;n=r*r+o*o>u}h.mouse("drag",i)}function v(t){Qe(t.view).on("mousemove.drag mouseup.drag",null),tn(t.view,n),Je(t),h.mouse("end",t)}function g(t,e){if(r.call(this,t,e)){var n,i,s=t.changedTouches,a=o.call(this,t,e),h=s.length;for(n=0;n<h;++n)(i=b(this,a,t,e,s[n].identifier,s[n]))&&(Ke(t),i("start",t,s[n]))}}function m(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=h[i[e].identifier])&&(Je(t),n("drag",t,i[e]))}function y(t){var e,n,r=t.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<o;++e)(n=h[r[e].identifier])&&(Ke(t),n("end",t,r[e]))}function b(t,e,n,i,r,o){var a,u,d,p=l.copy(),v=qn(o||n,e);if(null!=(d=s.call(t,new er("beforestart",{sourceEvent:n,target:f,identifier:r,active:c,x:v[0],y:v[1],dx:0,dy:0,dispatch:p}),i)))return a=d.x-v[0]||0,u=d.y-v[1]||0,function n(o,s,l){var g,m=v;switch(o){case"start":h[r]=n,g=c++;break;case"end":delete h[r],--c;case"drag":v=qn(l||s,e),g=c}p.call(o,t,new er(o,{sourceEvent:s,subject:d,target:f,identifier:r,active:g,x:v[0]+a,y:v[1]+u,dx:v[0]-m[0],dy:v[1]-m[1],dispatch:p}),i)}}return f.filter=function(t){return arguments.length?(r="function"==typeof t?t:tr(!!t),f):r},f.container=function(t){return arguments.length?(o="function"==typeof t?t:tr(t),f):o},f.subject=function(t){return arguments.length?(s="function"==typeof t?t:tr(t),f):s},f.touchable=function(t){return arguments.length?(a="function"==typeof t?t:tr(!!t),f):a},f.on=function(){var t=l.on.apply(l,arguments);return t===l?f:t},f.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,f):Math.sqrt(u)},f}().on("start",(e,n)=>{this.setSelectedNode(n,e.sourceEvent);const i=this.svg.select("rect#r"+n.id);if(null!=i&&0!=i.size()){this.dragSourceNode=i;try{const t=+i.attr("original-x"),e=+i.attr("original-y");this.dragX=this.dragStartX=t,this.dragY=this.dragStartY=e}catch(r){}this.svg.selectAll(".profile-container").attr("pointer-events","mouseover").on("mouseover",(function(e,n){e.target.setAttribute("stroke","red"),t.mouseOverProfile(n)})).on("mouseout",(function(e,n){var i;null!=e.fromElement&&null!=e.toElement&&e.fromElement.parentElement!=e.toElement.parentElement&&(n.id!==(null===(i=t.selectedProfile)||void 0===i?void 0:i.id)&&e.target.setAttribute("stroke",t.getRectColorForItemType(n.data.itemType)),t.mouseLeaveProfile(n))})),e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}}).on("drag",(t,e)=>{if(this.svg.select("rect#r"+e.id),0==this.dragStartX)return;this.dragX+=t.dx,this.dragY+=t.dy;const n=[[+this.dragStartX,+this.dragStartY],[this.dragX,this.dragY]],i=this.getDragLine(),r=function(t,e){var n=dr(!0),i=null,r=vr,o=null;function s(s){var a,h,l,c=(s=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(s)).length,u=!1;for(null==i&&(o=r(l=fr())),a=0;a<=c;++a)!(a<c&&n(h=s[a],a,s))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(h,a,s),+e(h,a,s));if(l)return o=null,l+""||null}return t="function"==typeof t?t:void 0===t?gr:dr(t),e="function"==typeof e?e:void 0===e?mr:dr(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:dr(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:dr(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:dr(!!t),s):n},s.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),s):r},s.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),s):i},s}();i.attr("d",r(n))}).on("end",()=>{if(this.removeDragLine(),this.dragStartX=0,this.dragStartY=0,null==this.dragSourceNode||null==this.dragTargetData)return;const t=this.dragSourceNode.attr("id").substr(1),e=this.dragTargetData.id;if(t==e)return;const n=this.profileMap[e];this.changeIntroducesCycle(this.profileMap[t],e)||n.parentIds.find(e=>e==t)})}getRectColorForItemType(t){return"profile"===t?this.profileRectColor:this.profileItemRectColor}changeIntroducesCycle(t,e){if(null==t.parentIds)return!1;if(null==t?void 0:t.parentIds.find(t=>t==e))return!0;for(const n of null==t?void 0:t.parentIds)return this.changeIntroducesCycle(this.profileMap[n],e)}removeDragLine(){this.svg.select(".drag-line").remove(),this.dragLine=null}getDragLine(){return this.dragLine||(this.dragLine=this.svg.select(".graph-area").append("path").attr("class","drag-line").style("stroke","red").style("fill","none")),this.dragLine}drawHierarchy(){const t=this.svg.select(".graph-area");if(this.previousGraphAreaTransform=null,t.size()>0){const e=t.node();this.previousGraphAreaTransform=Cr(e)}this.svg.select(".graph-area").remove();const e=function(...t){if(t.length)throw Error(`got arguments to dagStratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);return function t(e,n,i){function r(t){if(!t.length)throw new Error("can't stratify empty data");const n=t.map((t,n)=>new d(function(t){if("string"!=typeof t)throw new Error("id is supposed to be string but got type "+typeof t);if(t.indexOf("\0")>=0)throw new Error(`node id ${t} contained null character`);return t}(e(t,n)),t)),r=new Map;n.forEach(t=>{if(r.has(t.id))throw new Error("found a duplicate id: "+t.id);r.set(t.id,t)});const o=[];return n.forEach((t,e)=>{const n=i(t.data,e)||[];n.forEach(([e,n])=>{const i=r.get(e);if(!i)throw new Error("missing id: "+e);return i.dataChildren.push(new u(t,n)),i}),n.length||o.push(t)}),function(t){if(!t.length)throw new Error("dag contained no roots");const e=new Set,n=new Set;let i=null;function r(t){if(e.has(t.id))return[];if(n.has(t.id))return i=t.id,[t.id];{n.add(t.id);let o=[];for(const e of t.ichildren())if(o=r(e),o.length)break;return n.delete(t.id),e.add(t.id),o.length&&null!==i&&o.push(t.id),i===t.id&&(i=null),o}}for(const o of t){const t=r(o);if(t.length)throw new Error("dag contained a cycle: "+t.reverse().join(" -> "))}for(const o of new p(t))if(new Set(o.ichildren().map(t=>t.id)).size!==o.dataChildren.length)throw new Error(`node '${o.id}' contained duplicate children`)}(o),o.length>1?new p(o):o[0]}return r.id=function(r){return void 0===r?e:t(r,n,i)},r.parentData=function(n){return void 0===n?i:t(e,function(t){function e(e,n){return(t(e,n)||[]).map(([t])=>t)}return e.wrapped=t,e}(n),n)},r.parentIds=function(i){return void 0===i?n:t(e,i,v(i))},r}(g,m,v(m))}();if(!this.data||0==this.data.length)return;let n;this.profileMap=this.profileHelperService.createProfileMap(this.data);try{n=e(this.data)}catch(l){return void this.dhDialogService.showMessage("error with local profile data. Please refresh")}const i=_t().nodeSize([80,390])(n),r=this.svg.append("g").attr("class","graph-area"),o=i.descendants(),s=this.getDragBehavior(),a=r.append("g").attr("class","links-group"),h=i.links();a.selectAll("line").data(h).enter().append("line").attr("class","line").attr("stroke",this.linkColor).attr("stroke-width","5").attr("data-id-source",t=>"r"+t.source.id).attr("data-id-target",t=>"r"+t.target.id).attr("x1",t=>this.margin.left+t.source.y).attr("x2",t=>this.margin.left+t.target.y).attr("y1",t=>this.margin.top+t.source.x).attr("y2",t=>this.margin.top+t.target.x).on("mouseover",(t,e)=>{Qe(t.srcElement).attr("stroke","red")}).on("mouseout",(t,e)=>{Qe(t.srcElement).attr("stroke",this.linkColor)}).on("click",(t,e)=>{this.clickedLinkSource=e.source.id,this.clickedLinkTarget=e.target.data.originalId,this.weightTargetType=e.target.data.scores?"item":"childProfile",this.clickedLinkEvent=t,Qe(t.srcElement).attr("stroke",this.linkColor),this.linkClicked.next(this.clickedLinkSource)}),r.append("g").attr("class","nodes-group").selectAll("g.node").data(o).enter().append("g").attr("class","node").attr("transform",t=>`translate(${this.margin.left+t.y},${this.margin.top+t.x})`).each((t,e,n)=>{const i=Qe(n[e]),r=i.append("rect").attr("id","r"+t.id).attr("fill","white").attr("original-x",this.margin.left+t.y).attr("original-y",this.margin.top+t.x).attr("stroke",t=>this.getRectColorForItemType(t.data.itemType)).call(s).on("click",(t,e)=>{this.setSelectedNode(e,t)}),o=i.append("text").attr("class","svg-text").attr("dx",10).text(t.data.name).on("click",(t,e)=>{const n=new Event("click",{});t.srcElement.parentElement.firstChild.dispatchEvent(n)}),a=o.node().getBBox(),h=Mt([a.width+20,this.nodeSquareWidth]),l=Mt([a.height,this.nodeSquareHeight]);r.attr("x",0-h/2).attr("class","profile-container").attr("y",-l/2).attr("width",h).attr("height",l),o.attr("x",0-h/2)})}setSelectedNode(t,e){this.setSelectedProfile(t),(".profile-container",new Ye([document.querySelectorAll(".profile-container")],[document.documentElement])).attr("stroke",t=>this.getRectColorForItemType(t.data.itemType)),Qe(e.srcElement).attr("stroke",this.selectedNodeColor)}saveNewWeight(){this.hideWeightSlider(),"item"==this.weightTargetType?this.itemWeightChanged.next({profileId:this.clickedLinkSource,updateProfileItemWeightDto:{newWeight:this.selectedWeight,profileItemName:this.clickedLinkTarget}}):this.childProfileWeightChanged.next({profileId:this.clickedLinkSource,subProfileId:this.clickedLinkTarget,updateSubProfileWeightDto:{newWeight:this.selectedWeight}})}hideWeightSlider(){Qe(this.weightSliderContainer.nativeElement).transition().duration(200).style("opacity",0),this.sliderContainerStyle={width:"0",height:"0",padding:"0"}}disconnect(){this.hideWeightSlider(),this.disconnectLinkClicked.next({profileId:this.clickedLinkSource,childProfileToDelete:this.clickedLinkTarget})}showWeightSlider(){var t;this.selectedWeight=null!==(t=this.getLinkWeight(this.clickedLinkSource,this.clickedLinkTarget))&&void 0!==t?t:0;const e=Qe(this.weightSliderContainer.nativeElement),n=this.selectTopForSlider(),i=this.selectLeftForSlider();this.sliderContainerStyle={width:"300px",left:i+"px",top:n+"px",padding:"10px"},e.transition().duration(200).style("opacity",1),Object(s.lb)(this)}selectTopForSlider(){return this.clickedLinkEvent.y+this.sliderElementHeight>=this.totalComponentHeight?this.totalComponentHeight-130:this.clickedLinkEvent.y}selectLeftForSlider(){return this.clickedLinkEvent.x+this.sliderElementWidth>=this.totalComponentWidth?this.totalComponentWidth-this.sliderElementWidth-10:this.clickedLinkEvent.x}weightChanged(t){this.selectedWeight=t.value}getLinkWeight(t,e){const n=this.weights[t];let i=n[e];i||(i=n[e.toUpperCase()]);const r=e.indexOf("_");return!i&&r>-1&&(i=n[e=e.substr(r+1)]),i}setUpZoomBehavior(){if(!this.data||0==this.data.length)return;const t=this.svg.select(".graph-area");var e=this.svg.select(".nodes-group").node();if(null==e)return;const n=e.getBBox(),i=[[0,0],[this.totalComponentWidth,this.totalComponentHeight]],r=[[0,-100],[n.width+this.margin.left+100,n.height]],o=function(){var t,e,n,i=Er,r=Mr,o=jr,s=Or,a=Br,h=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,u=br,f=Vt("start","zoom","end"),d=500,p=0,v=10;function g(t){t.property("__zoom",Tr).on("wheel.zoom",I).on("mousedown.zoom",C).on("dblclick.zoom",S).filter(a).on("touchstart.zoom",k).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(h[0],Math.min(h[1],e)))===t.k?t:new _r(e,t.x,t.y)}function y(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new _r(t.k,i,r)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,n,i){t.on("start.zoom",(function(){x(this,arguments).event(i).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(i).end()})).tween("zoom",(function(){var t=this,o=arguments,s=x(t,o).event(i),a=r.apply(t,o),h=null==n?b(a):"function"==typeof n?n.apply(t,o):n,l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),c=t.__zoom,f="function"==typeof e?e.apply(t,o):e,d=u(c.invert(h).concat(l/c.k),f.invert(h).concat(l/f.k));return function(t){if(1===t)t=f;else{var e=d(t),n=l/e[2];t=new _r(n,h[0]-e[0]*n,h[1]-e[1]*n)}s.zoom(null,t)}}))}function x(t,e,n){return!n&&t.__zooming||new _(t,e)}function _(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function I(t,...e){if(i.apply(this,arguments)){var n=x(this,e).event(t),r=this.__zoom,a=Math.max(h[0],Math.min(h[1],r.k*Math.pow(2,s.apply(this,arguments)))),c=qn(t);if(n.wheel)n.mouse[0][0]===c[0]&&n.mouse[0][1]===c[1]||(n.mouse[1]=r.invert(n.mouse[0]=c)),clearTimeout(n.wheel);else{if(r.k===a)return;n.mouse=[c,r.invert(c)],pi(this),n.start()}kr(t),n.wheel=setTimeout(u,150),n.zoom("mouse",o(y(m(r,a),n.mouse[0],n.mouse[1]),n.extent,l))}function u(){n.wheel=null,n.end()}}function C(t,...e){if(!n&&i.apply(this,arguments)){var r=x(this,e,!0).event(t),s=Qe(t.view).on("mousemove.zoom",f,!0).on("mouseup.zoom",d,!0),a=qn(t,h),h=t.currentTarget,c=t.clientX,u=t.clientY;Ze(t.view),Sr(t),r.mouse=[a,this.__zoom.invert(a)],pi(this),r.start()}function f(t){if(kr(t),!r.moved){var e=t.clientX-c,n=t.clientY-u;r.moved=e*e+n*n>p}r.event(t).zoom("mouse",o(y(r.that.__zoom,r.mouse[0]=qn(t,h),r.mouse[1]),r.extent,l))}function d(t){s.on("mousemove.zoom mouseup.zoom",null),tn(t.view,r.moved),kr(t),r.event(t).end()}}function S(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,s=qn(t.changedTouches?t.changedTouches[0]:t,this),a=n.invert(s),h=o(y(m(n,n.k*(t.shiftKey?.5:2)),s,a),r.apply(this,e),l);kr(t),c>0?Qe(this).transition().duration(c).call(w,h,s,t):Qe(this).call(g.transform,h,s,t)}}function k(n,...r){if(i.apply(this,arguments)){var o,s,a,h,l=n.touches,c=l.length,u=x(this,r,n.changedTouches.length===c).event(n);for(Sr(n),s=0;s<c;++s)h=[h=qn(a=l[s],this),this.__zoom.invert(h),a.identifier],u.touch0?u.touch1||u.touch0[2]===h[2]||(u.touch1=h,u.taps=0):(u.touch0=h,o=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(u.taps<2&&(e=h[0],t=setTimeout((function(){t=null}),d)),pi(this),u.start())}}function E(t,...e){if(this.__zooming){var n,i,r,s,a=x(this,e).event(t),h=t.changedTouches,c=h.length;for(kr(t),n=0;n<c;++n)r=qn(i=h[n],this),a.touch0&&a.touch0[2]===i.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===i.identifier&&(a.touch1[0]=r);if(i=a.that.__zoom,a.touch1){var u=a.touch0[0],f=a.touch0[1],d=a.touch1[0],p=a.touch1[1],v=(v=d[0]-u[0])*v+(v=d[1]-u[1])*v,g=(g=p[0]-f[0])*g+(g=p[1]-f[1])*g;i=m(i,Math.sqrt(v/g)),r=[(u[0]+d[0])/2,(u[1]+d[1])/2],s=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(y(i,r,s),a.extent,l))}}function M(t,...i){if(this.__zooming){var r,o,s=x(this,i).event(t),a=t.changedTouches,h=a.length;for(Sr(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),d),r=0;r<h;++r)o=a[r],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=qn(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<v)){var l=Qe(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return g.transform=function(t,e,n,i){var r=t.selection?t.selection():t;r.property("__zoom",Tr),t!==r?w(t,e,n,i):r.interrupt().each((function(){x(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},g.scaleBy=function(t,e,n,i){g.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),n,i)},g.scaleTo=function(t,e,n,i){g.transform(t,(function(){var t=r.apply(this,arguments),i=this.__zoom,s=null==n?b(t):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(s),h="function"==typeof e?e.apply(this,arguments):e;return o(y(m(i,h),s,a),t,l)}),n,i)},g.translateBy=function(t,e,n,i){g.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),l)}),null,i)},g.translateTo=function(t,e,n,i,s){g.transform(t,(function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==i?b(t):"function"==typeof i?i.apply(this,arguments):i;return o(Ir.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)}),i,s)},_.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Qe(this.that).datum();f.call(t,this.that,new xr(t,{sourceEvent:this.sourceEvent,target:g,type:t,transform:this.that.__zoom,dispatch:f}),e)}},g.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:wr(+t),g):s},g.filter=function(t){return arguments.length?(i="function"==typeof t?t:wr(!!t),g):i},g.touchable=function(t){return arguments.length?(a="function"==typeof t?t:wr(!!t),g):a},g.extent=function(t){return arguments.length?(r="function"==typeof t?t:wr([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):r},g.scaleExtent=function(t){return arguments.length?(h[0]=+t[0],h[1]=+t[1],g):[h[0],h[1]]},g.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],g):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},g.constrain=function(t){return arguments.length?(o=t,g):o},g.duration=function(t){return arguments.length?(c=+t,g):c},g.interpolate=function(t){return arguments.length?(u=t,g):u},g.on=function(){var t=f.on.apply(f,arguments);return t===f?g:t},g.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,g):Math.sqrt(p)},g.tapDistance=function(t){return arguments.length?(v=+t,g):v},g}().scaleExtent([.1,10]).extent(i).translateExtent(r).on("zoom",e=>{t.attr("transform",e.transform)});this.svg.call(o),this.previousGraphAreaTransform&&this.svg.call(o.transform,this.previousGraphAreaTransform)}setSelectedProfile(t){this.profileSelected.next({selectedNodeId:t.id,nodeType:t.data.itemType})}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(Zr),s.Nb(to.a),s.Nb(eo.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-hierarchy"]],viewQuery:function(t,e){var n;1&t&&(s.Bc(oo,!0),s.Bc(so,!0)),2&t&&(s.kc(n=s.bc())&&(e.chartContainer=n.first),s.kc(n=s.bc())&&(e.weightSliderContainer=n.first))},inputs:{data:"data",weights:"weights",selectedProfile:"selectedProfile"},outputs:{profileSelected:"profileSelected",itemWeightChanged:"itemWeightChanged",childProfileWeightChanged:"childProfileWeightChanged",linkClicked:"linkClicked",disconnectLinkClicked:"disconnectLinkClicked"},decls:14,vars:3,consts:[["id","rent-comparable-graph",1,"rent-comparable-graph"],["chart",""],["id","weight-slider",1,"bg-yellow-200","overflow-hidden",3,"ngStyle"],["weightSlider",""],["min","1","max","100","step","1",3,"ngModel","ngModelChange","input"],[1,"flex"],["mat-flat-button","","color","primary",1,"mx-2",3,"click"],["mat-flat-button","","color","warn",1,"mx-2",3,"click"]],template:function(t,e){1&t&&(s.Ob(0,"div",0,1),s.Tb(2,"div",2,3),s.Tb(4,"div"),s.xc(5),s.Sb(),s.Tb(6,"mat-slider",4),s.ac("ngModelChange",(function(t){return e.selectedWeight=t}))("input",(function(t){return e.weightChanged(t)})),s.Sb(),s.Tb(7,"div",5),s.Tb(8,"button",6),s.ac("click",(function(){return e.saveNewWeight()})),s.xc(9,"Save"),s.Sb(),s.Tb(10,"button",7),s.ac("click",(function(){return e.hideWeightSlider()})),s.xc(11,"Cancel"),s.Sb(),s.Tb(12,"button",7),s.ac("click",(function(){return e.disconnect()})),s.xc(13,"Disconnect"),s.Sb(),s.Sb(),s.Sb()),2&t&&(s.Cb(2),s.jc("ngStyle",e.sliderContainerStyle),s.Cb(3),s.zc("Weight: ",e.selectedWeight,""),s.Cb(1),s.jc("ngModel",e.selectedWeight))},directives:[i.l,no.a,io.j,io.m,ro.a],styles:[".rent-comparable-graph[_ngcontent-%COMP%]{height:inherit;width:inherit}#weight-slider[_ngcontent-%COMP%]{background-color:#fff;color:#000;position:absolute;opacity:0;width:0}#weight-slider[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:100%}.svg-text[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}"]}),t})();var ho=n("yDe4"),lo=n("C9XJ"),co=n("rxR5"),uo=n("PC4E"),fo=n("oYEq"),po=n("pLgK");let vo=(()=>{class t{constructor(t,e){this.store=t,this.actions$=e,this.keyChanged$=new St.a,this.actions$.pipe(Object(ho.l)(lo.b)).subscribe(()=>{this.keyChanged$.next()})}selectProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new co.j(t)).toPromise()}))}updateChildProfileLinkWeight(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new fo.f(t)).toPromise(),!!this.store.selectSnapshot(po.a.getUpdateSubChildWeightStatus)}))}disconectSubProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new co.i(t)).toPromise(),!!this.store.selectSnapshot(uo.a.getDisconnectSubProfileError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(ho.h),s.Xb(ho.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(ho.e)(uo.a.getState)],t.prototype,"profileState$",void 0),Object(o.b)([Object(ho.e)(po.a.getState)],t.prototype,"weightState$",void 0),t})();var go=n("pg5I"),mo=n("HOZh"),yo=n("yD3o"),bo=n("yzyx"),wo=n("LaE4"),xo=n("zjL5"),_o=n("P/uR");const Io={provide:io.h,useExisting:Object(s.U)(()=>Co),multi:!0};let Co=(()=>{class t{constructor(){this.isDisabled=!1,this.propagateChange=t=>{},this.propagateTouched=t=>{}}writeValue(t){void 0!==t&&(this.value=t,this.propagateChange(this.value),this.propagateTouched(this.value))}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){this.propagateTouched=t}changeMade(t){this.propagateChange(t.value)}setDisabledState(t){this.isDisabled=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-slider-control"]],features:[s.Bb([Io])],decls:1,vars:2,consts:[["thumbLabel","","tickInterval","1","min","1","max","100",3,"ngModel","disabled","ngModelChange","change"]],template:function(t,e){1&t&&(s.Tb(0,"mat-slider",0),s.ac("ngModelChange",(function(t){return e.value=t}))("change",(function(t){return e.changeMade(t)})),s.Sb()),2&t&&s.jc("ngModel",e.value)("disabled",e.isDisabled)},directives:[no.a,io.j,io.m],styles:[""]}),t})();function So(t,e){if(1&t&&(s.Tb(0,"div",4),s.Rb(1,5),s.Tb(2,"label"),s.xc(3),s.ec(4,"removeParentIdFromSubProfile"),s.Sb(),s.Ob(5,"dh-slider-control",6),s.Qb(),s.Sb()),2&t){const t=e.index,n=s.dc();s.Cb(1),s.jc("formGroupName",t),s.Cb(2),s.yc(s.gc(4,2,n.subProfiles.controls[t].get("id").value,n.parentProfileId))}}let ko=(()=>{class t{constructor(t){this.formBuilder=t,this.removeParentIdFromSubProfile=new xo.a}ngOnInit(){this.form=this.formBuilder.group({subProfiles:this.formBuilder.array(this.getFormGroupsForIds())})}get subProfiles(){return this.form.get("subProfiles")}getFormGroupsForIds(){return this.ids.map(t=>{const e=this.removeParentIdFromSubProfile.transform(t,this.parentProfileId);return this.formBuilder.group({id:[t,[]],weight:[this.weights[e],[]]})})}getChanges(){const t=this.subProfiles.controls.map(t=>t.value).reduce((t,e)=>(t[e.id]=e.weight,t),{});return this.ids.reduce((e,n)=>{const i=this.removeParentIdFromSubProfile.transform(n,this.parentProfileId),r=t[n];return r!=this.weights[i]&&e.push({newWeight:r,id:n}),e},[])}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(io.c))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-sub-profiles-edit"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights"},decls:5,vars:2,consts:[[1,"mt-10"],["ngxsForm","selectionActions.subProfileWeightForm",3,"formGroup"],["formArrayName","subProfiles",1,"mt-10"],["class","mb-10",4,"ngFor","ngForOf"],[1,"mb-10"],[3,"formGroupName"],["formControlName","weight"]],template:function(t,e){1&t&&(s.Tb(0,"h3",0),s.xc(1,"Sub-Profiles:"),s.Sb(),s.Rb(2,1),s.Tb(3,"div",2),s.vc(4,So,6,5,"div",3),s.Sb(),s.Qb()),2&t&&(s.Cb(2),s.jc("formGroup",e.form),s.Cb(2),s.jc("ngForOf",e.subProfiles.controls))},directives:[_o.c,io.k,io.e,io.b,i.j,io.f,Co,io.j,io.d],pipes:[xo.a],styles:[""]}),t})();var Eo=n("29Wa"),Mo=n("Cd2c");function To(t,e){1&t&&(s.Tb(0,"span"),s.xc(1,"Item "),s.Sb())}function Oo(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"dh-profile-item-form",4),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("profile",t.profile)}}function Bo(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"dh-sub-profiles-edit",5),s.Qb()),2&t){const t=e.ngIf,n=s.dc(2);s.Cb(1),s.jc("ids",null==n.profile?null:n.profile.childrenIds)("parentProfileId",null==n.profile?null:n.profile.id)("weights",t.weights[null==n.profile?null:n.profile.id])}}function jo(t,e){if(1&t&&(s.Rb(0),s.vc(1,Bo,2,3,"ng-container",2),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngIf",s.fc(2,1,t.weightStateService.weightState$))}}let zo=(()=>{class t{constructor(t,e){this.formBuilder=t,this.weightStateService=e}ngOnInit(){this.form=this.formBuilder.group({name:this.profile.name})}getProfileName(){return this.form.value.name}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(io.c),s.Nb(go.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-details-edit"]],viewQuery:function(t,e){var n;1&t&&(s.Bc(ko,!0),s.Bc(wo.a,!0)),2&t&&(s.kc(n=s.bc())&&(e.subProfilesEditComponent=n.first),s.kc(n=s.bc())&&(e.profileItemFormComponent=n.first))},inputs:{profile:"profile"},decls:9,vars:4,consts:[["ngxsForm","selectionActions.profileNameForm",3,"formGroup"],[1,"w-full"],[4,"ngIf"],["matInput","","placeholder","Name","formControlName","name","matInput","","placeholder","element name"],[3,"profile"],[3,"ids","parentProfileId","weights"]],template:function(t,e){1&t&&(s.Tb(0,"form",0),s.Tb(1,"mat-form-field",1),s.Tb(2,"mat-label"),s.xc(3,"Profile "),s.vc(4,To,2,0,"span",2),s.xc(5,"Name"),s.Sb(),s.Ob(6,"input",3),s.Sb(),s.Sb(),s.vc(7,Oo,2,1,"ng-container",2),s.vc(8,jo,3,3,"ng-container",2)),2&t&&(s.jc("formGroup",e.form),s.Cb(4),s.jc("ngIf","profile"!==e.profile.itemType),s.Cb(3),s.jc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[io.p,io.k,_o.c,io.e,Eo.b,Eo.e,i.k,Mo.a,io.a,io.j,io.d,wo.a,ko],pipes:[i.b],styles:[""]}),t})();var Po=n("YtkY");let Vo=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-item-score-chart"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t})(),Ao=(()=>{class t{transform(t,e){return null==t||null==e?null:e[t]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Mb({name:"getProfileElementById",type:t,pure:!0}),t})();function No(t,e){if(1&t&&(s.Rb(0),s.Tb(1,"div"),s.xc(2),s.Sb(),s.Qb()),2&t){const t=e.ngIf,n=s.dc(2);s.Cb(2),s.Ac(" ",t.name," ( weight: ",n.weights[t.originalId]||"1",") ")}}function Ro(t,e){if(1&t&&(s.Tb(0,"li"),s.vc(1,No,3,2,"ng-container",1),s.ec(2,"getProfileElementById"),s.Sb()),2&t){const t=e.$implicit,n=s.dc();s.Cb(1),s.jc("ngIf",s.gc(2,1,t,n.profileMap))}}let Lo=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-sub-profiles"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights",profileMap:"profileMap"},decls:4,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(s.Tb(0,"h3"),s.xc(1,"Sub-Profiles:"),s.Sb(),s.Tb(2,"ul"),s.vc(3,Ro,3,4,"li",0),s.Sb()),2&t&&(s.Cb(3),s.jc("ngForOf",e.ids))},directives:[i.j,i.k],pipes:[Ao],styles:[""]}),t})();function Do(t,e){if(1&t&&(s.Tb(0,"div",4),s.xc(1),s.Sb()),2&t){const t=s.dc();s.Cb(1),s.zc("Id: ",(null==t.profile?null:t.profile.id)||"No Type","")}}function Wo(t,e){if(1&t&&(s.Tb(0,"tr"),s.Tb(1,"th",6),s.xc(2),s.Sb(),s.Tb(3,"th",6),s.xc(4),s.Sb(),s.Sb()),2&t){const t=e.$implicit;s.Cb(2),s.yc(t.name),s.Cb(2),s.yc(t.score)}}function $o(t,e){if(1&t&&(s.Rb(0),s.Tb(1,"div",5),s.Tb(2,"table",4),s.Tb(3,"thead"),s.Tb(4,"tr"),s.Tb(5,"th",6),s.xc(6,"Value"),s.Sb(),s.Tb(7,"th",6),s.xc(8,"Score"),s.Sb(),s.Sb(),s.Sb(),s.Tb(9,"tbody"),s.vc(10,Wo,5,2,"tr",7),s.Sb(),s.Sb(),s.Ob(11,"dh-profile-item-score-chart"),s.Sb(),s.Qb()),2&t){const t=s.dc();s.Cb(10),s.jc("ngForOf",null==t.profile?null:t.profile.scores)}}function Fo(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"dh-sub-profiles",8),s.Qb()),2&t){const t=e.ngIf,n=s.dc().ngIf,i=s.dc(2);s.Cb(1),s.jc("ids",null==i.profile?null:i.profile.childrenIds)("parentProfileId",null==i.profile?null:i.profile.id)("profileMap",t)("weights",n.weights[null==i.profile?null:i.profile.id])}}function qo(t,e){if(1&t&&(s.Rb(0),s.vc(1,Fo,2,4,"ng-container",3),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc(2);s.Cb(1),s.jc("ngIf",s.fc(2,1,t.profileMap$))}}function Ho(t,e){if(1&t&&(s.Rb(0),s.vc(1,qo,3,3,"ng-container",3),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngIf",s.fc(2,1,t.weightStateService.weightState$))}}let Xo=(()=>{class t{constructor(t,e,n){this.weightStateService=t,this.profileMap$=e.profiles$.pipe(Object(Po.a)(t=>n.createProfileMap(t)))}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(go.a),s.Nb(yo.a),s.Nb(to.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-details-view"]],inputs:{profile:"profile"},decls:7,vars:5,consts:[[1,"mb-10","truncate"],[1,"mb-5","truncate"],["class","mb-5",4,"ngIf"],[4,"ngIf"],[1,"mb-5"],[1,"overflow-y-auto","limit-height"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"],[3,"ids","parentProfileId","profileMap","weights"]],template:function(t,e){1&t&&(s.Tb(0,"h2",0),s.xc(1),s.Sb(),s.Tb(2,"div",1),s.xc(3),s.Sb(),s.vc(4,Do,2,1,"div",2),s.vc(5,$o,12,1,"ng-container",3),s.vc(6,Ho,3,3,"ng-container",3)),2&t&&(s.Cb(1),s.yc(null==e.profile?null:e.profile.name),s.Cb(2),s.zc("Item Type: ",(null==e.profile?null:e.profile.itemType)||"No Type",""),s.Cb(1),s.jc("ngIf",!((null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0)),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.jc("ngIf",(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[i.k,i.j,Vo,Lo],pipes:[i.b],styles:[".limit-height[_ngcontent-%COMP%]{height:calc(100vh - 400px);max-height:calc(100vh - 400px)}"]}),t})();function Yo(t,e){if(1&t&&s.Ob(0,"dh-profile-details-view",5),2&t){const t=s.dc(3);s.jc("profile",t.profile)}}function Uo(t,e){if(1&t&&s.Ob(0,"dh-profile-details-edit",5),2&t){const t=s.dc(3);s.jc("profile",t.profile)}}function Go(t,e){if(1&t&&(s.Rb(0),s.vc(1,Yo,1,1,"dh-profile-details-view",4),s.vc(2,Uo,1,1,"dh-profile-details-edit",4),s.Qb()),2&t){const t=e.ngIf;s.Cb(1),s.jc("ngIf","none"==t),s.Cb(1),s.jc("ngIf","edit"==t)}}function Qo(t,e){if(1&t&&(s.Rb(0),s.Ob(1,"div",2),s.vc(2,Go,3,2,"ng-container",3),s.ec(3,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(2),s.jc("ngIf",s.fc(3,1,t.selectionActionStateService.action$))}}function Ko(t,e){1&t&&s.xc(0," No selected profile.\n")}let Jo=(()=>{class t{constructor(t){this.selectionActionStateService=t}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(bo.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile-details"]],viewQuery:function(t,e){var n;1&t&&s.Bc(zo,!0),2&t&&s.kc(n=s.bc())&&(e.profileDetailsEdit=n.first)},inputs:{profile:"profile"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noProfile",""],[1,"flex","justify-end","mb-16","mt-3"],[4,"ngIf"],[3,"profile",4,"ngIf"],[3,"profile"]],template:function(t,e){if(1&t&&(s.vc(0,Qo,4,3,"ng-container",0),s.vc(1,Ko,1,0,"ng-template",null,1,s.wc)),2&t){const t=s.lc(2);s.jc("ngIf",e.profile)("ngIfElse",t)}},directives:[i.k,Xo,zo],pipes:[i.b],styles:[""]}),t})();function Zo(t,e){if(1&t&&s.Ob(0,"dh-profile-details",4),2&t){const t=s.dc(2).ngIf;s.jc("profile",t.selectedProfile)}}function ts(t,e){if(1&t){const t=s.Ub();s.Rb(0),s.Tb(1,"dh-hierarchy",2),s.ac("profileSelected",(function(e){return s.nc(t),s.dc(2).selectProfile(e)}))("linkClicked",(function(e){return s.nc(t),s.dc(2).linkClicked(e)}))("itemWeightChanged",(function(e){return s.nc(t),s.dc(2).itemWeightValueChanged(e)}))("childProfileWeightChanged",(function(e){return s.nc(t),s.dc(2).childProfileWeightValueChanged(e)}))("disconnectLinkClicked",(function(e){return s.nc(t),s.dc(2).disconnectLinkClicked(e)})),s.Sb(),s.vc(2,Zo,1,1,"dh-profile-details",3),s.Qb()}if(2&t){const t=e.ngIf,n=s.dc().ngIf,i=s.dc();s.Cb(1),s.jc("data",n.profiles)("weights",t.weights)("selectedProfile",n.selectedProfile),s.Cb(1),s.jc("ngIf",i.fairlyBigScreen&&n.selectedProfile)}}function es(t,e){if(1&t&&(s.Rb(0),s.vc(1,ts,3,4,"ng-container",1),s.ec(2,"async"),s.Qb()),2&t){const t=s.dc();s.Cb(1),s.jc("ngIf",s.fc(2,1,t.profileVsService.weightState$))}}const ns=[{path:"",component:(()=>{class t{constructor(t,e,n,i,r,o){this.profileVsService=t,this.weightStateService=e,this.dhDialogService=n,this.breakpointObserver=i,this.profileStateService=r,this.selectionActionStateService=o,this.fairlyBigScreen=!0,this.breakpointObserver.observe("(max-width: 1200px)").subscribe(t=>{this.fairlyBigScreen=0==t.matches})}ngOnInit(){return Object(o.a)(this,void 0,void 0,(function*(){this.profileVsService.keyChanged$.subscribe(()=>Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var t=yield this.profileStateService.getProfiles();this.dhDialogService.hideLoading(),"error"==t&&this.dhDialogService.showMessage("error loading profile")})))}))}selectProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){yield this.selectionActionStateService.clearForms(),yield this.profileVsService.selectProfile(t.selectedNodeId),this.fairlyBigScreen?Object(s.lb)(this):this.showProfileDetailsModal()}))}showProfileDetailsModal(){}linkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){this.hierarchyComponent.showWeightSlider()}))}itemWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var e=yield this.weightStateService.updateItemLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating item weight":"Item weight updated")}))}childProfileWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var e=yield this.profileVsService.updateChildProfileLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating child profile weight":"Child profile weight updated")}))}disconnectLinkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){if(yield this.dhDialogService.showConfirmation({title:"Disconnect Sub Profile",message:"Are you sure you want to disconnect these profiles?"}).toPromise()){var e=yield this.profileVsService.disconectSubProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error disconnecting sub profile":"Sub Profile Disconnected")}}))}}return t.\u0275fac=function(e){return new(e||t)(s.Nb(vo),s.Nb(go.a),s.Nb(eo.a),s.Nb(mo.a),s.Nb(yo.a),s.Nb(bo.a))},t.\u0275cmp=s.Hb({type:t,selectors:[["dh-profile"]],viewQuery:function(t,e){var n;1&t&&s.Bc(ao,!0),2&t&&s.kc(n=s.bc())&&(e.hierarchyComponent=n.first)},decls:3,vars:3,consts:[[1,"flex"],[4,"ngIf"],[1,"block","flex-1","overflow-hidden",3,"data","weights","selectedProfile","profileSelected","linkClicked","itemWeightChanged","childProfileWeightChanged","disconnectLinkClicked"],["class","block border-l-4 px-10 text-base","style","width: 500px",3,"profile",4,"ngIf"],[1,"block","border-l-4","px-10","text-base",2,"width","500px",3,"profile"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.vc(1,es,3,3,"ng-container",1),s.ec(2,"async"),s.Sb()),2&t&&(s.Cb(1),s.jc("ngIf",s.fc(2,1,e.profileVsService.profileState$)))},directives:[i.k,ao,Jo],pipes:[i.b],styles:["dh-hierarchy[_ngcontent-%COMP%]{height:calc(100vh - 76px)}"]}),t})()}];let is=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[r.a.forChild(ns)],r.a]}),t})();var rs=n("R7+U"),os=n("W1gw");n("cqs0"),n("9bRT"),n("C05f"),n("ROBh"),n("J+dc"),n("xVbo"),n("5XID"),n("E5oP");let ss=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)}}),t})();var as=n("mFH5");n("g6G6");let hs=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},imports:[[ss,as.e],as.e]}),t})();var ls=n("bFHC"),cs=n("OZ4H"),us=n("evil");let fs=(()=>{class t{}return t.\u0275mod=s.Lb({type:t}),t.\u0275inj=s.Kb({factory:function(e){return new(e||t)},providers:[eo.a],imports:[[_o.a,i.c,is,io.g,io.o,no.b,ro.b,Eo.d,Mo.b,os.b,hs,ls.b,cs.f,us.a,rs.b]]}),t})()}}]);