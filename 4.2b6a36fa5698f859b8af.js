(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"723k":function(t,e,i){"use strict";i.r(e),i.d(e,"ProfileModule",(function(){return ra}));var n=i("2kYt"),r=i("sEIs"),o=i("D57K"),s=i("EM62");class a{constructor(t){this.base=t}[Symbol.iterator](){return this.base[Symbol.iterator]()}concat(...t){return l(function*(t){for(const e of t)yield*e}([this,...t.map(l)]))}entries(){return l(function*(t){let e=0;for(const i of t)yield[e++,i]}(this))}every(t){return!this.some((e,i)=>!t(e,i))}fill(t){return this.map(()=>t)}filter(t){return l(function*(e){for(const[i,n]of e)t(n,i)&&(yield n)}(this.entries()))}find(t){for(const[e,i]of this.entries())if(t(i,e))return i}findIndex(t){for(const[e,i]of this.entries())if(t(i,e))return e;return-1}flatMap(t){return l(function*(e){for(const[i,n]of e)yield*l(t(n,i))}(this.entries()))}forEach(t){for(const[e,i]of this.entries())t(i,e)}includes(t,e=0){return this.indexOf(t,e)>=0}indexOf(t,e=0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");for(const[i,n]of this.entries())if(i>=e&&n===t)return i;return-1}join(t=","){return[...this].join(t)}keys(){return l(function*(t){let e=0;for(const i of t)yield e++}(this))}lastIndexOf(t,e=1/0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");let i=-1;for(const[n,r]of this.entries())n<=e&&r===t&&(i=n);return i}get length(){return this.reduce(t=>t+1,0)}map(t){return l(function*(e){for(const[i,n]of e)yield t(n,i)}(this.entries()))}reduce(t,e){if(void 0===e){const e=t;let i=!0,n=void 0;for(const[t,r]of this.entries())i?(n=r,i=!1):n=e(n,r,t);if(i)throw new TypeError("Reduce of empty iterable with no initial value");return n}{const i=t;let n=e;for(const[t,e]of this.entries())n=i(n,e,t);return n}}reverse(){return l([...this].reverse())}slice(t=0,e=1/0){return l(function*(i){for(const[n,r]of i)if(n<t);else{if(!(n<e))break;yield r}}(this.entries()))}some(t){for(const[e,i]of this.entries())if(t(i,e))return!0;return!1}sort(t){return l([...this].sort(t))}splice(t,e=0,...i){return l(function*(n){for(const[r,o]of n)r===t&&(yield*i),(r<t||r>=t+e)&&(yield o)}(this.entries()))}values(){return this}}function l(t){return function(t){return"function"==typeof t[Symbol.iterator]}(t)?new a(t):new a({[Symbol.iterator]:()=>t})}function c(t,e){e.size<t.size&&([e,t]=[t,e]);for(const i of t)if(e.has(i))return!0;return!1}class h extends Map{getThrow(t){const e=this.get(t);if(void 0===e)throw new Error("map doesn't contain key: "+t);return e}getDefault(t,e){const i=this.get(t);return void 0===i?e:i}setIfAbsent(t,e){const i=this.get(t);return void 0===i?(this.set(t,e),e):i}}class u{constructor(t,e,i=[]){this.child=t,this.data=e,this.points=i}}class d{constructor(t,e,i,n){this.source=t,this.target=e,this.data=i,this.points=n}}class f{constructor(t,e){this.id=t,this.data=e,this.dataChildren=[]}iroots(){return l([this])}roots(){return[this]}*iterChildren(){for(const{child:t}of this.dataChildren)yield t}ichildren(){return l(this.iterChildren())}children(){return[...this.ichildren()]}*iterChildLinks(){for(const{child:t,data:e,points:i}of this.dataChildren)yield new d(this,t,e,i)}ichildLinks(){return l(this.iterChildLinks())}childLinks(){return[...this.ichildLinks()]}[Symbol.iterator](){return new p([this])[Symbol.iterator]()}idescendants(t="depth"){return new p([this]).idescendants(t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return new p([this]).ilinks()}links(){return[...this.ilinks()]}size(){return new p([this]).size()}sum(t){return new p([this]).sum(t),this}count(){return new p([this]).count(),this}height(){return new p([this]).height(),this}depth(){return new p([this]).depth(),this}split(){return[this]}connected(){return!0}}class p{constructor(t){this.dagRoots=t}[Symbol.iterator](){return this.idepth()}iroots(){return l(this.dagRoots)}roots(){return this.dagRoots.slice()}*idepth(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(e.add(i.id),yield i,t.push(...i.ichildren()))}*ibreadth(){const t=new Set;let e=this.roots(),i=[];do{let n;for(i=e.reverse(),e=[];n=i.pop();)t.has(n.id)||(t.add(n.id),yield n,e.push(...n.ichildren()))}while(e.length)}*ibefore(){const t=new h;for(const n of this)for(const e of n.ichildren())t.set(e.id,t.getDefault(e.id,0)+1);const e=this.roots();let i;for(;i=e.pop();){yield i;for(const n of i.ichildren()){const i=t.getThrow(n.id);i>1?t.set(n.id,i-1):e.push(n)}}}*iafter(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(i.ichildren().every(t=>e.has(t.id))?(e.add(i.id),yield i):(t.push(i),t.push(...i.ichildren())))}idescendants(t="depth"){if("depth"===t)return l(this.idepth());if("breadth"===t)return l(this.ibreadth());if("before"===t)return l(this.ibefore());if("after"===t)return l(this.iafter());throw new Error("unknown iteration style: "+t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return this.idescendants().flatMap(t=>t.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(t=>t+1,0)}sum(t){const e=new h;for(const[i,n]of this.idescendants("after").entries()){const r=t(n,i),o=new h;o.set(n.id,r);for(const t of n.ichildren()){const i=e.getThrow(t.id);for(const[t,e]of i.entries())o.set(t,e)}n.value=l(o.entries()).map(([,t])=>t).reduce((t,e)=>t+e),e.set(n.id,o)}return this}count(){const t=new h;for(const e of this.idescendants("after"))if(e.ichildren()[Symbol.iterator]().next().done)t.set(e.id,new Set([e.id])),e.value=1;else{const i=new Set;for(const n of e.ichildren()){const e=t.getThrow(n.id);for(const t of e)i.add(t)}t.set(e.id,i),e.value=i.size}return this}height(){for(const t of this.idescendants("after"))t.value=Math.max(0,...t.ichildren().map(t=>{if(void 0===t.value)throw new Error("`after` iteration didn't iterate in after order");return t.value+1}));return this}depth(){const t=new h;for(const e of this)for(const i of e.ichildren())t.setIfAbsent(i.id,[]).push(e);for(const e of this.idescendants("before"))e.value=Math.max(0,...t.getDefault(e.id,[]).map(t=>{if(void 0===t.value)throw new Error("`before` iteration didn't iterate in before order");return t.value+1}));return this}split(){const t=new h,e=new h;for(const r of this.iroots())t.set(r.id,[]),e.set(r.id,new Set(r.idescendants().map(t=>t.id)));for(const[r,o]of this.iroots().entries()){const i=e.getThrow(o.id);for(const n of this.iroots().slice(r+1))c(i,e.getThrow(n.id))&&(t.getThrow(o.id).push(n),t.getThrow(n.id).push(o))}const i=[],n=new Set;for(const r of this.iroots())if(!n.has(r.id)){n.add(r.id);const e=[r];i.push(e);const o=t.getThrow(r.id).slice();let s;for(;s=o.pop();)n.has(s.id)||(n.add(s.id),e.push(s),o.push(...t.getThrow(s.id)))}return i.map(t=>t.length>1?new p(t):t[0])}connected(){return 1===this.split().length}}function v(t){function e(e,i){return(t(e,i)||[]).map(t=>[t,void 0])}return e.wrapped=t,e}function g(t){if(function(t){try{return"string"==typeof t.id}catch(e){return!1}}(t))return t.id;throw new Error("default id function expected datum to have an id field but got: "+t)}function m(t){if(function(t){try{const e=t.parentIds;return void 0===e||e instanceof Array&&e.every(t=>"string"==typeof t)}catch(e){return!1}}(t))return t.parentIds;throw new Error("default parentIds function expected datum to have a parentIds field but got: "+t)}let b,y,w=1e-60;do{w+=w,b=1+.1*w,y=1+.2*w}while(b<=1||y<=1);var _=w,x=function(t,e,i,n=[],r=0,o=[0,0]){const s=[],a=[],l=[],c=[],h=[],u=[];let d="";const f=t.length-1,p=i[1].length-1;if(!n)for(let g=1;g<=p;g+=1)n[g]=0;if(f!==t[1].length-1&&(d="Dmat is not symmetric!"),f!==e.length-1&&(d="Dmat and dvec are incompatible!"),f!==i.length-1&&(d="Amat and dvec are incompatible!"),p!==n.length-1&&(d="Amat and bvec are incompatible!"),(r>p||r<0)&&(d="Value of meq is invalid!"),""!==d)return{message:d};for(let g=1;g<=p;g+=1)a[g]=0,c[g]=0;const v=Math.min(f,p);for(let g=1;g<=f;g+=1)l[g]=0;s[1]=0;for(let g=1;g<=2*f+v*(v+5)/2+2*p+1;g+=1)h[g]=0;for(let g=1;g<=2;g+=1)u[g]=0;return function(t,e,i,n,r,o,s,a,l,c,h,u,d,f=0,p,v,g){let m,b,y,w,x,C,S,I,k,E,M,O,R,T;const P=Math.min(n,h);let B=2*n+P*(P+5)/2+2*h+1;for(let _=1;_<=n;_+=1)v[_]=e[_];for(let _=n+1;_<=B;_+=1)v[_]=0;for(let _=1;_<=h;_+=1)d[_]=0,o[_]=0;const N=[];if(0===g[1]){if(function(t,e,i,n){let r,o,s;for(let a=1;a<=i;a+=1){if(n[1]=a,s=0,r=a-1,r<1){if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}else{for(let e=1;e<=r;e+=1){o=t[e][a];for(let i=1;i<e;i+=1)o-=t[i][a]*t[i][e];o/=t[e][e],t[e][a]=o,s+=o*o}if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}n[1]=0}}(t,0,n,N),0!==N[1])return void(g[1]=2);(function(t,e,i,n){let r,o;for(r=1;r<=i;r+=1){o=0;for(let e=1;e<r;e+=1)o+=t[e][r]*n[e];n[r]=(n[r]-o)/t[r][r]}for(let s=1;s<=i;s+=1){r=i+1-s,n[r]/=t[r][r],o=-n[r];for(let e=1;e<r;e+=1)n[e]+=o*t[e][r]}})(t,0,n,e),function(t,e,i){let n,r;for(let o=1;o<=i;o+=1){t[o][o]=1/t[o][o],r=-t[o][o];for(let e=1;e<o;e+=1)t[e][o]*=r;if(n=o+1,i<n)break;for(let e=n;e<=i;e+=1){r=t[o][e],t[o][e]=0;for(let i=1;i<=o;i+=1)t[i][e]+=r*t[i][o]}}}(t,0,n)}else{for(let i=1;i<=n;i+=1){r[i]=0;for(let n=1;n<=i;n+=1)r[i]+=t[n][i]*e[n]}for(let i=1;i<=n;i+=1){e[i]=0;for(let o=i;o<=n;o+=1)e[i]+=t[i][o]*r[o]}}s[1]=0;for(let _=1;_<=n;_+=1){r[_]=e[_],s[1]+=v[_]*r[_],v[_]=0;for(let e=_+1;e<=n;e+=1)t[e][_]=0}s[1]=-s[1]/2,g[1]=0;const j=n,V=j+n,A=V+P,D=A+P+1,z=D+P*(P+1)/2,L=z+h;for(let _=1;_<=h;_+=1){C=0;for(let t=1;t<=n;t+=1)C+=a[t][_]*a[t][_];v[L+_]=Math.sqrt(C)}function W(){p[1]+=1,B=z;for(let t=1;t<=h;t+=1){B+=1,C=-l[t];for(let e=1;e<=n;e+=1)C+=a[e][t]*r[e];if(Math.abs(C)<_&&(C=0),t>u)v[B]=C;else if(v[B]=-Math.abs(C),C>0){for(let e=1;e<=n;e+=1)a[e][t]=-a[e][t];l[t]=-l[t]}}for(let t=1;t<=w;t+=1)v[z+d[t]]=0;y=0,x=0;for(let t=1;t<=h;t+=1)v[z+t]<x*v[L+t]&&(y=t,x=v[z+t]/v[L+t]);if(0===y){for(let t=1;t<=w;t+=1)o[d[t]]=v[A+t];return 999}return 0}function q(){for(let e=1;e<=n;e+=1){C=0;for(let i=1;i<=n;i+=1)C+=t[i][e]*a[i][y];v[e]=C}m=j;for(let t=1;t<=n;t+=1)v[m+t]=0;for(let e=w+1;e<=n;e+=1)for(let i=1;i<=n;i+=1)v[m+i]=v[m+i]+t[i][e]*v[e];O=!0;for(let t=w;t>=1;t-=1){C=v[t],B=D+t*(t+3)/2,m=B-t;for(let e=t+1;e<=w;e+=1)C-=v[B]*v[V+e],B+=e;C/=v[m],v[V+t]=C,d[t]<=u||C<=0||(O=!1,b=t)}if(!O){S=v[A+b]/v[V+b];for(let t=1;t<=w;t+=1)d[t]<=u||v[V+t]<=0||(x=v[A+t]/v[V+t],x<S&&(S=x,b=t))}C=0;for(let t=j+1;t<=j+n;t+=1)C+=v[t]*v[t];if(Math.abs(C)<=_){if(O)return g[1]=1,999;for(let t=1;t<=w;t+=1)v[A+t]=v[A+t]-S*v[V+t];return v[A+w+1]=v[A+w+1]+S,700}C=0;for(let t=1;t<=n;t+=1)C+=v[j+t]*a[t][y];I=-v[z+y]/C,R=!0,O||S<I&&(I=S,R=!1);for(let t=1;t<=n;t+=1)r[t]+=I*v[j+t],Math.abs(r[t])<_&&(r[t]=0);s[1]+=I*C*(I/2+v[A+w+1]);for(let t=1;t<=w;t+=1)v[A+t]=v[A+t]-I*v[V+t];if(v[A+w+1]=v[A+w+1]+I,!R){C=-l[y];for(let t=1;t<=n;t+=1)C+=r[t]*a[t][y];if(y>u)v[z+y]=C;else if(v[z+y]=-Math.abs(C),C>0){for(let t=1;t<=n;t+=1)a[t][y]=-a[t][y];l[y]=-l[y]}return 700}w+=1,d[w]=y,B=D+(w-1)*w/2+1;for(let t=1;t<=w-1;t+=1)v[B]=v[t],B+=1;if(w===n)v[B]=v[n];else{for(let e=n;e>=w+1;e-=1)if(0!==v[e]&&(k=Math.max(Math.abs(v[e-1]),Math.abs(v[e])),E=Math.min(Math.abs(v[e-1]),Math.abs(v[e])),x=v[e-1]>=0?Math.abs(k*Math.sqrt(1+E*E/(k*k))):-Math.abs(k*Math.sqrt(1+E*E/(k*k))),k=v[e-1]/x,E=v[e]/x,1!==k))if(0===k){v[e-1]=E*x;for(let i=1;i<=n;i+=1)x=t[i][e-1],t[i][e-1]=t[i][e],t[i][e]=x}else{v[e-1]=x,M=E/(1+k);for(let i=1;i<=n;i+=1)x=k*t[i][e-1]+E*t[i][e],t[i][e]=M*(t[i][e-1]+x)-t[i][e],t[i][e-1]=x}v[B]=v[w]}return 0}function F(){if(B=D+b*(b+1)/2+1,m=B+b,0===v[m])return 798;if(k=Math.max(Math.abs(v[m-1]),Math.abs(v[m])),E=Math.min(Math.abs(v[m-1]),Math.abs(v[m])),x=v[m-1]>=0?Math.abs(k*Math.sqrt(1+E*E/(k*k))):-Math.abs(k*Math.sqrt(1+E*E/(k*k))),k=v[m-1]/x,E=v[m]/x,1===k)return 798;if(0===k){for(let t=b+1;t<=w;t+=1)x=v[m-1],v[m-1]=v[m],v[m]=x,m+=t;for(let e=1;e<=n;e+=1)x=t[e][b],t[e][b]=t[e][b+1],t[e][b+1]=x}else{M=E/(1+k);for(let t=b+1;t<=w;t+=1)x=k*v[m-1]+E*v[m],v[m]=M*(v[m-1]+x)-v[m],v[m-1]=x,m+=t;for(let e=1;e<=n;e+=1)x=k*t[e][b]+E*t[e][b+1],t[e][b+1]=M*(t[e][b]+x)-t[e][b+1],t[e][b]=x}return 0}function $(){m=B-b;for(let t=1;t<=b;t+=1)v[m]=v[B],B+=1,m+=1;return v[A+b]=v[A+b+1],d[b]=d[b+1],b+=1,b<w?797:0}function H(){return v[A+w]=v[A+w+1],v[A+w+1]=0,d[w]=0,w-=1,p[2]+=1,0}for(w=f,p[1]=0,p[2]=0,T=0;;){if(T=W(),999===T)return;for(;T=q(),0!==T;){if(999===T)return;if(700===T)if(b===w)H();else{for(;F(),T=$(),797===T;);H()}}}}(t,e,0,f,l,c,s,i,n,0,p,r,a,0,u,h,o),1===o[1]&&(d="constraints are inconsistent, no solution!"),2===o[1]&&(d="matrix D in quadratic function is not positive definite!"),{solution:l,Lagrangian:c,value:s,unconstrained_solution:e,iterations:u,iact:a,message:d}};function C(t,e){let[i,...n]=t,r=i.x=0;for(const o of n)r=o.x=r+e(i,o),i=o;if(r>0)for(const o of t)o.x/=r;else for(const o of t)o.x=.5}function S(t,e,i,n){t[i][i]+=n,t[i][e]-=n,t[e][i]-=n,t[e][e]+=n}function I(t,e,i,n,r){t[n][n]+=r,t[n][i]-=2*r,t[n][e]+=r,t[i][n]-=2*r,t[i][i]+=4*r,t[i][e]-=2*r,t[e][n]+=r,t[e][i]-=2*r,t[e][e]+=r}class k extends f{constructor(t){super(t,void 0)}}function E(t,e,i,n){this.feasible=i,this.evaluation=e,this.bounded=n,this._tableau=t}var M=E;function O(t,e,i,n,r){M.call(this,t,e,i,n),this.iter=r}E.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,n=e.variablesPerIndex,r=e.matrix,o=e.rhsColumn,s=e.height-1,a=Math.round(1/e.precision),l=1;l<=s;l+=1){var c=n[i[l]];void 0!==c&&!0!==c.isSlack&&(t[c.id]=Math.round((Number.EPSILON+r[l][o])*a)/a)}return t};var R=O;function T(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}O.prototype=Object.create(M.prototype),O.constructor=O;var P=T;function B(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}T.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},B.prototype.copy=function(){var t=new B(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},T.prototype.setOptionalObjective=function(t,e,i){var n=this.objectivesByPriority[t];void 0===n&&(n=new B(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=n,this.optionalObjectives.push(n),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),n.reducedCosts[e]=i},T.prototype.initialize=function(t,e,i,n){this.variables=i,this.unrestrictedVars=n,this.width=t,this.height=e;for(var r=new Array(t),o=0;o<t;o++)r[o]=0;this.matrix=new Array(e);for(var s=0;s<e;s++)this.matrix[s]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},T.prototype._resetMatrix=function(){var t,e,i=this.model.variables,n=this.model.constraints,r=i.length,o=n.length,s=this.matrix[0],a=!0===this.model.isMinimization?-1:1;for(t=0;t<r;t+=1){var l=i[t],c=l.priority,h=a*l.cost;0===c?s[t+1]=h:this.setOptionalObjective(c,t+1,h),this.rowByVarIndex[e=i[t].index]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var u=1,d=0;d<o;d+=1){var f,p,v=n[d],g=v.index;this.rowByVarIndex[g]=u,this.colByVarIndex[g]=-1,this.varIndexByRow[u]=g;var m=v.terms,b=m.length,y=this.matrix[u++];if(v.isUpperBound){for(f=0;f<b;f+=1)y[this.colByVarIndex[(p=m[f]).variable.index]]=p.coefficient;y[0]=v.rhs}else{for(f=0;f<b;f+=1)y[this.colByVarIndex[(p=m[f]).variable.index]]=-p.coefficient;y[0]=-v.rhs}}},T.prototype.setModel=function(t){return this.model=t,this.initialize(t.nVariables+1,t.nConstraints+1,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},T.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},T.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var n=e[i],r=0;r<this.width;r++)0!==n[r]&&(t+=1);return t/(this.height*this.width)},T.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*t)/t;this.evaluation=e,0===this.simplexIters&&(this.bestPossibleEval=e)},T.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new R(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new M(this,t,this.feasible,this.bounded)},P.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},P.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,n=this.rhsColumn,r=this.width-1,o=this.height-1,s=0;;){for(var a=0,l=-this.precision,c=1;c<=o;c++){var h=i[c][n];h<l&&(l=h,a=c)}if(0===a)return this.feasible=!0,s;for(var u=0,d=-1/0,f=i[0],p=i[a],v=1;v<=r;v++){var g=p[v];if(!0===this.unrestrictedVars[this.varIndexByCol[v]]||g<-this.precision){var m=-f[v]/g;d<m&&(d=m,u=v)}}if(0===u)return this.feasible=!1,s;if(t){e.push([this.varIndexByRow[a],this.varIndexByCol[u]]);var b=this.checkForCycles(e);if(b.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+b[0]),this.model.messages.push("Length :"+b[1]),this.feasible=!1,s}this.pivot(a,u),s+=1}},P.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,n=[],r=this.matrix,o=this.rhsColumn,s=this.width-1,a=this.height-1,l=this.precision,c=this.optionalObjectives.length,h=null,u=0;;){var d=r[this.costRowIndex];c>0&&(h=[]);for(var f=0,p=l,v=!1,g=1;g<=s;g++)t=d[g],e=!0===this.unrestrictedVars[this.varIndexByCol[g]],c>0&&-l<t&&t<l?h.push(g):e&&t<0?-t>p&&(p=-t,f=g,v=!0):t>p&&(p=t,f=g,v=!1);if(c>0)for(var m=0;0===f&&h.length>0&&m<c;){var b=[],y=this.optionalObjectives[m].reducedCosts;p=l;for(var w=0;w<h.length;w++)e=!0===this.unrestrictedVars[this.varIndexByCol[g=h[w]]],-l<(t=y[g])&&t<l?b.push(g):e&&t<0?-t>p&&(p=-t,f=g,v=!0):t>p&&(p=t,f=g,v=!1);h=b,m+=1}if(0===f)return this.setEvaluation(),this.simplexIters+=1,u;for(var _=0,x=1/0,C=1;C<=a;C++){var S=r[C],I=S[o],k=S[f];if(!(-l<k&&k<l)){if(k>0&&l>I&&I>-l){x=0,_=C;break}var E=v?-I/k:I/k;E>l&&x>E&&(x=E,_=C)}}if(x===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],u;if(i){n.push([this.varIndexByRow[_],this.varIndexByCol[f]]);var M=this.checkForCycles(n);if(M.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+M[0]),this.model.messages.push("Length :"+M[1]),this.feasible=!1,u}this.pivot(_,f,!0),u+=1}};var N=[];function j(t,e,i,n){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=n}function V(t,e,i,n){j.call(this,t,e,i,n)}function A(t,e){j.call(this,t,0,e,0)}function D(t,e){this.variable=t,this.coefficient=e}function z(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function L(t,e,i,n){this.slack=new A("s"+i,i),this.index=i,this.model=n,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function W(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}P.prototype.pivot=function(t,e){var i=this.matrix,n=i[t][e],r=this.height-1,o=this.width-1,s=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=s,this.rowByVarIndex[a]=t,this.rowByVarIndex[s]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[s]=e;for(var l,c,h,u=i[t],d=0,f=0;f<=o;f++)u[f]>=-1e-16&&u[f]<=1e-16?u[f]=0:(u[f]/=n,N[d]=f,d+=1);u[e]=1/n;for(var p=0;p<=r;p++)if(p!==t&&!(i[p][e]>=-1e-16&&i[p][e]<=1e-16)){var v=i[p];if((l=v[e])>=-1e-16&&l<=1e-16)0!==l&&(v[e]=0);else{for(c=0;c<d;c++)(h=u[f=N[c]])>=-1e-16&&h<=1e-16?0!==h&&(u[f]=0):v[f]=v[f]-l*h;v[e]=-l/n}}var g=this.optionalObjectives.length;if(g>0)for(var m=0;m<g;m+=1){var b=this.optionalObjectives[m].reducedCosts;if(0!==(l=b[e])){for(c=0;c<d;c++)0!==(h=u[f=N[c]])&&(b[f]=b[f]-l*h);b[e]=-l/n}}},P.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var n=t[e],r=t[i];if(n[0]===r[0]&&n[1]===r[1]){if(i-e>t.length-i)break;for(var o=!0,s=1;s<i-e;s++){var a=t[e+s],l=t[i+s];if(a[0]!==l[0]||a[1]!==l[1]){o=!1;break}}if(o)return[e,i-e]}}return[]},V.prototype.isInteger=!0,A.prototype.isSlack=!0,L.prototype.addTerm=function(t,e){var i=e.index,n=this.termsByVarIndex[i];return void 0===n?(n=new D(e,t),this.termsByVarIndex[i]=n,this.terms.push(n),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t)):this.setVariableCoefficient(n.coefficient+t,e),this},L.prototype.removeTerm=function(t){return this},L.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},L.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var n=this.termsByVarIndex[i];if(void 0===n)this.addTerm(t,e);else if(t!==n.coefficient){var r=t-n.coefficient;!0===this.isUpperBound&&(r=-r),n.coefficient=t,this.model.updateConstraintCoefficient(this,e,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},L.prototype.relax=function(t,e){this.relaxation=z(this.model,t,e),this._relax(this.relaxation)},L.prototype._relax=function(t){null!==t&&this.setVariableCoefficient(this.isUpperBound?-1:1,t)},W.prototype.isEquality=!0,W.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},W.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},W.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},W.prototype.relax=function(t,e){this.relaxation=z(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var q={Constraint:L,Variable:j,IntegerVariable:V,SlackVariable:A,Equality:W,Term:D},F=q.SlackVariable;function $(t,e){this.index=t,this.value=e}P.prototype.addCutConstraints=function(t){for(var e,i=t.length,n=this.height,r=n+i,o=n;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var s=this.width-1,a=0;a<i;a+=1){var l=t[a],c=n+a,h="min"===l.type?-1:1,u=l.varIndex,d=this.rowByVarIndex[u],f=this.matrix[c];if(-1===d){for(f[this.rhsColumn]=h*l.value,e=1;e<=s;e+=1)f[e]=0;f[this.colByVarIndex[u]]=h}else{var p=this.matrix[d];for(f[this.rhsColumn]=h*(l.value-p[this.rhsColumn]),e=1;e<=s;e+=1)f[e]=-h*p[e]}var v=this.getNewElementIndex();this.varIndexByRow[c]=v,this.rowByVarIndex[v]=c,this.colByVarIndex[v]=-1,this.variablesPerIndex[v]=new F("s"+v,v),this.nVars+=1}},P.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new F("s"+o,o),e[r][this.rhsColumn]=Math.floor(i);for(var s=1;s<this.varIndexByCol.length;s+=1)if(this.variablesPerIndex[this.varIndexByCol[s]].isInteger){var a=e[t][s],l=Math.floor(a)+Math.max(0,a-Math.floor(a)-n)/(1-n);e[r][s]=l}else e[r][s]=Math.min(0,e[t][s]/(1-n));for(var c=0;c<this.width;c+=1)e[r][c]-=e[t][c];return!0},P.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new F("s"+o,o),e[r][this.rhsColumn]=-n;for(var s=1;s<this.varIndexByCol.length;s+=1){var a=this.variablesPerIndex[this.varIndexByCol[s]],l=e[t][s],c=l-Math.floor(l);e[r][s]=a.isInteger?c<=n?-c:-(1-c)*n/c:l>=0?-l:l*n/(1-n)}return!0},P.prototype.applyMIRCuts=function(){},P.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],n=1;n<this.height;n+=1){var r=this.matrix[n][i];if(r<-this.precision||this.precision<r){e=n;break}}this.pivot(e,i)}return e},P.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],n=this.matrix[i],r=1;r<this.height;r+=1){var o=n[r];if(o<-this.precision||this.precision<o){e=r;break}}this.pivot(i,e)}return e},P.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var n=this.variables[i],r=this.rowByVarIndex[n.index];n.value=-1===r?0:Math.round((this.matrix[r][this.rhsColumn]+Number.EPSILON)*e)/e}},P.prototype.updateRightHandSide=function(t,e){var i=this.height-1,n=this.rowByVarIndex[t.index];if(-1===n){for(var r=this.colByVarIndex[t.index],o=0;o<=i;o+=1){var s=this.matrix[o];s[this.rhsColumn]-=e*s[r]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var c=this.optionalObjectives[l].reducedCosts;c[this.rhsColumn]-=e*c[r]}}else this.matrix[n][this.rhsColumn]-=e},P.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var n=this._putInBase(t.index),r=this.colByVarIndex[e.index];if(-1===r)for(var o=this.rowByVarIndex[e.index],s=0;s<this.width;s+=1)this.matrix[n][s]+=i*this.matrix[o][s];else this.matrix[n][r]-=i},P.prototype.updateCost=function(t,e){var i=t.index,n=this.width-1,r=this.colByVarIndex[i];if(-1===r){var o,s=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var a=this.matrix[0];for(o=0;o<=n;o+=1)a[o]+=e*s[o]}else{var l=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=n;o+=1)l[o]+=e*s[o]}}else this.matrix[0][r]-=e},P.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,n=this.matrix[i];void 0===n&&(n=this.matrix[0].slice(),this.matrix[i]=n);for(var r=this.width-1,o=0;o<=r;o+=1)n[o]=0;n[this.rhsColumn]=e*t.rhs;for(var s=t.terms,a=s.length,l=0;l<a;l+=1){var c=s[l],h=c.coefficient,u=c.variable.index,d=this.rowByVarIndex[u];if(-1===d)n[this.colByVarIndex[u]]+=e*h;else{var f=this.matrix[d];for(o=0;o<=r;o+=1)n[o]-=e*h*f[o]}}var p=t.index;this.varIndexByRow[i]=p,this.rowByVarIndex[p]=i,this.colByVarIndex[p]=-1,this.height+=1},P.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,n=this._putInBase(e),r=this.matrix[i];this.matrix[i]=this.matrix[n],this.matrix[n]=r,this.varIndexByRow[n]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1},P.prototype.addVariable=function(t){var e=this.height-1,i=this.width,n=!0===this.model.isMinimization?-t.cost:t.cost,r=t.priority,o=this.optionalObjectives.length;if(o>0)for(var s=0;s<o;s+=1)this.optionalObjectives[s].reducedCosts[i]=0;0===r?this.matrix[0][i]=n:(this.setOptionalObjective(r,i,n),this.matrix[0][i]=0);for(var a=1;a<=e;a+=1)this.matrix[a][i]=0;var l=t.index;this.varIndexByCol[i]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=i,this.width+=1},P.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),n=this.width-1;if(i!==n){for(var r=this.height-1,o=0;o<=r;o+=1){var s=this.matrix[o];s[i]=s[n]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var c=this.optionalObjectives[l].reducedCosts;c[i]=c[n]}var h=this.varIndexByCol[n];this.varIndexByCol[i]=h,this.colByVarIndex[h]=i}this.varIndexByCol[n]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1},P.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i,n,r,o,s,a,l,c,h,u,d="",f=[" "];for(n=1;n<this.width;n+=1)l=" ",c="\t",(a=void 0===(o=this.variablesPerIndex[s=this.varIndexByCol[n]])?"c"+s:o.id).length>5?l+=" ":c+="\t",f[n]=l,d+=c+a;console.log(d);var p=this.matrix[this.costRowIndex],v="\t";for(i=1;i<this.width;i+=1)v+="\t",v+=f[i],v+=p[i].toFixed(5);for(v+="\t"+f[0]+p[0].toFixed(5),console.log(v+"\tZ"),r=1;r<this.height;r+=1){for(h=this.matrix[r],u="\t",n=1;n<this.width;n+=1)u+="\t"+f[n]+h[n].toFixed(5);u+="\t"+f[0]+h[0].toFixed(5),a=void 0===(o=this.variablesPerIndex[s=this.varIndexByRow[r]])?"c"+s:o.id,console.log(u+"\t"+a)}console.log("");var g=this.optionalObjectives.length;if(g>0){console.log("    Optional objectives:");for(var m=0;m<g;m+=1){var b=this.optionalObjectives[m].reducedCosts,y="";for(i=1;i<this.width;i+=1)y+=b[i]<0?"":" ",y+=f[i],y+=b[i].toFixed(5);y+=(b[0]<0?"":" ")+f[0]+b[0].toFixed(5),console.log(y+" z"+m)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},P.prototype.copy=function(){var t=new P(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var n=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=n[o].slice();return t.matrix=r,t},P.prototype.save=function(){this.savedState=this.copy()},P.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,n=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var r=n[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=r[e]}var s=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=s[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=a[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=i.rowByVarIndex,c=i.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=l[h],this.colByVarIndex[h]=c[h];if(i.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var u=0;u<i.optionalObjectives.length;u++){var d=i.optionalObjectives[u].copy();this.optionalObjectives[u]=d,this.optionalObjectivePerPriority[d.priority]=d}}}},P.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,n=this.model.integerVariables,r=n.length,o=0;o<r;o++){var s=n[o].index,a=this.rowByVarIndex[s];if(-1!==a){var l=this.matrix[a][this.rhsColumn],c=Math.abs(l-Math.round(l));t<c&&(t=c,e=s,i=l)}}return new $(e,i)},P.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,n=this.model.integerVariables,r=n.length,o=0;o<r;o++){var s=n[o],a=s.index,l=this.rowByVarIndex[a];if(-1!==l){var c=this.matrix[l][this.rhsColumn];if(Math.abs(c-Math.round(c))>this.precision){var h=s.cost;t>h&&(t=h,e=a,i=c)}}}return new $(e,i)},P.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},P.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var n=this.rowByVarIndex[t[i].index];if(-1!==n){var r=this.matrix[n][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},P.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var n=this.matrix[i][this.rhsColumn];if(n=Math.abs(n),Math.min(n-Math.floor(n),Math.floor(n+1))<this.precision){if(!t)return 0}else-1===e?e=n:e*=n}return-1===e?0:e};var H=P;function X(t,e,i){this.type=t,this.varIndex=e,this.value=i}function U(t,e){this.relaxedEvaluation=t,this.cuts=e}function G(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}P.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*i&&(e=!1)}},P.prototype.branchAndCut=function(){var t=[],e=0,i=this.model.tolerance,n=!0,r=1e99;this.model.timeout&&(r=Date.now()+this.model.timeout);for(var o=1/0,s=null,a=[],l=0;l<this.optionalObjectives.length;l+=1)a.push(1/0);var c=new U(-1/0,[]);for(t.push(c);t.length>0&&!0===n&&Date.now()<r;)if(i>0&&o<(this.model.isMinimization?this.bestPossibleEval*(1+i):this.bestPossibleEval*(1-i))&&(n=!1),!((c=t.pop()).relaxedEvaluation>o)){var h=c.cuts;if(this.applyCuts(h),e++,!1!==this.feasible){var u=this.evaluation;if(!(u>o)){if(u===o){for(var d=!0,f=0;f<this.optionalObjectives.length&&!(this.optionalObjectives[f].reducedCosts[0]>a[f]);f+=1)if(this.optionalObjectives[f].reducedCosts[0]<a[f]){d=!1;break}if(d)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===e)return void(this.branchAndCutIterations=e);s=c,o=u;for(var p=0;p<this.optionalObjectives.length;p+=1)a[p]=this.optionalObjectives[p].reducedCosts[0]}else{1===e&&this.save();for(var v=this.getMostFractionalVar(),g=v.index,m=[],b=[],y=h.length,w=0;w<y;w+=1){var _=h[w];_.varIndex===g?"min"===_.type?b.push(_):m.push(_):(m.push(_),b.push(_))}var x=Math.ceil(v.value),C=Math.floor(v.value),S=new X("min",g,x);m.push(S);var I=new X("max",g,C);b.push(I),t.push(new U(u,m)),t.push(new U(u,b)),t.sort(G)}}}}null!==s&&this.applyCuts(s.cuts),this.branchAndCutIterations=e};var Y={},Z=q.Constraint,Q=q.Equality,J=q.Variable,K=q.IntegerVariable;function tt(t,e){this.tableau=new P(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var et=tt;tt.prototype.minimize=function(){return this.isMinimization=!0,this},tt.prototype.maximize=function(){return this.isMinimization=!1,this},tt.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},tt.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},tt.prototype.smallerThan=function(t){var e=new Z(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.greaterThan=function(t){var e=new Z(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.equal=function(t){var e=new Z(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new Z(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new Q(e,i)},tt.prototype.addVariable=function(t,e,i,n,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,s=this.tableau.getNewElementIndex();return null==e&&(e="v"+s),null==t&&(t=0),null==r&&(r=0),i?(o=new K(e,t,s,r),this.integerVariables.push(o)):o=new J(e,t,s,r),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,n&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},tt.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},tt.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},tt.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},tt.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},tt.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},tt.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},tt.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,n={},r={},o=Object.keys(i),s=o.length,a=0;a<s;a+=1){var l,c,h=o[a],u=i[h],d=u.equal,f=u.weight,p=u.priority,v=void 0!==f||void 0!==p;if(void 0===d){var g=u.min;void 0!==g&&(l=this.greaterThan(g),n[h]=l,v&&l.relax(f,p));var m=u.max;void 0!==m&&(c=this.smallerThan(m),r[h]=c,v&&c.relax(f,p))}else{l=this.greaterThan(d),n[h]=l,c=this.smallerThan(d),r[h]=c;var b=new Q(l,c);v&&b.relax(f,p)}}var y=Object.keys(e),w=y.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),0===this.tolerance&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),this.checkForCycles=void 0===t.options.exitOnCycles||t.options.exitOnCycles);for(var _=t.ints||{},x=t.binaries||{},C=t.unrestricted||{},S=t.optimize,I=0;I<w;I+=1){var k=y[I],E=e[k],M=!!x[k],O=this.addVariable(E[S]||0,k,!!_[k]||M,!!C[k]);M&&this.smallerThan(1).addTerm(1,O);var R=Object.keys(E);for(a=0;a<R.length;a+=1){var T=R[a];if(T!==S){var P=E[T],B=n[T];void 0!==B&&B.addTerm(P,O);var N=r[T];void 0!==N&&N.addTerm(P,O)}}}return this},tt.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},tt.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},tt.prototype.isFeasible=function(){return this.tableau.feasible},tt.prototype.save=function(){return this.tableau.save()},tt.prototype.restore=function(){return this.tableau.restore()},tt.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},tt.prototype.debug=function(t){this.checkForCycles=t},tt.prototype.log=function(t){return this.tableau.log(t)};var it={CleanObjectiveAttributes:function(t){var e,i,n;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(n in t.optimize)if(t.constraints[n])if("equal"===t.constraints[n])delete t.optimize[n];else{for(i in e=Math.random(),t.variables)t.variables[i][n]&&(t.variables[i][e]=t.variables[i][n]);t.constraints[e]=t.constraints[n],delete t.constraints[n]}return t}},nt=function(t){return t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},n={">=":"min","<=":"max","=":"equal"},r="",o=null,s="",a="",l="",c=0;"string"==typeof t&&(t=t.split("\n"));for(var h=0;h<t.length;h++)if(l="__"+h,o=null,e.is_objective.test(r=t[h]))i.opType=r.match(/(max|min)/gi)[0],(o=r.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[a]=i.variables[a]||{},i.variables[a]._obj=s}));else if(e.is_int.test(r))o=r.match(e.parse_int).slice(1),i.ints=i.ints||{},o.forEach((function(t){t=t.replace(";",""),i.ints[t]=1}));else if(e.is_bin.test(r))o=r.match(e.parse_bin).slice(1),i.binaries=i.binaries||{},o.forEach((function(t){t=t.replace(";",""),i.binaries[t]=1}));else if(e.is_constraint.test(r)){var u=r.indexOf(":");(o=(-1===u?r:r.slice(u+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0],i.variables[a]=i.variables[a]||{},i.variables[a][l]=s})),c=parseFloat(r.match(e.parse_rhs)[0]),r=n[r.match(e.parse_dir)[0]],i.constraints[l]=i.constraints[l]||{},i.constraints[l][r]=c}else e.is_unrestricted.test(r)&&(o=r.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},o.forEach((function(t){t=t.replace(";",""),i.unrestricted[t]=1})));return i}(t):function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},n=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType)for(var r in e+=t.opType+":",t.variables)t.variables[r][r]=t.variables[r][r]?t.variables[r][r]:1,t.variables[r][t.optimize]&&(e+=" "+t.variables[r][t.optimize]+" "+r.replace(n,"_"));else e+="max:";for(var o in e+=";\n\n",t.constraints)for(var s in t.constraints[o])if(void 0!==i[s]){for(var a in t.variables)void 0!==t.variables[a][o]&&(e+=" "+t.variables[a][o]+" "+a.replace(n,"_"));e+=" "+i[s]+" "+t.constraints[o][s],e+=";\n"}if(t.ints)for(var l in e+="\n\n",t.ints)e+="int "+l.replace(n,"_")+";\n";if(t.unrestricted)for(var c in e+="\n\n",t.unrestricted)e+="unrestricted "+c.replace(n,"_")+";\n";return e}(t)};function rt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})})),e}var ot=rt(Object.freeze({__proto__:null,default:{}}));function st(t){return(t=(t=t.replace("\\r\\n","\r\n")).split("\r\n")).filter((function(t){return!0!==new RegExp(" 0$","gi").test(t)&&!1!==new RegExp("\\d$","gi").test(t)})).map((function(t){return t.split(/\:{0,1} +(?=\d)/)})).reduce((function(t,e,i){return t[e[0]]=e[1],t}),{})}var at={lpsolve:{reformat:nt,solve:function(t){return new Promise((function(e,i){"undefined"!=typeof window&&i("Function Not Available in Browser");var n=nt(t);t.external||i("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||i("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||i("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||i("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),ot.writeFile(t.external.tempName,n,(function(n,r){if(n)i(n);else{var o=ot.execFile;t.external.args.push(t.external.tempName),o(t.external.binPath,t.external.args,(function(t,n){t?1===t.code?e(st(n)):i({code:t.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[t.code],data:n}):e(st(n))}))}}))}))}}},lt=function(t,e){var i,n,r,o,s,a=e.optimize,l=JSON.parse(JSON.stringify(e.optimize)),c=Object.keys(e.optimize),h=0,u={},d="",f={},p=[];for(delete e.optimize,n=0;n<c.length;n++)l[c[n]]=0;for(n=0;n<c.length;n++){for(s in e.optimize=c[n],e.opType=a[c[n]],i=t.Solve(e,void 0,void 0,!0),c)if(!e.variables[c[s]])for(o in i[c[s]]=i[c[s]]?i[c[s]]:0,e.variables)e.variables[o][c[s]]&&i[o]&&(i[c[s]]+=i[o]*e.variables[o][c[s]]);for(d="base",r=0;r<c.length;r++)d+=i[c[r]]?"-"+(1e3*i[c[r]]|0)/1e3:"-0";if(!u[d]){for(u[d]=1,h++,r=0;r<c.length;r++)i[c[r]]&&(l[c[r]]+=i[c[r]]);delete i.feasible,delete i.result,p.push(i)}}for(n=0;n<c.length;n++)e.constraints[c[n]]={equal:l[c[n]]/h};for(n in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[n].cheater=1;for(n in p)for(o in p[n])f[o]=f[o]||{min:1e99,max:-1e99};for(n in f)for(o in p)p[o][n]?(p[o][n]>f[n].max&&(f[n].max=p[o][n]),p[o][n]<f[n].min&&(f[n].min=p[o][n])):(p[o][n]=0,f[n].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:p,ranges:f}},ct=q.Constraint,ht=q.Variable,ut=q.Numeral,dt=q.Term,ft=function(){this.Model=et,this.branchAndCut=Y,this.Constraint=ct,this.Variable=ht,this.Numeral=ut,this.Term=dt,this.Tableau=H,this.lastSolvedModel=null,this.External=at,this.Solve=function(t,e,i,n){if(n)for(var r in it)t=it[r](t);if(!t)throw new Error("Solver requires a model to operate on");if("object"==typeof t.optimize&&Object.keys(t.optimize>1))return lt(this,t);if(t.external){var o=Object.keys(at);if(o=JSON.stringify(o),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+o);if(!at[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+o);return at[t.external.solver].solve(t)}t instanceof et==0&&(t=new et(e).loadJson(t));var s=t.solve();if(this.lastSolvedModel=t,s.solutionSet=s.generateSolutionSet(),i)return s;var a={};return a.feasible=s.feasible,a.result=s.evaluation,a.bounded=s.bounded,s._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(s.solutionSet).forEach((function(t){0!==s.solutionSet[t]&&(a[t]=s.solutionSet[t])})),a},this.ReformatLP=nt,this.MultiObjective=function(t){return lt(this,t)}};"object"==typeof window?window.solver=new ft:"object"==typeof self&&(self.solver=new ft);var pt=new ft;function vt(){}function gt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function bt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i>n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}function yt(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function wt(t,e,i){if(n=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(yield i);else{let i=-1;for(let n of t)null!=(n=e(n,++i,t))&&(n=+n)>=n&&(yield n)}}(t,i))).length){if((e=+e)<=0||n<2)return bt(t);if(e>=1)return mt(t);var n,r=(n-1)*e,o=Math.floor(r),s=mt(function t(e,i,n=0,r=e.length-1,o=gt){for(;r>n;){if(r-n>600){const s=r-n+1,a=i-n+1,l=Math.log(s),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);t(e,i,Math.max(n,Math.floor(i-a*c/s+h)),Math.min(r,Math.floor(i+(s-a)*c/s+h)),o)}const s=e[i];let a=n,l=r;for(yt(e,n,i),o(e[r],s)>0&&yt(e,n,r);a<l;){for(yt(e,a,l),++a,--l;o(e[a],s)<0;)++a;for(;o(e[l],s)>0;)--l}0===o(e[n],s)?yt(e,n,l):(++l,yt(e,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}return e}(t,o).subarray(0,o+1));return s+(bt(t.subarray(o+1))-s)*(r-o)}}function _t(t,e){return+!(t instanceof k)+ +!(e instanceof k)}function xt(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return function t(e,i,n,r,o,s,a){const[l,c]=o;function h(t){e(t);for(const e of t){const t=e.layer;if(void 0===t)throw new Error(`layering did not assign layer to node '${e.id}'`);if(t<0)throw new Error(`layering assigned a negative layer (${t}) to node '${e.id}'`)}const o=function(t){const e=[];for(const i of t.descendants()){const t=i.layer;(e[t]||(e[t]=[])).push(i),i.dataChildren=i.dataChildren.map(n=>{const r=n.child.layer;if(r<=t)throw new Error(`layering left child node "${n.child.id}" (${r}) with a greater or equal layer to parent node "${i.id}" (${t})`);let o=n.child;for(let s=r-1;s>t;s--){let t;t=a?`${i.id}->${n.child.id} (${s})`:`${i.id}\0${n.child.id}\0${s}`;const r=new k(t);r.dataChildren.push(new u(o,void 0)),(e[s]||(e[s]=[])).push(r),o=r}return new u(o,n.data)})}return e}(t);if(1===o.length){const[t]=o;for(const e of t)e.y=c/2}else{const t=r?c:c/(o.length-1);for(const[e,i]of o.entries())for(const n of i)n.y=t*e}if(o.every(t=>1===t.length))for(const[e]of o)e.x=l/2;else if(1===o.length){const[t]=o;C(t,s);const e=t,i=r?e.length-1:1;for(const n of e)n.x*=l*i}else{i(o),n(o,s);for(const i of o)for(const t of i)if(void 0===t.x)throw new Error(`coord didn't assign an x to node '${t.id}'`);const t=o,e=r?Math.max(...o.map(t=>t.length))-1:1;for(const i of t)for(const t of i)t.x*=l*e}const h=t;return function(t){for(const e of t)e instanceof k||(e.dataChildren=e.dataChildren.map(t=>{let i=t.child;const n=[{x:e.x,y:e.y}];for(;i instanceof k;)n.push({x:i.x,y:i.y}),[i]=i.ichildren();return n.push({x:i.x,y:i.y}),new u(i,t.data,n)}))}(h),h}return h.layering=function(l){return void 0===l?e:t(l,i,n,r,o,s,a)},h.decross=function(l){return void 0===l?i:t(e,l,n,r,o,s,a)},h.coord=function(l){return void 0===l?n:t(e,i,l,r,o,s,a)},h.size=function(l){return void 0!==l?t(e,i,n,!1,l,s,a):r?null:o},h.nodeSize=function(l){return void 0!==l?t(e,i,n,!0,l,s,a):r?o:null},h.separation=function(l){return void 0===l?s:t(e,i,n,r,o,l,a)},h.debug=function(l){return void 0===l?a:t(e,i,n,r,o,s,l)},h}(function(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return function t(e,i){const n=i?"":"\0",r=i?"rank: ":"\0",o=i?" -> ":"\0";function s(t){return`${n}${t.id}`}function a(t){return`${t.source.id}${o}${t.target.id}`}function l(t,e){return`${r}${t.id}${o}${e.id}`}function c(t){const i=Object.create(null),n=Object.create(null),r=Object.create(null),o=[];for(const a of t){const t=s(a);n[t]=1,i[t]={opt:a.children.length};const r=e(a);void 0!==r&&o.push([r,a])}for(const e of t.ilinks()){const t=i[s(e.source)],n=i[s(e.target)],o=a(e);r[o]={min:1},t[o]=-1,t.opt++,n[o]=1,n.opt--}let[c,...h]=o.sort(([t],[e])=>t-e);for(const e of h){const[t,n]=c,[o,a]=e,h=i[s(n)],u=i[s(a)],d=l(n,a);if(t<o)r[d]={min:1},h[d]=-1,u[d]=1;else{const t=l(a,n);r[d]={min:0},r[t]={min:0},h[d]=-1,h[t]=1,u[d]=1,u[t]=-1}c=e}const u=pt.Solve({optimize:"opt",opType:"max",constraints:r,variables:i,ints:n}),{feasible:d}=u,f=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}(u,["feasible"]);if(!d)throw o.length?new Error("could not find a feasbile simplex layout, check that rank accessors are not ill-defined"):new Error("could not find feasbile simplex layout, this should not happen");for(const e of t)e.layer=f[s(e)]||0}return c.rank=function(n){return void 0===n?e:t(n,i)},c.debug=function(n){return void 0===n?i:t(e,n)},c}(vt,!1)}(),function(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return function t(e){function i(t){t.slice(0,t.length-1).forEach((i,n)=>e(i,t[n+1]))}return i.order=function(i){return void 0===i?e:t(i)},i}(function(...t){if(t.length)throw new Error(`got arguments to median(${t}), but constructor takes no aruguments.`);return function(t,e){const i=new h;for(const[o,s]of t.entries())for(const t of s.ichildren())i.setIfAbsent(t.id,[]).push(o);const n=new h;let r=-1;for(const o of e){const e=wt(i.getDefault(o.id,[]),.5,void 0);void 0===e?(n.set(o.id,r),r=+!((r+1)/(t.length+1))*(t.length+1)-1):n.set(o.id,e)}e.sort((t,e)=>n.getThrow(t.id)-n.getThrow(e.id))}}())}(),function(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return function t(e,i,n,r,o){function s(t,s,a){const l=function(t){const e=new h;let i=0;for(const n of t)for(const t of n)e.set(t.id,i++);return e}(t),[c,u,d,f]=function(t,e,i){const n=1+Math.max(...e.values()),r=[],o=[];for(const a of t){let[t,...s]=a;for(const a of s){const s=e.getThrow(t.id),l=e.getThrow(a.id),c=new Array(n).fill(0);c[s]=1,c[l]=-1,r.push(c),o.push(-i(t,a)),t=a}}const s=new Array(n).fill(0);return[new Array(n).fill(null).map(()=>new Array(n).fill(0)),s,r,o]}(t,l,s);for(const o of t)for(const t of o){const o=l.getThrow(t.id),s=t instanceof k?i:e;for(const a of t.ichildren()){const t=l.getThrow(a.id),h=a instanceof k?r:n;S(c,o,t,s+(a instanceof k?i:e));for(const e of a.ichildren())I(c,o,t,l.getThrow(e.id),h)}}for(let[e,...i]of t)for(const t of i)a.getThrow(e.id)!==a.getThrow(t.id)&&S(c,l.getThrow(e.id),l.getThrow(t.id),o),e=t;!function(t,e,i){const n=Math.min(...i),r=Math.max(...i)-n;if(r>0)for(const o of t)for(const t of o){const o=e.getThrow(t.id);t.x=(i[o]-n)/r}else for(const o of t)for(const t of o)t.x=.5}(t,l,function(t,e,i,n,r=0){e.pop(),t.pop(),t.forEach(t=>t.pop()),i.forEach(t=>t.pop());const o=function(t,e,i,n,r){const o=[[0]],s=[0],a=[[0]],l=[0];for(const u of t){const t=[0];t.push(...u),o.push(t)}s.push(...e),a.push(...e.map(()=>[0]));for(const u of i)for(const[t,e]of u.entries())a[t+1].push(-e);l.push(...n.map(t=>-t));const{solution:c,message:h}=x(o,s,a,l,r);if(h.length)throw new Error("quadprog failed with: "+h);return c.shift(),c}(t,e,i,n,r);return o.push(0),o}(c,u,d,f))}function a(t,o){if(0===e&&0===n)throw new Error("node vertical weight or node curve weight needs to be positive");if(0===i&&0===r)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");const a=function(t){const e=new h;for(const r of t.slice().reverse())for(const t of r){for(const i of t.ichildren())e.delete(i.id);e.set(t.id,t)}const i=new p([...e.values()]).split(),n=new h;for(const[r,o]of i.entries())for(const t of o)n.set(t.id,r);return n}(t);for(const e of function(t,e){const i=[];let n=[],r=new Set;for(const o of t){const t=new Set(o.map(t=>e.getThrow(t.id)));c(r,t)||i.push(n=[]),n.push(o),r=t}return i}(t,a))if(e.every(t=>1===t.length))for(const[t]of e)t.x=.5;else if(1===e.length){const[t]=e;C(t,o)}else s(e,o,a)}return a.vertical=function(s){if(void 0===s)return[e,i];const[a,l]=s;if(a<0||l<0)throw new Error(`weights must be non-negative, but were ${a} and ${l}`);return t(a,l,n,r,o)},a.curve=function(s){if(void 0===s)return[n,r];const[a,l]=s;if(a<0||l<0)throw new Error(`weights must be non-negative, but were ${a} and ${l}`);return t(e,i,a,l,o)},a.component=function(s){if(void 0===s)return o;if(s<=0)throw new Error("weight must be positive, but was "+s);return t(e,i,n,r,s)},a}(1,0,0,1,1)}(),!1,[1,1],_t,!1)}var Ct=function(t,e){return t<e};function St(t){if(!(this instanceof St))return new St(t);this.array=[],this.size=0,this.compare=t||Ct}St.prototype.clone=function(){var t=new St(this.compare);t.size=this.size;for(var e=0;e<this.size;e++)t.array.push(this.array[e]);return t},St.prototype.add=function(t){var e,i,n=this.size;for(this.array[this.size]=t,this.size+=1;n>0&&this.compare(t,i=this.array[e=n-1>>1]);)this.array[n]=i,n=e;this.array[n]=t},St.prototype.heapify=function(t){var e;for(this.array=t,this.size=t.length,e=this.size>>1;e>=0;e--)this._percolateDown(e)},St.prototype._percolateUp=function(t,e){for(var i,n,r=this.array[t];t>0&&(n=this.array[i=t-1>>1],e||this.compare(r,n));)this.array[t]=n,t=i;this.array[t]=r},St.prototype._percolateDown=function(t){for(var e,i,n,r=this.size,o=this.size>>>1,s=this.array[t];t<o&&(n=this.array[e=1+(t<<1)],(i=e+1)<r&&this.compare(this.array[i],n)&&(e=i,n=this.array[i]),this.compare(n,s));)this.array[t]=n,t=e;this.array[t]=s},St.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},St.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1},St.prototype._batchRemove=function(t,e){var i=new Array(e||this.size),n=0;if("function"==typeof t&&this.size)for(var r=0;r<this.size&&n<i.length;)t(this.array[r])?(i[n]=this._removeAt(r),n++,r>>=1):r++;return i.length=n,i},St.prototype.removeOne=function(t){var e=this._batchRemove(t,1);return e.length>0?e[0]:void 0},St.prototype.removeMany=function(t,e){return this._batchRemove(t,e)},St.prototype.peek=function(){if(0!=this.size)return this.array[0]},St.prototype.poll=function(){if(0!=this.size){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}},St.prototype.replaceTop=function(t){if(0!=this.size){var e=this.array[0];return this.array[0]=t,this._percolateDown(0),e}},St.prototype.trim=function(){this.array=this.array.slice(0,this.size)},St.prototype.isEmpty=function(){return 0===this.size},St.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var e=0,i=this.clone();!i.isEmpty();)t(i.poll(),e++)},St.prototype.kSmallest=function(t){if(0==this.size)return[];var e=this.compare,i=this.array,n=new St((function(t,n){return e(i[t],i[n])}));t=Math.min(this.size,t);var r=new Array(t),o=0;for(n.add(0);o<t;){var s=n.poll();r[o++]=this.array[s];var a=1+(s<<1),l=a+1;a<this.size&&n.add(a),l<this.size&&n.add(l)}return r};var It=i("ZTXN"),kt=i("mWib"),Et=i("kuMc");function Mt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}var Ot={value:()=>{}};function Rt(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new Tt(n)}function Tt(t){this._=t}function Pt(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}function Bt(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function Nt(t,e,i){for(var n=0,r=t.length;n<r;++n)if(t[n].name===e){t[n]=Ot,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}Tt.prototype=Rt.prototype={constructor:Tt,on:function(t,e){var i,n=this._,r=Pt(t+"",n),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=Nt(n[i],t.name,e);else if(null==e)for(i in n)n[i]=Nt(n[i],t.name,null);return this}for(;++o<s;)if((i=(t=r[o]).type)&&(i=Bt(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Tt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,r=new Array(i),o=0;o<i;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,i=(n=this._[t]).length;o<i;++o)n[o].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],r=0,o=n.length;r<o;++r)n[r].value.apply(e,i)}};var jt=Rt;function Vt(){}var At=function(t){return null==t?Vt:function(){return this.querySelector(t)}},Dt=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)};function zt(){return[]}var Lt=function(t){return null==t?zt:function(){return this.querySelectorAll(t)}},Wt=function(t){return function(){return this.matches(t)}};function qt(t){return function(e){return e.matches(t)}}var Ft=Array.prototype.find;function $t(){return this.firstElementChild}var Ht=Array.prototype.filter;function Xt(){return this.children}var Ut=function(t){return new Array(t.length)};function Gt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Gt.prototype={constructor:Gt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Yt=function(t){return function(){return t}};function Zt(t,e,i,n,r,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],n[a]=s):i[a]=new Gt(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function Qt(t,e,i,n,r,o,s){var a,l,c,h=new Map,u=e.length,d=o.length,f=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(f[a]=c=s.call(l,l.__data__,a,e)+"",h.has(c)?r[a]=l:h.set(c,l));for(a=0;a<d;++a)c=s.call(t,o[a],a,o)+"",(l=h.get(c))?(n[a]=l,l.__data__=o[a],h.delete(c)):i[a]=new Gt(t,o[a]);for(a=0;a<u;++a)(l=e[a])&&h.get(f[a])===l&&(r[a]=l)}function Jt(t){return t.__data__}function Kt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var te="http://www.w3.org/1999/xhtml",ee={svg:"http://www.w3.org/2000/svg",xhtml:te,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ie=function(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),ee.hasOwnProperty(e)?{space:ee[e],local:t}:t};function ne(t){return function(){this.removeAttribute(t)}}function re(t){return function(){this.removeAttributeNS(t.space,t.local)}}function oe(t,e){return function(){this.setAttribute(t,e)}}function se(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ae(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function le(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}var ce=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function he(t){return function(){this.style.removeProperty(t)}}function ue(t,e,i){return function(){this.style.setProperty(t,e,i)}}function de(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function fe(t,e){return t.style.getPropertyValue(e)||ce(t).getComputedStyle(t,null).getPropertyValue(e)}function pe(t){return function(){delete this[t]}}function ve(t,e){return function(){this[t]=e}}function ge(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function me(t){return t.trim().split(/^|\s+/)}function be(t){return t.classList||new ye(t)}function ye(t){this._node=t,this._names=me(t.getAttribute("class")||"")}function we(t,e){for(var i=be(t),n=-1,r=e.length;++n<r;)i.add(e[n])}function _e(t,e){for(var i=be(t),n=-1,r=e.length;++n<r;)i.remove(e[n])}function xe(t){return function(){we(this,t)}}function Ce(t){return function(){_e(this,t)}}function Se(t,e){return function(){(e.apply(this,arguments)?we:_e)(this,t)}}function Ie(){this.textContent=""}function ke(t){return function(){this.textContent=t}}function Ee(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Me(){this.innerHTML=""}function Oe(t){return function(){this.innerHTML=t}}function Re(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Te(){this.nextSibling&&this.parentNode.appendChild(this)}function Pe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Be(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===te&&e.documentElement.namespaceURI===te?e.createElement(t):e.createElementNS(i,t)}}function Ne(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}ye.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var je=function(t){var e=ie(t);return(e.local?Ne:Be)(e)};function Ve(){return null}function Ae(){var t=this.parentNode;t&&t.removeChild(this)}function De(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ze(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Le(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}function We(t){return function(){var e=this.__on;if(e){for(var i,n=0,r=-1,o=e.length;n<o;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function qe(t,e,i){return function(){var n,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((n=r[s]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=o,n.options=i),void(n.value=e);this.addEventListener(t.type,o,i),n={type:t.type,name:t.name,value:e,listener:o,options:i},r?r.push(n):this.__on=[n]}}function Fe(t,e,i){var n=ce(t),r=n.CustomEvent;"function"==typeof r?r=new r(e,i):(r=n.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function $e(t,e){return function(){return Fe(this,t,e)}}function He(t,e){return function(){return Fe(this,t,e.apply(this,arguments))}}var Xe=[null];function Ue(t,e){this._groups=t,this._parents=e}function Ge(){return new Ue([[document.documentElement]],Xe)}Ue.prototype=Ge.prototype={constructor:Ue,select:function(t){"function"!=typeof t&&(t=At(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s,a=e[r],l=a.length,c=n[r]=new Array(l),h=0;h<l;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),c[h]=s);return new Ue(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:Dt(e)}}(t):Lt(t);for(var e=this._groups,i=e.length,n=[],r=[],o=0;o<i;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(n.push(t.call(s,s.__data__,c,a)),r.push(s));return new Ue(n,r)},selectChild:function(t){return this.select(null==t?$t:function(t){return function(){return Ft.call(this.children,t)}}("function"==typeof t?t:qt(t)))},selectChildren:function(t){return this.selectAll(null==t?Xt:function(t){return function(){return Ht.call(this.children,t)}}("function"==typeof t?t:qt(t)))},filter:function(t){"function"!=typeof t&&(t=Wt(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s=e[r],a=s.length,l=n[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Ue(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Jt);var i=e?Qt:Zt,n=this._parents,r=this._groups;"function"!=typeof t&&(t=Yt(t));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var h=n[c],u=r[c],d=u.length,f=Dt(t.call(h,h&&h.__data__,c,n)),p=f.length,v=a[c]=new Array(p),g=s[c]=new Array(p),m=l[c]=new Array(d);i(h,u,v,g,m,f,e);for(var b,y,w=0,_=0;w<p;++w)if(b=v[w]){for(w>=_&&(_=w+1);!(y=g[_])&&++_<p;);b._next=y||null}}return(s=new Ue(s,n))._enter=a,s._exit=l,s},enter:function(){return new Ue(this._enter||this._groups.map(Ut),this._parents)},exit:function(){return new Ue(this._exit||this._groups.map(Ut),this._parents)},join:function(t,e,i){var n=this.enter(),r=this,o=this.exit();return n="function"==typeof t?t(n):n.append(t+""),null!=e&&(r=e(r)),null==i?o.remove():i(o),n&&r?n.merge(r).order():r},merge:function(t){if(!(t instanceof Ue))throw new Error("invalid merge");for(var e=this._groups,i=t._groups,n=e.length,r=Math.min(n,i.length),o=new Array(n),s=0;s<r;++s)for(var a,l=e[s],c=i[s],h=l.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=l[d]||c[d])&&(u[d]=a);for(;s<n;++s)o[s]=e[s];return new Ue(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,r=t[e],o=r.length-1,s=r[o];--o>=0;)(n=r[o])&&(s&&4^n.compareDocumentPosition(s)&&s.parentNode.insertBefore(n,s),s=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=Kt);for(var i=this._groups,n=i.length,r=new Array(n),o=0;o<n;++o){for(var s,a=i[o],l=a.length,c=r[o]=new Array(l),h=0;h<l;++h)(s=a[h])&&(c[h]=s);c.sort(e)}return new Ue(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],r=0,o=n.length;r<o;++r){var s=n[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var r,o=e[i],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var i=ie(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?re:ne:"function"==typeof e?i.local?le:ae:i.local?se:oe)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?he:"function"==typeof e?de:ue)(t,e,null==i?"":i)):fe(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?pe:"function"==typeof e?ge:ve)(t,e)):this.node()[t]},classed:function(t,e){var i=me(t+"");if(arguments.length<2){for(var n=be(this.node()),r=-1,o=i.length;++r<o;)if(!n.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?Se:e?xe:Ce)(i,e))},text:function(t){return arguments.length?this.each(null==t?Ie:("function"==typeof t?Ee:ke)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Me:("function"==typeof t?Re:Oe)(t)):this.node().innerHTML},raise:function(){return this.each(Te)},lower:function(){return this.each(Pe)},append:function(t){var e="function"==typeof t?t:je(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:je(t),n=null==e?Ve:"function"==typeof e?e:At(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(Ae)},clone:function(t){return this.select(t?ze:De)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,r,o=Le(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?qe:We,n=0;n<s;++n)this.each(a(o[n],e,i));return this}var a=this.node().__on;if(a)for(var l,c=0,h=a.length;c<h;++c)for(n=0,l=a[c];n<s;++n)if((r=o[n]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?He:$e)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,r=t[e],o=0,s=r.length;o<s;++o)(n=r[o])&&(yield n)}};var Ye=Ge,Ze=function(t){return"string"==typeof t?new Ue([[document.querySelector(t)]],[document.documentElement]):new Ue([[t]],Xe)};function Qe(t){t.stopImmediatePropagation()}var Je=function(t){t.preventDefault(),t.stopImmediatePropagation()},Ke=function(t){var e=t.document.documentElement,i=Ze(t).on("dragstart.drag",Je,!0);"onselectstart"in e?i.on("selectstart.drag",Je,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function ti(t,e){var i=t.document.documentElement,n=Ze(t).on("dragstart.drag",null);e&&(n.on("click.drag",Je,!0),setTimeout((function(){n.on("click.drag",null)}),0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}var ei=function(t,e,i){t.prototype=e.prototype=i,i.constructor=t};function ii(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function ni(){}var ri=.7,oi=1/ri,si="\\s*([+-]?\\d+)\\s*",ai="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",li="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ci=/^#([0-9a-f]{3,8})$/,hi=new RegExp("^rgb\\("+[si,si,si]+"\\)$"),ui=new RegExp("^rgb\\("+[li,li,li]+"\\)$"),di=new RegExp("^rgba\\("+[si,si,si,ai]+"\\)$"),fi=new RegExp("^rgba\\("+[li,li,li,ai]+"\\)$"),pi=new RegExp("^hsl\\("+[ai,li,li]+"\\)$"),vi=new RegExp("^hsla\\("+[ai,li,li,ai]+"\\)$"),gi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function mi(){return this.rgb().formatHex()}function bi(){return this.rgb().formatRgb()}function yi(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=ci.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?wi(e):3===i?new Si(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?_i(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?_i(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=hi.exec(t))?new Si(e[1],e[2],e[3],1):(e=ui.exec(t))?new Si(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=di.exec(t))?_i(e[1],e[2],e[3],e[4]):(e=fi.exec(t))?_i(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=pi.exec(t))?Mi(e[1],e[2]/100,e[3]/100,1):(e=vi.exec(t))?Mi(e[1],e[2]/100,e[3]/100,e[4]):gi.hasOwnProperty(t)?wi(gi[t]):"transparent"===t?new Si(NaN,NaN,NaN,0):null}function wi(t){return new Si(t>>16&255,t>>8&255,255&t,1)}function _i(t,e,i,n){return n<=0&&(t=e=i=NaN),new Si(t,e,i,n)}function xi(t){return t instanceof ni||(t=yi(t)),t?new Si((t=t.rgb()).r,t.g,t.b,t.opacity):new Si}function Ci(t,e,i,n){return 1===arguments.length?xi(t):new Si(t,e,i,null==n?1:n)}function Si(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function Ii(){return"#"+Ei(this.r)+Ei(this.g)+Ei(this.b)}function ki(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Ei(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Mi(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new Ri(t,e,i,n)}function Oi(t){if(t instanceof Ri)return new Ri(t.h,t.s,t.l,t.opacity);if(t instanceof ni||(t=yi(t)),!t)return new Ri;if(t instanceof Ri)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),o=Math.max(e,i,n),s=NaN,a=o-r,l=(o+r)/2;return a?(s=e===o?(i-n)/a+6*(i<n):i===o?(n-e)/a+2:(e-i)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new Ri(s,a,l,t.opacity)}function Ri(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function Ti(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function Pi(t,e,i,n,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*i+(1+3*t+3*o-3*s)*n+s*r)/6}ei(ni,yi,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:mi,formatHex:mi,formatHsl:function(){return Oi(this).formatHsl()},formatRgb:bi,toString:bi}),ei(Si,Ci,ii(ni,{brighter:function(t){return t=null==t?oi:Math.pow(oi,t),new Si(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ri:Math.pow(ri,t),new Si(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ii,formatHex:Ii,formatRgb:ki,toString:ki})),ei(Ri,(function(t,e,i,n){return 1===arguments.length?Oi(t):new Ri(t,e,i,null==n?1:n)}),ii(ni,{brighter:function(t){return t=null==t?oi:Math.pow(oi,t),new Ri(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ri:Math.pow(ri,t),new Ri(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new Si(Ti(t>=240?t-240:t+120,r,n),Ti(t,r,n),Ti(t<120?t+240:t-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Bi=t=>()=>t;function Ni(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):Bi(isNaN(t)?e:t)}var ji=function t(e){var i=function(t){return 1==(t=+t)?Ni:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):Bi(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=Ci(t)).r,(e=Ci(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),s=Ni(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return n.gamma=t,n}(1);function Vi(t){return function(e){var i,n,r=e.length,o=new Array(r),s=new Array(r),a=new Array(r);for(i=0;i<r;++i)n=Ci(e[i]),o[i]=n.r||0,s[i]=n.g||0,a[i]=n.b||0;return o=t(o),s=t(s),a=t(a),n.opacity=1,function(t){return n.r=o(t),n.g=s(t),n.b=a(t),n+""}}}Vi((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[n],o=t[n+1];return Pi((i-n/e)*e,n>0?t[n-1]:2*r-o,r,o,n<e-1?t[n+2]:2*o-r)}})),Vi((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e);return Pi((i-n/e)*e,t[(n+e-1)%e],t[n%e],t[(n+1)%e],t[(n+2)%e])}}));var Ai,Di,zi=function(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}},Li=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wi=new RegExp(Li.source,"g"),qi=function(t,e){var i,n,r,o=Li.lastIndex=Wi.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(i=Li.exec(t))&&(n=Wi.exec(e));)(r=n.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(i=i[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,l.push({i:s,x:zi(i,n)})),o=Wi.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})},Fi=function(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]},$i=0,Hi=0,Xi=0,Ui=0,Gi=0,Yi=0,Zi="object"==typeof performance&&performance.now?performance:Date,Qi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ji(){return Gi||(Qi(Ki),Gi=Zi.now()+Yi)}function Ki(){Gi=0}function tn(){this._call=this._time=this._next=null}function en(t,e,i){var n=new tn;return n.restart(t,e,i),n}function nn(){Gi=(Ui=Zi.now())+Yi,$i=Hi=0;try{!function(){Ji(),++$i;for(var t,e=Ai;e;)(t=Gi-e._time)>=0&&e._call.call(null,t),e=e._next;--$i}()}finally{$i=0,function(){for(var t,e,i=Ai,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Ai=e);Di=t,on(n)}(),Gi=0}}function rn(){var t=Zi.now(),e=t-Ui;e>1e3&&(Yi-=e,Ui=t)}function on(t){$i||(Hi&&(Hi=clearTimeout(Hi)),t-Gi>24?(t<1/0&&(Hi=setTimeout(nn,t-Zi.now()-Yi)),Xi&&(Xi=clearInterval(Xi))):(Xi||(Ui=Zi.now(),Xi=setInterval(rn,1e3)),$i=1,Qi(nn)))}tn.prototype=en.prototype={constructor:tn,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?Ji():+i)+(null==e?0:+e),this._next||Di===this||(Di?Di._next=this:Ai=this,Di=this),this._call=t,this._time=i,on()},stop:function(){this._call&&(this._call=null,this._time=1/0,on())}};var sn=function(t,e,i){var n=new tn;return n.restart(i=>{n.stop(),t(i+e)},e=null==e?0:+e,i),n},an=jt("start","end","cancel","interrupt"),ln=[],cn=function(t,e,i,n,r,o){var s=t.__transition;if(s){if(i in s)return}else t.__transition={};!function(t,e,i){var n,r=t.__transition;function o(l){var c,h,u,d;if(1!==i.state)return a();for(c in r)if((d=r[c]).name===i.name){if(3===d.state)return sn(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(sn((function(){3===i.state&&(i.state=4,i.timer.restart(s,i.delay,i.time),s(l))})),i.state=2,i.on.call("start",t,t.__data__,i.index,i.group),2===i.state){for(i.state=3,n=new Array(u=i.tween.length),c=0,h=-1;c<u;++c)(d=i.tween[c].value.call(t,t.__data__,i.index,i.group))&&(n[++h]=d);n.length=h+1}}function s(e){for(var r=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=5,1),o=-1,s=n.length;++o<s;)n[o].call(t,r);5===i.state&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=6,i.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=i,i.timer=en((function(t){i.state=1,i.timer.restart(o,i.delay,i.time),i.delay<=t&&o(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:r,on:an,tween:ln,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function hn(t,e){var i=dn(t,e);if(i.state>0)throw new Error("too late; already scheduled");return i}function un(t,e){var i=dn(t,e);if(i.state>3)throw new Error("too late; already running");return i}function dn(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}var fn,pn=function(t,e){var i,n,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(i=o[r]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete o[r]):s=!1;s&&delete t.__transition}},vn=180/Math.PI,gn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},mn=function(t,e,i,n,r,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*i+e*n)&&(i-=t*l,n-=e*l),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,l/=a),t*n<e*i&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*vn,skewX:Math.atan(l)*vn,scaleX:s,scaleY:a}};function bn(t,e,i,n){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,n,r,o,s,a){if(t!==r||n!==o){var l=s.push("translate(",null,e,null,i);a.push({i:l-4,x:zi(t,r)},{i:l-2,x:zi(n,o)})}else(r||o)&&s.push("translate("+r+e+o+i)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,i,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:i.push(r(i)+"rotate(",null,n)-2,x:zi(t,e)})):e&&i.push(r(i)+"rotate("+e+n)}(o.rotate,s.rotate,a,l),function(t,e,i,o){t!==e?o.push({i:i.push(r(i)+"skewX(",null,n)-2,x:zi(t,e)}):e&&i.push(r(i)+"skewX("+e+n)}(o.skewX,s.skewX,a,l),function(t,e,i,n,o,s){if(t!==i||e!==n){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:zi(t,i)},{i:a-2,x:zi(e,n)})}else 1===i&&1===n||o.push(r(o)+"scale("+i+","+n+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,i=-1,n=l.length;++i<n;)a[(e=l[i]).i]=e.x(t);return a.join("")}}}var yn=bn((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gn:mn(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),wn=bn((function(t){return null==t?gn:(fn||(fn=document.createElementNS("http://www.w3.org/2000/svg","g")),fn.setAttribute("transform",t),(t=fn.transform.baseVal.consolidate())?mn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):gn)}),", ",")",")");function _n(t,e){var i,n;return function(){var r=un(this,t),o=r.tween;if(o!==i)for(var s=0,a=(n=i=o).length;s<a;++s)if(n[s].name===e){(n=n.slice()).splice(s,1);break}r.tween=n}}function xn(t,e,i){var n,r;if("function"!=typeof i)throw new Error;return function(){var o=un(this,t),s=o.tween;if(s!==n){r=(n=s).slice();for(var a={name:e,value:i},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function Cn(t,e,i){var n=t._id;return t.each((function(){var t=un(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return dn(t,n).value[e]}}var Sn=function(t,e){var i;return("number"==typeof e?zi:e instanceof yi?ji:(i=yi(e))?(e=i,ji):qi)(t,e)};function In(t){return function(){this.removeAttribute(t)}}function kn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function En(t,e,i){var n,r,o=i+"";return function(){var s=this.getAttribute(t);return s===o?null:s===n?r:r=e(n=s,i)}}function Mn(t,e,i){var n,r,o=i+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===n?r:r=e(n=s,i)}}function On(t,e,i){var n,r,o;return function(){var s,a,l=i(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===n&&a===r?o:(r=a,o=e(n=s,l));this.removeAttribute(t)}}function Rn(t,e,i){var n,r,o;return function(){var s,a,l=i(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===n&&a===r?o:(r=a,o=e(n=s,l));this.removeAttributeNS(t.space,t.local)}}function Tn(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function Pn(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function Bn(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&Pn(t,r)),i}return r._value=e,r}function Nn(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&Tn(t,r)),i}return r._value=e,r}function jn(t,e){return function(){hn(this,t).delay=+e.apply(this,arguments)}}function Vn(t,e){return e=+e,function(){hn(this,t).delay=e}}function An(t,e){return function(){un(this,t).duration=+e.apply(this,arguments)}}function Dn(t,e){return e=+e,function(){un(this,t).duration=e}}function zn(t,e){if("function"!=typeof e)throw new Error;return function(){un(this,t).ease=e}}function Ln(t,e,i){var n,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?hn:un;return function(){var s=o(this,t),a=s.on;a!==n&&(r=(n=a).copy()).on(e,i),s.on=r}}var Wn=Ye.prototype.constructor;function qn(t){return function(){this.style.removeProperty(t)}}function Fn(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}function $n(t,e,i){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&Fn(t,o,i)),n}return o._value=e,o}function Hn(t){return function(e){this.textContent=t.call(this,e)}}function Xn(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&Hn(n)),e}return n._value=t,n}var Un=0;function Gn(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function Yn(){return++Un}var Zn=Ye.prototype;Gn.prototype=(function(t){return Ye().transition(t)}).prototype={constructor:Gn,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=At(t));for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=n[s],h=c.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),u[d]=l,cn(u[d],e,i,d,u,dn(a,i)));return new Gn(o,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Lt(t));for(var n=this._groups,r=n.length,o=[],s=[],a=0;a<r;++a)for(var l,c=n[a],h=c.length,u=0;u<h;++u)if(l=c[u]){for(var d,f=t.call(l,l.__data__,u,c),p=dn(l,i),v=0,g=f.length;v<g;++v)(d=f[v])&&cn(d,e,i,v,f,p);o.push(f),s.push(l)}return new Gn(o,s,e,i)},filter:function(t){"function"!=typeof t&&(t=Wt(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s=e[r],a=s.length,l=n[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new Gn(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,r=Math.min(n,i.length),o=new Array(n),s=0;s<r;++s)for(var a,l=e[s],c=i[s],h=l.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=l[d]||c[d])&&(u[d]=a);for(;s<n;++s)o[s]=e[s];return new Gn(o,this._parents,this._name,this._id)},selection:function(){return new Wn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=Yn(),n=this._groups,r=n.length,o=0;o<r;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var h=dn(s,e);cn(s,t,i,c,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Gn(n,this._parents,t,i)},call:Zn.call,nodes:Zn.nodes,node:Zn.node,size:Zn.size,empty:Zn.empty,each:Zn.each,on:function(t,e){var i=this._id;return arguments.length<2?dn(this.node(),i).on.on(t):this.each(Ln(i,t,e))},attr:function(t,e){var i=ie(t),n="transform"===i?wn:Sn;return this.attrTween(t,"function"==typeof e?(i.local?Rn:On)(i,n,Cn(this,"attr."+t,e)):null==e?(i.local?kn:In)(i):(i.local?Mn:En)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=ie(t);return this.tween(i,(n.local?Bn:Nn)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?yn:Sn;return null==e?this.styleTween(t,function(t,e){var i,n,r;return function(){var o=fe(this,t),s=(this.style.removeProperty(t),fe(this,t));return o===s?null:o===i&&s===n?r:r=e(i=o,n=s)}}(t,n)).on("end.style."+t,qn(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,r,o;return function(){var s=fe(this,t),a=i(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=fe(this,t)),s===l?null:s===n&&l===r?o:(r=l,o=e(n=s,a))}}(t,n,Cn(this,"style."+t,e))).each(function(t,e){var i,n,r,o,s="style."+e,a="end."+s;return function(){var l=un(this,t),c=l.on,h=null==l.value[s]?o||(o=qn(e)):void 0;c===i&&r===h||(n=(i=c).copy()).on(a,r=h),l.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,r,o=i+"";return function(){var s=fe(this,t);return s===o?null:s===n?r:r=e(n=s,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,$n(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Cn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Xn(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,r=dn(this.node(),i).tween,o=0,s=r.length;o<s;++o)if((n=r[o]).name===t)return n.value;return null}return this.each((null==e?_n:xn)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?jn:Vn)(e,t)):dn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?An:Dn)(e,t)):dn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(zn(e,t)):dn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;un(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,r=i.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--r&&o()}};i.each((function(){var i=un(this,n),r=i.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),i.on=e})),0===r&&o()}))},[Symbol.iterator]:Zn[Symbol.iterator]};var Qn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Jn(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function Kn(t){return{type:t}}Ye.prototype.interrupt=function(t){return this.each((function(){pn(this,t)}))},Ye.prototype.transition=function(t){var e,i;t instanceof Gn?(e=t._id,t=t._name):(e=Yn(),(i=Qn).time=Ji(),t=null==t?null:t+"");for(var n=this._groups,r=n.length,o=0;o<r;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)(s=a[c])&&cn(s,t,e,c,a,i||Jn(s,e));return new Gn(n,this._parents,t,e)},Math,["w","e"].map(Kn),["n","s"].map(Kn),["n","w","e","s","nw","ne","sw","se"].map(Kn);var tr=t=>()=>t;function er(t,{sourceEvent:e,subject:i,target:n,identifier:r,active:o,x:s,y:a,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function ir(t){return!t.ctrlKey&&!t.button}function nr(){return this.parentNode}function rr(t,e){return null==e?{x:t.x,y:t.y}:e}function or(){return navigator.maxTouchPoints||"ontouchstart"in this}er.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const sr=Math.PI,ar=2*sr,lr=1e-6,cr=ar-lr;function hr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ur(){return new hr}hr.prototype=ur.prototype={constructor:hr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,i,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+i)+","+(this._y1=+n)},bezierCurveTo:function(t,e,i,n,r,o){this._+="C"+ +t+","+ +e+","+ +i+","+ +n+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,i,n,r){var o=this._x1,s=this._y1,a=(i=+i)-(t=+t),l=(n=+n)-(e=+e),c=o-t,h=s-e,u=c*c+h*h;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>lr)if(Math.abs(h*a-l*c)>lr&&r){var d=i-o,f=n-s,p=a*a+l*l,v=d*d+f*f,g=Math.sqrt(p),m=Math.sqrt(u),b=r*Math.tan((sr-Math.acos((p+u-v)/(2*g*m)))/2),y=b/m,w=b/g;Math.abs(y-1)>lr&&(this._+="L"+(t+y*c)+","+(e+y*h)),this._+="A"+r+","+r+",0,0,"+ +(h*d>c*f)+","+(this._x1=t+w*a)+","+(this._y1=e+w*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,i,n,r,o){t=+t,e=+e,o=!!o;var s=(i=+i)*Math.cos(n),a=i*Math.sin(n),l=t+s,c=e+a,h=1^o,u=o?n-r:r-n;if(i<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>lr||Math.abs(this._y1-c)>lr)&&(this._+="L"+l+","+c),i&&(u<0&&(u=u%ar+ar),u>cr?this._+="A"+i+","+i+",0,1,"+h+","+(t-s)+","+(e-a)+"A"+i+","+i+",0,1,"+h+","+(this._x1=l)+","+(this._y1=c):u>lr&&(this._+="A"+i+","+i+",0,"+ +(u>=sr)+","+h+","+(this._x1=t+i*Math.cos(r))+","+(this._y1=e+i*Math.sin(r))))},rect:function(t,e,i,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +i+"v"+ +n+"h"+-i+"Z"},toString:function(){return this._}};var dr=ur,fr=function(t){return function(){return t}};function pr(t){this._context=t}pr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var vr=function(t){return new pr(t)};function gr(t){return t[0]}function mr(t){return t[1]}function br(t){return((t=Math.exp(t))+1/t)/2}var yr=function t(e,i,n){function r(t,r){var o,s,a=t[0],l=t[1],c=t[2],h=r[2],u=r[0]-a,d=r[1]-l,f=u*u+d*d;if(f<1e-12)s=Math.log(h/c)/e,o=function(t){return[a+t*u,l+t*d,c*Math.exp(e*t*s)]};else{var p=Math.sqrt(f),v=(h*h-c*c+n*f)/(2*c*i*p),g=(h*h-c*c-n*f)/(2*h*i*p),m=Math.log(Math.sqrt(v*v+1)-v),b=Math.log(Math.sqrt(g*g+1)-g);s=(b-m)/e,o=function(t){var n,r=t*s,o=br(m),h=c/(i*p)*(o*(n=e*r+m,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(m));return[a+h*u,l+h*d,c*o/br(e*r+m)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return r.rho=function(e){var i=Math.max(.001,+e),n=i*i;return t(i,n,n*n)},r}(Math.SQRT2,2,4),wr=t=>()=>t;function _r(t,{sourceEvent:e,target:i,transform:n,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:r}})}function xr(t,e,i){this.k=t,this.x=e,this.y=i}xr.prototype={constructor:xr,scale:function(t){return 1===t?this:new xr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new xr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Cr=new xr(1,0,0);function Sr(t){t.stopImmediatePropagation()}var Ir=function(t){t.preventDefault(),t.stopImmediatePropagation()};function kr(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Er(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Mr(){return this.__zoom||Cr}function Or(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Rr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Tr(t,e,i){var n=t.invertX(e[0][0])-i[0][0],r=t.invertX(e[1][0])-i[1][0],o=t.invertY(e[0][1])-i[0][1],s=t.invertY(e[1][1])-i[1][1];return t.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}var Pr=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var r=n[i];t.call(e,r[1],r[0])}},e}()}(),Br="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Nr="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),jr="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Nr):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},Vr=["top","right","bottom","left","width","height","size","weight"],Ar="undefined"!=typeof MutationObserver,Dr=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,r=0;function o(){i&&(i=!1,t()),n&&a()}function s(){jr(o)}function a(){var t=Date.now();if(i){if(t-r<2)return;n=!0}else i=!0,n=!1,setTimeout(s,20);r=t}return a}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Br&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Ar?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Br&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;Vr.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),zr=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},Lr=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Nr},Wr=Hr(0,0,0,0);function qr(t){return parseFloat(t)||0}function Fr(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+qr(t["border-"+i+"-width"])}),0)}var $r="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof Lr(t).SVGGraphicsElement}:function(t){return t instanceof Lr(t).SVGElement&&"function"==typeof t.getBBox};function Hr(t,e,i,n){return{x:t,y:e,width:i,height:n}}var Xr=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Hr(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t,e=(t=this.target,Br?$r(t)?function(t){var e=t.getBBox();return Hr(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return Wr;var n=Lr(t).getComputedStyle(t),r=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var r=n[i];e[r]=qr(t["padding-"+r])}return e}(n),o=r.left+r.right,s=r.top+r.bottom,a=qr(n.width),l=qr(n.height);if("border-box"===n.boxSizing&&(Math.round(a+o)!==e&&(a-=Fr(n,"left","right")+o),Math.round(l+s)!==i&&(l-=Fr(n,"top","bottom")+s)),!function(t){return t===Lr(t).document.documentElement}(t)){var c=Math.round(a+o)-e,h=Math.round(l+s)-i;1!==Math.abs(c)&&(a-=c),1!==Math.abs(h)&&(l-=h)}return Hr(r.left,r.top,a,l)}(t):Wr);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Ur=function(t,e){var i,n,r,o,s,a,l,c=(n=(i=e).x,r=i.y,o=i.width,s=i.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),zr(l,{x:n,y:r,width:o,height:s,top:r,right:n+o,bottom:s+r,left:n}),l);zr(this,{target:t,contentRect:c})},Gr=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new Pr,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Lr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Xr(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Lr(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new Ur(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Yr="undefined"!=typeof WeakMap?new WeakMap:new Pr,Zr=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=Dr.getInstance(),n=new Gr(e,i,this);Yr.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){Zr.prototype[t]=function(){var e;return(e=Yr.get(this))[t].apply(e,arguments)}}));var Qr=void 0!==Nr.ResizeObserver?Nr.ResizeObserver:Zr;let Jr=(()=>{class t{constructor(){this.elementSubjects=new Map,this.resizeObserver=new Qr(t=>{for(const i of t){var e=this.elementSubjects.get(i.target);if(null==e)return;e.next(i.contentRect)}})}listenToElementResize(t){this.resizeObserver.observe(t);const e=new It.a;return this.elementSubjects.set(t,e),e}unListenToElementResize(t){this.elementSubjects.delete(t),this.resizeObserver.unobserve(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Kr=i("v9BS"),to=i("nIj0"),eo=i("PBFl");const io=["chart"],no=["weightSlider"];let ro=(()=>{class t{constructor(t){this.bloomaResizeListenerService=t,this.profileSelected=new s.o,this.itemWeightChanged=new s.o,this.childProfileWeightChanged=new s.o,this.linkClicked=new s.o,this.disconnectLinkClicked=new s.o,this._data=null,this.sliderContainerStyle={width:"0",height:"0",padding:"0"},this.unsubscribe$=new It.a,this.viewInitialized=!1,this.margin={top:10,bottom:20,left:150,right:10},this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.nodeSquareWidth=100,this.nodeSquareHeight=60,this.draggableSquareDimension=10,this.dragX=0,this.dragY=0,this.linkColor="gray",this.selectedNodeColor="green",this.clickedLinkSource=null,this.clickedLinkTarget=null,this.weightTargetType=null,this.clickedLinkEvent=null,this.sliderElementHeight=124,this.sliderElementWidth=124;const e=new It.a;e.pipe(Object(kt.a)(400),Object(Et.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=e}get data(){return this._data}set data(t){this._data=t,this.createSubject.next()}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Et.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},800)}createChart(){if(!this.viewInitialized)return;if(!this.data)return;const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.initSvg(),this.setSvgHeight(),this.drawHierarchy(),this.setUpZoomBehavior())}initSvg(){if(!this.svg){const t=Ze(this.chartContainer.nativeElement).append("svg");this.svg=t}}setSvgHeight(){this.svg.attr("height",this.totalComponentHeight).attr("width",this.totalComponentWidth)}mouseOverProfile(t){this.dragTargetData=t}mouseLeaveProfile(t){this.dragTargetData=null}getDragBehavior(){const t=this;return function(){var t,e,i,n,r=ir,o=nr,s=rr,a=or,l={},c=jt("start","drag","end"),h=0,u=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",g).on("touchmove.drag",m).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!n&&r.call(this,s,a)){var l=y(this,o.call(this,s,a),s,a,"mouse");l&&(Ze(s.view).on("mousemove.drag",p,!0).on("mouseup.drag",v,!0),Ke(s.view),Qe(s),i=!1,t=s.clientX,e=s.clientY,l("start",s))}}function p(n){if(Je(n),!i){var r=n.clientX-t,o=n.clientY-e;i=r*r+o*o>u}l.mouse("drag",n)}function v(t){Ze(t.view).on("mousemove.drag mouseup.drag",null),ti(t.view,i),Je(t),l.mouse("end",t)}function g(t,e){if(r.call(this,t,e)){var i,n,s=t.changedTouches,a=o.call(this,t,e),l=s.length;for(i=0;i<l;++i)(n=y(this,a,t,e,s[i].identifier,s[i]))&&(Qe(t),n("start",t,s[i]))}}function m(t){var e,i,n=t.changedTouches,r=n.length;for(e=0;e<r;++e)(i=l[n[e].identifier])&&(Je(t),i("drag",t,n[e]))}function b(t){var e,i,r=t.changedTouches,o=r.length;for(n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),e=0;e<o;++e)(i=l[r[e].identifier])&&(Qe(t),i("end",t,r[e]))}function y(t,e,i,n,r,o){var a,u,f,p=c.copy(),v=Fi(o||i,e);if(null!=(f=s.call(t,new er("beforestart",{sourceEvent:i,target:d,identifier:r,active:h,x:v[0],y:v[1],dx:0,dy:0,dispatch:p}),n)))return a=f.x-v[0]||0,u=f.y-v[1]||0,function i(o,s,c){var g,m=v;switch(o){case"start":l[r]=i,g=h++;break;case"end":delete l[r],--h;case"drag":v=Fi(c||s,e),g=h}p.call(o,t,new er(o,{sourceEvent:s,subject:f,target:d,identifier:r,active:g,x:v[0]+a,y:v[1]+u,dx:v[0]-m[0],dy:v[1]-m[1],dispatch:p}),n)}}return d.filter=function(t){return arguments.length?(r="function"==typeof t?t:tr(!!t),d):r},d.container=function(t){return arguments.length?(o="function"==typeof t?t:tr(t),d):o},d.subject=function(t){return arguments.length?(s="function"==typeof t?t:tr(t),d):s},d.touchable=function(t){return arguments.length?(a="function"==typeof t?t:tr(!!t),d):a},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,d):Math.sqrt(u)},d}().on("start",(e,i)=>{this.setSelectedNode(i,e.sourceEvent);const n=this.svg.select("rect#r"+i.id);this.dragSourceNode=n;const r=+n.attr("original-x"),o=+n.attr("original-y");this.dragX=this.dragStartX=r,this.dragY=this.dragStartY=o,this.svg.selectAll(".profile-container").attr("pointer-events","mouseover").on("mouseover",(function(e,i){e.target.setAttribute("stroke","red"),t.mouseOverProfile(i)})).on("mouseout",(function(e,i){var n;null!=e.fromElement&&null!=e.toElement&&e.fromElement.parentElement!=e.toElement.parentElement&&(i.id!==(null===(n=t.selectedProfile)||void 0===n?void 0:n.id)&&e.target.setAttribute("stroke","black"),t.mouseLeaveProfile(i))})),e.sourceEvent.stopPropagation(),e.sourceEvent.preventDefault()}).on("drag",(t,e)=>{if(this.svg.select("rect#r"+e.id),0==this.dragStartX)return;this.dragX+=t.dx,this.dragY+=t.dy;const i=[[+this.dragStartX,+this.dragStartY],[this.dragX,this.dragY]],n=this.getDragLine(),r=function(t,e){var i=fr(!0),n=null,r=vr,o=null;function s(s){var a,l,c,h=(s=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(s)).length,u=!1;for(null==n&&(o=r(c=dr())),a=0;a<=h;++a)!(a<h&&i(l=s[a],a,s))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(l,a,s),+e(l,a,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?gr:fr(t),e="function"==typeof e?e:void 0===e?mr:fr(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:fr(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:fr(+t),s):e},s.defined=function(t){return arguments.length?(i="function"==typeof t?t:fr(!!t),s):i},s.curve=function(t){return arguments.length?(r=t,null!=n&&(o=r(n)),s):r},s.context=function(t){return arguments.length?(null==t?n=o=null:o=r(n=t),s):n},s}();n.attr("d",r(i))}).on("end",()=>{if(this.removeDragLine(),this.dragStartX=0,this.dragStartY=0,null==this.dragSourceNode||null==this.dragTargetData)return;const t=this.dragSourceNode.attr("id").substr(1),e=this.dragTargetData.id;if(t==e)return;const i=this.profileMap[e];this.changeIntroducesCycle(this.profileMap[t],e)||i.parentIds.find(e=>e==t)})}changeIntroducesCycle(t,e){if(null==t.parentIds)return!1;if(null==t?void 0:t.parentIds.find(t=>t==e))return!0;for(const i of null==t?void 0:t.parentIds)return this.changeIntroducesCycle(this.profileMap[i],e)}removeDragLine(){this.svg.select(".drag-line").remove(),this.dragLine=null}getDragLine(){return this.dragLine||(this.dragLine=this.svg.select(".graph-area").append("path").attr("class","drag-line").style("stroke","red").style("fill","none")),this.dragLine}drawHierarchy(){this.svg.select(".graph-area").remove();const t=function(...t){if(t.length)throw Error(`got arguments to dagStratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);return function t(e,i,n){function r(t){if(!t.length)throw new Error("can't stratify empty data");const i=t.map((t,i)=>new f(function(t){if("string"!=typeof t)throw new Error("id is supposed to be string but got type "+typeof t);if(t.indexOf("\0")>=0)throw new Error(`node id ${t} contained null character`);return t}(e(t,i)),t)),r=new Map;i.forEach(t=>{if(r.has(t.id))throw new Error("found a duplicate id: "+t.id);r.set(t.id,t)});const o=[];return i.forEach((t,e)=>{const i=n(t.data,e)||[];i.forEach(([e,i])=>{const n=r.get(e);if(!n)throw new Error("missing id: "+e);return n.dataChildren.push(new u(t,i)),n}),i.length||o.push(t)}),function(t){if(!t.length)throw new Error("dag contained no roots");const e=new Set,i=new Set;let n=null;function r(t){if(e.has(t.id))return[];if(i.has(t.id))return n=t.id,[t.id];{i.add(t.id);let o=[];for(const e of t.ichildren())if(o=r(e),o.length)break;return i.delete(t.id),e.add(t.id),o.length&&null!==n&&o.push(t.id),n===t.id&&(n=null),o}}for(const o of t){const t=r(o);if(t.length)throw new Error("dag contained a cycle: "+t.reverse().join(" -> "))}for(const o of new p(t))if(new Set(o.ichildren().map(t=>t.id)).size!==o.dataChildren.length)throw new Error(`node '${o.id}' contained duplicate children`)}(o),o.length>1?new p(o):o[0]}return r.id=function(r){return void 0===r?e:t(r,i,n)},r.parentData=function(i){return void 0===i?n:t(e,function(t){function e(e,i){return(t(e,i)||[]).map(([t])=>t)}return e.wrapped=t,e}(i),i)},r.parentIds=function(n){return void 0===n?i:t(e,n,v(n))},r}(g,m,v(m))}();if(!this.data)return;const e=t(this.data),i=xt().nodeSize([80,390])(e),n=this.svg.append("g").attr("class","graph-area"),r=i.descendants(),o=this.getDragBehavior(),s=n.append("g").attr("class","links-group"),a=i.links();s.selectAll("line").data(a).enter().append("line").attr("class","line").attr("stroke",this.linkColor).attr("stroke-width","5").attr("data-id-source",t=>"r"+t.source.id).attr("data-id-target",t=>"r"+t.target.id).attr("x1",t=>this.margin.left+t.source.y).attr("x2",t=>this.margin.left+t.target.y).attr("y1",t=>this.margin.top+t.source.x).attr("y2",t=>this.margin.top+t.target.x).on("mouseover",(t,e)=>{Ze(t.srcElement).attr("stroke","red")}).on("mouseout",(t,e)=>{Ze(t.srcElement).attr("stroke",this.linkColor)}).on("click",(t,e)=>{this.clickedLinkSource=e.source.id,this.clickedLinkTarget=e.target.data.originalId,this.weightTargetType=e.target.data.scores?"item":"childProfile",this.clickedLinkEvent=t,Ze(t.srcElement).attr("stroke",this.linkColor),this.linkClicked.next(this.clickedLinkSource)}),n.append("g").attr("class","nodes-group").selectAll("g.node").data(r).enter().append("g").attr("class","node").attr("transform",t=>`translate(${this.margin.left+t.y},${this.margin.top+t.x})`).each((t,e,i)=>{const n=Ze(i[e]),r=n.append("rect").attr("id","r"+t.id).attr("fill","white").attr("original-x",this.margin.left+t.y).attr("original-y",this.margin.top+t.x).attr("stroke","black").call(o).on("click",(t,e)=>{this.setSelectedNode(e,t)}),s=n.append("text").attr("class","svg-text").attr("dx",10).text(t.data.name).on("click",(t,e)=>{var i=new Event("click",{});t.srcElement.parentElement.firstChild.dispatchEvent(i)}),a=s.node().getBBox(),l=Mt([a.width+20,this.nodeSquareWidth]),c=Mt([a.height,this.nodeSquareHeight]);r.attr("x",0-l/2).attr("class","profile-container").attr("y",-c/2).attr("width",l).attr("height",c),s.attr("x",0-l/2)})}setSelectedNode(t,e){this.setSelectedProfile(t),(".profile-container",new Ue([document.querySelectorAll(".profile-container")],[document.documentElement])).attr("stroke","black"),Ze(e.srcElement).attr("stroke",this.selectedNodeColor)}saveNewWeight(){this.hideWeightSlider(),"item"==this.weightTargetType?this.itemWeightChanged.next({profileId:this.clickedLinkSource,updateProfileItemWeightDto:{newWeight:this.selectedWeight,profileItemName:this.clickedLinkTarget}}):this.childProfileWeightChanged.next({profileId:this.clickedLinkSource,subProfileId:this.clickedLinkTarget,updateSubProfileWeightDto:{newWeight:this.selectedWeight}})}hideWeightSlider(){Ze(this.weightSliderContainer.nativeElement).transition().duration(200).style("opacity",0),this.sliderContainerStyle={width:"0",height:"0",padding:"0"}}disconnect(){this.hideWeightSlider(),this.disconnectLinkClicked.next({profileId:this.clickedLinkSource,childProfileToDelete:this.clickedLinkTarget})}showWeightSlider(){var t;this.selectedWeight=null!==(t=this.getLinkWeight(this.clickedLinkSource,this.clickedLinkTarget))&&void 0!==t?t:0;const e=Ze(this.weightSliderContainer.nativeElement);var i=this.selectTopForSlider(),n=this.selectLeftForSlider();this.sliderContainerStyle={width:"300px",left:n+"px",top:i+"px",padding:"10px"},e.transition().duration(200).style("opacity",1),Object(s.lb)(this)}selectTopForSlider(){return this.clickedLinkEvent.y+this.sliderElementHeight>=this.totalComponentHeight?this.totalComponentHeight-130:this.clickedLinkEvent.y}selectLeftForSlider(){return this.clickedLinkEvent.x+this.sliderElementWidth>=this.totalComponentWidth?this.totalComponentWidth-this.sliderElementWidth-10:this.clickedLinkEvent.x}weightChanged(t){this.selectedWeight=t.value}getLinkWeight(t,e){var i=this.weights[t];let n=i[e];n||(n=i[e.toUpperCase()]);const r=e.indexOf("_");return!n&&r>-1&&(n=i[e=e.substr(r+1)]),n}setUpZoomBehavior(){const t=this.svg.select(".graph-area"),e=this.svg.select(".nodes-group").node().getBBox(),i=[[0,0],[this.totalComponentWidth,this.totalComponentHeight]],n=[[0,-100],[e.width+this.margin.left+100,e.height]],r=function(){var t,e,i,n=kr,r=Er,o=Tr,s=Or,a=Rr,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],h=250,u=yr,d=jt("start","zoom","end"),f=500,p=0,v=10;function g(t){t.property("__zoom",Mr).on("wheel.zoom",C).on("mousedown.zoom",S).on("dblclick.zoom",I).filter(a).on("touchstart.zoom",k).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new xr(e,t.x,t.y)}function b(t,e,i){var n=e[0]-i[0]*t.k,r=e[1]-i[1]*t.k;return n===t.x&&r===t.y?t:new xr(t.k,n,r)}function y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,i,n){t.on("start.zoom",(function(){_(this,arguments).event(n).start()})).on("interrupt.zoom end.zoom",(function(){_(this,arguments).event(n).end()})).tween("zoom",(function(){var t=this,o=arguments,s=_(t,o).event(n),a=r.apply(t,o),l=null==i?y(a):"function"==typeof i?i.apply(t,o):i,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),h=t.__zoom,d="function"==typeof e?e.apply(t,o):e,f=u(h.invert(l).concat(c/h.k),d.invert(l).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=f(t),i=c/e[2];t=new xr(i,l[0]-e[0]*i,l[1]-e[1]*i)}s.zoom(null,t)}}))}function _(t,e,i){return!i&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function C(t,...e){if(n.apply(this,arguments)){var i=_(this,e).event(t),r=this.__zoom,a=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,s.apply(this,arguments)))),h=Fi(t);if(i.wheel)i.mouse[0][0]===h[0]&&i.mouse[0][1]===h[1]||(i.mouse[1]=r.invert(i.mouse[0]=h)),clearTimeout(i.wheel);else{if(r.k===a)return;i.mouse=[h,r.invert(h)],pn(this),i.start()}Ir(t),i.wheel=setTimeout(u,150),i.zoom("mouse",o(b(m(r,a),i.mouse[0],i.mouse[1]),i.extent,c))}function u(){i.wheel=null,i.end()}}function S(t,...e){if(!i&&n.apply(this,arguments)){var r=_(this,e,!0).event(t),s=Ze(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",f,!0),a=Fi(t,l),l=t.currentTarget,h=t.clientX,u=t.clientY;Ke(t.view),Sr(t),r.mouse=[a,this.__zoom.invert(a)],pn(this),r.start()}function d(t){if(Ir(t),!r.moved){var e=t.clientX-h,i=t.clientY-u;r.moved=e*e+i*i>p}r.event(t).zoom("mouse",o(b(r.that.__zoom,r.mouse[0]=Fi(t,l),r.mouse[1]),r.extent,c))}function f(t){s.on("mousemove.zoom mouseup.zoom",null),ti(t.view,r.moved),Ir(t),r.event(t).end()}}function I(t,...e){if(n.apply(this,arguments)){var i=this.__zoom,s=Fi(t.changedTouches?t.changedTouches[0]:t,this),a=i.invert(s),l=o(b(m(i,i.k*(t.shiftKey?.5:2)),s,a),r.apply(this,e),c);Ir(t),h>0?Ze(this).transition().duration(h).call(w,l,s,t):Ze(this).call(g.transform,l,s,t)}}function k(i,...r){if(n.apply(this,arguments)){var o,s,a,l,c=i.touches,h=c.length,u=_(this,r,i.changedTouches.length===h).event(i);for(Sr(i),s=0;s<h;++s)l=[l=Fi(a=c[s],this),this.__zoom.invert(l),a.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,o=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(u.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),f)),pn(this),u.start())}}function E(t,...e){if(this.__zooming){var i,n,r,s,a=_(this,e).event(t),l=t.changedTouches,h=l.length;for(Ir(t),i=0;i<h;++i)r=Fi(n=l[i],this),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var u=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],v=(v=f[0]-u[0])*v+(v=f[1]-u[1])*v,g=(g=p[0]-d[0])*g+(g=p[1]-d[1])*g;n=m(n,Math.sqrt(v/g)),r=[(u[0]+f[0])/2,(u[1]+f[1])/2],s=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(b(n,r,s),a.extent,c))}}function M(t,...n){if(this.__zooming){var r,o,s=_(this,n).event(t),a=t.changedTouches,l=a.length;for(Sr(t),i&&clearTimeout(i),i=setTimeout((function(){i=null}),f),r=0;r<l;++r)o=a[r],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=Fi(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<v)){var c=Ze(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return g.transform=function(t,e,i,n){var r=t.selection?t.selection():t;r.property("__zoom",Mr),t!==r?w(t,e,i,n):r.interrupt().each((function(){_(this,arguments).event(n).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},g.scaleBy=function(t,e,i,n){g.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),i,n)},g.scaleTo=function(t,e,i,n){g.transform(t,(function(){var t=r.apply(this,arguments),n=this.__zoom,s=null==i?y(t):"function"==typeof i?i.apply(this,arguments):i,a=n.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return o(b(m(n,l),s,a),t,c)}),i,n)},g.translateBy=function(t,e,i,n){g.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof i?i.apply(this,arguments):i),r.apply(this,arguments),c)}),null,n)},g.translateTo=function(t,e,i,n,s){g.transform(t,(function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==n?y(t):"function"==typeof n?n.apply(this,arguments):n;return o(Cr.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof i?-i.apply(this,arguments):-i),t,c)}),n,s)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Ze(this.that).datum();d.call(t,this.that,new _r(t,{sourceEvent:this.sourceEvent,target:g,type:t,transform:this.that.__zoom,dispatch:d}),e)}},g.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:wr(+t),g):s},g.filter=function(t){return arguments.length?(n="function"==typeof t?t:wr(!!t),g):n},g.touchable=function(t){return arguments.length?(a="function"==typeof t?t:wr(!!t),g):a},g.extent=function(t){return arguments.length?(r="function"==typeof t?t:wr([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):r},g.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],g):[l[0],l[1]]},g.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],g):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},g.constrain=function(t){return arguments.length?(o=t,g):o},g.duration=function(t){return arguments.length?(h=+t,g):h},g.interpolate=function(t){return arguments.length?(u=t,g):u},g.on=function(){var t=d.on.apply(d,arguments);return t===d?g:t},g.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,g):Math.sqrt(p)},g.tapDistance=function(t){return arguments.length?(v=+t,g):v},g}().scaleExtent([.1,10]).extent(i).translateExtent(n).on("zoom",e=>{t.attr("transform",e.transform)});this.svg.call(r)}setSelectedProfile(t){this.profileSelected.next({selectedNodeId:t.id,nodeType:t.data.itemType})}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(Jr))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-hierarchy"]],viewQuery:function(t,e){var i;1&t&&(s.yc(io,!0),s.yc(no,!0)),2&t&&(s.jc(i=s.ac())&&(e.chartContainer=i.first),s.jc(i=s.ac())&&(e.weightSliderContainer=i.first))},inputs:{data:"data",weights:"weights",profileMap:"profileMap",selectedProfile:"selectedProfile"},outputs:{profileSelected:"profileSelected",itemWeightChanged:"itemWeightChanged",childProfileWeightChanged:"childProfileWeightChanged",linkClicked:"linkClicked",disconnectLinkClicked:"disconnectLinkClicked"},decls:14,vars:3,consts:[["id","rent-comparable-graph",1,"rent-comparable-graph"],["chart",""],["id","weight-slider",1,"bg-yellow-200","overflow-hidden",3,"ngStyle"],["weightSlider",""],["min","1","max","100","step","1",3,"ngModel","ngModelChange","input"],[1,"flex"],["mat-flat-button","","color","primary",1,"mx-2",3,"click"],["mat-flat-button","","color","warn",1,"mx-2",3,"click"]],template:function(t,e){1&t&&(s.Nb(0,"div",0,1),s.Sb(2,"div",2,3),s.Sb(4,"div"),s.vc(5),s.Rb(),s.Sb(6,"mat-slider",4),s.Zb("ngModelChange",(function(t){return e.selectedWeight=t}))("input",(function(t){return e.weightChanged(t)})),s.Rb(),s.Sb(7,"div",5),s.Sb(8,"button",6),s.Zb("click",(function(){return e.saveNewWeight()})),s.vc(9,"Save"),s.Rb(),s.Sb(10,"button",7),s.Zb("click",(function(){return e.hideWeightSlider()})),s.vc(11,"Cancel"),s.Rb(),s.Sb(12,"button",7),s.Zb("click",(function(){return e.disconnect()})),s.vc(13,"Disconnect"),s.Rb(),s.Rb(),s.Rb()),2&t&&(s.Cb(2),s.ic("ngStyle",e.sliderContainerStyle),s.Cb(3),s.xc("Weight: ",e.selectedWeight,""),s.Cb(1),s.ic("ngModel",e.selectedWeight))},directives:[n.l,Kr.a,to.j,to.m,eo.a],styles:[".rent-comparable-graph[_ngcontent-%COMP%]{height:inherit;width:inherit}#weight-slider[_ngcontent-%COMP%]{background-color:#fff;color:#000;position:absolute;opacity:0;width:0}#weight-slider[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:100%}.svg-text[_ngcontent-%COMP%]{pointer-events:none;-webkit-user-select:none;user-select:none}"]}),t})();var oo=i("yDe4"),so=i("C9XJ"),ao=i("rxR5"),lo=i("PC4E"),co=i("oYEq"),ho=i("pLgK");let uo=(()=>{class t{constructor(t,e){this.store=t,this.actions$=e,this.keyChanged$=new It.a,this.actions$.pipe(Object(oo.j)(so.a)).subscribe(()=>{this.keyChanged$.next()})}getProfiles(){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.d).toPromise(),null==this.store.selectSnapshot(lo.a.getGetProfileError)?"success":"error"}))}selectProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.f(t)).toPromise()}))}updateChildProfileLinkWeight(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new co.c(t)).toPromise(),!!this.store.selectSnapshot(ho.a.getUpdateSubChildWeightStatus)}))}disconectSubProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.e(t)).toPromise(),!!this.store.selectSnapshot(lo.a.getDisconnectSubProfileError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(oo.h),s.Wb(oo.b))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(oo.e)(lo.a.getState)],t.prototype,"profileState$",void 0),Object(o.b)([Object(oo.e)(ho.a.getState)],t.prototype,"weightState$",void 0),t})(),fo=(()=>{class t{constructor(t){this.store=t}updateItemLinkWeight(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new co.d(t)).toPromise(),!!this.store.selectSnapshot(ho.a.getUpdateItemWeightStatus)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(oo.h))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(oo.e)(ho.a.getState)],t.prototype,"weightState$",void 0),t})();var po=i("OZ4H");let vo=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.title=e.title,this.message=e.message}onConfirm(){this.dialogRef.close(!0)}onDismiss(){this.dialogRef.close(!1)}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(po.h),s.Mb(po.a))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-confirmation-dialog"]],decls:10,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(s.Sb(0,"h1",0),s.vc(1),s.Rb(),s.Sb(2,"div",1),s.Sb(3,"p"),s.vc(4),s.Rb(),s.Rb(),s.Sb(5,"div",2),s.Sb(6,"button",3),s.Zb("click",(function(){return e.onDismiss()})),s.vc(7,"No"),s.Rb(),s.Sb(8,"button",4),s.Zb("click",(function(){return e.onConfirm()})),s.vc(9,"Yes"),s.Rb(),s.Rb()),2&t&&(s.Cb(1),s.xc(" ",e.title,"\n"),s.Cb(3),s.wc(e.message))},directives:[po.i,po.f,po.d,eo.a],styles:[""]}),t})();var go=i("csyo");let mo=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-loading-component"]],decls:2,vars:0,consts:[[1,"bg-blue-500","bg-opacity-25","flex","h-full","items-center","justify-center","justify-items-center","w-full"]],template:function(t,e){1&t&&(s.Sb(0,"div",0),s.Nb(1,"mat-spinner"),s.Rb())},directives:[go.b],styles:[""]}),t})();var bo=i("W1gw");let yo=(()=>{class t{constructor(t,e){this.dialog=t,this._snackBar=e,this.loadingIsShown=!1}showLoading(){const t=this.dialog.open(mo,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",panelClass:"custom-dialog",data:{name:"test"}});return this.loadingDialog=t,this.loadingDialog.afterOpened().subscribe(()=>{this.loadingIsShown=!0}),this.loadingDialog.afterClosed().subscribe(()=>{this.loadingIsShown=!1}),t}hideLoading(){null!=this.loadingDialog&&(this.loadingIsShown||setTimeout(()=>{this.hideLoading()},300),this.loadingDialog.close(),this.loadingDialog=null)}showMessage(t){this._snackBar.open(t,"close",{duration:5e3})}openDialog(t,e,i){return this.dialog.open(t,{width:e+"px",data:i}).afterClosed()}showConfirmation(t){return this.dialog.open(vo,{data:t}).afterClosed()}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(po.c),s.Wb(bo.a))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var wo=i("29Wa"),_o=i("cZZj"),xo=i("5XID"),Co=i("6Oco");i("KTx3"),i("prE9");const So=Object(_o.f)({passive:!0});let Io=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return Co.a;const e=Object(xo.d)(t),i=this._monitoredElements.get(e);if(i)return i.subject;const n=new It.a,r="cdk-text-field-autofilled",o=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(r)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(r)&&(e.classList.remove(r),this._ngZone.run(()=>n.next({target:t.target,isAutofilled:!1}))):(e.classList.add(r),this._ngZone.run(()=>n.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",o,So),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:n,unlisten:()=>{e.removeEventListener("animationstart",o,So)}}),n}stopMonitoring(t){const e=Object(xo.d)(t),i=this._monitoredElements.get(e);i&&(i.unlisten(),i.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(_o.a),s.Wb(s.A))},t.\u0275prov=Object(s.Ib)({factory:function(){return new t(Object(s.Wb)(_o.a),Object(s.Wb)(s.A))},token:t,providedIn:"root"}),t})(),ko=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},imports:[[_o.b]]}),t})();var Eo=i("mFH5");const Mo=new s.r("MAT_INPUT_VALUE_ACCESSOR"),Oo=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Ro=0;class To{constructor(t,e,i,n){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=i,this.ngControl=n}}const Po=Object(Eo.k)(To);let Bo=(()=>{class t extends Po{constructor(t,e,i,n,r,o,s,a,l,c){super(o,n,r,i),this._elementRef=t,this._platform=e,this.ngControl=i,this._autofillMonitor=a,this._formField=c,this._uid="mat-input-"+Ro++,this.focused=!1,this.stateChanges=new It.a,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>Object(_o.e)().has(t));const h=this._elementRef.nativeElement,u=h.nodeName.toLowerCase();this._inputValueAccessor=s||h,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&l.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===u,this._isTextarea="textarea"===u,this._isNativeSelect&&(this.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=Object(xo.b)(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=Object(xo.b)(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&Object(_o.e)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=Object(xo.b)(t)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){var t,e;const i=(null===(e=null===(t=this._formField)||void 0===t?void 0:t._hideControlPlaceholder)||void 0===e?void 0:e.call(t))?null:this.placeholder;if(i!==this._previousPlaceholder){const t=this._elementRef.nativeElement;this._previousPlaceholder=i,i?t.setAttribute("placeholder",i):t.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){Oo.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.m),s.Mb(_o.a),s.Mb(to.i,10),s.Mb(to.l,8),s.Mb(to.e,8),s.Mb(Eo.a),s.Mb(Mo,10),s.Mb(Io),s.Mb(s.A),s.Mb(wo.a,8))},t.\u0275dir=s.Hb({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:9,hostBindings:function(t,e){1&t&&s.Zb("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(s.Vb("disabled",e.disabled)("required",e.required),s.Db("id",e.id)("data-placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),s.Eb("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"]},exportAs:["matInput"],features:[s.Bb([{provide:wo.c,useExisting:t}]),s.zb,s.Ab]}),t})(),No=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},providers:[Eo.a],imports:[[ko,wo.d],ko,wo.d]}),t})(),jo=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(po.h),s.Mb(po.a))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-prompt"]],decls:12,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(s.Sb(0,"h1",0),s.vc(1),s.Rb(),s.Sb(2,"div",1),s.Sb(3,"mat-form-field"),s.Sb(4,"mat-label"),s.vc(5),s.Rb(),s.Sb(6,"input",2),s.Zb("ngModelChange",(function(t){return e.data.inputValue=t})),s.Rb(),s.Rb(),s.Rb(),s.Sb(7,"div",3),s.Sb(8,"button",4),s.Zb("click",(function(){return e.onNoClick()})),s.vc(9,"Cancel"),s.Rb(),s.Sb(10,"button",5),s.vc(11,"Create"),s.Rb(),s.Rb()),2&t&&(s.Cb(1),s.wc(e.data.title),s.Cb(4),s.wc(e.data.label),s.Cb(1),s.ic("ngModel",e.data.inputValue),s.Cb(4),s.ic("mat-dialog-close",e.data.inputValue))},directives:[po.i,po.f,wo.b,wo.e,Bo,to.a,to.j,to.m,po.d,eo.a,po.e],styles:[""]}),t})(),Vo=(()=>{class t{constructor(t){this.store=t}addRootProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.a(t)).toPromise(),this.store.selectSnapshot(lo.a.getCreateRootProfileError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(oo.h))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ao=(()=>{class t{constructor(t,e){this.dhDialogService=t,this.hierarchyActionsService=e}ngOnInit(){}addRootProfile(){return Object(o.a)(this,void 0,void 0,(function*(){let t=yield this.dhDialogService.openDialog(jo,300,{title:"Enter new Root Profile data",label:"Profile Name",inputValue:""}).toPromise();if(null!=t){this.dhDialogService.showLoading();var e=this.hierarchyActionsService.addRootProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Root Profile Added.":"Error adding Root Profile.")}}))}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(yo),s.Mb(Vo))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-hierarchy-actions"]],decls:2,vars:0,consts:[["mat-flat-button","","color","primary",1,"mb-4","w-full",3,"click"]],template:function(t,e){1&t&&(s.Sb(0,"button",0),s.Zb("click",(function(){return e.addRootProfile()})),s.vc(1,"Add Root Profile"),s.Rb())},directives:[eo.a],styles:[""]}),t})();var Do=i("cqs0"),zo=i("9bRT"),Lo=i("C05f"),Wo=i("ROBh"),qo=i("J+dc"),Fo=i("xVbo");i("E5oP");class $o extends class{constructor(){this.expansionModel=new Do.c(!0)}toggle(t){this.expansionModel.toggle(this._trackByValue(t))}expand(t){this.expansionModel.select(this._trackByValue(t))}collapse(t){this.expansionModel.deselect(this._trackByValue(t))}isExpanded(t){return this.expansionModel.isSelected(this._trackByValue(t))}toggleDescendants(t){this.expansionModel.isSelected(this._trackByValue(t))?this.collapseDescendants(t):this.expandDescendants(t)}collapseAll(){this.expansionModel.clear()}expandDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.select(...e.map(t=>this._trackByValue(t)))}collapseDescendants(t){let e=[t];e.push(...this.getDescendants(t)),this.expansionModel.deselect(...e.map(t=>this._trackByValue(t)))}_trackByValue(t){return this.trackBy?this.trackBy(t):t}}{constructor(t,e){super(),this.getChildren=t,this.options=e,this.options&&(this.trackBy=this.options.trackBy)}expandAll(){this.expansionModel.clear();const t=this.dataNodes.reduce((t,e)=>[...t,...this.getDescendants(e),e],[]);this.expansionModel.select(...t.map(t=>this._trackByValue(t)))}getDescendants(t){const e=[];return this._getDescendants(e,t),e.splice(1)}_getDescendants(t,e){t.push(e);const i=this.getChildren(e);Array.isArray(i)?i.forEach(e=>this._getDescendants(t,e)):Object(zo.a)(i)&&i.pipe(Object(qo.a)(1),Object(Fo.a)(Boolean)).subscribe(e=>{for(const i of e)this._getDescendants(t,i)})}}const Ho=new s.r("CDK_TREE_NODE_OUTLET_NODE");let Xo=(()=>{class t{constructor(t,e){this.viewContainer=t,this._node=e}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.Q),s.Mb(Ho,8))},t.\u0275dir=s.Hb({type:t,selectors:[["","cdkTreeNodeOutlet",""]]}),t})();class Uo{constructor(t){this.$implicit=t}}let Go=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.M))},t.\u0275dir=s.Hb({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),Yo=(()=>{class t{constructor(t,e){this._differs=t,this._changeDetectorRef=e,this._onDestroy=new It.a,this._levels=new Map,this.viewChange=new Lo.a({start:0,end:Number.MAX_VALUE})}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}ngOnInit(){this._dataDiffer=this._differs.find([]).create(this.trackBy)}ngOnDestroy(){this._nodeOutlet.viewContainer.clear(),this.viewChange.complete(),this._onDestroy.next(),this._onDestroy.complete(),this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null)}ngAfterContentChecked(){const t=this._nodeDefs.filter(t=>!t.when);this._defaultNodeDef=t[0],this.dataSource&&this._nodeDefs&&!this._dataSubscription&&this._observeRenderChanges()}_switchDataSource(t){this._dataSource&&"function"==typeof this._dataSource.disconnect&&this.dataSource.disconnect(this),this._dataSubscription&&(this._dataSubscription.unsubscribe(),this._dataSubscription=null),t||this._nodeOutlet.viewContainer.clear(),this._dataSource=t,this._nodeDefs&&this._observeRenderChanges()}_observeRenderChanges(){let t;Object(Do.f)(this._dataSource)?t=this._dataSource.connect(this):Object(zo.a)(this._dataSource)?t=this._dataSource:Array.isArray(this._dataSource)&&(t=Object(Wo.a)(this._dataSource)),t&&(this._dataSubscription=t.pipe(Object(Et.a)(this._onDestroy)).subscribe(t=>this.renderNodeChanges(t)))}renderNodeChanges(t,e=this._dataDiffer,i=this._nodeOutlet.viewContainer,n){const r=e.diff(t);r&&(r.forEachOperation((e,r,o)=>{if(null==e.previousIndex)this.insertNode(t[o],o,i,n);else if(null==o)i.remove(r),this._levels.delete(e.item);else{const t=i.get(r);i.move(t,o)}}),this._changeDetectorRef.detectChanges())}_getNodeDef(t,e){return 1===this._nodeDefs.length?this._nodeDefs.first:this._nodeDefs.find(i=>i.when&&i.when(e,t))||this._defaultNodeDef}insertNode(t,e,i,n){const r=this._getNodeDef(t,e),o=new Uo(t);o.level=this.treeControl.getLevel?this.treeControl.getLevel(t):void 0!==n&&this._levels.has(n)?this._levels.get(n)+1:0,this._levels.set(t,o.level),(i||this._nodeOutlet.viewContainer).createEmbeddedView(r.template,o,e),Zo.mostRecentTreeNode&&(Zo.mostRecentTreeNode.data=t)}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.t),s.Mb(s.i))},t.\u0275cmp=s.Gb({type:t,selectors:[["cdk-tree"]],contentQueries:function(t,e,i){var n;1&t&&s.Fb(i,Go,!0),2&t&&s.jc(n=s.ac())&&(e._nodeDefs=n)},viewQuery:function(t,e){var i;1&t&&s.pc(Xo,!0),2&t&&s.jc(i=s.ac())&&(e._nodeOutlet=i.first)},hostAttrs:["role","tree",1,"cdk-tree"],inputs:{dataSource:"dataSource",treeControl:"treeControl",trackBy:"trackBy"},exportAs:["cdkTree"],decls:1,vars:0,consts:[["cdkTreeNodeOutlet",""]],template:function(t,e){1&t&&s.Ob(0,0)},directives:[Xo],encapsulation:2}),t})(),Zo=(()=>{class t{constructor(e,i){this._elementRef=e,this._tree=i,this._destroyed=new It.a,this._dataChanges=new It.a,this.role="treeitem",t.mostRecentTreeNode=this}get data(){return this._data}set data(t){t!==this._data&&(this._data=t,this._setRoleFromData(),this._dataChanges.next())}get isExpanded(){return this._tree.treeControl.isExpanded(this._data)}get level(){return this._tree.treeControl.getLevel?this._tree.treeControl.getLevel(this._data):0}ngOnDestroy(){t.mostRecentTreeNode===this&&(t.mostRecentTreeNode=null),this._dataChanges.complete(),this._destroyed.next(),this._destroyed.complete()}focus(){this._elementRef.nativeElement.focus()}_setRoleFromData(){this.role="treeitem"}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.m),s.Mb(Yo))},t.\u0275dir=s.Hb({type:t,selectors:[["cdk-tree-node"]],hostAttrs:[1,"cdk-tree-node"],hostVars:3,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("aria-level",e.level+1)("role",e.role)},inputs:{role:"role"},exportAs:["cdkTreeNode"]}),t.mostRecentTreeNode=null,t})(),Qo=(()=>{class t extends Zo{constructor(t,e,i){super(t,e),this._elementRef=t,this._tree=e,this._differs=i}ngAfterContentInit(){this._dataDiffer=this._differs.find([]).create(this._tree.trackBy);const t=this._tree.treeControl.getChildren(this.data);Array.isArray(t)?this.updateChildrenNodes(t):Object(zo.a)(t)&&t.pipe(Object(Et.a)(this._destroyed)).subscribe(t=>this.updateChildrenNodes(t)),this.nodeOutlet.changes.pipe(Object(Et.a)(this._destroyed)).subscribe(()=>this.updateChildrenNodes())}ngOnDestroy(){this._clear(),super.ngOnDestroy()}updateChildrenNodes(t){const e=this._getNodeOutlet();t&&(this._children=t),e&&this._children?this._tree.renderNodeChanges(this._children,this._dataDiffer,e.viewContainer,this._data):this._dataDiffer.diff([])}_clear(){const t=this._getNodeOutlet();t&&(t.viewContainer.clear(),this._dataDiffer.diff([]))}_getNodeOutlet(){const t=this.nodeOutlet;return t&&t.find(t=>!t._node||t._node===this)}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.m),s.Mb(Yo),s.Mb(s.t))},t.\u0275dir=s.Hb({type:t,selectors:[["cdk-nested-tree-node"]],contentQueries:function(t,e,i){var n;1&t&&s.Fb(i,Xo,!0),2&t&&s.jc(n=s.ac())&&(e.nodeOutlet=n)},hostAttrs:[1,"cdk-tree-node","cdk-nested-tree-node"],hostVars:2,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("role",e.role)},exportAs:["cdkNestedTreeNode"],features:[s.Bb([{provide:Zo,useExisting:t},{provide:Ho,useExisting:t}]),s.zb]}),t})(),Jo=(()=>{class t{constructor(t,e){this._tree=t,this._treeNode=e,this._recursive=!1}get recursive(){return this._recursive}set recursive(t){this._recursive=Object(xo.b)(t)}_toggle(t){this.recursive?this._tree.treeControl.toggleDescendants(this._treeNode.data):this._tree.treeControl.toggle(this._treeNode.data),t.stopPropagation()}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(Yo),s.Mb(Zo))},t.\u0275dir=s.Hb({type:t,selectors:[["","cdkTreeNodeToggle",""]],hostBindings:function(t,e){1&t&&s.Zb("click",(function(t){return e._toggle(t)}))},inputs:{recursive:["cdkTreeNodeToggleRecursive","recursive"]}}),t})(),Ko=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)}}),t})();var ts=i("g6G6"),es=i("YtkY");const is=Object(Eo.l)(Object(Eo.j)(Zo));let ns=(()=>{class t extends is{constructor(t,e,i){super(t,e),this._elementRef=t,this._tree=e,this.role="treeitem",this.tabIndex=Number(i)||0}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.m),s.Mb(Yo),s.Xb("tabindex"))},t.\u0275dir=s.Hb({type:t,selectors:[["mat-tree-node"]],hostAttrs:[1,"mat-tree-node"],hostVars:3,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("aria-level",e.level+1)("role",e.role)},inputs:{disabled:"disabled",tabIndex:"tabIndex",role:"role"},exportAs:["matTreeNode"],features:[s.Bb([{provide:Zo,useExisting:t}]),s.zb]}),t})(),rs=(()=>{class t extends Go{}return t.\u0275fac=function(e){return os(e||t)},t.\u0275dir=s.Hb({type:t,selectors:[["","matTreeNodeDef",""]],inputs:{when:["matTreeNodeDefWhen","when"],data:["matTreeNode","data"]},features:[s.Bb([{provide:Go,useExisting:t}]),s.zb]}),t})();const os=s.Ub(rs);let ss=(()=>{class t extends Qo{constructor(t,e,i,n){super(t,e,i),this._elementRef=t,this._tree=e,this._differs=i,this._disabled=!1,this.tabIndex=Number(n)||0}get disabled(){return this._disabled}set disabled(t){this._disabled=Object(xo.b)(t)}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?t:0}ngAfterContentInit(){super.ngAfterContentInit()}ngOnDestroy(){super.ngOnDestroy()}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.m),s.Mb(Yo),s.Mb(s.t),s.Xb("tabindex"))},t.\u0275dir=s.Hb({type:t,selectors:[["mat-nested-tree-node"]],hostAttrs:[1,"mat-nested-tree-node"],hostVars:2,hostBindings:function(t,e){2&t&&s.Db("aria-expanded",e.isExpanded)("role",e.role)},inputs:{tabIndex:"tabIndex",disabled:"disabled",node:["matNestedTreeNode","node"]},exportAs:["matNestedTreeNode"],features:[s.Bb([{provide:Qo,useExisting:t},{provide:Zo,useExisting:t},{provide:Ho,useExisting:t}]),s.zb]}),t})(),as=(()=>{class t{constructor(t,e){this.viewContainer=t,this._node=e}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(s.Q),s.Mb(Ho,8))},t.\u0275dir=s.Hb({type:t,selectors:[["","matTreeNodeOutlet",""]],features:[s.Bb([{provide:Xo,useExisting:t}])]}),t})(),ls=(()=>{class t extends Yo{}return t.\u0275fac=function(e){return cs(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["mat-tree"]],viewQuery:function(t,e){var i;1&t&&s.pc(as,!0),2&t&&s.jc(i=s.ac())&&(e._nodeOutlet=i.first)},hostAttrs:["role","tree",1,"mat-tree"],exportAs:["matTree"],features:[s.Bb([{provide:Yo,useExisting:t}]),s.zb],decls:1,vars:0,consts:[["matTreeNodeOutlet",""]],template:function(t,e){1&t&&s.Ob(0,0)},directives:[as],styles:[".mat-tree{display:block}.mat-tree-node{display:flex;align-items:center;flex:1;word-wrap:break-word}.mat-nested-tree-node{border-bottom-width:0}\n"],encapsulation:2}),t})();const cs=s.Ub(ls);let hs=(()=>{class t extends Jo{get recursive(){return this._recursive}set recursive(t){this._recursive=Object(xo.b)(t)}}return t.\u0275fac=function(e){return us(e||t)},t.\u0275dir=s.Hb({type:t,selectors:[["","matTreeNodeToggle",""]],inputs:{recursive:["matTreeNodeToggleRecursive","recursive"]},features:[s.Bb([{provide:Jo,useExisting:t}]),s.zb]}),t})();const us=s.Ub(hs);let ds=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},imports:[[Ko,Eo.c],Eo.c]}),t})();class fs extends Do.b{constructor(){super(...arguments),this._data=new Lo.a([])}get data(){return this._data.value}set data(t){this._data.next(t)}connect(t){return Object(ts.a)(t.viewChange,this._data).pipe(Object(es.a)(()=>this.data))}disconnect(){}}const ps=[{name:"Fruit",children:[{name:"Apple"},{name:"Banana"},{name:"Fruit loops"}]},{name:"Vegetables",children:[{name:"Green",children:[{name:"Broccoli"},{name:"Brussels sprouts"}]},{name:"Orange",children:[{name:"Pumpkins"},{name:"Carrots"}]}]}];var vs=i("bFHC");function gs(t,e){if(1&t&&(s.Sb(0,"mat-tree-node",3),s.Sb(1,"li",4),s.Nb(2,"button",5),s.vc(3),s.Rb(),s.Rb()),2&t){const t=e.$implicit;s.Cb(3),s.xc(" ",t.name," ")}}function ms(t,e){if(1&t&&(s.Sb(0,"mat-nested-tree-node"),s.Sb(1,"li"),s.Sb(2,"div",4),s.Sb(3,"button",6),s.Sb(4,"mat-icon",7),s.vc(5),s.Rb(),s.Rb(),s.vc(6),s.Rb(),s.Sb(7,"ul"),s.Ob(8,8),s.Rb(),s.Rb(),s.Rb()),2&t){const t=e.$implicit,i=s.cc();s.Cb(3),s.Db("aria-label","Toggle "+t.name),s.Cb(2),s.xc(" ",i.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),s.Cb(1),s.xc(" ",t.name," "),s.Cb(1),s.Eb("example-tree-invisible",!i.treeControl.isExpanded(t))}}let bs=(()=>{class t{constructor(){this.treeControl=new $o(t=>t.children),this.dataSource=new fs,this.hasChild=(t,e)=>!!e.children&&e.children.length>0,this.dataSource.data=ps}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-available-fields"]],decls:3,vars:3,consts:[[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["matTreeNodeOutlet",""]],template:function(t,e){1&t&&(s.Sb(0,"mat-tree",0),s.tc(1,gs,4,1,"mat-tree-node",1),s.tc(2,ms,9,5,"mat-nested-tree-node",2),s.Rb()),2&t&&(s.ic("dataSource",e.dataSource)("treeControl",e.treeControl),s.Cb(2),s.ic("matTreeNodeDefWhen",e.hasChild))},directives:[ls,rs,ns,hs,eo.a,ss,vs.a,as],styles:[".example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}"]}),t})(),ys=(()=>{class t{transform(t,e){return null==t||null==e?null:0!=t.indexOf(e)?t:t.substr(e.length+1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Lb({name:"removeParentIdFromSubProfile",type:t,pure:!0}),t})();const ws={provide:to.h,useExisting:Object(s.U)(()=>_s),multi:!0};let _s=(()=>{class t{constructor(){this.isDisabled=!1,this.propagateChange=t=>{},this.propagateTouched=t=>{}}writeValue(t){void 0!==t&&(this.value=t,this.propagateChange(this.value),this.propagateTouched(this.value))}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){this.propagateTouched=t}changeMade(t){this.propagateChange(t.value)}setDisabledState(t){this.isDisabled=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-slider-control"]],features:[s.Bb([ws])],decls:1,vars:2,consts:[["thumbLabel","","tickInterval","1","min","1","max","100",3,"ngModel","disabled","ngModelChange","change"]],template:function(t,e){1&t&&(s.Sb(0,"mat-slider",0),s.Zb("ngModelChange",(function(t){return e.value=t}))("change",(function(t){return e.changeMade(t)})),s.Rb()),2&t&&s.ic("ngModel",e.value)("disabled",e.isDisabled)},directives:[Kr.a,to.j,to.m],styles:[""]}),t})();function xs(t,e){if(1&t&&(s.Sb(0,"div",4),s.Qb(1,5),s.Sb(2,"label"),s.vc(3),s.dc(4,"removeParentIdFromSubProfile"),s.Rb(),s.Nb(5,"dh-slider-control",6),s.Pb(),s.Rb()),2&t){const t=e.index,i=s.cc();s.Cb(1),s.ic("formGroupName",t),s.Cb(2),s.wc(s.fc(4,2,i.subProfiles.controls[t].get("id").value,i.parentProfileId))}}let Cs=(()=>{class t{constructor(t){this.formBuilder=t,this.removeParentIdFromSubProfile=new ys}ngOnInit(){this.form=this.formBuilder.group({subProfiles:this.formBuilder.array(this.getFormGroupsForIds())})}get subProfiles(){return this.form.get("subProfiles")}getFormGroupsForIds(){return this.ids.map(t=>{const e=this.removeParentIdFromSubProfile.transform(t,this.parentProfileId);return this.formBuilder.group({id:[t,[]],weight:[this.weights[e],[]]})})}getChanges(){const t=this.subProfiles.controls.map(t=>t.value).reduce((t,e)=>(t[e.id]=e.weight,t),{});return this.ids.reduce((e,i)=>{const n=this.removeParentIdFromSubProfile.transform(i,this.parentProfileId),r=t[i];return r!=this.weights[n]&&(e[n]=r),e},{})}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(to.c))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-sub-profiles-edit"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights"},decls:5,vars:2,consts:[[1,"mt-10"],[3,"formGroup"],["formArrayName","subProfiles",1,"mt-10"],["class","mb-10",4,"ngFor","ngForOf"],[1,"mb-10"],[3,"formGroupName"],["formControlName","weight"]],template:function(t,e){1&t&&(s.Sb(0,"h3",0),s.vc(1,"Sub-Profiles:"),s.Rb(),s.Qb(2,1),s.Sb(3,"div",2),s.tc(4,xs,6,5,"div",3),s.Rb(),s.Pb()),2&t&&(s.Cb(2),s.ic("formGroup",e.form),s.Cb(2),s.ic("ngForOf",e.subProfiles.controls))},directives:[to.k,to.e,to.b,n.j,to.f,_s,to.j,to.d],pipes:[ys],styles:[""]}),t})(),Ss=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-profile-item-score-chart"]],decls:0,vars:0,template:function(t,e){},styles:[""]}),t})();function Is(t,e){if(1&t&&(s.Sb(0,"div",3),s.vc(1),s.Rb()),2&t){const t=s.cc();s.Cb(1),s.xc("Id: ",(null==t.profile?null:t.profile.id)||"No Type","")}}function ks(t,e){if(1&t&&(s.Sb(0,"tr"),s.Sb(1,"th",7),s.vc(2),s.Rb(),s.Sb(3,"th",7),s.vc(4),s.Rb(),s.Rb()),2&t){const t=e.$implicit;s.Cb(2),s.wc(t.name),s.Cb(2),s.wc(t.score)}}function Es(t,e){if(1&t&&(s.Sb(0,"table",3),s.Sb(1,"thead"),s.Sb(2,"tr"),s.Sb(3,"th",7),s.vc(4,"Value"),s.Rb(),s.Sb(5,"th",7),s.vc(6,"Score"),s.Rb(),s.Rb(),s.Rb(),s.Sb(7,"tbody"),s.tc(8,ks,5,2,"tr",8),s.Rb(),s.Rb()),2&t){const t=s.cc();s.Cb(8),s.ic("ngForOf",null==t.profile?null:t.profile.scores)}}function Ms(t,e){1&t&&(s.Qb(0),s.Nb(1,"dh-profile-item-score-chart"),s.Pb())}function Os(t,e){if(1&t&&(s.Qb(0),s.Nb(1,"dh-sub-profiles-edit",9),s.Pb()),2&t){const t=e.ngIf,i=s.cc(2);s.Cb(1),s.ic("ids",null==i.profile?null:i.profile.childrenIds)("parentProfileId",null==i.profile?null:i.profile.id)("weights",t.weights[null==i.profile?null:i.profile.id])}}function Rs(t,e){if(1&t&&(s.Qb(0),s.tc(1,Os,2,3,"ng-container",6),s.dc(2,"async"),s.Pb()),2&t){const t=s.cc();s.Cb(1),s.ic("ngIf",s.ec(2,1,t.weightStateService.weightState$))}}let Ts=(()=>{class t{constructor(t,e){this.formBuilder=t,this.weightStateService=e}ngOnInit(){this.form=this.formBuilder.group({name:this.profile.name})}getProfileName(){return this.form.value.name}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(to.c),s.Mb(fo))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-profile-details-edit"]],viewQuery:function(t,e){var i;1&t&&s.yc(Cs,!0),2&t&&s.jc(i=s.ac())&&(e.subProfilesEditComponent=i.first)},inputs:{profile:"profile"},decls:11,vars:6,consts:[[1,"bg-gray-300","p-10",3,"formGroup"],[1,"w-full"],["matInput","","placeholder","Profile Item Name","formControlName","name","matInput","","placeholder","Ex. name of the object property"],[1,"mb-5"],["class","mb-5",4,"ngIf"],["class","table-auto","class","mb-5",4,"ngIf"],[4,"ngIf"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"],[3,"ids","parentProfileId","weights"]],template:function(t,e){1&t&&(s.Sb(0,"form",0),s.Sb(1,"mat-form-field",1),s.Sb(2,"mat-label"),s.vc(3,"Profile Item Name"),s.Rb(),s.Nb(4,"input",2),s.Rb(),s.Sb(5,"div",3),s.vc(6),s.Rb(),s.tc(7,Is,2,1,"div",4),s.tc(8,Es,9,1,"table",5),s.Rb(),s.tc(9,Ms,2,0,"ng-container",6),s.tc(10,Rs,3,3,"ng-container",6)),2&t&&(s.ic("formGroup",e.form),s.Cb(6),s.xc("Item Type: ",(null==e.profile?null:e.profile.itemType)||"No Type",""),s.Cb(1),s.ic("ngIf",!((null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0)),s.Cb(1),s.ic("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.ic("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.ic("ngIf",(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[to.o,to.k,to.e,wo.b,wo.e,Bo,to.a,to.j,to.d,n.k,n.j,Ss,Cs],pipes:[n.b],styles:[""]}),t})(),Ps=(()=>{class t{constructor(t){this.store=t}updateName(t,e){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.g({profileId:t,updateProfileDto:{name:e}})).toPromise(),this.store.selectSnapshot(lo.a.getUpdateProfileNameError)}))}deleteProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.c(t)).toPromise(),null!=this.store.selectSnapshot(lo.a.getDeleteProfileError)}))}addSubProfile(t,e){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new ao.b(t,e)).toPromise(),this.store.selectSnapshot(lo.a.getCreateChildProfileError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Wb(oo.h))},t.\u0275prov=s.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Bs(t,e){if(1&t&&(s.Qb(0),s.Sb(1,"div"),s.vc(2),s.Rb(),s.Sb(3,"div"),s.vc(4),s.Rb(),s.Pb()),2&t){const t=e.ngIf,i=s.cc(2);s.Cb(2),s.xc(" ",t," "),s.Cb(2),s.xc(" ",i.weights[t]," ")}}function Ns(t,e){if(1&t&&(s.Sb(0,"li"),s.tc(1,Bs,5,2,"ng-container",1),s.dc(2,"removeParentIdFromSubProfile"),s.Rb()),2&t){const t=e.$implicit,i=s.cc();s.Cb(1),s.ic("ngIf",s.fc(2,1,t,i.parentProfileId))}}let js=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-sub-profiles"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights"},decls:4,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(s.Sb(0,"h3"),s.vc(1,"Sub-Profiles:"),s.Rb(),s.Sb(2,"ul"),s.tc(3,Ns,3,4,"li",0),s.Rb()),2&t&&(s.Cb(3),s.ic("ngForOf",e.ids))},directives:[n.j,n.k],pipes:[ys],styles:[""]}),t})();function Vs(t,e){if(1&t&&(s.Sb(0,"div",4),s.vc(1),s.Rb()),2&t){const t=s.cc();s.Cb(1),s.xc("Id: ",(null==t.profile?null:t.profile.id)||"No Type","")}}function As(t,e){if(1&t&&(s.Sb(0,"tr"),s.Sb(1,"th",5),s.vc(2),s.Rb(),s.Sb(3,"th",5),s.vc(4),s.Rb(),s.Rb()),2&t){const t=e.$implicit;s.Cb(2),s.wc(t.name),s.Cb(2),s.wc(t.score)}}function Ds(t,e){if(1&t&&(s.Qb(0),s.Sb(1,"table",4),s.Sb(2,"thead"),s.Sb(3,"tr"),s.Sb(4,"th",5),s.vc(5,"Value"),s.Rb(),s.Sb(6,"th",5),s.vc(7,"Score"),s.Rb(),s.Rb(),s.Rb(),s.Sb(8,"tbody"),s.tc(9,As,5,2,"tr",6),s.Rb(),s.Rb(),s.Nb(10,"dh-profile-item-score-chart"),s.Pb()),2&t){const t=s.cc();s.Cb(9),s.ic("ngForOf",null==t.profile?null:t.profile.scores)}}function zs(t,e){if(1&t&&(s.Qb(0),s.Nb(1,"dh-sub-profiles",7),s.Pb()),2&t){const t=e.ngIf,i=s.cc(2);s.Cb(1),s.ic("ids",null==i.profile?null:i.profile.childrenIds)("parentProfileId",null==i.profile?null:i.profile.id)("weights",t.weights[null==i.profile?null:i.profile.id])}}function Ls(t,e){if(1&t&&(s.Qb(0),s.tc(1,zs,2,3,"ng-container",3),s.dc(2,"async"),s.Pb()),2&t){const t=s.cc();s.Cb(1),s.ic("ngIf",s.ec(2,1,t.weightStateService.weightState$))}}let Ws=(()=>{class t{constructor(t){this.weightStateService=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(fo))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-profile-details-view"]],inputs:{profile:"profile"},decls:7,vars:5,consts:[[1,"mb-10","truncate"],[1,"mb-5","truncate"],["class","mb-5",4,"ngIf"],[4,"ngIf"],[1,"mb-5"],[1,"px-4","py-2"],[4,"ngFor","ngForOf"],[3,"ids","parentProfileId","weights"]],template:function(t,e){1&t&&(s.Sb(0,"h2",0),s.vc(1),s.Rb(),s.Sb(2,"div",1),s.vc(3),s.Rb(),s.tc(4,Vs,2,1,"div",2),s.tc(5,Ds,11,1,"ng-container",3),s.tc(6,Ls,3,3,"ng-container",3)),2&t&&(s.Cb(1),s.wc(null==e.profile?null:e.profile.name),s.Cb(2),s.xc("Item Type: ",(null==e.profile?null:e.profile.itemType)||"No Type",""),s.Cb(1),s.ic("ngIf",!((null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0)),s.Cb(1),s.ic("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Cb(1),s.ic("ngIf",(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[n.k,n.j,Ss,js],pipes:[n.b],styles:[""]}),t})();function qs(t,e){if(1&t){const t=s.Tb();s.Sb(0,"button",7),s.Zb("click",(function(){return s.lc(t),s.cc(2).addChildProfile()})),s.vc(1,"Add Sub-Profile"),s.Rb()}}function Fs(t,e){if(1&t){const t=s.Tb();s.Sb(0,"button",7),s.Zb("click",(function(){return s.lc(t),s.cc(2).addItem()})),s.vc(1,"Add Item"),s.Rb()}}function $s(t,e){if(1&t){const t=s.Tb();s.Sb(0,"button",7),s.Zb("click",(function(){return s.lc(t),s.cc(2).isEdit=!0})),s.vc(1,"Edit"),s.Rb()}}function Hs(t,e){if(1&t){const t=s.Tb();s.Sb(0,"button",7),s.Zb("click",(function(){return s.lc(t),s.cc(2).saveEdit()})),s.vc(1,"Save"),s.Rb()}}function Xs(t,e){if(1&t){const t=s.Tb();s.Sb(0,"button",8),s.Zb("click",(function(){return s.lc(t),s.cc(2).isEdit=!1})),s.vc(1,"Cancel"),s.Rb()}}function Us(t,e){if(1&t){const t=s.Tb();s.Sb(0,"button",9),s.Zb("click",(function(){return s.lc(t),s.cc(2).deleteProfile()})),s.vc(1,"Delete"),s.Rb()}}function Gs(t,e){if(1&t&&s.Nb(0,"dh-profile-details-view",10),2&t){const t=s.cc(2);s.ic("profile",t.profile)}}function Ys(t,e){if(1&t&&s.Nb(0,"dh-profile-details-edit",10),2&t){const t=s.cc(2);s.ic("profile",t.profile)}}function Zs(t,e){if(1&t&&(s.Qb(0),s.Sb(1,"div",2),s.tc(2,qs,2,0,"button",3),s.tc(3,Fs,2,0,"button",3),s.tc(4,$s,2,0,"button",3),s.tc(5,Hs,2,0,"button",3),s.tc(6,Xs,2,0,"button",4),s.tc(7,Us,2,0,"button",5),s.Rb(),s.tc(8,Gs,1,1,"dh-profile-details-view",6),s.tc(9,Ys,1,1,"dh-profile-details-edit",6),s.Pb()),2&t){const t=s.cc();s.Cb(2),s.ic("ngIf",!t.isEdit&&"profile"==(null==t.profile?null:t.profile.itemType)),s.Cb(1),s.ic("ngIf",!t.isEdit&&"profile"==(null==t.profile?null:t.profile.itemType)),s.Cb(1),s.ic("ngIf",!t.isEdit),s.Cb(1),s.ic("ngIf",t.isEdit),s.Cb(1),s.ic("ngIf",t.isEdit),s.Cb(1),s.ic("ngIf",!t.isEdit),s.Cb(1),s.ic("ngIf",!t.isEdit),s.Cb(1),s.ic("ngIf",t.isEdit)}}function Qs(t,e){1&t&&s.vc(0," No selected profile.\n")}let Js=(()=>{class t{constructor(t,e,i){this.profileDetailsService=t,this.dhDialogService=e,this.weightStateService=i,this.isEdit=!1,this.pprofile=null}get profile(){return this.pprofile}set profile(t){this.isEdit=!1,this.pprofile=t}ngOnInit(){}saveEdit(){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const t=this.profileDetailsEdit.getProfileName();t!=this.profile.name&&null!=(yield this.profileDetailsService.updateName(this.profile.id,t))&&this.dhDialogService.showMessage("Failed updating profile name");const e=this.profileDetailsEdit.subProfilesEditComponent.getChanges(),i=Object.keys(e);if(i.length>0)for(const n of i){const t=e[n];null!=(yield this.weightStateService.updateItemLinkWeight({profileId:this.profile.id,updateProfileItemWeightDto:{profileItemName:n,newWeight:t}}))&&this.dhDialogService.showMessage(`Failed updating ${n} weight`)}this.isEdit=!1,this.dhDialogService.hideLoading()}))}deleteProfile(){return Object(o.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({title:"Confirm Delete",message:"Are you sure you want to delete this profile?"}).toPromise()))return;this.dhDialogService.showLoading();const t=yield this.profileDetailsService.deleteProfile(this.profile.id);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(t?"Error deleting profile.":"Profile Deleted.")}))}addChildProfile(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.dhDialogService.openDialog(jo,300,{title:"Enter new Child Profile Name",label:"Profile Name",inputValue:""}).toPromise();if(null==t)return;this.dhDialogService.showLoading();const e=yield this.profileDetailsService.addSubProfile(this.profile.id,t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Sub Profile Added.":"Error adding Sub Profile.")}))}addItem(){}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(Ps),s.Mb(yo),s.Mb(fo))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-profile-details"]],viewQuery:function(t,e){var i;1&t&&s.yc(Ts,!0),2&t&&s.jc(i=s.ac())&&(e.profileDetailsEdit=i.first)},inputs:{profile:"profile"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noProfile",""],[1,"flex","justify-end","mb-16","mt-3"],["class","mr-5","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","mr-5","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-5","mat-flat-button","","color","warn",3,"click",4,"ngIf"],[3,"profile",4,"ngIf"],["mat-flat-button","","color","primary",1,"mr-5",3,"click"],["mat-flat-button","",1,"mr-5",3,"click"],["mat-flat-button","","color","warn",1,"mr-5",3,"click"],[3,"profile"]],template:function(t,e){if(1&t&&(s.tc(0,Zs,10,8,"ng-container",0),s.tc(1,Qs,1,0,"ng-template",null,1,s.uc)),2&t){const t=s.kc(2);s.ic("ngIf",e.profile)("ngIfElse",t)}},directives:[n.k,eo.a,Ws,Ts],styles:[""]}),t})();function Ks(t,e){if(1&t){const t=s.Tb();s.Qb(0),s.Sb(1,"div",2),s.Nb(2,"dh-hierarchy-actions"),s.Nb(3,"dh-available-fields"),s.Rb(),s.Sb(4,"dh-hierarchy",3),s.Zb("profileSelected",(function(e){return s.lc(t),s.cc(2).selectProfile(e)}))("linkClicked",(function(e){return s.lc(t),s.cc(2).linkClicked(e)}))("itemWeightChanged",(function(e){return s.lc(t),s.cc(2).itemWeightValueChanged(e)}))("childProfileWeightChanged",(function(e){return s.lc(t),s.cc(2).childProfileWeightValueChanged(e)}))("disconnectLinkClicked",(function(e){return s.lc(t),s.cc(2).disconnectLinkClicked(e)})),s.Rb(),s.Nb(5,"dh-profile-details",4),s.Pb()}if(2&t){const t=e.ngIf,i=s.cc().ngIf;s.Cb(4),s.ic("data",i.profiles)("weights",t.weights)("profileMap",i.profilesMap)("selectedProfile",i.selectedProfile),s.Cb(1),s.ic("profile",i.selectedProfile)}}function ta(t,e){if(1&t&&(s.Qb(0),s.tc(1,Ks,6,5,"ng-container",1),s.dc(2,"async"),s.Pb()),2&t){const t=s.cc();s.Cb(1),s.ic("ngIf",s.ec(2,1,t.profileVsService.weightState$))}}const ea=[{path:"",component:(()=>{class t{constructor(t,e,i){this.profileVsService=t,this.weightStateService=e,this.dhDialogService=i}ngOnInit(){return Object(o.a)(this,void 0,void 0,(function*(){this.profileVsService.keyChanged$.subscribe(()=>Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var t=yield this.profileVsService.getProfiles();this.dhDialogService.hideLoading(),"error"==t&&this.dhDialogService.showMessage("error loading profile")})))}))}selectProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){yield this.profileVsService.selectProfile(t.selectedNodeId),Object(s.lb)(this)}))}linkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){this.hierarchyComponent.showWeightSlider()}))}itemWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var e=yield this.weightStateService.updateItemLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating item weight":"Item weight updated")}))}childProfileWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();var e=yield this.profileVsService.updateChildProfileLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating child profile weight":"Child profile weight updated")}))}disconnectLinkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){if(yield this.dhDialogService.showConfirmation({title:"Disconnect Sub Profile",message:"Are you sure you want to disconnect these profiles?"}).toPromise()){var e=yield this.profileVsService.disconectSubProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error disconnecting sub profile":"Sub Profile Disconnected")}}))}}return t.\u0275fac=function(e){return new(e||t)(s.Mb(uo),s.Mb(fo),s.Mb(yo))},t.\u0275cmp=s.Gb({type:t,selectors:[["dh-profile"]],viewQuery:function(t,e){var i;1&t&&s.yc(ro,!0),2&t&&s.jc(i=s.ac())&&(e.hierarchyComponent=i.first)},decls:3,vars:3,consts:[[1,"flex"],[4,"ngIf"],[1,"block","border-r-4","px-10","text-base",2,"width","290px"],[1,"block","flex-1","overflow-hidden",3,"data","weights","profileMap","selectedProfile","profileSelected","linkClicked","itemWeightChanged","childProfileWeightChanged","disconnectLinkClicked"],[1,"block","border-l-4","px-10","text-base",2,"width","490px",3,"profile"]],template:function(t,e){1&t&&(s.Sb(0,"div",0),s.tc(1,ta,3,3,"ng-container",1),s.dc(2,"async"),s.Rb()),2&t&&(s.Cb(1),s.ic("ngIf",s.ec(2,1,e.profileVsService.profileState$)))},directives:[n.k,Ao,bs,ro,Js],pipes:[n.b],styles:["dh-hierarchy[_ngcontent-%COMP%]{height:calc(100vh - 76px)}"]}),t})()}];let ia=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},imports:[[r.a.forChild(ea)],r.a]}),t})(),na=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},imports:[[n.c,Kr.b,to.g]]}),t})(),ra=(()=>{class t{}return t.\u0275mod=s.Kb({type:t}),t.\u0275inj=s.Jb({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,ia,to.g,to.n,Kr.b,eo.b,wo.d,No,bo.b,ds,vs.b,po.g,na]]}),t})()}}]);