(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"723k":function(t,e,i){"use strict";i.r(e),i.d(e,"ProfileModule",(function(){return ch}));var n=i("2kYt"),r=i("sEIs"),o=i("D57K"),s=i("EM62");class a{constructor(t){this.base=t}[Symbol.iterator](){return this.base[Symbol.iterator]()}concat(...t){return l(function*(t){for(const e of t)yield*e}([this,...t.map(l)]))}entries(){return l(function*(t){let e=0;for(const i of t)yield[e++,i]}(this))}every(t){return!this.some((e,i)=>!t(e,i))}fill(t){return this.map(()=>t)}filter(t){return l(function*(e){for(const[i,n]of e)t(n,i)&&(yield n)}(this.entries()))}find(t){for(const[e,i]of this.entries())if(t(i,e))return i}findIndex(t){for(const[e,i]of this.entries())if(t(i,e))return e;return-1}flatMap(t){return l(function*(e){for(const[i,n]of e)yield*l(t(n,i))}(this.entries()))}forEach(t){for(const[e,i]of this.entries())t(i,e)}includes(t,e=0){return this.indexOf(t,e)>=0}indexOf(t,e=0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");for(const[i,n]of this.entries())if(i>=e&&n===t)return i;return-1}join(t=","){return[...this].join(t)}keys(){return l(function*(t){let e=0;for(const i of t)yield e++}(this))}lastIndexOf(t,e=1/0){if(e<0)throw new Error("fromIndex doesn't support negative numbers because generator length isn't known");let i=-1;for(const[n,r]of this.entries())n<=e&&r===t&&(i=n);return i}get length(){return this.reduce(t=>t+1,0)}map(t){return l(function*(e){for(const[i,n]of e)yield t(n,i)}(this.entries()))}reduce(t,e){if(void 0===e){const e=t;let i=!0,n=void 0;for(const[t,r]of this.entries())i?(n=r,i=!1):n=e(n,r,t);if(i)throw new TypeError("Reduce of empty iterable with no initial value");return n}{const i=t;let n=e;for(const[t,e]of this.entries())n=i(n,e,t);return n}}reverse(){return l([...this].reverse())}slice(t=0,e=1/0){return l(function*(i){for(const[n,r]of i)if(n<t);else{if(!(n<e))break;yield r}}(this.entries()))}some(t){for(const[e,i]of this.entries())if(t(i,e))return!0;return!1}sort(t){return l([...this].sort(t))}splice(t,e=0,...i){return l(function*(n){for(const[r,o]of n)r===t&&(yield*i),(r<t||r>=t+e)&&(yield o)}(this.entries()))}values(){return this}}function l(t){return function(t){return"function"==typeof t[Symbol.iterator]}(t)?new a(t):new a({[Symbol.iterator]:()=>t})}function c(t,e){e.size<t.size&&([e,t]=[t,e]);for(const i of t)if(e.has(i))return!0;return!1}class h extends Map{getThrow(t){const e=this.get(t);if(void 0===e)throw new Error("map doesn't contain key: "+t);return e}getDefault(t,e){const i=this.get(t);return void 0===i?e:i}setIfAbsent(t,e){const i=this.get(t);return void 0===i?(this.set(t,e),e):i}}class u{constructor(t,e,i=[]){this.child=t,this.data=e,this.points=i}}class d{constructor(t,e,i,n){this.source=t,this.target=e,this.data=i,this.points=n}}class f{constructor(t,e){this.id=t,this.data=e,this.dataChildren=[]}iroots(){return l([this])}roots(){return[this]}*iterChildren(){for(const{child:t}of this.dataChildren)yield t}ichildren(){return l(this.iterChildren())}children(){return[...this.ichildren()]}*iterChildLinks(){for(const{child:t,data:e,points:i}of this.dataChildren)yield new d(this,t,e,i)}ichildLinks(){return l(this.iterChildLinks())}childLinks(){return[...this.ichildLinks()]}[Symbol.iterator](){return new p([this])[Symbol.iterator]()}idescendants(t="depth"){return new p([this]).idescendants(t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return new p([this]).ilinks()}links(){return[...this.ilinks()]}size(){return new p([this]).size()}sum(t){return new p([this]).sum(t),this}count(){return new p([this]).count(),this}height(){return new p([this]).height(),this}depth(){return new p([this]).depth(),this}split(){return[this]}connected(){return!0}}class p{constructor(t){this.dagRoots=t}[Symbol.iterator](){return this.idepth()}iroots(){return l(this.dagRoots)}roots(){return this.dagRoots.slice()}*idepth(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(e.add(i.id),yield i,t.push(...i.ichildren()))}*ibreadth(){const t=new Set;let e=this.roots(),i=[];do{let n;for(i=e.reverse(),e=[];n=i.pop();)t.has(n.id)||(t.add(n.id),yield n,e.push(...n.ichildren()))}while(e.length)}*ibefore(){const t=new h;for(const n of this)for(const e of n.ichildren())t.set(e.id,t.getDefault(e.id,0)+1);const e=this.roots();let i;for(;i=e.pop();){yield i;for(const n of i.ichildren()){const i=t.getThrow(n.id);i>1?t.set(n.id,i-1):e.push(n)}}}*iafter(){const t=this.roots(),e=new Set;let i;for(;i=t.pop();)e.has(i.id)||(i.ichildren().every(t=>e.has(t.id))?(e.add(i.id),yield i):(t.push(i),t.push(...i.ichildren())))}idescendants(t="depth"){if("depth"===t)return l(this.idepth());if("breadth"===t)return l(this.ibreadth());if("before"===t)return l(this.ibefore());if("after"===t)return l(this.iafter());throw new Error("unknown iteration style: "+t)}descendants(t="depth"){return[...this.idescendants(t)]}ilinks(){return this.idescendants().flatMap(t=>t.ichildLinks())}links(){return[...this.ilinks()]}size(){return this.idescendants().reduce(t=>t+1,0)}sum(t){const e=new h;for(const[i,n]of this.idescendants("after").entries()){const r=t(n,i),o=new h;o.set(n.id,r);for(const t of n.ichildren()){const i=e.getThrow(t.id);for(const[t,e]of i.entries())o.set(t,e)}n.value=l(o.entries()).map(([,t])=>t).reduce((t,e)=>t+e),e.set(n.id,o)}return this}count(){const t=new h;for(const e of this.idescendants("after"))if(e.ichildren()[Symbol.iterator]().next().done)t.set(e.id,new Set([e.id])),e.value=1;else{const i=new Set;for(const n of e.ichildren()){const e=t.getThrow(n.id);for(const t of e)i.add(t)}t.set(e.id,i),e.value=i.size}return this}height(){for(const t of this.idescendants("after"))t.value=Math.max(0,...t.ichildren().map(t=>{if(void 0===t.value)throw new Error("`after` iteration didn't iterate in after order");return t.value+1}));return this}depth(){const t=new h;for(const e of this)for(const i of e.ichildren())t.setIfAbsent(i.id,[]).push(e);for(const e of this.idescendants("before"))e.value=Math.max(0,...t.getDefault(e.id,[]).map(t=>{if(void 0===t.value)throw new Error("`before` iteration didn't iterate in before order");return t.value+1}));return this}split(){const t=new h,e=new h;for(const r of this.iroots())t.set(r.id,[]),e.set(r.id,new Set(r.idescendants().map(t=>t.id)));for(const[r,o]of this.iroots().entries()){const i=e.getThrow(o.id);for(const n of this.iroots().slice(r+1))c(i,e.getThrow(n.id))&&(t.getThrow(o.id).push(n),t.getThrow(n.id).push(o))}const i=[],n=new Set;for(const r of this.iroots())if(!n.has(r.id)){n.add(r.id);const e=[r];i.push(e);const o=t.getThrow(r.id).slice();let s;for(;s=o.pop();)n.has(s.id)||(n.add(s.id),e.push(s),o.push(...t.getThrow(s.id)))}return i.map(t=>t.length>1?new p(t):t[0])}connected(){return 1===this.split().length}}function g(t){function e(e,i){return(t(e,i)||[]).map(t=>[t,void 0])}return e.wrapped=t,e}function m(t){if(function(t){try{return"string"==typeof t.id}catch(e){return!1}}(t))return t.id;throw new Error("default id function expected datum to have an id field but got: "+t)}function b(t){if(function(t){try{const e=t.parentIds;return void 0===e||e instanceof Array&&e.every(t=>"string"==typeof t)}catch(e){return!1}}(t))return t.parentIds;throw new Error("default parentIds function expected datum to have a parentIds field but got: "+t)}let v,y,w=1e-60;do{w+=w,v=1+.1*w,y=1+.2*w}while(v<=1||y<=1);var _=w,x=function(t,e,i,n=[],r=0,o=[0,0]){const s=[],a=[],l=[],c=[],h=[],u=[];let d="";const f=t.length-1,p=i[1].length-1;if(!n)for(let m=1;m<=p;m+=1)n[m]=0;if(f!==t[1].length-1&&(d="Dmat is not symmetric!"),f!==e.length-1&&(d="Dmat and dvec are incompatible!"),f!==i.length-1&&(d="Amat and dvec are incompatible!"),p!==n.length-1&&(d="Amat and bvec are incompatible!"),(r>p||r<0)&&(d="Value of meq is invalid!"),""!==d)return{message:d};for(let m=1;m<=p;m+=1)a[m]=0,c[m]=0;const g=Math.min(f,p);for(let m=1;m<=f;m+=1)l[m]=0;s[1]=0;for(let m=1;m<=2*f+g*(g+5)/2+2*p+1;m+=1)h[m]=0;for(let m=1;m<=2;m+=1)u[m]=0;return function(t,e,i,n,r,o,s,a,l,c,h,u,d,f=0,p,g,m){let b,v,y,w,x,S,I,k,C,P,A,M,T,E;const O=Math.min(n,h);let D=2*n+O*(O+5)/2+2*h+1;for(let _=1;_<=n;_+=1)g[_]=e[_];for(let _=n+1;_<=D;_+=1)g[_]=0;for(let _=1;_<=h;_+=1)d[_]=0,o[_]=0;const z=[];if(0===m[1]){if(function(t,e,i,n){let r,o,s;for(let a=1;a<=i;a+=1){if(n[1]=a,s=0,r=a-1,r<1){if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}else{for(let e=1;e<=r;e+=1){o=t[e][a];for(let i=1;i<e;i+=1)o-=t[i][a]*t[i][e];o/=t[e][e],t[e][a]=o,s+=o*o}if(s=t[a][a]-s,s<=0)break;t[a][a]=Math.sqrt(s)}n[1]=0}}(t,0,n,z),0!==z[1])return void(m[1]=2);(function(t,e,i,n){let r,o;for(r=1;r<=i;r+=1){o=0;for(let e=1;e<r;e+=1)o+=t[e][r]*n[e];n[r]=(n[r]-o)/t[r][r]}for(let s=1;s<=i;s+=1){r=i+1-s,n[r]/=t[r][r],o=-n[r];for(let e=1;e<r;e+=1)n[e]+=o*t[e][r]}})(t,0,n,e),function(t,e,i){let n,r;for(let o=1;o<=i;o+=1){t[o][o]=1/t[o][o],r=-t[o][o];for(let e=1;e<o;e+=1)t[e][o]*=r;if(n=o+1,i<n)break;for(let e=n;e<=i;e+=1){r=t[o][e],t[o][e]=0;for(let i=1;i<=o;i+=1)t[i][e]+=r*t[i][o]}}}(t,0,n)}else{for(let i=1;i<=n;i+=1){r[i]=0;for(let n=1;n<=i;n+=1)r[i]+=t[n][i]*e[n]}for(let i=1;i<=n;i+=1){e[i]=0;for(let o=i;o<=n;o+=1)e[i]+=t[i][o]*r[o]}}s[1]=0;for(let _=1;_<=n;_+=1){r[_]=e[_],s[1]+=g[_]*r[_],g[_]=0;for(let e=_+1;e<=n;e+=1)t[e][_]=0}s[1]=-s[1]/2,m[1]=0;const V=n,B=V+n,R=B+O,j=R+O+1,F=j+O*(O+1)/2,L=F+h;for(let _=1;_<=h;_+=1){S=0;for(let t=1;t<=n;t+=1)S+=a[t][_]*a[t][_];g[L+_]=Math.sqrt(S)}function N(){p[1]+=1,D=F;for(let t=1;t<=h;t+=1){D+=1,S=-l[t];for(let e=1;e<=n;e+=1)S+=a[e][t]*r[e];if(Math.abs(S)<_&&(S=0),t>u)g[D]=S;else if(g[D]=-Math.abs(S),S>0){for(let e=1;e<=n;e+=1)a[e][t]=-a[e][t];l[t]=-l[t]}}for(let t=1;t<=w;t+=1)g[F+d[t]]=0;y=0,x=0;for(let t=1;t<=h;t+=1)g[F+t]<x*g[L+t]&&(y=t,x=g[F+t]/g[L+t]);if(0===y){for(let t=1;t<=w;t+=1)o[d[t]]=g[R+t];return 999}return 0}function U(){for(let e=1;e<=n;e+=1){S=0;for(let i=1;i<=n;i+=1)S+=t[i][e]*a[i][y];g[e]=S}b=V;for(let t=1;t<=n;t+=1)g[b+t]=0;for(let e=w+1;e<=n;e+=1)for(let i=1;i<=n;i+=1)g[b+i]=g[b+i]+t[i][e]*g[e];M=!0;for(let t=w;t>=1;t-=1){S=g[t],D=j+t*(t+3)/2,b=D-t;for(let e=t+1;e<=w;e+=1)S-=g[D]*g[B+e],D+=e;S/=g[b],g[B+t]=S,d[t]<=u||S<=0||(M=!1,v=t)}if(!M){I=g[R+v]/g[B+v];for(let t=1;t<=w;t+=1)d[t]<=u||g[B+t]<=0||(x=g[R+t]/g[B+t],x<I&&(I=x,v=t))}S=0;for(let t=V+1;t<=V+n;t+=1)S+=g[t]*g[t];if(Math.abs(S)<=_){if(M)return m[1]=1,999;for(let t=1;t<=w;t+=1)g[R+t]=g[R+t]-I*g[B+t];return g[R+w+1]=g[R+w+1]+I,700}S=0;for(let t=1;t<=n;t+=1)S+=g[V+t]*a[t][y];k=-g[F+y]/S,T=!0,M||I<k&&(k=I,T=!1);for(let t=1;t<=n;t+=1)r[t]+=k*g[V+t],Math.abs(r[t])<_&&(r[t]=0);s[1]+=k*S*(k/2+g[R+w+1]);for(let t=1;t<=w;t+=1)g[R+t]=g[R+t]-k*g[B+t];if(g[R+w+1]=g[R+w+1]+k,!T){S=-l[y];for(let t=1;t<=n;t+=1)S+=r[t]*a[t][y];if(y>u)g[F+y]=S;else if(g[F+y]=-Math.abs(S),S>0){for(let t=1;t<=n;t+=1)a[t][y]=-a[t][y];l[y]=-l[y]}return 700}w+=1,d[w]=y,D=j+(w-1)*w/2+1;for(let t=1;t<=w-1;t+=1)g[D]=g[t],D+=1;if(w===n)g[D]=g[n];else{for(let e=n;e>=w+1;e-=1)if(0!==g[e]&&(C=Math.max(Math.abs(g[e-1]),Math.abs(g[e])),P=Math.min(Math.abs(g[e-1]),Math.abs(g[e])),x=g[e-1]>=0?Math.abs(C*Math.sqrt(1+P*P/(C*C))):-Math.abs(C*Math.sqrt(1+P*P/(C*C))),C=g[e-1]/x,P=g[e]/x,1!==C))if(0===C){g[e-1]=P*x;for(let i=1;i<=n;i+=1)x=t[i][e-1],t[i][e-1]=t[i][e],t[i][e]=x}else{g[e-1]=x,A=P/(1+C);for(let i=1;i<=n;i+=1)x=C*t[i][e-1]+P*t[i][e],t[i][e]=A*(t[i][e-1]+x)-t[i][e],t[i][e-1]=x}g[D]=g[w]}return 0}function G(){if(D=j+v*(v+1)/2+1,b=D+v,0===g[b])return 798;if(C=Math.max(Math.abs(g[b-1]),Math.abs(g[b])),P=Math.min(Math.abs(g[b-1]),Math.abs(g[b])),x=g[b-1]>=0?Math.abs(C*Math.sqrt(1+P*P/(C*C))):-Math.abs(C*Math.sqrt(1+P*P/(C*C))),C=g[b-1]/x,P=g[b]/x,1===C)return 798;if(0===C){for(let t=v+1;t<=w;t+=1)x=g[b-1],g[b-1]=g[b],g[b]=x,b+=t;for(let e=1;e<=n;e+=1)x=t[e][v],t[e][v]=t[e][v+1],t[e][v+1]=x}else{A=P/(1+C);for(let t=v+1;t<=w;t+=1)x=C*g[b-1]+P*g[b],g[b]=A*(g[b-1]+x)-g[b],g[b-1]=x,b+=t;for(let e=1;e<=n;e+=1)x=C*t[e][v]+P*t[e][v+1],t[e][v+1]=A*(t[e][v]+x)-t[e][v+1],t[e][v]=x}return 0}function W(){b=D-v;for(let t=1;t<=v;t+=1)g[b]=g[D],D+=1,b+=1;return g[R+v]=g[R+v+1],d[v]=d[v+1],v+=1,v<w?797:0}function H(){return g[R+w]=g[R+w+1],g[R+w+1]=0,d[w]=0,w-=1,p[2]+=1,0}for(w=f,p[1]=0,p[2]=0,E=0;;){if(E=N(),999===E)return;for(;E=U(),0!==E;){if(999===E)return;if(700===E)if(v===w)H();else{for(;G(),E=W(),797===E;);H()}}}}(t,e,0,f,l,c,s,i,n,0,p,r,a,0,u,h,o),1===o[1]&&(d="constraints are inconsistent, no solution!"),2===o[1]&&(d="matrix D in quadratic function is not positive definite!"),{solution:l,Lagrangian:c,value:s,unconstrained_solution:e,iterations:u,iact:a,message:d}};function S(t,e){let[i,...n]=t,r=i.x=0;for(const o of n)r=o.x=r+e(i,o),i=o;if(r>0)for(const o of t)o.x/=r;else for(const o of t)o.x=.5}function I(t,e,i,n){t[i][i]+=n,t[i][e]-=n,t[e][i]-=n,t[e][e]+=n}function k(t,e,i,n,r){t[n][n]+=r,t[n][i]-=2*r,t[n][e]+=r,t[i][n]-=2*r,t[i][i]+=4*r,t[i][e]-=2*r,t[e][n]+=r,t[e][i]-=2*r,t[e][e]+=r}class C extends f{constructor(t){super(t,void 0)}}function P(t,e,i,n){this.feasible=i,this.evaluation=e,this.bounded=n,this._tableau=t}var A=P;function M(t,e,i,n,r){A.call(this,t,e,i,n),this.iter=r}P.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,n=e.variablesPerIndex,r=e.matrix,o=e.rhsColumn,s=e.height-1,a=Math.round(1/e.precision),l=1;l<=s;l+=1){var c=n[i[l]];void 0!==c&&!0!==c.isSlack&&(t[c.id]=Math.round((Number.EPSILON+r[l][o])*a)/a)}return t};var T=M;function E(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}M.prototype=Object.create(A.prototype),M.constructor=M;var O=E;function D(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}E.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},D.prototype.copy=function(){var t=new D(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},E.prototype.setOptionalObjective=function(t,e,i){var n=this.objectivesByPriority[t];void 0===n&&(n=new D(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=n,this.optionalObjectives.push(n),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),n.reducedCosts[e]=i},E.prototype.initialize=function(t,e,i,n){this.variables=i,this.unrestrictedVars=n,this.width=t,this.height=e;for(var r=new Array(t),o=0;o<t;o++)r[o]=0;this.matrix=new Array(e);for(var s=0;s<e;s++)this.matrix[s]=r.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},E.prototype._resetMatrix=function(){var t,e,i=this.model.variables,n=this.model.constraints,r=i.length,o=n.length,s=this.matrix[0],a=!0===this.model.isMinimization?-1:1;for(t=0;t<r;t+=1){var l=i[t],c=l.priority,h=a*l.cost;0===c?s[t+1]=h:this.setOptionalObjective(c,t+1,h),this.rowByVarIndex[e=i[t].index]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var u=1,d=0;d<o;d+=1){var f,p,g=n[d],m=g.index;this.rowByVarIndex[m]=u,this.colByVarIndex[m]=-1,this.varIndexByRow[u]=m;var b=g.terms,v=b.length,y=this.matrix[u++];if(g.isUpperBound){for(f=0;f<v;f+=1)y[this.colByVarIndex[(p=b[f]).variable.index]]=p.coefficient;y[0]=g.rhs}else{for(f=0;f<v;f+=1)y[this.colByVarIndex[(p=b[f]).variable.index]]=-p.coefficient;y[0]=-g.rhs}}},E.prototype.setModel=function(t){return this.model=t,this.initialize(t.nVariables+1,t.nConstraints+1,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},E.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},E.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var n=e[i],r=0;r<this.width;r++)0!==n[r]&&(t+=1);return t/(this.height*this.width)},E.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=Math.round((Number.EPSILON+this.matrix[this.costRowIndex][this.rhsColumn])*t)/t;this.evaluation=e,0===this.simplexIters&&(this.bestPossibleEval=e)},E.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new T(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new A(this,t,this.feasible,this.bounded)},O.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},O.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,n=this.rhsColumn,r=this.width-1,o=this.height-1,s=0;;){for(var a=0,l=-this.precision,c=1;c<=o;c++){var h=i[c][n];h<l&&(l=h,a=c)}if(0===a)return this.feasible=!0,s;for(var u=0,d=-1/0,f=i[0],p=i[a],g=1;g<=r;g++){var m=p[g];if(!0===this.unrestrictedVars[this.varIndexByCol[g]]||m<-this.precision){var b=-f[g]/m;d<b&&(d=b,u=g)}}if(0===u)return this.feasible=!1,s;if(t){e.push([this.varIndexByRow[a],this.varIndexByCol[u]]);var v=this.checkForCycles(e);if(v.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+v[0]),this.model.messages.push("Length :"+v[1]),this.feasible=!1,s}this.pivot(a,u),s+=1}},O.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,n=[],r=this.matrix,o=this.rhsColumn,s=this.width-1,a=this.height-1,l=this.precision,c=this.optionalObjectives.length,h=null,u=0;;){var d=r[this.costRowIndex];c>0&&(h=[]);for(var f=0,p=l,g=!1,m=1;m<=s;m++)t=d[m],e=!0===this.unrestrictedVars[this.varIndexByCol[m]],c>0&&-l<t&&t<l?h.push(m):e&&t<0?-t>p&&(p=-t,f=m,g=!0):t>p&&(p=t,f=m,g=!1);if(c>0)for(var b=0;0===f&&h.length>0&&b<c;){var v=[],y=this.optionalObjectives[b].reducedCosts;p=l;for(var w=0;w<h.length;w++)e=!0===this.unrestrictedVars[this.varIndexByCol[m=h[w]]],-l<(t=y[m])&&t<l?v.push(m):e&&t<0?-t>p&&(p=-t,f=m,g=!0):t>p&&(p=t,f=m,g=!1);h=v,b+=1}if(0===f)return this.setEvaluation(),this.simplexIters+=1,u;for(var _=0,x=1/0,S=1;S<=a;S++){var I=r[S],k=I[o],C=I[f];if(!(-l<C&&C<l)){if(C>0&&l>k&&k>-l){x=0,_=S;break}var P=g?-k/C:k/C;P>l&&x>P&&(x=P,_=S)}}if(x===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],u;if(i){n.push([this.varIndexByRow[_],this.varIndexByCol[f]]);var A=this.checkForCycles(n);if(A.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+A[0]),this.model.messages.push("Length :"+A[1]),this.feasible=!1,u}this.pivot(_,f,!0),u+=1}};var z=[];function V(t,e,i,n){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=n}function B(t,e,i,n){V.call(this,t,e,i,n)}function R(t,e){V.call(this,t,0,e,0)}function j(t,e){this.variable=t,this.coefficient=e}function F(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function L(t,e,i,n){this.slack=new R("s"+i,i),this.index=i,this.model=n,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function N(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}O.prototype.pivot=function(t,e){var i=this.matrix,n=i[t][e],r=this.height-1,o=this.width-1,s=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=s,this.rowByVarIndex[a]=t,this.rowByVarIndex[s]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[s]=e;for(var l,c,h,u=i[t],d=0,f=0;f<=o;f++)u[f]>=-1e-16&&u[f]<=1e-16?u[f]=0:(u[f]/=n,z[d]=f,d+=1);u[e]=1/n;for(var p=0;p<=r;p++)if(p!==t&&!(i[p][e]>=-1e-16&&i[p][e]<=1e-16)){var g=i[p];if((l=g[e])>=-1e-16&&l<=1e-16)0!==l&&(g[e]=0);else{for(c=0;c<d;c++)(h=u[f=z[c]])>=-1e-16&&h<=1e-16?0!==h&&(u[f]=0):g[f]=g[f]-l*h;g[e]=-l/n}}var m=this.optionalObjectives.length;if(m>0)for(var b=0;b<m;b+=1){var v=this.optionalObjectives[b].reducedCosts;if(0!==(l=v[e])){for(c=0;c<d;c++)0!==(h=u[f=z[c]])&&(v[f]=v[f]-l*h);v[e]=-l/n}}},O.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var n=t[e],r=t[i];if(n[0]===r[0]&&n[1]===r[1]){if(i-e>t.length-i)break;for(var o=!0,s=1;s<i-e;s++){var a=t[e+s],l=t[i+s];if(a[0]!==l[0]||a[1]!==l[1]){o=!1;break}}if(o)return[e,i-e]}}return[]},B.prototype.isInteger=!0,R.prototype.isSlack=!0,L.prototype.addTerm=function(t,e){var i=e.index,n=this.termsByVarIndex[i];return void 0===n?(n=new j(e,t),this.termsByVarIndex[i]=n,this.terms.push(n),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t)):this.setVariableCoefficient(n.coefficient+t,e),this},L.prototype.removeTerm=function(t){return this},L.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},L.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var n=this.termsByVarIndex[i];if(void 0===n)this.addTerm(t,e);else if(t!==n.coefficient){var r=t-n.coefficient;!0===this.isUpperBound&&(r=-r),n.coefficient=t,this.model.updateConstraintCoefficient(this,e,r)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},L.prototype.relax=function(t,e){this.relaxation=F(this.model,t,e),this._relax(this.relaxation)},L.prototype._relax=function(t){null!==t&&this.setVariableCoefficient(this.isUpperBound?-1:1,t)},N.prototype.isEquality=!0,N.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},N.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},N.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},N.prototype.relax=function(t,e){this.relaxation=F(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var U={Constraint:L,Variable:V,IntegerVariable:B,SlackVariable:R,Equality:N,Term:j},G=U.SlackVariable;function W(t,e){this.index=t,this.value=e}O.prototype.addCutConstraints=function(t){for(var e,i=t.length,n=this.height,r=n+i,o=n;o<r;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=r,this.nVars=this.width+this.height-2;for(var s=this.width-1,a=0;a<i;a+=1){var l=t[a],c=n+a,h="min"===l.type?-1:1,u=l.varIndex,d=this.rowByVarIndex[u],f=this.matrix[c];if(-1===d){for(f[this.rhsColumn]=h*l.value,e=1;e<=s;e+=1)f[e]=0;f[this.colByVarIndex[u]]=h}else{var p=this.matrix[d];for(f[this.rhsColumn]=h*(l.value-p[this.rhsColumn]),e=1;e<=s;e+=1)f[e]=-h*p[e]}var g=this.getNewElementIndex();this.varIndexByRow[c]=g,this.rowByVarIndex[g]=c,this.colByVarIndex[g]=-1,this.variablesPerIndex[g]=new G("s"+g,g),this.nVars+=1}},O.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new G("s"+o,o),e[r][this.rhsColumn]=Math.floor(i);for(var s=1;s<this.varIndexByCol.length;s+=1)if(this.variablesPerIndex[this.varIndexByCol[s]].isInteger){var a=e[t][s],l=Math.floor(a)+Math.max(0,a-Math.floor(a)-n)/(1-n);e[r][s]=l}else e[r][s]=Math.min(0,e[t][s]/(1-n));for(var c=0;c<this.width;c+=1)e[r][c]-=e[t][c];return!0},O.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var r=this.height;e[r]=e[r-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[r]=o,this.rowByVarIndex[o]=r,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new G("s"+o,o),e[r][this.rhsColumn]=-n;for(var s=1;s<this.varIndexByCol.length;s+=1){var a=this.variablesPerIndex[this.varIndexByCol[s]],l=e[t][s],c=l-Math.floor(l);e[r][s]=a.isInteger?c<=n?-c:-(1-c)*n/c:l>=0?-l:l*n/(1-n)}return!0},O.prototype.applyMIRCuts=function(){},O.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],n=1;n<this.height;n+=1){var r=this.matrix[n][i];if(r<-this.precision||this.precision<r){e=n;break}}this.pivot(e,i)}return e},O.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],n=this.matrix[i],r=1;r<this.height;r+=1){var o=n[r];if(o<-this.precision||this.precision<o){e=r;break}}this.pivot(i,e)}return e},O.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var n=this.variables[i],r=this.rowByVarIndex[n.index];n.value=-1===r?0:Math.round((this.matrix[r][this.rhsColumn]+Number.EPSILON)*e)/e}},O.prototype.updateRightHandSide=function(t,e){var i=this.height-1,n=this.rowByVarIndex[t.index];if(-1===n){for(var r=this.colByVarIndex[t.index],o=0;o<=i;o+=1){var s=this.matrix[o];s[this.rhsColumn]-=e*s[r]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var c=this.optionalObjectives[l].reducedCosts;c[this.rhsColumn]-=e*c[r]}}else this.matrix[n][this.rhsColumn]-=e},O.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var n=this._putInBase(t.index),r=this.colByVarIndex[e.index];if(-1===r)for(var o=this.rowByVarIndex[e.index],s=0;s<this.width;s+=1)this.matrix[n][s]+=i*this.matrix[o][s];else this.matrix[n][r]-=i},O.prototype.updateCost=function(t,e){var i=t.index,n=this.width-1,r=this.colByVarIndex[i];if(-1===r){var o,s=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var a=this.matrix[0];for(o=0;o<=n;o+=1)a[o]+=e*s[o]}else{var l=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=n;o+=1)l[o]+=e*s[o]}}else this.matrix[0][r]-=e},O.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,n=this.matrix[i];void 0===n&&(n=this.matrix[0].slice(),this.matrix[i]=n);for(var r=this.width-1,o=0;o<=r;o+=1)n[o]=0;n[this.rhsColumn]=e*t.rhs;for(var s=t.terms,a=s.length,l=0;l<a;l+=1){var c=s[l],h=c.coefficient,u=c.variable.index,d=this.rowByVarIndex[u];if(-1===d)n[this.colByVarIndex[u]]+=e*h;else{var f=this.matrix[d];for(o=0;o<=r;o+=1)n[o]-=e*h*f[o]}}var p=t.index;this.varIndexByRow[i]=p,this.rowByVarIndex[p]=i,this.colByVarIndex[p]=-1,this.height+=1},O.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,n=this._putInBase(e),r=this.matrix[i];this.matrix[i]=this.matrix[n],this.matrix[n]=r,this.varIndexByRow[n]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1},O.prototype.addVariable=function(t){var e=this.height-1,i=this.width,n=!0===this.model.isMinimization?-t.cost:t.cost,r=t.priority,o=this.optionalObjectives.length;if(o>0)for(var s=0;s<o;s+=1)this.optionalObjectives[s].reducedCosts[i]=0;0===r?this.matrix[0][i]=n:(this.setOptionalObjective(r,i,n),this.matrix[0][i]=0);for(var a=1;a<=e;a+=1)this.matrix[a][i]=0;var l=t.index;this.varIndexByCol[i]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=i,this.width+=1},O.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),n=this.width-1;if(i!==n){for(var r=this.height-1,o=0;o<=r;o+=1){var s=this.matrix[o];s[i]=s[n]}var a=this.optionalObjectives.length;if(a>0)for(var l=0;l<a;l+=1){var c=this.optionalObjectives[l].reducedCosts;c[i]=c[n]}var h=this.varIndexByCol[n];this.varIndexByCol[i]=h,this.colByVarIndex[h]=i}this.varIndexByCol[n]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1},O.prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i,n,r,o,s,a,l,c,h,u,d="",f=[" "];for(n=1;n<this.width;n+=1)l=" ",c="\t",(a=void 0===(o=this.variablesPerIndex[s=this.varIndexByCol[n]])?"c"+s:o.id).length>5?l+=" ":c+="\t",f[n]=l,d+=c+a;console.log(d);var p=this.matrix[this.costRowIndex],g="\t";for(i=1;i<this.width;i+=1)g+="\t",g+=f[i],g+=p[i].toFixed(5);for(g+="\t"+f[0]+p[0].toFixed(5),console.log(g+"\tZ"),r=1;r<this.height;r+=1){for(h=this.matrix[r],u="\t",n=1;n<this.width;n+=1)u+="\t"+f[n]+h[n].toFixed(5);u+="\t"+f[0]+h[0].toFixed(5),a=void 0===(o=this.variablesPerIndex[s=this.varIndexByRow[r]])?"c"+s:o.id,console.log(u+"\t"+a)}console.log("");var m=this.optionalObjectives.length;if(m>0){console.log("    Optional objectives:");for(var b=0;b<m;b+=1){var v=this.optionalObjectives[b].reducedCosts,y="";for(i=1;i<this.width;i+=1)y+=v[i]<0?"":" ",y+=f[i],y+=v[i].toFixed(5);y+=(v[0]<0?"":" ")+f[0]+v[0].toFixed(5),console.log(y+" z"+b)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},O.prototype.copy=function(){var t=new O(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var n=this.matrix,r=new Array(this.height),o=0;o<this.height;o++)r[o]=n[o].slice();return t.matrix=r,t},O.prototype.save=function(){this.savedState=this.copy()},O.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,n=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var r=n[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=r[e]}var s=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=s[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=a[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=i.rowByVarIndex,c=i.colByVarIndex,h=0;h<this.nVars;h+=1)this.rowByVarIndex[h]=l[h],this.colByVarIndex[h]=c[h];if(i.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var u=0;u<i.optionalObjectives.length;u++){var d=i.optionalObjectives[u].copy();this.optionalObjectives[u]=d,this.optionalObjectivePerPriority[d.priority]=d}}}},O.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,n=this.model.integerVariables,r=n.length,o=0;o<r;o++){var s=n[o].index,a=this.rowByVarIndex[s];if(-1!==a){var l=this.matrix[a][this.rhsColumn],c=Math.abs(l-Math.round(l));t<c&&(t=c,e=s,i=l)}}return new W(e,i)},O.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,n=this.model.integerVariables,r=n.length,o=0;o<r;o++){var s=n[o],a=s.index,l=this.rowByVarIndex[a];if(-1!==l){var c=this.matrix[l][this.rhsColumn];if(Math.abs(c-Math.round(c))>this.precision){var h=s.cost;t>h&&(t=h,e=a,i=c)}}}return new W(e,i)},O.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},O.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var n=this.rowByVarIndex[t[i].index];if(-1!==n){var r=this.matrix[n][this.rhsColumn];if(Math.abs(r-Math.round(r))>this.precision)return!1}}return!0},O.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var n=this.matrix[i][this.rhsColumn];if(n=Math.abs(n),Math.min(n-Math.floor(n),Math.floor(n+1))<this.precision){if(!t)return 0}else-1===e?e=n:e*=n}return-1===e?0:e};var H=O;function $(t,e,i){this.type=t,this.varIndex=e,this.value=i}function q(t,e){this.relaxedEvaluation=t,this.cuts=e}function Y(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}O.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*i&&(e=!1)}},O.prototype.branchAndCut=function(){var t=[],e=0,i=this.model.tolerance,n=!0,r=1e99;this.model.timeout&&(r=Date.now()+this.model.timeout);for(var o=1/0,s=null,a=[],l=0;l<this.optionalObjectives.length;l+=1)a.push(1/0);var c=new q(-1/0,[]);for(t.push(c);t.length>0&&!0===n&&Date.now()<r;)if(i>0&&o<(this.model.isMinimization?this.bestPossibleEval*(1+i):this.bestPossibleEval*(1-i))&&(n=!1),!((c=t.pop()).relaxedEvaluation>o)){var h=c.cuts;if(this.applyCuts(h),e++,!1!==this.feasible){var u=this.evaluation;if(!(u>o)){if(u===o){for(var d=!0,f=0;f<this.optionalObjectives.length&&!(this.optionalObjectives[f].reducedCosts[0]>a[f]);f+=1)if(this.optionalObjectives[f].reducedCosts[0]<a[f]){d=!1;break}if(d)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===e)return void(this.branchAndCutIterations=e);s=c,o=u;for(var p=0;p<this.optionalObjectives.length;p+=1)a[p]=this.optionalObjectives[p].reducedCosts[0]}else{1===e&&this.save();for(var g=this.getMostFractionalVar(),m=g.index,b=[],v=[],y=h.length,w=0;w<y;w+=1){var _=h[w];_.varIndex===m?"min"===_.type?v.push(_):b.push(_):(b.push(_),v.push(_))}var x=Math.ceil(g.value),S=Math.floor(g.value),I=new $("min",m,x);b.push(I);var k=new $("max",m,S);v.push(k),t.push(new q(u,b)),t.push(new q(u,v)),t.sort(Y)}}}}null!==s&&this.applyCuts(s.cuts),this.branchAndCutIterations=e};var J={},X=U.Constraint,Q=U.Equality,Z=U.Variable,K=U.IntegerVariable;function tt(t,e){this.tableau=new O(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}var et=tt;tt.prototype.minimize=function(){return this.isMinimization=!0,this},tt.prototype.maximize=function(){return this.isMinimization=!1,this},tt.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},tt.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},tt.prototype.smallerThan=function(t){var e=new X(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.greaterThan=function(t){var e=new X(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},tt.prototype.equal=function(t){var e=new X(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new X(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new Q(e,i)},tt.prototype.addVariable=function(t,e,i,n,r){if("string"==typeof r)switch(r){case"required":r=0;break;case"strong":r=1;break;case"medium":r=2;break;case"weak":r=3;break;default:r=0}var o,s=this.tableau.getNewElementIndex();return null==e&&(e="v"+s),null==t&&(t=0),null==r&&(r=0),i?(o=new K(e,t,s,r),this.integerVariables.push(o)):o=new Z(e,t,s,r),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,n&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},tt.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},tt.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},tt.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},tt.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},tt.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},tt.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},tt.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,n={},r={},o=Object.keys(i),s=o.length,a=0;a<s;a+=1){var l,c,h=o[a],u=i[h],d=u.equal,f=u.weight,p=u.priority,g=void 0!==f||void 0!==p;if(void 0===d){var m=u.min;void 0!==m&&(l=this.greaterThan(m),n[h]=l,g&&l.relax(f,p));var b=u.max;void 0!==b&&(c=this.smallerThan(b),r[h]=c,g&&c.relax(f,p))}else{l=this.greaterThan(d),n[h]=l,c=this.smallerThan(d),r[h]=c;var v=new Q(l,c);g&&v.relax(f,p)}}var y=Object.keys(e),w=y.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),0===this.tolerance&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),this.checkForCycles=void 0===t.options.exitOnCycles||t.options.exitOnCycles);for(var _=t.ints||{},x=t.binaries||{},S=t.unrestricted||{},I=t.optimize,k=0;k<w;k+=1){var C=y[k],P=e[C],A=!!x[C],M=this.addVariable(P[I]||0,C,!!_[C]||A,!!S[C]);A&&this.smallerThan(1).addTerm(1,M);var T=Object.keys(P);for(a=0;a<T.length;a+=1){var E=T[a];if(E!==I){var O=P[E],D=n[E];void 0!==D&&D.addTerm(O,M);var z=r[E];void 0!==z&&z.addTerm(O,M)}}}return this},tt.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},tt.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},tt.prototype.isFeasible=function(){return this.tableau.feasible},tt.prototype.save=function(){return this.tableau.save()},tt.prototype.restore=function(){return this.tableau.restore()},tt.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},tt.prototype.debug=function(t){this.checkForCycles=t},tt.prototype.log=function(t){return this.tableau.log(t)};var it={CleanObjectiveAttributes:function(t){var e,i,n;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(n in t.optimize)if(t.constraints[n])if("equal"===t.constraints[n])delete t.optimize[n];else{for(i in e=Math.random(),t.variables)t.variables[i][n]&&(t.variables[i][e]=t.variables[i][n]);t.constraints[e]=t.constraints[n],delete t.constraints[n]}return t}},nt=function(t){return t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},n={">=":"min","<=":"max","=":"equal"},r="",o=null,s="",a="",l="",c=0;"string"==typeof t&&(t=t.split("\n"));for(var h=0;h<t.length;h++)if(l="__"+h,o=null,e.is_objective.test(r=t[h]))i.opType=r.match(/(max|min)/gi)[0],(o=r.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[a]=i.variables[a]||{},i.variables[a]._obj=s}));else if(e.is_int.test(r))o=r.match(e.parse_int).slice(1),i.ints=i.ints||{},o.forEach((function(t){t=t.replace(";",""),i.ints[t]=1}));else if(e.is_bin.test(r))o=r.match(e.parse_bin).slice(1),i.binaries=i.binaries||{},o.forEach((function(t){t=t.replace(";",""),i.binaries[t]=1}));else if(e.is_constraint.test(r)){var u=r.indexOf(":");(o=(-1===u?r:r.slice(u+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0],i.variables[a]=i.variables[a]||{},i.variables[a][l]=s})),c=parseFloat(r.match(e.parse_rhs)[0]),r=n[r.match(e.parse_dir)[0]],i.constraints[l]=i.constraints[l]||{},i.constraints[l][r]=c}else e.is_unrestricted.test(r)&&(o=r.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},o.forEach((function(t){t=t.replace(";",""),i.unrestricted[t]=1})));return i}(t):function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},n=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType)for(var r in e+=t.opType+":",t.variables)t.variables[r][r]=t.variables[r][r]?t.variables[r][r]:1,t.variables[r][t.optimize]&&(e+=" "+t.variables[r][t.optimize]+" "+r.replace(n,"_"));else e+="max:";for(var o in e+=";\n\n",t.constraints)for(var s in t.constraints[o])if(void 0!==i[s]){for(var a in t.variables)void 0!==t.variables[a][o]&&(e+=" "+t.variables[a][o]+" "+a.replace(n,"_"));e+=" "+i[s]+" "+t.constraints[o][s],e+=";\n"}if(t.ints)for(var l in e+="\n\n",t.ints)e+="int "+l.replace(n,"_")+";\n";if(t.unrestricted)for(var c in e+="\n\n",t.unrestricted)e+="unrestricted "+c.replace(n,"_")+";\n";return e}(t)};function rt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})})),e}var ot=rt(Object.freeze({__proto__:null,default:{}}));function st(t){return(t=(t=t.replace("\\r\\n","\r\n")).split("\r\n")).filter((function(t){return!0!==new RegExp(" 0$","gi").test(t)&&!1!==new RegExp("\\d$","gi").test(t)})).map((function(t){return t.split(/\:{0,1} +(?=\d)/)})).reduce((function(t,e,i){return t[e[0]]=e[1],t}),{})}var at={lpsolve:{reformat:nt,solve:function(t){return new Promise((function(e,i){"undefined"!=typeof window&&i("Function Not Available in Browser");var n=nt(t);t.external||i("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||i("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||i("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||i("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),ot.writeFile(t.external.tempName,n,(function(n,r){if(n)i(n);else{var o=ot.execFile;t.external.args.push(t.external.tempName),o(t.external.binPath,t.external.args,(function(t,n){t?1===t.code?e(st(n)):i({code:t.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[t.code],data:n}):e(st(n))}))}}))}))}}},lt=function(t,e){var i,n,r,o,s,a=e.optimize,l=JSON.parse(JSON.stringify(e.optimize)),c=Object.keys(e.optimize),h=0,u={},d="",f={},p=[];for(delete e.optimize,n=0;n<c.length;n++)l[c[n]]=0;for(n=0;n<c.length;n++){for(s in e.optimize=c[n],e.opType=a[c[n]],i=t.Solve(e,void 0,void 0,!0),c)if(!e.variables[c[s]])for(o in i[c[s]]=i[c[s]]?i[c[s]]:0,e.variables)e.variables[o][c[s]]&&i[o]&&(i[c[s]]+=i[o]*e.variables[o][c[s]]);for(d="base",r=0;r<c.length;r++)d+=i[c[r]]?"-"+(1e3*i[c[r]]|0)/1e3:"-0";if(!u[d]){for(u[d]=1,h++,r=0;r<c.length;r++)i[c[r]]&&(l[c[r]]+=i[c[r]]);delete i.feasible,delete i.result,p.push(i)}}for(n=0;n<c.length;n++)e.constraints[c[n]]={equal:l[c[n]]/h};for(n in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[n].cheater=1;for(n in p)for(o in p[n])f[o]=f[o]||{min:1e99,max:-1e99};for(n in f)for(o in p)p[o][n]?(p[o][n]>f[n].max&&(f[n].max=p[o][n]),p[o][n]<f[n].min&&(f[n].min=p[o][n])):(p[o][n]=0,f[n].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:p,ranges:f}},ct=U.Constraint,ht=U.Variable,ut=U.Numeral,dt=U.Term,ft=function(){this.Model=et,this.branchAndCut=J,this.Constraint=ct,this.Variable=ht,this.Numeral=ut,this.Term=dt,this.Tableau=H,this.lastSolvedModel=null,this.External=at,this.Solve=function(t,e,i,n){if(n)for(var r in it)t=it[r](t);if(!t)throw new Error("Solver requires a model to operate on");if("object"==typeof t.optimize&&Object.keys(t.optimize>1))return lt(this,t);if(t.external){var o=Object.keys(at);if(o=JSON.stringify(o),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+o);if(!at[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+o);return at[t.external.solver].solve(t)}t instanceof et==0&&(t=new et(e).loadJson(t));var s=t.solve();if(this.lastSolvedModel=t,s.solutionSet=s.generateSolutionSet(),i)return s;var a={};return a.feasible=s.feasible,a.result=s.evaluation,a.bounded=s.bounded,s._tableau.__isIntegral&&(a.isIntegral=!0),Object.keys(s.solutionSet).forEach((function(t){0!==s.solutionSet[t]&&(a[t]=s.solutionSet[t])})),a},this.ReformatLP=nt,this.MultiObjective=function(t){return lt(this,t)}};"object"==typeof window?window.solver=new ft:"object"==typeof self&&(self.solver=new ft);var pt=new ft;function gt(){}function mt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function bt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function vt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i>n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}function yt(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function wt(t,e,i){if(n=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(yield i);else{let i=-1;for(let n of t)null!=(n=e(n,++i,t))&&(n=+n)>=n&&(yield n)}}(t,i))).length){if((e=+e)<=0||n<2)return vt(t);if(e>=1)return bt(t);var n,r=(n-1)*e,o=Math.floor(r),s=bt(function t(e,i,n=0,r=e.length-1,o=mt){for(;r>n;){if(r-n>600){const s=r-n+1,a=i-n+1,l=Math.log(s),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);t(e,i,Math.max(n,Math.floor(i-a*c/s+h)),Math.min(r,Math.floor(i+(s-a)*c/s+h)),o)}const s=e[i];let a=n,l=r;for(yt(e,n,i),o(e[r],s)>0&&yt(e,n,r);a<l;){for(yt(e,a,l),++a,--l;o(e[a],s)<0;)++a;for(;o(e[l],s)>0;)--l}0===o(e[n],s)?yt(e,n,l):(++l,yt(e,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}return e}(t,o).subarray(0,o+1));return s+(vt(t.subarray(o+1))-s)*(r-o)}}function _t(t,e){return+!(t instanceof C)+ +!(e instanceof C)}function xt(...t){if(t.length)throw new Error(`got arguments to sugiyama(${t}), but constructor takes no aruguments.`);return function t(e,i,n,r,o,s,a){const[l,c]=o;function h(t){e(t);for(const e of t){const t=e.layer;if(void 0===t)throw new Error(`layering did not assign layer to node '${e.id}'`);if(t<0)throw new Error(`layering assigned a negative layer (${t}) to node '${e.id}'`)}const o=function(t){const e=[];for(const i of t.descendants()){const t=i.layer;(e[t]||(e[t]=[])).push(i),i.dataChildren=i.dataChildren.map(n=>{const r=n.child.layer;if(r<=t)throw new Error(`layering left child node "${n.child.id}" (${r}) with a greater or equal layer to parent node "${i.id}" (${t})`);let o=n.child;for(let s=r-1;s>t;s--){let t;t=a?`${i.id}->${n.child.id} (${s})`:`${i.id}\0${n.child.id}\0${s}`;const r=new C(t);r.dataChildren.push(new u(o,void 0)),(e[s]||(e[s]=[])).push(r),o=r}return new u(o,n.data)})}return e}(t);if(1===o.length){const[t]=o;for(const e of t)e.y=c/2}else{const t=r?c:c/(o.length-1);for(const[e,i]of o.entries())for(const n of i)n.y=t*e}if(o.every(t=>1===t.length))for(const[e]of o)e.x=l/2;else if(1===o.length){const[t]=o;S(t,s);const e=t,i=r?e.length-1:1;for(const n of e)n.x*=l*i}else{i(o),n(o,s);for(const i of o)for(const t of i)if(void 0===t.x)throw new Error(`coord didn't assign an x to node '${t.id}'`);const t=o,e=r?Math.max(...o.map(t=>t.length))-1:1;for(const i of t)for(const t of i)t.x*=l*e}const h=t;return function(t){for(const e of t)e instanceof C||(e.dataChildren=e.dataChildren.map(t=>{let i=t.child;const n=[{x:e.x,y:e.y}];for(;i instanceof C;)n.push({x:i.x,y:i.y}),[i]=i.ichildren();return n.push({x:i.x,y:i.y}),new u(i,t.data,n)}))}(h),h}return h.layering=function(l){return void 0===l?e:t(l,i,n,r,o,s,a)},h.decross=function(l){return void 0===l?i:t(e,l,n,r,o,s,a)},h.coord=function(l){return void 0===l?n:t(e,i,l,r,o,s,a)},h.size=function(l){return void 0!==l?t(e,i,n,!1,l,s,a):r?null:o},h.nodeSize=function(l){return void 0!==l?t(e,i,n,!0,l,s,a):r?o:null},h.separation=function(l){return void 0===l?s:t(e,i,n,r,o,l,a)},h.debug=function(l){return void 0===l?a:t(e,i,n,r,o,s,l)},h}(function(...t){if(t.length)throw new Error(`got arguments to simplex(${t}), but constructor takes no aruguments.`);return function t(e,i){const n=i?"":"\0",r=i?"rank: ":"\0",o=i?" -> ":"\0";function s(t){return`${n}${t.id}`}function a(t){return`${t.source.id}${o}${t.target.id}`}function l(t,e){return`${r}${t.id}${o}${e.id}`}function c(t){const i=Object.create(null),n=Object.create(null),r=Object.create(null),o=[];for(const a of t){const t=s(a);n[t]=1,i[t]={opt:a.children.length};const r=e(a);void 0!==r&&o.push([r,a])}for(const e of t.ilinks()){const t=i[s(e.source)],n=i[s(e.target)],o=a(e);r[o]={min:1},t[o]=-1,t.opt++,n[o]=1,n.opt--}let[c,...h]=o.sort(([t],[e])=>t-e);for(const e of h){const[t,n]=c,[o,a]=e,h=i[s(n)],u=i[s(a)],d=l(n,a);if(t<o)r[d]={min:1},h[d]=-1,u[d]=1;else{const t=l(a,n);r[d]={min:0},r[t]={min:0},h[d]=-1,h[t]=1,u[d]=1,u[t]=-1}c=e}const u=pt.Solve({optimize:"opt",opType:"max",constraints:r,variables:i,ints:n}),{feasible:d}=u,f=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}(u,["feasible"]);if(!d)throw o.length?new Error("could not find a feasbile simplex layout, check that rank accessors are not ill-defined"):new Error("could not find feasbile simplex layout, this should not happen");for(const e of t)e.layer=f[s(e)]||0}return c.rank=function(n){return void 0===n?e:t(n,i)},c.debug=function(n){return void 0===n?i:t(e,n)},c}(gt,!1)}(),function(...t){if(t.length)throw new Error(`got arguments to twoLayer(${t}), but constructor takes no aruguments.`);return function t(e){function i(t){t.slice(0,t.length-1).forEach((i,n)=>e(i,t[n+1]))}return i.order=function(i){return void 0===i?e:t(i)},i}(function(...t){if(t.length)throw new Error(`got arguments to median(${t}), but constructor takes no aruguments.`);return function(t,e){const i=new h;for(const[o,s]of t.entries())for(const t of s.ichildren())i.setIfAbsent(t.id,[]).push(o);const n=new h;let r=-1;for(const o of e){const e=wt(i.getDefault(o.id,[]),.5,void 0);void 0===e?(n.set(o.id,r),r=+!((r+1)/(t.length+1))*(t.length+1)-1):n.set(o.id,e)}e.sort((t,e)=>n.getThrow(t.id)-n.getThrow(e.id))}}())}(),function(...t){if(t.length)throw new Error(`got arguments to quad(${t}), but constructor takes no aruguments.`);return function t(e,i,n,r,o){function s(t,s,a){const l=function(t){const e=new h;let i=0;for(const n of t)for(const t of n)e.set(t.id,i++);return e}(t),[c,u,d,f]=function(t,e,i){const n=1+Math.max(...e.values()),r=[],o=[];for(const a of t){let[t,...s]=a;for(const a of s){const s=e.getThrow(t.id),l=e.getThrow(a.id),c=new Array(n).fill(0);c[s]=1,c[l]=-1,r.push(c),o.push(-i(t,a)),t=a}}const s=new Array(n).fill(0);return[new Array(n).fill(null).map(()=>new Array(n).fill(0)),s,r,o]}(t,l,s);for(const o of t)for(const t of o){const o=l.getThrow(t.id),s=t instanceof C?i:e;for(const a of t.ichildren()){const t=l.getThrow(a.id),h=a instanceof C?r:n;I(c,o,t,s+(a instanceof C?i:e));for(const e of a.ichildren())k(c,o,t,l.getThrow(e.id),h)}}for(let[e,...i]of t)for(const t of i)a.getThrow(e.id)!==a.getThrow(t.id)&&I(c,l.getThrow(e.id),l.getThrow(t.id),o),e=t;!function(t,e,i){const n=Math.min(...i),r=Math.max(...i)-n;if(r>0)for(const o of t)for(const t of o){const o=e.getThrow(t.id);t.x=(i[o]-n)/r}else for(const o of t)for(const t of o)t.x=.5}(t,l,function(t,e,i,n,r=0){e.pop(),t.pop(),t.forEach(t=>t.pop()),i.forEach(t=>t.pop());const o=function(t,e,i,n,r){const o=[[0]],s=[0],a=[[0]],l=[0];for(const u of t){const t=[0];t.push(...u),o.push(t)}s.push(...e),a.push(...e.map(()=>[0]));for(const u of i)for(const[t,e]of u.entries())a[t+1].push(-e);l.push(...n.map(t=>-t));const{solution:c,message:h}=x(o,s,a,l,r);if(h.length)throw new Error("quadprog failed with: "+h);return c.shift(),c}(t,e,i,n,r);return o.push(0),o}(c,u,d,f))}function a(t,o){if(0===e&&0===n)throw new Error("node vertical weight or node curve weight needs to be positive");if(0===i&&0===r)throw new Error("dummy vertical weight or dummy curve weight needs to be positive");const a=function(t){const e=new h;for(const r of t.slice().reverse())for(const t of r){for(const i of t.ichildren())e.delete(i.id);e.set(t.id,t)}const i=new p([...e.values()]).split(),n=new h;for(const[r,o]of i.entries())for(const t of o)n.set(t.id,r);return n}(t);for(const e of function(t,e){const i=[];let n=[],r=new Set;for(const o of t){const t=new Set(o.map(t=>e.getThrow(t.id)));c(r,t)||i.push(n=[]),n.push(o),r=t}return i}(t,a))if(e.every(t=>1===t.length))for(const[t]of e)t.x=.5;else if(1===e.length){const[t]=e;S(t,o)}else s(e,o,a)}return a.vertical=function(s){if(void 0===s)return[e,i];const[a,l]=s;if(a<0||l<0)throw new Error(`weights must be non-negative, but were ${a} and ${l}`);return t(a,l,n,r,o)},a.curve=function(s){if(void 0===s)return[n,r];const[a,l]=s;if(a<0||l<0)throw new Error(`weights must be non-negative, but were ${a} and ${l}`);return t(e,i,a,l,o)},a.component=function(s){if(void 0===s)return o;if(s<=0)throw new Error("weight must be positive, but was "+s);return t(e,i,n,r,s)},a}(1,0,0,1,1)}(),!1,[1,1],_t,!1)}var St=function(t,e){return t<e};function It(t){if(!(this instanceof It))return new It(t);this.array=[],this.size=0,this.compare=t||St}It.prototype.clone=function(){var t=new It(this.compare);t.size=this.size;for(var e=0;e<this.size;e++)t.array.push(this.array[e]);return t},It.prototype.add=function(t){var e,i,n=this.size;for(this.array[this.size]=t,this.size+=1;n>0&&this.compare(t,i=this.array[e=n-1>>1]);)this.array[n]=i,n=e;this.array[n]=t},It.prototype.heapify=function(t){var e;for(this.array=t,this.size=t.length,e=this.size>>1;e>=0;e--)this._percolateDown(e)},It.prototype._percolateUp=function(t,e){for(var i,n,r=this.array[t];t>0&&(n=this.array[i=t-1>>1],e||this.compare(r,n));)this.array[t]=n,t=i;this.array[t]=r},It.prototype._percolateDown=function(t){for(var e,i,n,r=this.size,o=this.size>>>1,s=this.array[t];t<o&&(n=this.array[e=1+(t<<1)],(i=e+1)<r&&this.compare(this.array[i],n)&&(e=i,n=this.array[i]),this.compare(n,s));)this.array[t]=n,t=e;this.array[t]=s},It.prototype._removeAt=function(t){if(!(t>this.size-1||t<0))return this._percolateUp(t,!0),this.poll()},It.prototype.remove=function(t){for(var e=0;e<this.size;e++)if(!this.compare(this.array[e],t)&&!this.compare(t,this.array[e]))return this._removeAt(e),!0;return!1},It.prototype._batchRemove=function(t,e){var i=new Array(e||this.size),n=0;if("function"==typeof t&&this.size)for(var r=0;r<this.size&&n<i.length;)t(this.array[r])?(i[n]=this._removeAt(r),n++,r>>=1):r++;return i.length=n,i},It.prototype.removeOne=function(t){var e=this._batchRemove(t,1);return e.length>0?e[0]:void 0},It.prototype.removeMany=function(t,e){return this._batchRemove(t,e)},It.prototype.peek=function(){if(0!=this.size)return this.array[0]},It.prototype.poll=function(){if(0!=this.size){var t=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this._percolateDown(0)):this.size-=1,t}},It.prototype.replaceTop=function(t){if(0!=this.size){var e=this.array[0];return this.array[0]=t,this._percolateDown(0),e}},It.prototype.trim=function(){this.array=this.array.slice(0,this.size)},It.prototype.isEmpty=function(){return 0===this.size},It.prototype.forEach=function(t){if(!this.isEmpty()&&"function"==typeof t)for(var e=0,i=this.clone();!i.isEmpty();)t(i.poll(),e++)},It.prototype.kSmallest=function(t){if(0==this.size)return[];var e=this.compare,i=this.array,n=new It((function(t,n){return e(i[t],i[n])}));t=Math.min(this.size,t);var r=new Array(t),o=0;for(n.add(0);o<t;){var s=n.poll();r[o++]=this.array[s];var a=1+(s<<1),l=a+1;a<this.size&&n.add(a),l<this.size&&n.add(l)}return r};var kt=i("ZTXN"),Ct=i("mWib"),Pt=i("kuMc"),At=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};function Mt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i<r||void 0===i&&r>=r)&&(i=r)}return i}function Tt(t,e){let i;if(void 0===e)for(const n of t)null!=n&&(i>n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(i>r||void 0===i&&r>=r)&&(i=r)}return i}var Et=function(t,e,i){t=+t,e=+e,i=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+i;for(var n=-1,r=0|Math.max(0,Math.ceil((e-t)/i)),o=new Array(r);++n<r;)o[n]=t+n*i;return o},Ot=Array.prototype.slice,Dt=function(t){return t},zt=1e-6;function Vt(t){return"translate("+(t+.5)+",0)"}function Bt(t){return"translate(0,"+(t+.5)+")"}function Rt(t){return e=>+t(e)}function jt(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(i){return+t(i)+e}}function Ft(){return!this.__axis}function Lt(t,e){var i=[],n=null,r=null,o=6,s=6,a=3,l=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",h=1===t||3===t?Vt:Bt;function u(u){var d=null==n?e.ticks?e.ticks.apply(e,i):e.domain():n,f=null==r?e.tickFormat?e.tickFormat.apply(e,i):Dt:r,p=Math.max(o,0)+a,g=e.range(),m=+g[0]+.5,b=+g[g.length-1]+.5,v=(e.bandwidth?jt:Rt)(e.copy()),y=u.selection?u.selection():u,w=y.selectAll(".domain").data([null]),_=y.selectAll(".tick").data(d,e).order(),x=_.exit(),S=_.enter().append("g").attr("class","tick"),I=_.select("line"),k=_.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(S),I=I.merge(S.append("line").attr("stroke","currentColor").attr(c+"2",l*o)),k=k.merge(S.append("text").attr("fill","currentColor").attr(c,l*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),u!==y&&(w=w.transition(u),_=_.transition(u),I=I.transition(u),k=k.transition(u),x=x.transition(u).attr("opacity",zt).attr("transform",(function(t){return isFinite(t=v(t))?h(t):this.getAttribute("transform")})),S.attr("opacity",zt).attr("transform",(function(t){var e=this.parentNode.__axis;return h(e&&isFinite(e=e(t))?e:v(t))}))),x.remove(),w.attr("d",4===t||2==t?s?"M"+l*s+","+m+"H0.5V"+b+"H"+l*s:"M0.5,"+m+"V"+b:s?"M"+m+","+l*s+"V0.5H"+b+"V"+l*s:"M"+m+",0.5H"+b),_.attr("opacity",1).attr("transform",(function(t){return h(v(t))})),I.attr(c+"2",l*o),k.attr(c,l*p).text(f),y.filter(Ft).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),y.each((function(){this.__axis=v}))}return u.scale=function(t){return arguments.length?(e=t,u):e},u.ticks=function(){return i=Ot.call(arguments),u},u.tickArguments=function(t){return arguments.length?(i=null==t?[]:Ot.call(t),u):i.slice()},u.tickValues=function(t){return arguments.length?(n=null==t?null:Ot.call(t),u):n&&n.slice()},u.tickFormat=function(t){return arguments.length?(r=t,u):r},u.tickSize=function(t){return arguments.length?(o=s=+t,u):o},u.tickSizeInner=function(t){return arguments.length?(o=+t,u):o},u.tickSizeOuter=function(t){return arguments.length?(s=+t,u):s},u.tickPadding=function(t){return arguments.length?(a=+t,u):a},u}var Nt={value:()=>{}};function Ut(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new Gt(n)}function Gt(t){this._=t}function Wt(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}function Ht(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function $t(t,e,i){for(var n=0,r=t.length;n<r;++n)if(t[n].name===e){t[n]=Nt,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}Gt.prototype=Ut.prototype={constructor:Gt,on:function(t,e){var i,n=this._,r=Wt(t+"",n),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=$t(n[i],t.name,e);else if(null==e)for(i in n)n[i]=$t(n[i],t.name,null);return this}for(;++o<s;)if((i=(t=r[o]).type)&&(i=Ht(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Gt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,r=new Array(i),o=0;o<i;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,i=(n=this._[t]).length;o<i;++o)n[o].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],r=0,o=n.length;r<o;++r)n[r].value.apply(e,i)}};var qt=Ut;function Yt(){}var Jt=function(t){return null==t?Yt:function(){return this.querySelector(t)}},Xt=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)};function Qt(){return[]}var Zt=function(t){return null==t?Qt:function(){return this.querySelectorAll(t)}},Kt=function(t){return function(){return this.matches(t)}};function te(t){return function(e){return e.matches(t)}}var ee=Array.prototype.find;function ie(){return this.firstElementChild}var ne=Array.prototype.filter;function re(){return this.children}var oe=function(t){return new Array(t.length)};function se(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}se.prototype={constructor:se,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var ae=function(t){return function(){return t}};function le(t,e,i,n,r,o){for(var s,a=0,l=e.length,c=o.length;a<c;++a)(s=e[a])?(s.__data__=o[a],n[a]=s):i[a]=new se(t,o[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function ce(t,e,i,n,r,o,s){var a,l,c,h=new Map,u=e.length,d=o.length,f=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(f[a]=c=s.call(l,l.__data__,a,e)+"",h.has(c)?r[a]=l:h.set(c,l));for(a=0;a<d;++a)c=s.call(t,o[a],a,o)+"",(l=h.get(c))?(n[a]=l,l.__data__=o[a],h.delete(c)):i[a]=new se(t,o[a]);for(a=0;a<u;++a)(l=e[a])&&h.get(f[a])===l&&(r[a]=l)}function he(t){return t.__data__}function ue(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var de="http://www.w3.org/1999/xhtml",fe={svg:"http://www.w3.org/2000/svg",xhtml:de,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},pe=function(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),fe.hasOwnProperty(e)?{space:fe[e],local:t}:t};function ge(t){return function(){this.removeAttribute(t)}}function me(t){return function(){this.removeAttributeNS(t.space,t.local)}}function be(t,e){return function(){this.setAttribute(t,e)}}function ve(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ye(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function we(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}var _e=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function xe(t){return function(){this.style.removeProperty(t)}}function Se(t,e,i){return function(){this.style.setProperty(t,e,i)}}function Ie(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function ke(t,e){return t.style.getPropertyValue(e)||_e(t).getComputedStyle(t,null).getPropertyValue(e)}function Ce(t){return function(){delete this[t]}}function Pe(t,e){return function(){this[t]=e}}function Ae(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function Me(t){return t.trim().split(/^|\s+/)}function Te(t){return t.classList||new Ee(t)}function Ee(t){this._node=t,this._names=Me(t.getAttribute("class")||"")}function Oe(t,e){for(var i=Te(t),n=-1,r=e.length;++n<r;)i.add(e[n])}function De(t,e){for(var i=Te(t),n=-1,r=e.length;++n<r;)i.remove(e[n])}function ze(t){return function(){Oe(this,t)}}function Ve(t){return function(){De(this,t)}}function Be(t,e){return function(){(e.apply(this,arguments)?Oe:De)(this,t)}}function Re(){this.textContent=""}function je(t){return function(){this.textContent=t}}function Fe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Le(){this.innerHTML=""}function Ne(t){return function(){this.innerHTML=t}}function Ue(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ge(){this.nextSibling&&this.parentNode.appendChild(this)}function We(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function He(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===de&&e.documentElement.namespaceURI===de?e.createElement(t):e.createElementNS(i,t)}}function $e(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}Ee.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var qe=function(t){var e=pe(t);return(e.local?$e:He)(e)};function Ye(){return null}function Je(){var t=this.parentNode;t&&t.removeChild(this)}function Xe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Qe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ze(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}function Ke(t){return function(){var e=this.__on;if(e){for(var i,n=0,r=-1,o=e.length;n<o;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function ti(t,e,i){return function(){var n,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((n=r[s]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=o,n.options=i),void(n.value=e);this.addEventListener(t.type,o,i),n={type:t.type,name:t.name,value:e,listener:o,options:i},r?r.push(n):this.__on=[n]}}function ei(t,e,i){var n=_e(t),r=n.CustomEvent;"function"==typeof r?r=new r(e,i):(r=n.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ii(t,e){return function(){return ei(this,t,e)}}function ni(t,e){return function(){return ei(this,t,e.apply(this,arguments))}}var ri=[null];function oi(t,e){this._groups=t,this._parents=e}function si(){return new oi([[document.documentElement]],ri)}oi.prototype=si.prototype={constructor:oi,select:function(t){"function"!=typeof t&&(t=Jt(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s,a=e[r],l=a.length,c=n[r]=new Array(l),h=0;h<l;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),c[h]=s);return new oi(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);return null==e?[]:Xt(e)}}(t):Zt(t);for(var e=this._groups,i=e.length,n=[],r=[],o=0;o<i;++o)for(var s,a=e[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(n.push(t.call(s,s.__data__,c,a)),r.push(s));return new oi(n,r)},selectChild:function(t){return this.select(null==t?ie:function(t){return function(){return ee.call(this.children,t)}}("function"==typeof t?t:te(t)))},selectChildren:function(t){return this.selectAll(null==t?re:function(t){return function(){return ne.call(this.children,t)}}("function"==typeof t?t:te(t)))},filter:function(t){"function"!=typeof t&&(t=Kt(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s=e[r],a=s.length,l=n[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new oi(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,he);var i=e?ce:le,n=this._parents,r=this._groups;"function"!=typeof t&&(t=ae(t));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var h=n[c],u=r[c],d=u.length,f=Xt(t.call(h,h&&h.__data__,c,n)),p=f.length,g=a[c]=new Array(p),m=s[c]=new Array(p),b=l[c]=new Array(d);i(h,u,g,m,b,f,e);for(var v,y,w=0,_=0;w<p;++w)if(v=g[w]){for(w>=_&&(_=w+1);!(y=m[_])&&++_<p;);v._next=y||null}}return(s=new oi(s,n))._enter=a,s._exit=l,s},enter:function(){return new oi(this._enter||this._groups.map(oe),this._parents)},exit:function(){return new oi(this._exit||this._groups.map(oe),this._parents)},join:function(t,e,i){var n=this.enter(),r=this,o=this.exit();return n="function"==typeof t?t(n):n.append(t+""),null!=e&&(r=e(r)),null==i?o.remove():i(o),n&&r?n.merge(r).order():r},merge:function(t){if(!(t instanceof oi))throw new Error("invalid merge");for(var e=this._groups,i=t._groups,n=e.length,r=Math.min(n,i.length),o=new Array(n),s=0;s<r;++s)for(var a,l=e[s],c=i[s],h=l.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=l[d]||c[d])&&(u[d]=a);for(;s<n;++s)o[s]=e[s];return new oi(o,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,r=t[e],o=r.length-1,s=r[o];--o>=0;)(n=r[o])&&(s&&4^n.compareDocumentPosition(s)&&s.parentNode.insertBefore(n,s),s=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=ue);for(var i=this._groups,n=i.length,r=new Array(n),o=0;o<n;++o){for(var s,a=i[o],l=a.length,c=r[o]=new Array(l),h=0;h<l;++h)(s=a[h])&&(c[h]=s);c.sort(e)}return new oi(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],r=0,o=n.length;r<o;++r){var s=n[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var r,o=e[i],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var i=pe(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?me:ge:"function"==typeof e?i.local?we:ye:i.local?ve:be)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?xe:"function"==typeof e?Ie:Se)(t,e,null==i?"":i)):ke(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Ce:"function"==typeof e?Ae:Pe)(t,e)):this.node()[t]},classed:function(t,e){var i=Me(t+"");if(arguments.length<2){for(var n=Te(this.node()),r=-1,o=i.length;++r<o;)if(!n.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?Be:e?ze:Ve)(i,e))},text:function(t){return arguments.length?this.each(null==t?Re:("function"==typeof t?Fe:je)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Le:("function"==typeof t?Ue:Ne)(t)):this.node().innerHTML},raise:function(){return this.each(Ge)},lower:function(){return this.each(We)},append:function(t){var e="function"==typeof t?t:qe(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:qe(t),n=null==e?Ye:"function"==typeof e?e:Jt(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(Je)},clone:function(t){return this.select(t?Qe:Xe)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,r,o=Ze(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?ti:Ke,n=0;n<s;++n)this.each(a(o[n],e,i));return this}var a=this.node().__on;if(a)for(var l,c=0,h=a.length;c<h;++c)for(n=0,l=a[c];n<s;++n)if((r=o[n]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?ni:ii)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,r=t[e],o=0,s=r.length;o<s;++o)(n=r[o])&&(yield n)}};var ai=si,li=function(t){return"string"==typeof t?new oi([[document.querySelector(t)]],[document.documentElement]):new oi([[t]],ri)};function ci(t){t.stopImmediatePropagation()}var hi=function(t){t.preventDefault(),t.stopImmediatePropagation()},ui=function(t){var e=t.document.documentElement,i=li(t).on("dragstart.drag",hi,!0);"onselectstart"in e?i.on("selectstart.drag",hi,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function di(t,e){var i=t.document.documentElement,n=li(t).on("dragstart.drag",null);e&&(n.on("click.drag",hi,!0),setTimeout((function(){n.on("click.drag",null)}),0)),"onselectstart"in i?n.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}var fi=function(t,e,i){t.prototype=e.prototype=i,i.constructor=t};function pi(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function gi(){}var mi=.7,bi=1/mi,vi="\\s*([+-]?\\d+)\\s*",yi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",wi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_i=/^#([0-9a-f]{3,8})$/,xi=new RegExp("^rgb\\("+[vi,vi,vi]+"\\)$"),Si=new RegExp("^rgb\\("+[wi,wi,wi]+"\\)$"),Ii=new RegExp("^rgba\\("+[vi,vi,vi,yi]+"\\)$"),ki=new RegExp("^rgba\\("+[wi,wi,wi,yi]+"\\)$"),Ci=new RegExp("^hsl\\("+[yi,wi,wi]+"\\)$"),Pi=new RegExp("^hsla\\("+[yi,wi,wi,yi]+"\\)$"),Ai={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Mi(){return this.rgb().formatHex()}function Ti(){return this.rgb().formatRgb()}function Ei(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=_i.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?Oi(e):3===i?new Bi(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?Di(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?Di(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=xi.exec(t))?new Bi(e[1],e[2],e[3],1):(e=Si.exec(t))?new Bi(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ii.exec(t))?Di(e[1],e[2],e[3],e[4]):(e=ki.exec(t))?Di(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ci.exec(t))?Li(e[1],e[2]/100,e[3]/100,1):(e=Pi.exec(t))?Li(e[1],e[2]/100,e[3]/100,e[4]):Ai.hasOwnProperty(t)?Oi(Ai[t]):"transparent"===t?new Bi(NaN,NaN,NaN,0):null}function Oi(t){return new Bi(t>>16&255,t>>8&255,255&t,1)}function Di(t,e,i,n){return n<=0&&(t=e=i=NaN),new Bi(t,e,i,n)}function zi(t){return t instanceof gi||(t=Ei(t)),t?new Bi((t=t.rgb()).r,t.g,t.b,t.opacity):new Bi}function Vi(t,e,i,n){return 1===arguments.length?zi(t):new Bi(t,e,i,null==n?1:n)}function Bi(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function Ri(){return"#"+Fi(this.r)+Fi(this.g)+Fi(this.b)}function ji(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Fi(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Li(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new Ui(t,e,i,n)}function Ni(t){if(t instanceof Ui)return new Ui(t.h,t.s,t.l,t.opacity);if(t instanceof gi||(t=Ei(t)),!t)return new Ui;if(t instanceof Ui)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),o=Math.max(e,i,n),s=NaN,a=o-r,l=(o+r)/2;return a?(s=e===o?(i-n)/a+6*(i<n):i===o?(n-e)/a+2:(e-i)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new Ui(s,a,l,t.opacity)}function Ui(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function Gi(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function Wi(t,e,i,n,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*i+(1+3*t+3*o-3*s)*n+s*r)/6}fi(gi,Ei,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Mi,formatHex:Mi,formatHsl:function(){return Ni(this).formatHsl()},formatRgb:Ti,toString:Ti}),fi(Bi,Vi,pi(gi,{brighter:function(t){return t=null==t?bi:Math.pow(bi,t),new Bi(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?mi:Math.pow(mi,t),new Bi(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ri,formatHex:Ri,formatRgb:ji,toString:ji})),fi(Ui,(function(t,e,i,n){return 1===arguments.length?Ni(t):new Ui(t,e,i,null==n?1:n)}),pi(gi,{brighter:function(t){return t=null==t?bi:Math.pow(bi,t),new Ui(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?mi:Math.pow(mi,t),new Ui(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new Bi(Gi(t>=240?t-240:t+120,r,n),Gi(t,r,n),Gi(t<120?t+240:t-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Hi=t=>()=>t;function $i(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):Hi(isNaN(t)?e:t)}var qi=function t(e){var i=function(t){return 1==(t=+t)?$i:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):Hi(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=Vi(t)).r,(e=Vi(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),s=$i(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return n.gamma=t,n}(1);function Yi(t){return function(e){var i,n,r=e.length,o=new Array(r),s=new Array(r),a=new Array(r);for(i=0;i<r;++i)n=Vi(e[i]),o[i]=n.r||0,s[i]=n.g||0,a[i]=n.b||0;return o=t(o),s=t(s),a=t(a),n.opacity=1,function(t){return n.r=o(t),n.g=s(t),n.b=a(t),n+""}}}Yi((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[n],o=t[n+1];return Wi((i-n/e)*e,n>0?t[n-1]:2*r-o,r,o,n<e-1?t[n+2]:2*o-r)}})),Yi((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e);return Wi((i-n/e)*e,t[(n+e-1)%e],t[n%e],t[(n+1)%e],t[(n+2)%e])}}));var Ji=function(t,e){e||(e=[]);var i,n=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}};function Xi(t,e){var i,n=e?e.length:0,r=t?Math.min(n,t.length):0,o=new Array(r),s=new Array(n);for(i=0;i<r;++i)o[i]=sn(t[i],e[i]);for(;i<n;++i)s[i]=e[i];return function(t){for(i=0;i<r;++i)s[i]=o[i](t);return s}}var Qi,Zi,Ki=function(t,e){var i=new Date;return t=+t,e=+e,function(n){return i.setTime(t*(1-n)+e*n),i}},tn=function(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}},en=function(t,e){var i,n={},r={};for(i in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)i in t?n[i]=sn(t[i],e[i]):r[i]=e[i];return function(t){for(i in n)r[i]=n[i](t);return r}},nn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rn=new RegExp(nn.source,"g"),on=function(t,e){var i,n,r,o=nn.lastIndex=rn.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(i=nn.exec(t))&&(n=rn.exec(e));)(r=n.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(i=i[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,l.push({i:s,x:tn(i,n)})),o=rn.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})},sn=function(t,e){var i,n,r=typeof e;return null==e||"boolean"===r?Hi(e):("number"===r?tn:"string"===r?(i=Ei(e))?(e=i,qi):on:e instanceof Ei?qi:e instanceof Date?Ki:(n=e,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(e)?Xi:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?en:tn:Ji))(t,e)},an=function(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var i=e.ownerSVGElement||e;if(i.createSVGPoint){var n=i.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,[(n=n.matrixTransform(e.getScreenCTM().inverse())).x,n.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]},ln=0,cn=0,hn=0,un=0,dn=0,fn=0,pn="object"==typeof performance&&performance.now?performance:Date,gn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function mn(){return dn||(gn(bn),dn=pn.now()+fn)}function bn(){dn=0}function vn(){this._call=this._time=this._next=null}function yn(t,e,i){var n=new vn;return n.restart(t,e,i),n}function wn(){dn=(un=pn.now())+fn,ln=cn=0;try{!function(){mn(),++ln;for(var t,e=Qi;e;)(t=dn-e._time)>=0&&e._call.call(null,t),e=e._next;--ln}()}finally{ln=0,function(){for(var t,e,i=Qi,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Qi=e);Zi=t,xn(n)}(),dn=0}}function _n(){var t=pn.now(),e=t-un;e>1e3&&(fn-=e,un=t)}function xn(t){ln||(cn&&(cn=clearTimeout(cn)),t-dn>24?(t<1/0&&(cn=setTimeout(wn,t-pn.now()-fn)),hn&&(hn=clearInterval(hn))):(hn||(un=pn.now(),hn=setInterval(_n,1e3)),ln=1,gn(wn)))}vn.prototype=yn.prototype={constructor:vn,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?mn():+i)+(null==e?0:+e),this._next||Zi===this||(Zi?Zi._next=this:Qi=this,Zi=this),this._call=t,this._time=i,xn()},stop:function(){this._call&&(this._call=null,this._time=1/0,xn())}};var Sn=function(t,e,i){var n=new vn;return n.restart(i=>{n.stop(),t(i+e)},e=null==e?0:+e,i),n},In=qt("start","end","cancel","interrupt"),kn=[],Cn=function(t,e,i,n,r,o){var s=t.__transition;if(s){if(i in s)return}else t.__transition={};!function(t,e,i){var n,r=t.__transition;function o(l){var c,h,u,d;if(1!==i.state)return a();for(c in r)if((d=r[c]).name===i.name){if(3===d.state)return Sn(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Sn((function(){3===i.state&&(i.state=4,i.timer.restart(s,i.delay,i.time),s(l))})),i.state=2,i.on.call("start",t,t.__data__,i.index,i.group),2===i.state){for(i.state=3,n=new Array(u=i.tween.length),c=0,h=-1;c<u;++c)(d=i.tween[c].value.call(t,t.__data__,i.index,i.group))&&(n[++h]=d);n.length=h+1}}function s(e){for(var r=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=5,1),o=-1,s=n.length;++o<s;)n[o].call(t,r);5===i.state&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=6,i.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=i,i.timer=yn((function(t){i.state=1,i.timer.restart(o,i.delay,i.time),i.delay<=t&&o(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:r,on:In,tween:kn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function Pn(t,e){var i=Mn(t,e);if(i.state>0)throw new Error("too late; already scheduled");return i}function An(t,e){var i=Mn(t,e);if(i.state>3)throw new Error("too late; already running");return i}function Mn(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}var Tn,En=function(t,e){var i,n,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(i=o[r]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete o[r]):s=!1;s&&delete t.__transition}},On=180/Math.PI,Dn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},zn=function(t,e,i,n,r,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*i+e*n)&&(i-=t*l,n-=e*l),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,l/=a),t*n<e*i&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*On,skewX:Math.atan(l)*On,scaleX:s,scaleY:a}};function Vn(t,e,i,n){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,n,r,o,s,a){if(t!==r||n!==o){var l=s.push("translate(",null,e,null,i);a.push({i:l-4,x:tn(t,r)},{i:l-2,x:tn(n,o)})}else(r||o)&&s.push("translate("+r+e+o+i)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,i,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:i.push(r(i)+"rotate(",null,n)-2,x:tn(t,e)})):e&&i.push(r(i)+"rotate("+e+n)}(o.rotate,s.rotate,a,l),function(t,e,i,o){t!==e?o.push({i:i.push(r(i)+"skewX(",null,n)-2,x:tn(t,e)}):e&&i.push(r(i)+"skewX("+e+n)}(o.skewX,s.skewX,a,l),function(t,e,i,n,o,s){if(t!==i||e!==n){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:tn(t,i)},{i:a-2,x:tn(e,n)})}else 1===i&&1===n||o.push(r(o)+"scale("+i+","+n+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,i=-1,n=l.length;++i<n;)a[(e=l[i]).i]=e.x(t);return a.join("")}}}var Bn=Vn((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Dn:zn(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Rn=Vn((function(t){return null==t?Dn:(Tn||(Tn=document.createElementNS("http://www.w3.org/2000/svg","g")),Tn.setAttribute("transform",t),(t=Tn.transform.baseVal.consolidate())?zn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Dn)}),", ",")",")");function jn(t,e){var i,n;return function(){var r=An(this,t),o=r.tween;if(o!==i)for(var s=0,a=(n=i=o).length;s<a;++s)if(n[s].name===e){(n=n.slice()).splice(s,1);break}r.tween=n}}function Fn(t,e,i){var n,r;if("function"!=typeof i)throw new Error;return function(){var o=An(this,t),s=o.tween;if(s!==n){r=(n=s).slice();for(var a={name:e,value:i},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function Ln(t,e,i){var n=t._id;return t.each((function(){var t=An(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return Mn(t,n).value[e]}}var Nn=function(t,e){var i;return("number"==typeof e?tn:e instanceof Ei?qi:(i=Ei(e))?(e=i,qi):on)(t,e)};function Un(t){return function(){this.removeAttribute(t)}}function Gn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Wn(t,e,i){var n,r,o=i+"";return function(){var s=this.getAttribute(t);return s===o?null:s===n?r:r=e(n=s,i)}}function Hn(t,e,i){var n,r,o=i+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===n?r:r=e(n=s,i)}}function $n(t,e,i){var n,r,o;return function(){var s,a,l=i(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===n&&a===r?o:(r=a,o=e(n=s,l));this.removeAttribute(t)}}function qn(t,e,i){var n,r,o;return function(){var s,a,l=i(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===n&&a===r?o:(r=a,o=e(n=s,l));this.removeAttributeNS(t.space,t.local)}}function Yn(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function Jn(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function Xn(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&Jn(t,r)),i}return r._value=e,r}function Qn(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&Yn(t,r)),i}return r._value=e,r}function Zn(t,e){return function(){Pn(this,t).delay=+e.apply(this,arguments)}}function Kn(t,e){return e=+e,function(){Pn(this,t).delay=e}}function tr(t,e){return function(){An(this,t).duration=+e.apply(this,arguments)}}function er(t,e){return e=+e,function(){An(this,t).duration=e}}function ir(t,e){if("function"!=typeof e)throw new Error;return function(){An(this,t).ease=e}}function nr(t,e,i){var n,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Pn:An;return function(){var s=o(this,t),a=s.on;a!==n&&(r=(n=a).copy()).on(e,i),s.on=r}}var rr=ai.prototype.constructor;function or(t){return function(){this.style.removeProperty(t)}}function sr(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}function ar(t,e,i){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&sr(t,o,i)),n}return o._value=e,o}function lr(t){return function(e){this.textContent=t.call(this,e)}}function cr(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&lr(n)),e}return n._value=t,n}var hr=0;function ur(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function dr(){return++hr}var fr=ai.prototype;ur.prototype=(function(t){return ai().transition(t)}).prototype={constructor:ur,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Jt(t));for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=n[s],h=c.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=c[d])&&(l=t.call(a,a.__data__,d,c))&&("__data__"in a&&(l.__data__=a.__data__),u[d]=l,Cn(u[d],e,i,d,u,Mn(a,i)));return new ur(o,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Zt(t));for(var n=this._groups,r=n.length,o=[],s=[],a=0;a<r;++a)for(var l,c=n[a],h=c.length,u=0;u<h;++u)if(l=c[u]){for(var d,f=t.call(l,l.__data__,u,c),p=Mn(l,i),g=0,m=f.length;g<m;++g)(d=f[g])&&Cn(d,e,i,g,f,p);o.push(f),s.push(l)}return new ur(o,s,e,i)},filter:function(t){"function"!=typeof t&&(t=Kt(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var o,s=e[r],a=s.length,l=n[r]=[],c=0;c<a;++c)(o=s[c])&&t.call(o,o.__data__,c,s)&&l.push(o);return new ur(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,r=Math.min(n,i.length),o=new Array(n),s=0;s<r;++s)for(var a,l=e[s],c=i[s],h=l.length,u=o[s]=new Array(h),d=0;d<h;++d)(a=l[d]||c[d])&&(u[d]=a);for(;s<n;++s)o[s]=e[s];return new ur(o,this._parents,this._name,this._id)},selection:function(){return new rr(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=dr(),n=this._groups,r=n.length,o=0;o<r;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var h=Mn(s,e);Cn(s,t,i,c,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new ur(n,this._parents,t,i)},call:fr.call,nodes:fr.nodes,node:fr.node,size:fr.size,empty:fr.empty,each:fr.each,on:function(t,e){var i=this._id;return arguments.length<2?Mn(this.node(),i).on.on(t):this.each(nr(i,t,e))},attr:function(t,e){var i=pe(t),n="transform"===i?Rn:Nn;return this.attrTween(t,"function"==typeof e?(i.local?qn:$n)(i,n,Ln(this,"attr."+t,e)):null==e?(i.local?Gn:Un)(i):(i.local?Hn:Wn)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=pe(t);return this.tween(i,(n.local?Xn:Qn)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?Bn:Nn;return null==e?this.styleTween(t,function(t,e){var i,n,r;return function(){var o=ke(this,t),s=(this.style.removeProperty(t),ke(this,t));return o===s?null:o===i&&s===n?r:r=e(i=o,n=s)}}(t,n)).on("end.style."+t,or(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,r,o;return function(){var s=ke(this,t),a=i(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=ke(this,t)),s===l?null:s===n&&l===r?o:(r=l,o=e(n=s,a))}}(t,n,Ln(this,"style."+t,e))).each(function(t,e){var i,n,r,o,s="style."+e,a="end."+s;return function(){var l=An(this,t),c=l.on,h=null==l.value[s]?o||(o=or(e)):void 0;c===i&&r===h||(n=(i=c).copy()).on(a,r=h),l.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,r,o=i+"";return function(){var s=ke(this,t);return s===o?null:s===n?r:r=e(n=s,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,ar(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Ln(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,cr(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,r=Mn(this.node(),i).tween,o=0,s=r.length;o<s;++o)if((n=r[o]).name===t)return n.value;return null}return this.each((null==e?jn:Fn)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Zn:Kn)(e,t)):Mn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?tr:er)(e,t)):Mn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(ir(e,t)):Mn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;An(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,r=i.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--r&&o()}};i.each((function(){var i=An(this,n),r=i.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),i.on=e})),0===r&&o()}))},[Symbol.iterator]:fr[Symbol.iterator]};var pr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function gr(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function mr(t){return{type:t}}ai.prototype.interrupt=function(t){return this.each((function(){En(this,t)}))},ai.prototype.transition=function(t){var e,i;t instanceof ur?(e=t._id,t=t._name):(e=dr(),(i=pr).time=mn(),t=null==t?null:t+"");for(var n=this._groups,r=n.length,o=0;o<r;++o)for(var s,a=n[o],l=a.length,c=0;c<l;++c)(s=a[c])&&Cn(s,t,e,c,a,i||gr(s,e));return new ur(n,this._parents,t,e)},Math,["w","e"].map(mr),["n","s"].map(mr),["n","w","e","s","nw","ne","sw","se"].map(mr);var br=t=>()=>t;function vr(t,{sourceEvent:e,subject:i,target:n,identifier:r,active:o,x:s,y:a,dx:l,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function yr(t){return!t.ctrlKey&&!t.button}function wr(){return this.parentNode}function _r(t,e){return null==e?{x:t.x,y:t.y}:e}function xr(){return navigator.maxTouchPoints||"ontouchstart"in this}vr.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Sr=function(){var t,e,i,n,r=yr,o=wr,s=_r,a=xr,l={},c=qt("start","drag","end"),h=0,u=0;function d(t){t.on("mousedown.drag",f).filter(a).on("touchstart.drag",m).on("touchmove.drag",b).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!n&&r.call(this,s,a)){var l=y(this,o.call(this,s,a),s,a,"mouse");l&&(li(s.view).on("mousemove.drag",p,!0).on("mouseup.drag",g,!0),ui(s.view),ci(s),i=!1,t=s.clientX,e=s.clientY,l("start",s))}}function p(n){if(hi(n),!i){var r=n.clientX-t,o=n.clientY-e;i=r*r+o*o>u}l.mouse("drag",n)}function g(t){li(t.view).on("mousemove.drag mouseup.drag",null),di(t.view,i),hi(t),l.mouse("end",t)}function m(t,e){if(r.call(this,t,e)){var i,n,s=t.changedTouches,a=o.call(this,t,e),l=s.length;for(i=0;i<l;++i)(n=y(this,a,t,e,s[i].identifier,s[i]))&&(ci(t),n("start",t,s[i]))}}function b(t){var e,i,n=t.changedTouches,r=n.length;for(e=0;e<r;++e)(i=l[n[e].identifier])&&(hi(t),i("drag",t,n[e]))}function v(t){var e,i,r=t.changedTouches,o=r.length;for(n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),e=0;e<o;++e)(i=l[r[e].identifier])&&(ci(t),i("end",t,r[e]))}function y(t,e,i,n,r,o){var a,u,f,p=c.copy(),g=an(o||i,e);if(null!=(f=s.call(t,new vr("beforestart",{sourceEvent:i,target:d,identifier:r,active:h,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),n)))return a=f.x-g[0]||0,u=f.y-g[1]||0,function i(o,s,c){var m,b=g;switch(o){case"start":l[r]=i,m=h++;break;case"end":delete l[r],--h;case"drag":g=an(c||s,e),m=h}p.call(o,t,new vr(o,{sourceEvent:s,subject:f,target:d,identifier:r,active:m,x:g[0]+a,y:g[1]+u,dx:g[0]-b[0],dy:g[1]-b[1],dispatch:p}),n)}}return d.filter=function(t){return arguments.length?(r="function"==typeof t?t:br(!!t),d):r},d.container=function(t){return arguments.length?(o="function"==typeof t?t:br(t),d):o},d.subject=function(t){return arguments.length?(s="function"==typeof t?t:br(t),d):s},d.touchable=function(t){return arguments.length?(a="function"==typeof t?t:br(!!t),d):a},d.on=function(){var t=c.on.apply(c,arguments);return t===c?d:t},d.clickDistance=function(t){return arguments.length?(u=(t=+t)*t,d):Math.sqrt(u)},d};function Ir(t){var e=0,i=t.children,n=i&&i.length;if(n)for(;--n>=0;)e+=i[n].value;else e=1;t.value=e}function kr(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Pr)):void 0===e&&(e=Cr);for(var i,n,r,o,s,a=new Tr(t),l=[a];i=l.pop();)if((r=e(i.data))&&(s=(r=Array.from(r)).length))for(i.children=r,o=s-1;o>=0;--o)l.push(n=r[o]=new Tr(r[o])),n.parent=i,n.depth=i.depth+1;return a.eachBefore(Mr)}function Cr(t){return t.children}function Pr(t){return Array.isArray(t)?t[1]:null}function Ar(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Mr(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Tr(t){this.data=t,this.depth=this.height=0,this.parent=null}Tr.prototype=kr.prototype={constructor:Tr,count:function(){return this.eachAfter(Ir)},each:function(t,e){let i=-1;for(const n of this)t.call(e,n,++i,this);return this},eachAfter:function(t,e){for(var i,n,r,o=this,s=[o],a=[],l=-1;o=s.pop();)if(a.push(o),i=o.children)for(n=0,r=i.length;n<r;++n)s.push(i[n]);for(;o=a.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var i,n,r=this,o=[r],s=-1;r=o.pop();)if(t.call(e,r,++s,this),i=r.children)for(n=i.length-1;n>=0;--n)o.push(i[n]);return this},find:function(t,e){let i=-1;for(const n of this)if(t.call(e,n,++i,this))return n},sum:function(t){return this.eachAfter((function(e){for(var i=+t(e.data)||0,n=e.children,r=n&&n.length;--r>=0;)i+=n[r].value;e.value=i}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,i=function(t,e){if(t===e)return t;var i=t.ancestors(),n=e.ancestors(),r=null;for(t=i.pop(),e=n.pop();t===e;)r=t,t=i.pop(),e=n.pop();return r}(e,t),n=[e];e!==i;)n.push(e=e.parent);for(var r=n.length;t!==i;)n.splice(r,0,t),t=t.parent;return n},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(i){i!==t&&e.push({source:i.parent,target:i})})),e},copy:function(){return kr(this).eachBefore(Ar)},[Symbol.iterator]:function*(){var t,e,i,n,r=this,o=[r];do{for(t=o.reverse(),o=[];r=t.pop();)if(yield r,e=r.children)for(i=0,n=e.length;i<n;++i)o.push(e[i])}while(o.length)}};var Er=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Or=function(t,e,i,n,r){for(var o,s=t.children,a=-1,l=s.length,c=t.value&&(n-e)/t.value;++a<l;)(o=s[a]).y0=i,o.y1=r,o.x0=e,o.x1=e+=o.value*c},Dr=function(t,e,i,n,r){for(var o,s=t.children,a=-1,l=s.length,c=t.value&&(r-i)/t.value;++a<l;)(o=s[a]).x0=e,o.x1=n,o.y0=i,o.y1=i+=o.value*c},zr=function t(e){function i(t,i,n,r,o){!function(t,e,i,n,r,o){for(var s,a,l,c,h,u,d,f,p,g,m,b=[],v=e.children,y=0,w=0,_=v.length,x=e.value;y<_;){l=r-i,c=o-n;do{h=v[w++].value}while(!h&&w<_);for(u=d=h,m=h*h*(g=Math.max(c/l,l/c)/(x*t)),p=Math.max(d/m,m/u);w<_;++w){if(h+=a=v[w].value,a<u&&(u=a),a>d&&(d=a),m=h*h*g,(f=Math.max(d/m,m/u))>p){h-=a;break}p=f}b.push(s={value:h,dice:l<c,children:v.slice(y,w)}),s.dice?Or(s,i,n,r,x?n+=c*h/x:o):Dr(s,i,n,x?i+=l*h/x:r,o),x-=h,y=w}}(e,t,i,n,r,o)}return i.ratio=function(e){return t((e=+e)>1?e:1)},i}((1+Math.sqrt(5))/2);function Vr(t){if("function"!=typeof t)throw new Error;return t}function Br(){return 0}var Rr=function(t){return function(){return t}};function jr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const Fr=Symbol("implicit");function Lr(){var t=new Map,e=[],i=[],n=Fr;function r(r){var o=r+"",s=t.get(o);if(!s){if(n!==Fr)return n;t.set(o,s=e.push(r))}return i[(s-1)%i.length]}return r.domain=function(i){if(!arguments.length)return e.slice();e=[],t=new Map;for(const n of i){const i=n+"";t.has(i)||t.set(i,e.push(n))}return r},r.range=function(t){return arguments.length?(i=Array.from(t),r):i.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return Lr(e,i).unknown(n)},jr.apply(r,arguments),r}function Nr(){var t,e,i=Lr().unknown(void 0),n=i.domain,r=i.range,o=0,s=1,a=!1,l=0,c=0,h=.5;function u(){var i=n().length,u=s<o,d=u?s:o,f=u?o:s;t=(f-d)/Math.max(1,i-l+2*c),a&&(t=Math.floor(t)),d+=(f-d-t*(i-l))*h,e=t*(1-l),a&&(d=Math.round(d),e=Math.round(e));var p=Et(i).map((function(e){return d+t*e}));return r(u?p.reverse():p)}return delete i.unknown,i.domain=function(t){return arguments.length?(n(t),u()):n()},i.range=function(t){return arguments.length?([o,s]=t,o=+o,s=+s,u()):[o,s]},i.rangeRound=function(t){return[o,s]=t,o=+o,s=+s,a=!0,u()},i.bandwidth=function(){return e},i.step=function(){return t},i.round=function(t){return arguments.length?(a=!!t,u()):a},i.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),u()):l},i.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),u()):l},i.paddingOuter=function(t){return arguments.length?(c=+t,u()):c},i.align=function(t){return arguments.length?(h=Math.max(0,Math.min(1,t)),u()):h},i.copy=function(){return Nr(n(),[o,s]).round(a).paddingInner(l).paddingOuter(c).align(h)},jr.apply(u(),arguments)}function Ur(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Ur(e())},t}var Gr=Math.sqrt(50),Wr=Math.sqrt(10),Hr=Math.sqrt(2);function $r(t,e,i){var n=(e-t)/Math.max(0,i),r=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,r);return r>=0?(o>=Gr?10:o>=Wr?5:o>=Hr?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=Gr?10:o>=Wr?5:o>=Hr?2:1)}var qr=function(t){let e=t,i=t;function n(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){const o=n+r>>>1;i(t[o],e)<0?n=o+1:r=o}return n}return 1===t.length&&(e=(e,i)=>t(e)-i,i=function(t){return(e,i)=>At(t(e),i)}(t)),{left:n,center:function(t,i,r,o){null==r&&(r=0),null==o&&(o=t.length);const s=n(t,i,r,o-1);return s>r&&e(t[s-1],i)>-e(t[s],i)?s-1:s},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){const o=n+r>>>1;i(t[o],e)>0?r=o:n=o+1}return n}}};const Yr=qr(At).right;qr((function(t){return null===t?NaN:+t}));var Jr=Yr,Xr=function(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}};function Qr(t){return+t}var Zr=[0,1];function Kr(t){return t}function to(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:(i=isNaN(e)?NaN:.5,function(){return i});var i}function eo(t,e,i){var n=t[0],r=t[1],o=e[0],s=e[1];return r<n?(n=to(r,n),o=i(s,o)):(n=to(n,r),o=i(o,s)),function(t){return o(n(t))}}function io(t,e,i){var n=Math.min(t.length,e.length)-1,r=new Array(n),o=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)r[s]=to(t[s],t[s+1]),o[s]=i(e[s],e[s+1]);return function(e){var i=Jr(t,e,1,n)-1;return o[i](r[i](e))}}function no(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ro(){return function(){var t,e,i,n,r,o,s=Zr,a=Zr,l=sn,c=Kr;function h(){var t,e,i,l=Math.min(s.length,a.length);return c!==Kr&&((t=s[0])>(e=s[l-1])&&(i=t,t=e,e=i),c=function(i){return Math.max(t,Math.min(e,i))}),n=l>2?io:eo,r=o=null,u}function u(e){return isNaN(e=+e)?i:(r||(r=n(s.map(t),a,l)))(t(c(e)))}return u.invert=function(i){return c(e((o||(o=n(a,s.map(t),tn)))(i)))},u.domain=function(t){return arguments.length?(s=Array.from(t,Qr),h()):s.slice()},u.range=function(t){return arguments.length?(a=Array.from(t),h()):a.slice()},u.rangeRound=function(t){return a=Array.from(t),l=Xr,h()},u.clamp=function(t){return arguments.length?(c=!!t||Kr,h()):c!==Kr},u.interpolate=function(t){return arguments.length?(l=t,h()):l},u.unknown=function(t){return arguments.length?(i=t,u):i},function(i,n){return t=i,e=n,h()}}()(Kr,Kr)}var oo=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function so(t){if(!(e=oo.exec(t)))throw new Error("invalid format: "+t);var e;return new ao({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ao(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function lo(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,n=t.slice(0,i);return[n.length>1?n[0]+n.slice(2):n,+t.slice(i+1)]}so.prototype=ao.prototype,ao.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var co,ho,uo,fo,po=function(t){return(t=lo(Math.abs(t)))?t[1]:NaN},go=function(t,e){var i=lo(t,e);if(!i)return t+"";var n=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")},mo={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>go(100*t,e),r:go,s:function(t,e){var i=lo(t,e);if(!i)return t+"";var n=i[0],r=i[1],o=r-(co=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+lo(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},bo=function(t){return t},vo=Array.prototype.map,yo=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function wo(t){var e=t.domain;return t.ticks=function(t){var i=e();return function(t,e,i){var n,r,o,s,a=-1;if(i=+i,(t=+t)==(e=+e)&&i>0)return[t];if((n=e<t)&&(r=t,t=e,e=r),0===(s=$r(t,e,i))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),o=new Array(r=Math.ceil(e-t+1));++a<r;)o[a]=(t+a)*s;else for(s=-s,t=Math.ceil(t*s),e=Math.floor(e*s),o=new Array(r=Math.ceil(e-t+1));++a<r;)o[a]=(t+a)/s;return n&&o.reverse(),o}(i[0],i[i.length-1],null==t?10:t)},t.tickFormat=function(t,i){var n=e();return function(t,e,i,n){var r,o=function(t,e,i){var n=Math.abs(e-t)/Math.max(0,i),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/r;return o>=Gr?r*=10:o>=Wr?r*=5:o>=Hr&&(r*=2),e<t?-r:r}(t,e,i);switch((n=so(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(po(e)/3)))-po(Math.abs(t)))}(o,s))||(n.precision=r),fo(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,po(e)-po(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-po(Math.abs(t)))}(o))||(n.precision=r-2*("%"===n.type))}return uo(n)}(n[0],n[n.length-1],null==t?10:t,i)},t.nice=function(i){null==i&&(i=10);var n,r,o=e(),s=0,a=o.length-1,l=o[s],c=o[a],h=10;for(c<l&&(r=l,l=c,c=r,r=s,s=a,a=r);h-- >0;){if((r=$r(l,c,i))===n)return o[s]=l,o[a]=c,e(o);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}n=r}return t},t}ho=function(t){var e,i,n=void 0===t.grouping||void 0===t.thousands?bo:(e=vo.call(t.grouping,Number),i=t.thousands+"",function(t,n){for(var r=t.length,o=[],s=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>n&&(a=Math.max(1,n-l)),o.push(t.substring(r-=a,r+a)),!((l+=a+1)>n));)a=e[s=(s+1)%e.length];return o.reverse().join(i)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?bo:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(vo.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"\u2212":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=so(t)).fill,i=t.align,u=t.sign,d=t.symbol,f=t.zero,p=t.width,g=t.comma,m=t.precision,b=t.trim,v=t.type;"n"===v?(g=!0,v="g"):mo[v]||(void 0===m&&(m=12),b=!0,v="g"),(f||"0"===e&&"="===i)&&(f=!0,e="0",i="=");var y="$"===d?r:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?l:"",_=mo[v],x=/[defgprs%]/.test(v);function S(t){var r,o,l,d=y,S=w;if("c"===v)S=_(t)+S,t="";else{var I=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:_(Math.abs(t),m),b&&(t=function(t){t:for(var e,i=t.length,n=1,r=-1;n<i;++n)switch(t[n]){case".":r=e=n;break;case"0":0===r&&(r=n),e=n;break;default:if(!+t[n])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),I&&0==+t&&"+"!==u&&(I=!1),d=(I?"("===u?u:c:"-"===u||"("===u?"":u)+d,S=("s"===v?yo[8+co/3]:"")+S+(I&&"("===u?")":""),x)for(r=-1,o=t.length;++r<o;)if(48>(l=t.charCodeAt(r))||l>57){S=(46===l?s+t.slice(r+1):t.slice(r))+S,t=t.slice(0,r);break}}g&&!f&&(t=n(t,1/0));var k=d.length+t.length+S.length,C=k<p?new Array(p-k+1).join(e):"";switch(g&&f&&(t=n(C+t,C.length?p-S.length:1/0),C=""),i){case"<":t=d+t+S+C;break;case"=":t=d+C+t+S;break;case"^":t=C.slice(0,k=C.length>>1)+d+t+S+C.slice(k);break;default:t=C+d+t+S}return a(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),S.toString=function(){return t+""},S}return{format:u,formatPrefix:function(t,e){var i=u(((t=so(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(po(e)/3))),r=Math.pow(10,-n),o=yo[8+n/3];return function(t){return i(r*t)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),uo=ho.format,fo=ho.formatPrefix;const _o=Math.PI,xo=2*_o,So=1e-6,Io=xo-So;function ko(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Co(){return new ko}ko.prototype=Co.prototype={constructor:ko,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,i,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+i)+","+(this._y1=+n)},bezierCurveTo:function(t,e,i,n,r,o){this._+="C"+ +t+","+ +e+","+ +i+","+ +n+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,i,n,r){var o=this._x1,s=this._y1,a=(i=+i)-(t=+t),l=(n=+n)-(e=+e),c=o-t,h=s-e,u=c*c+h*h;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(u>So)if(Math.abs(h*a-l*c)>So&&r){var d=i-o,f=n-s,p=a*a+l*l,g=d*d+f*f,m=Math.sqrt(p),b=Math.sqrt(u),v=r*Math.tan((_o-Math.acos((p+u-g)/(2*m*b)))/2),y=v/b,w=v/m;Math.abs(y-1)>So&&(this._+="L"+(t+y*c)+","+(e+y*h)),this._+="A"+r+","+r+",0,0,"+ +(h*d>c*f)+","+(this._x1=t+w*a)+","+(this._y1=e+w*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,i,n,r,o){t=+t,e=+e,o=!!o;var s=(i=+i)*Math.cos(n),a=i*Math.sin(n),l=t+s,c=e+a,h=1^o,u=o?n-r:r-n;if(i<0)throw new Error("negative radius: "+i);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>So||Math.abs(this._y1-c)>So)&&(this._+="L"+l+","+c),i&&(u<0&&(u=u%xo+xo),u>Io?this._+="A"+i+","+i+",0,1,"+h+","+(t-s)+","+(e-a)+"A"+i+","+i+",0,1,"+h+","+(this._x1=l)+","+(this._y1=c):u>So&&(this._+="A"+i+","+i+",0,"+ +(u>=_o)+","+h+","+(this._x1=t+i*Math.cos(r))+","+(this._y1=e+i*Math.sin(r))))},rect:function(t,e,i,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +i+"v"+ +n+"h"+-i+"Z"},toString:function(){return this._}};var Po=Co,Ao=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)},Mo=function(t){return function(){return t}};function To(t){this._context=t}To.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Eo=function(t){return new To(t)};function Oo(t){return t[0]}function Do(t){return t[1]}var zo=function(t,e){var i=Mo(!0),n=null,r=Eo,o=null;function s(s){var a,l,c,h=(s=Ao(s)).length,u=!1;for(null==n&&(o=r(c=Po())),a=0;a<=h;++a)!(a<h&&i(l=s[a],a,s))===u&&((u=!u)?o.lineStart():o.lineEnd()),u&&o.point(+t(l,a,s),+e(l,a,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?Oo:Mo(t),e="function"==typeof e?e:void 0===e?Do:Mo(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:Mo(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:Mo(+t),s):e},s.defined=function(t){return arguments.length?(i="function"==typeof t?t:Mo(!!t),s):i},s.curve=function(t){return arguments.length?(r=t,null!=n&&(o=r(n)),s):r},s.context=function(t){return arguments.length?(null==t?n=o=null:o=r(n=t),s):n},s};function Vo(t){return t<0?-1:1}function Bo(t,e,i){var n=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(n||r<0&&-0),s=(i-t._y1)/(r||n<0&&-0),a=(o*r+s*n)/(n+r);return(Vo(o)+Vo(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function Ro(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function jo(t,e,i){var n=t._x0,r=t._x1,o=t._y1,s=(r-n)/3;t._context.bezierCurveTo(n+s,t._y0+s*e,r-s,o-s*i,r,o)}function Fo(t){this._context=t}function Lo(t){this._context=t}function No(t){return new Fo(t)}function Uo(t){return((t=Math.exp(t))+1/t)/2}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jo(this,this._t0,Ro(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var i=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,jo(this,Ro(this,i=Bo(this,t,e)),i);break;default:jo(this,this._t0,i=Bo(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=i}}},((function(t){this._context=new Lo(t)}).prototype=Object.create(Fo.prototype)).point=function(t,e){Fo.prototype.point.call(this,e,t)},Lo.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,i,n,r,o){this._context.bezierCurveTo(e,t,n,i,o,r)}};var Go=function t(e,i,n){function r(t,r){var o,s,a=t[0],l=t[1],c=t[2],h=r[2],u=r[0]-a,d=r[1]-l,f=u*u+d*d;if(f<1e-12)s=Math.log(h/c)/e,o=function(t){return[a+t*u,l+t*d,c*Math.exp(e*t*s)]};else{var p=Math.sqrt(f),g=(h*h-c*c+n*f)/(2*c*i*p),m=(h*h-c*c-n*f)/(2*h*i*p),b=Math.log(Math.sqrt(g*g+1)-g),v=Math.log(Math.sqrt(m*m+1)-m);s=(v-b)/e,o=function(t){var n,r=t*s,o=Uo(b),h=c/(i*p)*(o*(n=e*r+b,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[a+h*u,l+h*d,c*o/Uo(e*r+b)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return r.rho=function(e){var i=Math.max(.001,+e),n=i*i;return t(i,n,n*n)},r}(Math.SQRT2,2,4),Wo=t=>()=>t;function Ho(t,{sourceEvent:e,target:i,transform:n,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:r}})}function $o(t,e,i){this.k=t,this.x=e,this.y=i}$o.prototype={constructor:$o,scale:function(t){return 1===t?this:new $o(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new $o(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var qo=new $o(1,0,0);function Yo(t){for(;!t.__zoom;)if(!(t=t.parentNode))return qo;return t.__zoom}function Jo(t){t.stopImmediatePropagation()}Yo.prototype=$o.prototype;var Xo=function(t){t.preventDefault(),t.stopImmediatePropagation()};function Qo(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Zo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Ko(){return this.__zoom||qo}function ts(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function es(){return navigator.maxTouchPoints||"ontouchstart"in this}function is(t,e,i){var n=t.invertX(e[0][0])-i[0][0],r=t.invertX(e[1][0])-i[1][0],o=t.invertY(e[0][1])-i[0][1],s=t.invertY(e[1][1])-i[1][1];return t.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}let ns=(()=>{class t{transform(t,e){if(null==t)return null;if(null==e)return null;for(var i=t;i;){var n=e[i];if("virtual"!=n.itemType)return n.id;i=n.parentIds[0]}return null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"getFirstRealParentId",type:t,pure:!0}),t})();var rs=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var r=n[i];t.call(e,r[1],r[0])}},e}()}(),os="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,ss="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),as="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(ss):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},ls=["top","right","bottom","left","width","height","size","weight"],cs="undefined"!=typeof MutationObserver,hs=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,r=0;function o(){i&&(i=!1,t()),n&&a()}function s(){as(o)}function a(){var t=Date.now();if(i){if(t-r<2)return;n=!0}else i=!0,n=!1,setTimeout(s,20);r=t}return a}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){os&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),cs?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){os&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;ls.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),us=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},ds=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||ss},fs=bs(0,0,0,0);function ps(t){return parseFloat(t)||0}function gs(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+ps(t["border-"+i+"-width"])}),0)}var ms="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof ds(t).SVGGraphicsElement}:function(t){return t instanceof ds(t).SVGElement&&"function"==typeof t.getBBox};function bs(t,e,i,n){return{x:t,y:e,width:i,height:n}}var vs=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=bs(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t,e=(t=this.target,os?ms(t)?function(t){var e=t.getBBox();return bs(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return fs;var n=ds(t).getComputedStyle(t),r=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var r=n[i];e[r]=ps(t["padding-"+r])}return e}(n),o=r.left+r.right,s=r.top+r.bottom,a=ps(n.width),l=ps(n.height);if("border-box"===n.boxSizing&&(Math.round(a+o)!==e&&(a-=gs(n,"left","right")+o),Math.round(l+s)!==i&&(l-=gs(n,"top","bottom")+s)),!function(t){return t===ds(t).document.documentElement}(t)){var c=Math.round(a+o)-e,h=Math.round(l+s)-i;1!==Math.abs(c)&&(a-=c),1!==Math.abs(h)&&(l-=h)}return bs(r.left,r.top,a,l)}(t):fs);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),ys=function(t,e){var i,n,r,o,s,a,l,c=(n=(i=e).x,r=i.y,o=i.width,s=i.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),us(l,{x:n,y:r,width:o,height:s,top:r,right:n+o,bottom:s+r,left:n}),l);us(this,{target:t,contentRect:c})},ws=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new rs,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof ds(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new vs(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof ds(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new ys(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),_s="undefined"!=typeof WeakMap?new WeakMap:new rs,xs=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=hs.getInstance(),n=new ws(e,i,this);_s.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){xs.prototype[t]=function(){var e;return(e=_s.get(this))[t].apply(e,arguments)}}));var Ss=void 0!==ss.ResizeObserver?ss.ResizeObserver:xs;let Is=(()=>{class t{constructor(){this.elementSubjects=new Map,this.resizeObserver=new Ss(t=>{for(const i of t){var e=this.elementSubjects.get(i.target);if(null==e)return;e.next(i.contentRect)}})}listenToElementResize(t){this.resizeObserver.observe(t);const e=new kt.a;return this.elementSubjects.set(t,e),e}unListenToElementResize(t){this.elementSubjects.delete(t),this.resizeObserver.unobserve(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ks=i("EmTj"),Cs=i("NWgr"),Ps=i("v9BS"),As=i("nIj0"),Ms=i("PBFl");const Ts=["chart"],Es=["weightSlider"];function Os(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",7),s.cc("click",(function(){return s.wc(t),s.gc().disconnect()})),s.Gc(1,"Disconnect"),s.Ub()}}let Ds=(()=>{class t{constructor(t,e){this.bloomaResizeListenerService=t,this.dhDialogService=e,this._data=null,this.profileSelected=new s.p,this.itemWeightChanged=new s.p,this.childProfileWeightChanged=new s.p,this.addSubProfileToProfile=new s.p,this.addProfileItemToProfile=new s.p,this.addVirtualProfileItemToProfile=new s.p,this.disconnectLinkClicked=new s.p,this.treeItemDropped=new s.p,this.firstZoom=!0,this.sliderContainerStyle={width:"0",height:"0",padding:"0"},this.unsubscribe$=new kt.a,this.viewInitialized=!1,this.margin={top:10,bottom:20,left:150,right:10},this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.nodeSquareWidth=100,this.nodeSquareHeight=60,this.draggableSquareDimension=10,this.dragStartX=0,this.dragStartY=0,this.dragX=0,this.dragY=0,this.linkColor="gray",this.selectedNodeColor="green",this.clickedLinkSource=null,this.clickedLinkTarget=null,this.weightTargetType=null,this.clickedLinkEvent=null,this.sliderElementHeight=124,this.sliderElementWidth=124,this.previousGraphAreaTransform=null,this.profileRectBorderColor="red",this.virtualProfileRectBorderColor="blue",this.profileItemRectBorderColor="black",this.profileRectBackgroundColor="rgb(235,199,199)",this.profileItemRectBackgroundColor="rgb(185,244,185)",this.virtualProfileRectBackgroundColor="rgb(199,235,243)",this.svgBackgroundColor="rgb(219,219,219)",this.getSquareIdForId=t=>"r"+t.replace(/\./g,"_");const i=new kt.a;i.pipe(Object(Ct.a)(400),Object(Pt.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=i}get data(){return this._data}set data(t){this._data=t,this.createSubject.next()}get scores(){return this.scoresPrivate}set scores(t){this.scoresPrivate=t,setTimeout(()=>{this.createSubject.next()},100)}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Pt.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},250)}createChart(){if(!this.viewInitialized)return;if(!this.data)return;const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.initSvg(),this.setSvgHeight(),this.drawHierarchy(),this.setUpZoomBehavior(),this.zoomFit(),setTimeout(()=>{Object(s.mb)(this)},300))}initSvg(){if(!this.svg){const t=li(this.chartContainer.nativeElement).append("svg");t.style("background","rgb(245,245,245)"),t.attr("class","main-svg"),this.svg=t;const e=5,i=5,n=e/2,r=i/2,o=[[0,0],[0,5],[5,2.5]];this.svg.append("defs").append("marker").attr("id","arrow").attr("viewBox",[0,0,e,i]).attr("refX",n).attr("refY",r).attr("markerWidth",e).attr("markerHeight",i).attr("orient","auto-start-reverse").append("path").attr("d",zo()(o)).attr("stroke","black")}}setSvgHeight(){this.svg.attr("height",this.totalComponentHeight).attr("width",this.totalComponentWidth)}mouseOverProfile(t){this.dragTargetData=t}mouseLeaveProfile(t){this.dragTargetData=null}getDragBehavior(t){return Sr().clickDistance(15).container(t.node()).on("start",(t,e)=>{this.dragSourceType=e.data.itemType;const i="#"+this.getSquareIdForId(e.id),n=this.svg.select(i);if(null!=n&&0!=n.size()){this.dragSourceNode=n;try{const t=+n.attr("original-x"),e=+n.attr("original-y");this.dragX=this.dragStartX=t,this.dragY=this.dragStartY=e}catch(r){console.log(r)}t.sourceEvent.stopPropagation(),t.sourceEvent.preventDefault()}}).on("drag",(t,e)=>{if(0==this.dragStartX)return;this.dragX=t.x-t.subject.x,this.dragY=t.y-t.subject.y;const i=[[+this.dragStartX,+this.dragStartY],[this.dragStartX+this.dragX,this.dragStartY+this.dragY]],n=this.getDragLine(),r=zo();n.attr("d",r(i))}).on("end",()=>{if(this.removeDragLine(),this.dragStartX=0,this.dragStartY=0,null!=this.dragSourceNode&&null!=this.dragTargetData&&"profile"===this.dragTargetData.data.itemType)return"profile"==this.dragSourceType?void this.connectProfiles():"virtual"==this.dragSourceType?void this.copyVirtualProfileItem():void this.copyProfileItem()})}connectProfiles(){var t;const e=null===(t=this.dragSourceNode.datum())||void 0===t?void 0:t.id,i=this.dragTargetData.id;if(e==i)return;const n=this.profileMap[i];this.changeIntroducesCycle(this.profileMap[e],i)||n.parentIds.find(t=>t==e)||this.addSubProfileToProfile.next({parentProfileId:e,subProfileId:n.id})}copyVirtualProfileItem(){var t;const e=null===(t=this.dragSourceNode.datum())||void 0===t?void 0:t.id,i=this.dragTargetData.id;if(e==i)return;const n=this.profileMap[e];this.changeIntroducesCycle(n,i)||this.addVirtualProfileItemToProfile.next({profileId:i,virtualProfileItem:n})}copyProfileItem(){var t;const e=null===(t=this.dragSourceNode.datum())||void 0===t?void 0:t.id,i=this.dragTargetData.id;if(e==i)return;const n=this.profileMap[e];this.changeIntroducesCycle(n,i)||this.addProfileItemToProfile.next({profileId:i,profileItemName:n.originalName})}getRectColorForItemType(t){switch(t){case"profile":return this.profileRectBorderColor;case"virtual":return this.virtualProfileRectBorderColor;default:return this.profileItemRectBorderColor}}getRectBackgroundColorForItemType(t){switch(t){case"profile":return this.profileRectBackgroundColor;case"virtual":return this.virtualProfileRectBackgroundColor;default:return this.profileItemRectBackgroundColor}}isProfile(t){return"profile"===t}isVirtualProfile(t){return"virtual"===t}changeIntroducesCycle(t,e){if(null==t.parentIds)return!1;if(null==t?void 0:t.parentIds.find(t=>t==e))return!0;for(const i of null==t?void 0:t.parentIds)if(1==this.changeIntroducesCycle(this.profileMap[i],e))return!0;return!1}removeDragLine(){this.svg.select(".drag-line").remove(),this.dragLine=null}getDragLine(){return this.dragLine||(this.dragLine=this.svg.select(".graph-area").append("path").attr("class","drag-line").style("stroke","red").style("fill","none")),this.dragLine}drawHierarchy(){const t=this.svg.select(".graph-area");if(this.previousGraphAreaTransform=null,t.size()>0){const e=t.node();this.previousGraphAreaTransform=Yo(e)}this.svg.select(".graph-area").remove();const e=function(...t){if(t.length)throw Error(`got arguments to dagStratify(${t}), but constructor takes no aruguments. These were probably meant as data which should be called as dagStratify()(...)`);return function t(e,i,n){function r(t){if(!t.length)throw new Error("can't stratify empty data");const i=t.map((t,i)=>new f(function(t){if("string"!=typeof t)throw new Error("id is supposed to be string but got type "+typeof t);if(t.indexOf("\0")>=0)throw new Error(`node id ${t} contained null character`);return t}(e(t,i)),t)),r=new Map;i.forEach(t=>{if(r.has(t.id))throw new Error("found a duplicate id: "+t.id);r.set(t.id,t)});const o=[];return i.forEach((t,e)=>{const i=n(t.data,e)||[];i.forEach(([e,i])=>{const n=r.get(e);if(!n)throw new Error("missing id: "+e);return n.dataChildren.push(new u(t,i)),n}),i.length||o.push(t)}),function(t){if(!t.length)throw new Error("dag contained no roots");const e=new Set,i=new Set;let n=null;function r(t){if(e.has(t.id))return[];if(i.has(t.id))return n=t.id,[t.id];{i.add(t.id);let o=[];for(const e of t.ichildren())if(o=r(e),o.length)break;return i.delete(t.id),e.add(t.id),o.length&&null!==n&&o.push(t.id),n===t.id&&(n=null),o}}for(const o of t){const t=r(o);if(t.length)throw new Error("dag contained a cycle: "+t.reverse().join(" -> "))}for(const o of new p(t))if(new Set(o.ichildren().map(t=>t.id)).size!==o.dataChildren.length)throw new Error(`node '${o.id}' contained duplicate children`)}(o),o.length>1?new p(o):o[0]}return r.id=function(r){return void 0===r?e:t(r,i,n)},r.parentData=function(i){return void 0===i?n:t(e,function(t){function e(e,i){return(t(e,i)||[]).map(([t])=>t)}return e.wrapped=t,e}(i),i)},r.parentIds=function(n){return void 0===n?i:t(e,n,g(n))},r}(m,b,g(b))}();if(!this.data||0==this.data.length)return;let i;try{i=e(this.data)}catch(c){return void this.dhDialogService.showMessage("error with local profile data. Please refresh")}const n=xt().nodeSize([150,390])(i),r=this.svg.append("g").attr("class","graph-area"),o=n.descendants(),s=this.getDragBehavior(r),a=r.append("g").attr("class","links-group"),l=n.links();a.selectAll("line").data(l).enter().append("line").attr("class","line").attr("stroke",this.linkColor).attr("stroke-width","5").attr("marker-end","url(#arrow)").attr("data-id-source",t=>this.getSquareIdForId(t.source.id)).attr("data-id-target",t=>this.getSquareIdForId(t.target.id)).attr("x1",t=>this.margin.left+t.source.y).attr("y1",t=>this.margin.top+t.source.x).attr("y2",t=>this.margin.top+t.target.x).on("mouseover",(t,e)=>{li(t.srcElement).attr("stroke","red")}).on("mouseout",(t,e)=>{li(t.srcElement).attr("stroke",this.linkColor)}).on("click",(t,e)=>{this.isVirtualProfile(e.target.data.itemType)||(this.clickedLinkSource=e.source.id,this.clickedLinkTarget=e.target.data.originalId,this.weightTargetType="profile"===e.target.data.itemType?"childProfile":"item",this.clickedLinkEvent=t,li(t.srcElement).attr("stroke",this.linkColor),this.showWeightSlider())}).each((t,e,i)=>{const n=li(i[e]),r=this.calculateTargetBoxWidth(t.target.data.name);n.attr("x2",this.margin.left+t.target.y-r/2-5)}),r.append("g").attr("class","nodes-group").selectAll("g.node").data(o).enter().append("g").attr("class","node").attr("transform",t=>`translate(${this.margin.left+t.y},${this.margin.top+t.x})`).on("click",(t,e)=>{this.setSelectedNode(e,t)}).each((t,e,i)=>{const n=li(i[e]);let r=this.drawRectNode(n,t.id),{width:o,height:a}=this.drawText(n,t.data.name);this.setRectWidthAndHeight(r,o,a,t.x,t.y),this.drawDraggableCircle(n,t.id,o,s),this.setRectMouseEvents(r),this.drawScoresTextForNode(n,t.data)})}drawScoresTextForNode(t,e){var i,n,r,o,s,a,l;if(null!=this.scores[this.selectedProfileId])if("profile"==e.itemType)if(0!=e.publicProfile||null!=e.parentIds&&0!=e.parentIds.length){const i=null===(s=null===(o=this.scores[this.selectedProfileId])||void 0===o?void 0:o.map)||void 0===s?void 0:s.profileScores[e.id];this.drawScoresText(t,null==i?void 0:i.score)}else this.drawScoresText(t,null===(r=null===(n=null===(i=this.scores[e.id])||void 0===i?void 0:i.map)||void 0===n?void 0:n.rootScore)||void 0===r?void 0:r.totalScore);else if("virtual"!=e.itemType){const i=null===(l=null===(a=this.scores[this.selectedProfileId])||void 0===a?void 0:a.map)||void 0===l?void 0:l.profileItemScores[e.id];this.drawScoresText(t,null==i?void 0:i.score)}}drawScoresText(t,e){null!=e&&t.append("text").attr("class","svg-text score-text").attr("dx",-40).attr("dy",-40).text(e)}setRectWidthAndHeight(t,e,i,n,r){t.attr("x",0-e/2).attr("y",-i/2).attr("width",e).attr("original-x",this.margin.left+r+e/2).attr("original-y",this.margin.top+n).attr("height",i)}setRectMouseEvents(t){t.attr("pointer-events","mouseover").on("mouseover",(t,e)=>{0!=this.dragStartX&&"profile"==e.data.itemType&&(t.target.setAttribute("stroke","red"),t.target.setAttribute("stroke-width",5),this.mouseOverProfile(e))}).on("mouseout",(t,e)=>{null!=t.fromElement&&null!=t.toElement&&(t.fromElement.parentElement==t.toElement.parentElement&&"circle"!=t.toElement.tagName||(e.id!==this.selectedProfileId&&(t.target.setAttribute("stroke-width",1),t.target.setAttribute("stroke",this.getRectColorForItemType(e.data.itemType))),this.mouseLeaveProfile(e)))})}drawRectNode(t,e){return t.append("rect").attr("id",this.getSquareIdForId(e)).attr("fill",t=>this.getRectBackgroundColorForItemType(t.data.itemType)).attr("stroke",t=>this.getRectColorForItemType(t.data.itemType)).attr("class","profile-container").attr("rx",15).classed("item-type-profile",t=>this.isProfile(t.data.itemType))}drawText(t,e){let i=t.append("text").attr("class","svg-text container-text").attr("dx",10).text(e).on("click",(t,e)=>{const i=new Event("click",{});t.srcElement.parentElement.firstChild.dispatchEvent(i)});const n=i.node().getBBox(),r=Mt([n.width+20,this.nodeSquareWidth]),o=Mt([n.height,this.nodeSquareHeight]);return i.attr("x",0-r/2),{width:r,height:o}}drawDraggableCircle(t,e,i,n){t.append("circle").attr("id","c"+e).attr("fill","purple").attr("r","8").attr("cx",i/2).attr("cy",0).attr("stroke","purple").call(n)}calculateTargetBoxWidth(t){const e=this.svg.append("text").attr("class","svg-text-to-remove").attr("dx",10).text(t),i=Mt([e.node().getBBox().width+20,this.nodeSquareWidth]);return e.remove(),i}setSelectedNode(t,e){var i,n;this.setSelectedProfile(t),(".profile-container",new oi([document.querySelectorAll(".profile-container")],[document.documentElement])).attr("stroke",t=>this.getRectColorForItemType(t.data.itemType)),li(null===(n=null===(i=null==e?void 0:e.srcElement)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.firstElementChild).attr("stroke",this.selectedNodeColor)}saveNewWeight(){if(this.hideWeightSlider(),"item"==this.weightTargetType){const t=(new ns).transform(this.clickedLinkSource,this.profileMap);this.itemWeightChanged.next({profileId:t,updateProfileItemWeightDto:{newWeight:this.selectedWeight,profileItemName:this.clickedLinkTarget}})}else this.childProfileWeightChanged.next({profileId:this.clickedLinkSource,subProfileId:this.clickedLinkTarget,updateSubProfileWeightDto:{newWeight:this.selectedWeight}})}hideWeightSlider(){li(this.weightSliderContainer.nativeElement).transition().duration(200).style("opacity",0),this.sliderContainerStyle={width:"0",height:"0",padding:"0"}}disconnect(){this.hideWeightSlider(),this.disconnectLinkClicked.next({profileId:this.clickedLinkSource,childProfileToDelete:this.clickedLinkTarget})}showWeightSlider(){var t;this.selectedWeight=null!==(t=this.getLinkWeight(this.clickedLinkSource,this.clickedLinkTarget))&&void 0!==t?t:0;const e=li(this.weightSliderContainer.nativeElement),i=this.selectTopForSlider(),n=this.selectLeftForSlider();this.sliderContainerStyle={width:"300px",left:n+"px",top:i+"px",padding:"10px"},e.transition().duration(200).style("opacity",1),Object(s.mb)(this)}selectTopForSlider(){return this.clickedLinkEvent.y+this.sliderElementHeight>=this.totalComponentHeight?this.totalComponentHeight-130:this.clickedLinkEvent.y}selectLeftForSlider(){return this.clickedLinkEvent.x+this.sliderElementWidth>=this.totalComponentWidth?this.totalComponentWidth-this.sliderElementWidth-10:this.clickedLinkEvent.x}weightChanged(t){this.selectedWeight=t.value}getLinkWeight(t,e){const i=(new ns).transform(t,this.profileMap),n=this.weights[i];let r=n[e];r||(r=n[e.toUpperCase()]);const o=e.indexOf("_");return!r&&o>-1&&(r=n[e=e.substr(o+1)]),r}setUpZoomBehavior(){if(!this.data||0==this.data.length)return;const t=this.svg.select(".graph-area"),e=this.svg.select(".nodes-group").node();if(null==e)return;const i=e.getBBox(),n=[[0,0],[Tt([this.totalComponentWidth,i.width+this.margin.left+100]),Tt([this.totalComponentHeight,i.height])]],r=[[0,-100],[i.width+this.margin.left+100,i.height]],o=function(){var t,e,i,n=Qo,r=Zo,o=is,s=ts,a=es,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],h=250,u=Go,d=qt("start","zoom","end"),f=500,p=0,g=10;function m(t){t.property("__zoom",Ko).on("wheel.zoom",S).on("mousedown.zoom",I).on("dblclick.zoom",k).filter(a).on("touchstart.zoom",C).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new $o(e,t.x,t.y)}function v(t,e,i){var n=e[0]-i[0]*t.k,r=e[1]-i[1]*t.k;return n===t.x&&r===t.y?t:new $o(t.k,n,r)}function y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,i,n){t.on("start.zoom",(function(){_(this,arguments).event(n).start()})).on("interrupt.zoom end.zoom",(function(){_(this,arguments).event(n).end()})).tween("zoom",(function(){var t=this,o=arguments,s=_(t,o).event(n),a=r.apply(t,o),l=null==i?y(a):"function"==typeof i?i.apply(t,o):i,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),h=t.__zoom,d="function"==typeof e?e.apply(t,o):e,f=u(h.invert(l).concat(c/h.k),d.invert(l).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=f(t),i=c/e[2];t=new $o(i,l[0]-e[0]*i,l[1]-e[1]*i)}s.zoom(null,t)}}))}function _(t,e,i){return!i&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function S(t,...e){if(n.apply(this,arguments)){var i=_(this,e).event(t),r=this.__zoom,a=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,s.apply(this,arguments)))),h=an(t);if(i.wheel)i.mouse[0][0]===h[0]&&i.mouse[0][1]===h[1]||(i.mouse[1]=r.invert(i.mouse[0]=h)),clearTimeout(i.wheel);else{if(r.k===a)return;i.mouse=[h,r.invert(h)],En(this),i.start()}Xo(t),i.wheel=setTimeout(u,150),i.zoom("mouse",o(v(b(r,a),i.mouse[0],i.mouse[1]),i.extent,c))}function u(){i.wheel=null,i.end()}}function I(t,...e){if(!i&&n.apply(this,arguments)){var r=_(this,e,!0).event(t),s=li(t.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",f,!0),a=an(t,l),l=t.currentTarget,h=t.clientX,u=t.clientY;ui(t.view),Jo(t),r.mouse=[a,this.__zoom.invert(a)],En(this),r.start()}function d(t){if(Xo(t),!r.moved){var e=t.clientX-h,i=t.clientY-u;r.moved=e*e+i*i>p}r.event(t).zoom("mouse",o(v(r.that.__zoom,r.mouse[0]=an(t,l),r.mouse[1]),r.extent,c))}function f(t){s.on("mousemove.zoom mouseup.zoom",null),di(t.view,r.moved),Xo(t),r.event(t).end()}}function k(t,...e){if(n.apply(this,arguments)){var i=this.__zoom,s=an(t.changedTouches?t.changedTouches[0]:t,this),a=i.invert(s),l=o(v(b(i,i.k*(t.shiftKey?.5:2)),s,a),r.apply(this,e),c);Xo(t),h>0?li(this).transition().duration(h).call(w,l,s,t):li(this).call(m.transform,l,s,t)}}function C(i,...r){if(n.apply(this,arguments)){var o,s,a,l,c=i.touches,h=c.length,u=_(this,r,i.changedTouches.length===h).event(i);for(Jo(i),s=0;s<h;++s)l=[l=an(a=c[s],this),this.__zoom.invert(l),a.identifier],u.touch0?u.touch1||u.touch0[2]===l[2]||(u.touch1=l,u.taps=0):(u.touch0=l,o=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(u.taps<2&&(e=l[0],t=setTimeout((function(){t=null}),f)),En(this),u.start())}}function P(t,...e){if(this.__zooming){var i,n,r,s,a=_(this,e).event(t),l=t.changedTouches,h=l.length;for(Xo(t),i=0;i<h;++i)r=an(n=l[i],this),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=r);if(n=a.that.__zoom,a.touch1){var u=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],g=(g=f[0]-u[0])*g+(g=f[1]-u[1])*g,m=(m=p[0]-d[0])*m+(m=p[1]-d[1])*m;n=b(n,Math.sqrt(g/m)),r=[(u[0]+f[0])/2,(u[1]+f[1])/2],s=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(v(n,r,s),a.extent,c))}}function A(t,...n){if(this.__zooming){var r,o,s=_(this,n).event(t),a=t.changedTouches,l=a.length;for(Jo(t),i&&clearTimeout(i),i=setTimeout((function(){i=null}),f),r=0;r<l;++r)o=a[r],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=an(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<g)){var c=li(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return m.transform=function(t,e,i,n){var r=t.selection?t.selection():t;r.property("__zoom",Ko),t!==r?w(t,e,i,n):r.interrupt().each((function(){_(this,arguments).event(n).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,i,n){m.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),i,n)},m.scaleTo=function(t,e,i,n){m.transform(t,(function(){var t=r.apply(this,arguments),n=this.__zoom,s=null==i?y(t):"function"==typeof i?i.apply(this,arguments):i,a=n.invert(s),l="function"==typeof e?e.apply(this,arguments):e;return o(v(b(n,l),s,a),t,c)}),i,n)},m.translateBy=function(t,e,i,n){m.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof i?i.apply(this,arguments):i),r.apply(this,arguments),c)}),null,n)},m.translateTo=function(t,e,i,n,s){m.transform(t,(function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==n?y(t):"function"==typeof n?n.apply(this,arguments):n;return o(qo.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof i?-i.apply(this,arguments):-i),t,c)}),n,s)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=li(this.that).datum();d.call(t,this.that,new Ho(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:d}),e)}},m.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:Wo(+t),m):s},m.filter=function(t){return arguments.length?(n="function"==typeof t?t:Wo(!!t),m):n},m.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Wo(!!t),m):a},m.extent=function(t){return arguments.length?(r="function"==typeof t?t:Wo([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):r},m.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],m):[l[0],l[1]]},m.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(t){return arguments.length?(o=t,m):o},m.duration=function(t){return arguments.length?(h=+t,m):h},m.interpolate=function(t){return arguments.length?(u=t,m):u},m.on=function(){var t=d.on.apply(d,arguments);return t===d?m:t},m.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,m):Math.sqrt(p)},m.tapDistance=function(t){return arguments.length?(g=+t,m):g},m}().scaleExtent([.1,10]).extent(n).translateExtent(r).on("zoom",e=>{t.attr("transform",e.transform)});if(this.zoomBehavior=o,this.svg.call(o),this.previousGraphAreaTransform){if(1==this.previousGraphAreaTransform.k&&0==this.previousGraphAreaTransform.y&&0==this.previousGraphAreaTransform.x)return;this.svg.call(o.transform,this.previousGraphAreaTransform)}}setSelectedProfile(t){this.profileSelected.next({selectedNodeId:t.id,nodeType:t.data.itemType})}onDrop(t){if(null==t.event.target)return;const e=t.event.target.classList.contains("main-svg")?"independent":"sub",i="independent"===e?null:t.event.target.id.substring(1);this.treeItemDropped.next({dropTargetType:e,dropTargetId:i,droppedData:[t.element.data]})}allowDrop(t,e){var i,n,r;return!!(null===(i=e.target)||void 0===i?void 0:i.classList.contains("item-type-profile"))||!!(null===(r=null===(n=e.target)||void 0===n?void 0:n.previousSibling)||void 0===r?void 0:r.classList.contains("item-type-profile"))}zoomFit(){if(!this.firstZoom)return;const t=this.svg.select(".graph-area");if(!t)return;let e=t.node();if(!e)return;this.firstZoom=!1;const i=e.getBBox(),n=e.parentElement,r=n.clientWidth,o=n.clientHeight,s=i.width,a=i.height,l=i.x+s/2,c=i.y+a/2;if(0==s||0==a)return;const h=.8/Math.max(s/r,a/o),u=[r/2-h*l,o/2-h*c];this.svg.call(this.zoomBehavior.transform,qo.translate(u[0],u[1]).scale(h))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Is),s.Pb(ks.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-hierarchy"]],viewQuery:function(t,e){if(1&t&&(s.Jc(Ts,!0),s.Jc(Es,!0)),2&t){let t;s.tc(t=s.dc())&&(e.chartContainer=t.first),s.tc(t=s.dc())&&(e.weightSliderContainer=t.first)}},inputs:{data:"data",weights:"weights",profileMap:"profileMap",selectedProfileId:"selectedProfileId",scores:"scores"},outputs:{profileSelected:"profileSelected",itemWeightChanged:"itemWeightChanged",childProfileWeightChanged:"childProfileWeightChanged",addSubProfileToProfile:"addSubProfileToProfile",addProfileItemToProfile:"addProfileItemToProfile",addVirtualProfileItemToProfile:"addVirtualProfileItemToProfile",disconnectLinkClicked:"disconnectLinkClicked",treeItemDropped:"treeItemDropped"},decls:13,vars:5,consts:[["id","hierarchy-graph",1,"hierarchy-graph",3,"treeAllowDrop","treeDrop"],["chart",""],["id","weight-slider",1,"overflow-hidden",3,"ngStyle"],["weightSlider",""],["min","1","max","100","step","1",3,"ngModel","ngModelChange","input"],[1,"flex"],["mat-flat-button","","color","primary",1,"mx-2",3,"click"],["mat-flat-button","","color","warn",1,"mx-2",3,"click"],["class","mx-2","mat-flat-button","","color","warn",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(s.Vb(0,"div",0,1),s.cc("treeDrop",(function(t){return e.onDrop(t)})),s.Ub(),s.Vb(2,"div",2,3),s.Vb(4,"div"),s.Gc(5),s.Ub(),s.Vb(6,"mat-slider",4),s.cc("ngModelChange",(function(t){return e.selectedWeight=t}))("input",(function(t){return e.weightChanged(t)})),s.Ub(),s.Vb(7,"div",5),s.Vb(8,"button",6),s.cc("click",(function(){return e.saveNewWeight()})),s.Gc(9,"Save"),s.Ub(),s.Vb(10,"button",7),s.cc("click",(function(){return e.hideWeightSlider()})),s.Gc(11,"Cancel"),s.Ub(),s.Ec(12,Os,2,0,"button",8),s.Ub(),s.Ub()),2&t&&(s.mc("treeAllowDrop",e.allowDrop.bind(e)),s.Db(2),s.mc("ngStyle",e.sliderContainerStyle),s.Db(3),s.Ic("Weight: ",e.selectedWeight,""),s.Db(1),s.mc("ngModel",e.selectedWeight),s.Db(6),s.mc("ngIf","childProfile"==e.weightTargetType))},directives:[Cs.b,n.n,Ps.a,As.j,As.m,Ms.b,n.m],styles:[".hierarchy-graph{height:inherit;width:inherit}.hierarchy-graph .svg-text{pointer-events:none;-webkit-user-select:none;user-select:none}.hierarchy-graph .score-text{fill:red;font-size:20px;font-weight:500;border:1px solid #000;font-style:italic}.hierarchy-graph svg{background:#d3d3d3}#weight-slider{background-color:#fff;color:#000;position:absolute;opacity:0;width:0}#weight-slider mat-slider{width:100%}"],encapsulation:2}),t})(),zs=(()=>{class t{transform(t,e){var i;if(null==t||(null===(i=null==t?void 0:t.childrenIds)||void 0===i?void 0:i.length)<1)return null;if(null==e)return null;var n=[];for(const r of null==t?void 0:t.childrenIds)this.addVirtualNodesToSubElements(n,r,e);return n}addVirtualNodesToSubElements(t,e,i){var n=i[e];if(null!=n)if("virtual"==(null==n?void 0:n.itemType))for(const r of null==n?void 0:n.childrenIds)this.addVirtualNodesToSubElements(t,r,i);else t.push(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"getRealSubItems",type:t,pure:!0}),t})();var Vs=i("jOdJ"),Bs=i("xJCX"),Rs=i("dgVI"),js=i("yDe4"),Fs=i("oYEq"),Ls=i("pLgK");let Ns=(()=>{class t{constructor(t){this.store=t}updateItemLinkWeight(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new Fs.e(t)).toPromise(),!!this.store.selectSnapshot(Ls.a.getUpdateItemWeightStatus)}))}updateSubElementsWeights(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.store.dispatch(new Fs.d(t)).toPromise(),!!this.store.selectSnapshot(Ls.a.getUpdateChildWeightStatus)}))}getProfileWeights(t){return this.store.selectSnapshot(Ls.a.getState).weights[t]}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(js.j))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(js.f)(Ls.a.getState)],t.prototype,"weightState$",void 0),t})();var Us=i("HOZh"),Gs=i("yD3o"),Ws=i("P/uR"),Hs=i("1Ups");let $s=(()=>{class t{constructor(t){this.store=t}getForms(){return this.store.selectSnapshot(Hs.a.getForms)}clearForms(){return Object(o.a)(this,void 0,void 0,(function*(){yield this.store.dispatch(new Ws.b({path:"selectionActions.profileNameForm"})).toPromise(),yield this.store.dispatch(new Ws.b({path:"selectionActions.profileItemForm"})).toPromise(),yield this.store.dispatch(new Ws.b({path:"selectionActions.subProfileWeightForm"})).toPromise()}))}updateScoreItems(t){return Object(o.a)(this,void 0,void 0,(function*(){yield this.store.dispatch(new Ws.c({path:"selectionActions.profileItemForm",value:t,propertyPath:"valueScores"})).toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(js.j))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(js.f)(Hs.a.getAction)],t.prototype,"action$",void 0),Object(o.b)([Object(js.f)(Hs.a.getScores)],t.prototype,"scores$",void 0),t})();var qs=i("OZ4H"),Ys=i("+T6E"),Js=i("qU21"),Xs=i("2Bju"),Qs=i("IdLP");const Zs=["gutterEls"];function Ks(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",2,3),s.cc("mousedown",(function(e){s.wc(t);const i=s.gc().index;return s.gc().startDragging(e,2*i+1,i+1)}))("touchstart",(function(e){s.wc(t);const i=s.gc().index;return s.gc().startDragging(e,2*i+1,i+1)}))("mouseup",(function(e){s.wc(t);const i=s.gc().index;return s.gc().clickGutter(e,i+1)}))("touchend",(function(e){s.wc(t);const i=s.gc().index;return s.gc().clickGutter(e,i+1)})),s.Qb(2,"div",4),s.Ub()}if(2&t){const t=s.gc().index,e=s.gc();s.Bc("flex-basis",e.gutterSize,"px")("order",2*t+1)}}function ta(t,e){1&t&&s.Ec(0,Ks,3,4,"div",1),2&t&&s.mc("ngIf",!1===e.last)}const ea=["*"];function ia(t){return void 0!==t.changedTouches&&t.changedTouches.length>0?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:void 0!==t.clientX&&void 0!==t.clientY?{x:t.clientX,y:t.clientY}:null}function na(t,e){const i=t.nativeElement.getBoundingClientRect();return"horizontal"===e?i.width:i.height}function ra(t){return"boolean"==typeof t?t:"false"!==t}function oa(t,e){return null==t?e:(t=Number(t),!isNaN(t)&&t>=0?t:e)}function sa(t,e){if("percent"===t){const t=e.reduce((t,e)=>null!==e?t+e:t,0);return e.every(t=>null!==t)&&t>99.9&&t<100.1}if("pixel"===t)return 1===e.filter(t=>null===t).length}function aa(t){return null===t.size?null:!0===t.component.lockSize?t.size:null===t.component.minSize?null:t.component.minSize>t.size?t.size:t.component.minSize}function la(t){return null===t.size?null:!0===t.component.lockSize?t.size:null===t.component.maxSize?null:t.component.maxSize<t.size?t.size:t.component.maxSize}function ca(t,e,i,n){return e.reduce((e,i)=>{const r=function(t,e,i,n){return 0===i?{areaSnapshot:e,pixelAbsorb:0,percentAfterAbsorption:e.sizePercentAtStart,pixelRemain:0}:0===e.sizePixelAtStart&&i<0?{areaSnapshot:e,pixelAbsorb:0,percentAfterAbsorption:0,pixelRemain:i}:"percent"===t?function(t,e,i){const n=(t.sizePixelAtStart+e)/i*100;if(e>0){if(null!==t.area.maxSize&&n>t.area.maxSize){const n=t.area.maxSize/100*i;return{areaSnapshot:t,pixelAbsorb:n,percentAfterAbsorption:t.area.maxSize,pixelRemain:t.sizePixelAtStart+e-n}}return{areaSnapshot:t,pixelAbsorb:e,percentAfterAbsorption:n>100?100:n,pixelRemain:0}}if(e<0){if(null!==t.area.minSize&&n<t.area.minSize){const n=t.area.minSize/100*i;return{areaSnapshot:t,pixelAbsorb:n,percentAfterAbsorption:t.area.minSize,pixelRemain:t.sizePixelAtStart+e-n}}return n<0?{areaSnapshot:t,pixelAbsorb:-t.sizePixelAtStart,percentAfterAbsorption:0,pixelRemain:e+t.sizePixelAtStart}:{areaSnapshot:t,pixelAbsorb:e,percentAfterAbsorption:n,pixelRemain:0}}}(e,i,n):"pixel"===t?function(t,e,i){const n=t.sizePixelAtStart+e;return e>0?null!==t.area.maxSize&&n>t.area.maxSize?{areaSnapshot:t,pixelAbsorb:t.area.maxSize-t.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:n-t.area.maxSize}:{areaSnapshot:t,pixelAbsorb:e,percentAfterAbsorption:-1,pixelRemain:0}:e<0?null!==t.area.minSize&&n<t.area.minSize?{areaSnapshot:t,pixelAbsorb:t.area.minSize+e-n,percentAfterAbsorption:-1,pixelRemain:n-t.area.minSize}:n<0?{areaSnapshot:t,pixelAbsorb:-t.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:e+t.sizePixelAtStart}:{areaSnapshot:t,pixelAbsorb:e,percentAfterAbsorption:-1,pixelRemain:0}:void 0}(e,i):void 0}(t,i,e.remain,n);return e.list.push(r),e.remain=r.pixelRemain,e},{remain:i,list:[]})}function ha(t,e){"percent"===t?e.areaSnapshot.area.size=e.percentAfterAbsorption:"pixel"===t&&null!==e.areaSnapshot.area.size&&(e.areaSnapshot.area.size=e.areaSnapshot.sizePixelAtStart+e.pixelAbsorb)}let ua=(()=>{class t{constructor(t,e,i,n){this.ngZone=t,this.elRef=e,this.cdRef=i,this.renderer=n,this._direction="horizontal",this._unit="percent",this._gutterSize=11,this._gutterStep=1,this._restrictMove=!1,this._useTransition=!1,this._disabled=!1,this._dir="ltr",this._gutterDblClickDuration=0,this.dragStart=new s.p(!1),this.dragEnd=new s.p(!1),this.gutterClick=new s.p(!1),this.gutterDblClick=new s.p(!1),this.dragProgressSubject=new kt.a,this.dragProgress$=this.dragProgressSubject.asObservable(),this.isDragging=!1,this.isWaitingClear=!1,this.dragListeners=[],this.snapshot=null,this.startPoint=null,this.endPoint=null,this.displayedAreas=[],this.hidedAreas=[],this._clickTimeout=null,this.direction=this._direction}set direction(t){this._direction="vertical"===t?"vertical":"horizontal",this.renderer.addClass(this.elRef.nativeElement,"as-"+this._direction),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("vertical"===this._direction?"horizontal":"vertical")),this.build(!1,!1)}get direction(){return this._direction}set unit(t){this._unit="pixel"===t?"pixel":"percent",this.renderer.addClass(this.elRef.nativeElement,"as-"+this._unit),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("pixel"===this._unit?"percent":"pixel")),this.build(!1,!0)}get unit(){return this._unit}set gutterSize(t){this._gutterSize=oa(t,11),this.build(!1,!1)}get gutterSize(){return this._gutterSize}set gutterStep(t){this._gutterStep=oa(t,1)}get gutterStep(){return this._gutterStep}set restrictMove(t){this._restrictMove=ra(t)}get restrictMove(){return this._restrictMove}set useTransition(t){this._useTransition=ra(t),this._useTransition?this.renderer.addClass(this.elRef.nativeElement,"as-transition"):this.renderer.removeClass(this.elRef.nativeElement,"as-transition")}get useTransition(){return this._useTransition}set disabled(t){this._disabled=ra(t),this._disabled?this.renderer.addClass(this.elRef.nativeElement,"as-disabled"):this.renderer.removeClass(this.elRef.nativeElement,"as-disabled")}get disabled(){return this._disabled}set dir(t){this._dir="rtl"===t?"rtl":"ltr",this.renderer.setAttribute(this.elRef.nativeElement,"dir",this._dir)}get dir(){return this._dir}set gutterDblClickDuration(t){this._gutterDblClickDuration=oa(t,0)}get gutterDblClickDuration(){return this._gutterDblClickDuration}get transitionEnd(){return new Qs.a(t=>this.transitionEndSubscriber=t).pipe(Object(Ct.a)(20))}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>this.renderer.addClass(this.elRef.nativeElement,"as-init"))})}getNbGutters(){return 0===this.displayedAreas.length?0:this.displayedAreas.length-1}addArea(t){const e={component:t,order:0,size:0,minSize:null,maxSize:null};!0===t.visible?(this.displayedAreas.push(e),this.build(!0,!0)):this.hidedAreas.push(e)}removeArea(t){if(this.displayedAreas.some(e=>e.component===t)){const e=this.displayedAreas.find(e=>e.component===t);this.displayedAreas.splice(this.displayedAreas.indexOf(e),1),this.build(!0,!0)}else if(this.hidedAreas.some(e=>e.component===t)){const e=this.hidedAreas.find(e=>e.component===t);this.hidedAreas.splice(this.hidedAreas.indexOf(e),1)}}updateArea(t,e,i){!0===t.visible&&this.build(e,i)}showArea(t){const e=this.hidedAreas.find(e=>e.component===t);if(void 0===e)return;const i=this.hidedAreas.splice(this.hidedAreas.indexOf(e),1);this.displayedAreas.push(...i),this.build(!0,!0)}hideArea(t){const e=this.displayedAreas.find(e=>e.component===t);if(void 0===e)return;const i=this.displayedAreas.splice(this.displayedAreas.indexOf(e),1);i.forEach(t=>{t.order=0,t.size=0}),this.hidedAreas.push(...i),this.build(!0,!0)}getVisibleAreaSizes(){return this.displayedAreas.map(t=>null===t.size?"*":t.size)}setVisibleAreaSizes(t){if(t.length!==this.displayedAreas.length)return!1;const e=t.map(t=>oa(t,null));return!1!==sa(this.unit,e)&&(this.displayedAreas.forEach((t,i)=>t.component._size=e[i]),this.build(!1,!0),!0)}build(t,e){if(this.stopDragging(),!0===t&&(this.displayedAreas.every(t=>null!==t.component.order)&&this.displayedAreas.sort((t,e)=>t.component.order-e.component.order),this.displayedAreas.forEach((t,e)=>{t.order=2*e,t.component.setStyleOrder(t.order)})),!0===e){const t=sa(this.unit,this.displayedAreas.map(t=>t.component.size));switch(this.unit){case"percent":{const e=100/this.displayedAreas.length;this.displayedAreas.forEach(i=>{i.size=t?i.component.size:e,i.minSize=aa(i),i.maxSize=la(i)});break}case"pixel":if(t)this.displayedAreas.forEach(t=>{t.size=t.component.size,t.minSize=aa(t),t.maxSize=la(t)});else{const t=this.displayedAreas.filter(t=>null===t.component.size);if(0===t.length&&this.displayedAreas.length>0)this.displayedAreas.forEach((t,e)=>{t.size=0===e?null:t.component.size,t.minSize=0===e?null:aa(t),t.maxSize=0===e?null:la(t)});else if(t.length>1){let t=!1;this.displayedAreas.forEach(e=>{null===e.component.size?!1===t?(e.size=null,e.minSize=null,e.maxSize=null,t=!0):(e.size=100,e.minSize=null,e.maxSize=null):(e.size=e.component.size,e.minSize=aa(e),e.maxSize=la(e))})}}}}this.refreshStyleSizes(),this.cdRef.markForCheck()}refreshStyleSizes(){if("percent"===this.unit)if(1===this.displayedAreas.length)this.displayedAreas[0].component.setStyleFlex(0,0,"100%",!1,!1);else{const t=this.getNbGutters()*this.gutterSize;this.displayedAreas.forEach(e=>{e.component.setStyleFlex(0,0,`calc( ${e.size}% - ${e.size/100*t}px )`,null!==e.minSize&&e.minSize===e.size,null!==e.maxSize&&e.maxSize===e.size)})}else"pixel"===this.unit&&this.displayedAreas.forEach(t=>{null===t.size?t.component.setStyleFlex(1,1,1===this.displayedAreas.length?"100%":"auto",!1,!1):1===this.displayedAreas.length?t.component.setStyleFlex(0,0,"100%",!1,!1):t.component.setStyleFlex(0,0,t.size+"px",null!==t.minSize&&t.minSize===t.size,null!==t.maxSize&&t.maxSize===t.size)})}clickGutter(t,e){const i=ia(t);this.startPoint&&this.startPoint.x===i.x&&this.startPoint.y===i.y&&(null!==this._clickTimeout?(window.clearTimeout(this._clickTimeout),this._clickTimeout=null,this.notify("dblclick",e),this.stopDragging()):this._clickTimeout=window.setTimeout(()=>{this._clickTimeout=null,this.notify("click",e),this.stopDragging()},this.gutterDblClickDuration))}startDragging(t,e,i){t.preventDefault(),t.stopPropagation(),this.startPoint=ia(t),null!==this.startPoint&&!0!==this.disabled&&!0!==this.isWaitingClear&&(this.snapshot={gutterNum:i,lastSteppedOffset:0,allAreasSizePixel:na(this.elRef,this.direction)-this.getNbGutters()*this.gutterSize,allInvolvedAreasSizePercent:100,areasBeforeGutter:[],areasAfterGutter:[]},this.displayedAreas.forEach(t=>{const i={area:t,sizePixelAtStart:na(t.component.elRef,this.direction),sizePercentAtStart:"percent"===this.unit?t.size:-1};t.order<e?!0===this.restrictMove?this.snapshot.areasBeforeGutter=[i]:this.snapshot.areasBeforeGutter.unshift(i):t.order>e&&(!0===this.restrictMove?0===this.snapshot.areasAfterGutter.length&&(this.snapshot.areasAfterGutter=[i]):this.snapshot.areasAfterGutter.push(i))}),this.snapshot.allInvolvedAreasSizePercent=[...this.snapshot.areasBeforeGutter,...this.snapshot.areasAfterGutter].reduce((t,e)=>t+e.sizePercentAtStart,0),0!==this.snapshot.areasBeforeGutter.length&&0!==this.snapshot.areasAfterGutter.length&&(this.dragListeners.push(this.renderer.listen("document","mouseup",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchend",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchcancel",this.stopDragging.bind(this))),this.ngZone.runOutsideAngular(()=>{this.dragListeners.push(this.renderer.listen("document","mousemove",this.dragEvent.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchmove",this.dragEvent.bind(this)))}),this.displayedAreas.forEach(t=>t.component.lockEvents()),this.isDragging=!0,this.renderer.addClass(this.elRef.nativeElement,"as-dragging"),this.renderer.addClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.notify("start",this.snapshot.gutterNum)))}dragEvent(t){if(t.preventDefault(),t.stopPropagation(),null!==this._clickTimeout&&(window.clearTimeout(this._clickTimeout),this._clickTimeout=null),!1===this.isDragging)return;if(this.endPoint=ia(t),null===this.endPoint)return;let e="horizontal"===this.direction?this.startPoint.x-this.endPoint.x:this.startPoint.y-this.endPoint.y;"rtl"===this.dir&&(e=-e);const i=Math.round(e/this.gutterStep)*this.gutterStep;if(i===this.snapshot.lastSteppedOffset)return;this.snapshot.lastSteppedOffset=i;let n=ca(this.unit,this.snapshot.areasBeforeGutter,-i,this.snapshot.allAreasSizePixel),r=ca(this.unit,this.snapshot.areasAfterGutter,i,this.snapshot.allAreasSizePixel);if(0!==n.remain&&0!==r.remain?Math.abs(n.remain)===Math.abs(r.remain)||(Math.abs(n.remain)>Math.abs(r.remain)?r=ca(this.unit,this.snapshot.areasAfterGutter,i+n.remain,this.snapshot.allAreasSizePixel):n=ca(this.unit,this.snapshot.areasBeforeGutter,-(i-r.remain),this.snapshot.allAreasSizePixel)):0!==n.remain?r=ca(this.unit,this.snapshot.areasAfterGutter,i+n.remain,this.snapshot.allAreasSizePixel):0!==r.remain&&(n=ca(this.unit,this.snapshot.areasBeforeGutter,-(i-r.remain),this.snapshot.allAreasSizePixel)),"percent"===this.unit){const t=[...n.list,...r.list],e=t.find(t=>0!==t.percentAfterAbsorption&&t.percentAfterAbsorption!==t.areaSnapshot.area.minSize&&t.percentAfterAbsorption!==t.areaSnapshot.area.maxSize);e&&(e.percentAfterAbsorption=this.snapshot.allInvolvedAreasSizePercent-t.filter(t=>t!==e).reduce((t,e)=>t+e.percentAfterAbsorption,0))}n.list.forEach(t=>ha(this.unit,t)),r.list.forEach(t=>ha(this.unit,t)),this.refreshStyleSizes(),this.notify("progress",this.snapshot.gutterNum)}stopDragging(t){if(t&&(t.preventDefault(),t.stopPropagation()),!1!==this.isDragging){for(this.displayedAreas.forEach(t=>t.component.unlockEvents());this.dragListeners.length>0;){const t=this.dragListeners.pop();t&&t()}this.isDragging=!1,!this.endPoint||this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y||this.notify("end",this.snapshot.gutterNum),this.renderer.removeClass(this.elRef.nativeElement,"as-dragging"),this.renderer.removeClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.snapshot=null,this.isWaitingClear=!0,this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.startPoint=null,this.endPoint=null,this.isWaitingClear=!1})})}}notify(t,e){const i=this.getVisibleAreaSizes();"start"===t?this.dragStart.emit({gutterNum:e,sizes:i}):"end"===t?this.dragEnd.emit({gutterNum:e,sizes:i}):"click"===t?this.gutterClick.emit({gutterNum:e,sizes:i}):"dblclick"===t?this.gutterDblClick.emit({gutterNum:e,sizes:i}):"transitionEnd"===t?this.transitionEndSubscriber&&this.ngZone.run(()=>this.transitionEndSubscriber.next(i)):"progress"===t&&this.dragProgressSubject.next({gutterNum:e,sizes:i})}ngOnDestroy(){this.stopDragging()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.B),s.Pb(s.m),s.Pb(s.i),s.Pb(s.G))},t.\u0275cmp=s.Jb({type:t,selectors:[["as-split"]],viewQuery:function(t,e){if(1&t&&s.Jc(Zs,!0),2&t){let t;s.tc(t=s.dc())&&(e.gutterEls=t)}},inputs:{direction:"direction",unit:"unit",gutterSize:"gutterSize",gutterStep:"gutterStep",restrictMove:"restrictMove",useTransition:"useTransition",disabled:"disabled",dir:"dir",gutterDblClickDuration:"gutterDblClickDuration"},outputs:{dragStart:"dragStart",dragEnd:"dragEnd",gutterClick:"gutterClick",gutterDblClick:"gutterDblClick",transitionEnd:"transitionEnd"},exportAs:["asSplit"],ngContentSelectors:ea,decls:2,vars:1,consts:[["ngFor","",3,"ngForOf"],["class","as-split-gutter",3,"flex-basis","order","mousedown","touchstart","mouseup","touchend",4,"ngIf"],[1,"as-split-gutter",3,"mousedown","touchstart","mouseup","touchend"],["gutterEls",""],[1,"as-split-gutter-icon"]],template:function(t,e){1&t&&(s.lc(),s.kc(0),s.Ec(1,ta,1,1,"ng-template",0)),2&t&&(s.Db(1),s.mc("ngForOf",e.displayedAreas))},directives:[n.l,n.m],styles:['[_nghost-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;width:100%;height:100%}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:0;background-color:#eee;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}[_nghost-%COMP%]    >.as-split-area{flex-grow:0;flex-shrink:0;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]    >.as-split-area.as-hidden{flex:0 1 0px!important;overflow-x:hidden;overflow-y:hidden}.as-horizontal[_nghost-%COMP%]{flex-direction:row}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:row;cursor:col-resize;height:100%}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}.as-horizontal[_nghost-%COMP%]    >.as-split-area{height:100%}.as-vertical[_nghost-%COMP%]{flex-direction:column}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:column;cursor:row-resize;width:100%}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC)}.as-vertical[_nghost-%COMP%]    >.as-split-area{width:100%}.as-vertical[_nghost-%COMP%]    >.as-split-area.as-hidden{max-width:0}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{cursor:default}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url("")}.as-transition.as-init[_nghost-%COMP%]:not(.as-dragging)    >.as-split-area, .as-transition.as-init[_nghost-%COMP%]:not(.as-dragging) > .as-split-gutter[_ngcontent-%COMP%]{transition:flex-basis .3s}'],changeDetection:0}),t})(),da=(()=>{class t{constructor(t,e,i,n){this.ngZone=t,this.elRef=e,this.renderer=i,this.split=n,this._order=null,this._size=null,this._minSize=null,this._maxSize=null,this._lockSize=!1,this._visible=!0,this.lockListeners=[],this.renderer.addClass(this.elRef.nativeElement,"as-split-area")}set order(t){this._order=oa(t,null),this.split.updateArea(this,!0,!1)}get order(){return this._order}set size(t){this._size=oa(t,null),this.split.updateArea(this,!1,!0)}get size(){return this._size}set minSize(t){this._minSize=oa(t,null),this.split.updateArea(this,!1,!0)}get minSize(){return this._minSize}set maxSize(t){this._maxSize=oa(t,null),this.split.updateArea(this,!1,!0)}get maxSize(){return this._maxSize}set lockSize(t){this._lockSize=ra(t),this.split.updateArea(this,!1,!0)}get lockSize(){return this._lockSize}set visible(t){this._visible=ra(t),this._visible?(this.split.showArea(this),this.renderer.removeClass(this.elRef.nativeElement,"as-hidden")):(this.split.hideArea(this),this.renderer.addClass(this.elRef.nativeElement,"as-hidden"))}get visible(){return this._visible}ngOnInit(){this.split.addArea(this),this.ngZone.runOutsideAngular(()=>{this.transitionListener=this.renderer.listen(this.elRef.nativeElement,"transitionend",t=>{"flex-basis"===t.propertyName&&this.split.notify("transitionEnd",-1)})})}setStyleOrder(t){this.renderer.setStyle(this.elRef.nativeElement,"order",t)}setStyleFlex(t,e,i,n,r){this.renderer.setStyle(this.elRef.nativeElement,"flex-grow",t),this.renderer.setStyle(this.elRef.nativeElement,"flex-shrink",e),this.renderer.setStyle(this.elRef.nativeElement,"flex-basis",i),!0===n?this.renderer.addClass(this.elRef.nativeElement,"as-min"):this.renderer.removeClass(this.elRef.nativeElement,"as-min"),!0===r?this.renderer.addClass(this.elRef.nativeElement,"as-max"):this.renderer.removeClass(this.elRef.nativeElement,"as-max")}lockEvents(){this.ngZone.runOutsideAngular(()=>{this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"selectstart",t=>!1)),this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"dragstart",t=>!1))})}unlockEvents(){for(;this.lockListeners.length>0;){const t=this.lockListeners.pop();t&&t()}}ngOnDestroy(){this.unlockEvents(),this.transitionListener&&this.transitionListener(),this.split.removeArea(this)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.B),s.Pb(s.m),s.Pb(s.G),s.Pb(ua))},t.\u0275dir=s.Kb({type:t,selectors:[["as-split-area"],["","as-split-area",""]],inputs:{order:"order",size:"size",minSize:"minSize",maxSize:"maxSize",lockSize:"lockSize",visible:"visible"},exportAs:["asSplitArea"]}),t})(),fa=(()=>{class t{static forRoot(){return{ngModule:t,providers:[]}}static forChild(){return{ngModule:t,providers:[]}}}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[n.c]]}),t})();var pa=i("sg/T"),ga=i("TKFd"),ma=i("Sv/w"),ba=i("mFH5"),va=i("5lCh"),ya=i("bwdy"),wa=i("g6G6"),_a=i("KTx3"),xa=i("ROBh"),Sa=i("8lHc"),Ia=i("f7+R"),ka=i("jIqt"),Ca=i("Ohay"),Pa=i("5XID"),Aa=i("cZZj"),Ma=i("fAiE"),Ta=i("E5oP"),Ea=i("qvOF");function Oa(t,e){1&t&&s.kc(0)}const Da=["*"];function za(t,e){}const Va=function(t){return{animationDuration:t}},Ba=function(t,e){return{value:t,params:e}},Ra=["tabBodyWrapper"],ja=["tabHeader"];function Fa(t,e){}function La(t,e){if(1&t&&s.Ec(0,Fa,0,0,"ng-template",9),2&t){const t=s.gc().$implicit;s.mc("cdkPortalOutlet",t.templateLabel)}}function Na(t,e){if(1&t&&s.Gc(0),2&t){const t=s.gc().$implicit;s.Hc(t.textLabel)}}function Ua(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",6),s.cc("click",(function(){s.wc(t);const i=e.$implicit,n=e.index,r=s.gc(),o=s.uc(1);return r._handleClick(i,o,n)})),s.Vb(1,"div",7),s.Ec(2,La,1,1,"ng-template",8),s.Ec(3,Na,1,1,"ng-template",8),s.Ub(),s.Ub()}if(2&t){const t=e.$implicit,i=e.index,n=s.gc();s.Hb("mat-tab-label-active",n.selectedIndex==i),s.mc("id",n._getTabLabelId(i))("disabled",t.disabled)("matRippleDisabled",t.disabled||n.disableRipple),s.Eb("tabIndex",n._getTabIndex(t,i))("aria-posinset",i+1)("aria-setsize",n._tabs.length)("aria-controls",n._getTabContentId(i))("aria-selected",n.selectedIndex==i)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),s.Db(2),s.mc("ngIf",t.templateLabel),s.Db(1),s.mc("ngIf",!t.templateLabel)}}function Ga(t,e){if(1&t){const t=s.Wb();s.Vb(0,"mat-tab-body",10),s.cc("_onCentered",(function(){return s.wc(t),s.gc()._removeTabBodyWrapperHeight()}))("_onCentering",(function(e){return s.wc(t),s.gc()._setTabBodyWrapperHeight(e)})),s.Ub()}if(2&t){const t=e.$implicit,i=e.index,n=s.gc();s.Hb("mat-tab-body-active",n.selectedIndex==i),s.mc("id",n._getTabContentId(i))("content",t.content)("position",t.position)("origin",t.origin)("animationDuration",n.animationDuration),s.Eb("aria-labelledby",n._getTabLabelId(i))}}const Wa=["tabListContainer"],Ha=["tabList"],$a=["nextPaginator"],qa=["previousPaginator"],Ya=new s.s("MatInkBarPositioner",{providedIn:"root",factory:function(){return t=>({left:t?(t.offsetLeft||0)+"px":"0",width:t?(t.offsetWidth||0)+"px":"0"})}});let Ja=(()=>{class t{constructor(t,e,i,n){this._elementRef=t,this._ngZone=e,this._inkBarPositioner=i,this._animationMode=n}alignToElement(t){this.show(),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._setStyles(t))}):this._setStyles(t)}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}_setStyles(t){const e=this._inkBarPositioner(t),i=this._elementRef.nativeElement;i.style.left=e.left,i.style.width=e.width}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(s.B),s.Pb(Ya),s.Pb(va.a,8))},t.\u0275dir=s.Kb({type:t,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(t,e){2&t&&s.Hb("_mat-animation-noopable","NoopAnimations"===e._animationMode)}}),t})();const Xa=new s.s("MatTabContent"),Qa=new s.s("MatTabLabel");class Za{}const Ka=Object(ba.u)(Za),tl=new s.s("MAT_TAB_GROUP");let el=(()=>{class t extends Ka{constructor(t,e){super(),this._viewContainerRef=t,this._closestTabGroup=e,this.textLabel="",this._contentPortal=null,this._stateChanges=new kt.a,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(t){this._setTemplateLabelInput(t)}get content(){return this._contentPortal}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new ma.h(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(t){t&&(this._templateLabel=t)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.R),s.Pb(tl))},t.\u0275cmp=s.Jb({type:t,selectors:[["mat-tab"]],contentQueries:function(t,e,i){if(1&t&&(s.Ib(i,Qa,!0),s.zc(i,Xa,!0,s.N)),2&t){let t;s.tc(t=s.dc())&&(e.templateLabel=t.first),s.tc(t=s.dc())&&(e._explicitContent=t.first)}},viewQuery:function(t,e){if(1&t&&s.Ac(s.N,!0),2&t){let t;s.tc(t=s.dc())&&(e._implicitContent=t.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[s.Ab,s.Bb],ngContentSelectors:Da,decls:1,vars:0,template:function(t,e){1&t&&(s.lc(),s.Ec(0,Oa,1,0,"ng-template"))},encapsulation:2}),t})();const il={translateTab:Object(Ia.m)("translateTab",[Object(Ia.j)("center, void, left-origin-center, right-origin-center",Object(Ia.k)({transform:"none"})),Object(Ia.j)("left",Object(Ia.k)({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),Object(Ia.j)("right",Object(Ia.k)({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),Object(Ia.l)("* => left, * => right, left => center, right => center",Object(Ia.e)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),Object(Ia.l)("void => left-origin-center",[Object(Ia.k)({transform:"translate3d(-100%, 0, 0)"}),Object(Ia.e)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),Object(Ia.l)("void => right-origin-center",[Object(Ia.k)({transform:"translate3d(100%, 0, 0)"}),Object(Ia.e)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let nl=(()=>{class t extends ma.c{constructor(t,e,i,n){super(t,e,n),this._host=i,this._centeringSub=ya.a.EMPTY,this._leavingSub=ya.a.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Object(ka.a)(this._host._isCenterPosition(this._host._position))).subscribe(t=>{t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.k),s.Pb(s.R),s.Pb(Object(s.V)(()=>ol)),s.Pb(n.d))},t.\u0275dir=s.Kb({type:t,selectors:[["","matTabBodyHost",""]],features:[s.Ab]}),t})(),rl=(()=>{class t{constructor(t,e,i){this._elementRef=t,this._dir=e,this._dirChangeSubscription=ya.a.EMPTY,this._translateTabComplete=new kt.a,this._onCentering=new s.p,this._beforeCentering=new s.p,this._afterLeavingCenter=new s.p,this._onCentered=new s.p(!0),this.animationDuration="500ms",e&&(this._dirChangeSubscription=e.change.subscribe(t=>{this._computePositionAnimationState(t),i.markForCheck()})),this._translateTabComplete.pipe(Object(Ca.a)((t,e)=>t.fromState===e.fromState&&t.toState===e.toState)).subscribe(t=>{this._isCenterPosition(t.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(t.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(t){this._positionIndex=t,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(t){const e=this._isCenterPosition(t.toState);this._beforeCentering.emit(e),e&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(t){return"center"==t||"left-origin-center"==t||"right-origin-center"==t}_computePositionAnimationState(t=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==t?"left":"right":this._positionIndex>0?"ltr"==t?"right":"left":"center"}_computePositionFromOrigin(t){const e=this._getLayoutDirection();return"ltr"==e&&t<=0||"rtl"==e&&t>0?"left-origin-center":"right-origin-center"}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(Ta.b,8),s.Pb(s.i))},t.\u0275dir=s.Kb({type:t,inputs:{animationDuration:"animationDuration",position:"position",_content:["content","_content"],origin:"origin"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),t})(),ol=(()=>{class t extends rl{constructor(t,e,i){super(t,e,i)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(Ta.b,8),s.Pb(s.i))},t.\u0275cmp=s.Jb({type:t,selectors:[["mat-tab-body"]],viewQuery:function(t,e){if(1&t&&s.Jc(ma.f,!0),2&t){let t;s.tc(t=s.dc())&&(e._portalHost=t.first)}},hostAttrs:[1,"mat-tab-body"],features:[s.Ab],decls:3,vars:6,consts:[[1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(t,e){1&t&&(s.Vb(0,"div",0,1),s.cc("@translateTab.start",(function(t){return e._onTranslateTabStarted(t)}))("@translateTab.done",(function(t){return e._translateTabComplete.next(t)})),s.Ec(2,za,0,0,"ng-template",2),s.Ub()),2&t&&s.mc("@translateTab",s.qc(3,Ba,e._position,s.pc(1,Va,e.animationDuration)))},directives:[nl],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[il.translateTab]}}),t})();const sl=new s.s("MAT_TABS_CONFIG");let al=0;class ll{}class cl{constructor(t){this._elementRef=t}}const hl=Object(ba.s)(Object(ba.t)(cl),"primary");let ul=(()=>{class t extends hl{constructor(t,e,i,n){super(t),this._changeDetectorRef=e,this._animationMode=n,this._tabs=new s.F,this._indexToSelect=0,this._tabBodyWrapperHeight=0,this._tabsSubscription=ya.a.EMPTY,this._tabLabelSubscription=ya.a.EMPTY,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new s.p,this.focusChange=new s.p,this.animationDone=new s.p,this.selectedTabChange=new s.p(!0),this._groupId=al++,this.animationDuration=i&&i.animationDuration?i.animationDuration:"500ms",this.disablePagination=!(!i||null==i.disablePagination)&&i.disablePagination,this.dynamicHeight=!(!i||null==i.dynamicHeight)&&i.dynamicHeight}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(t){this._dynamicHeight=Object(Pa.c)(t)}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=Object(Pa.f)(t,null)}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t)?t+"ms":t}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){const e=this._elementRef.nativeElement;e.classList.remove("mat-background-"+this.backgroundColor),t&&e.classList.add("mat-background-"+t),this._backgroundColor=t}ngAfterContentChecked(){const t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){const e=null==this._selectedIndex;e||this.selectedTabChange.emit(this._createChangeEvent(t)),Promise.resolve().then(()=>{this._tabs.forEach((e,i)=>e.isActive=i===t),e||this.selectedIndexChange.emit(t)})}this._tabs.forEach((e,i)=>{e.position=i-t,null==this._selectedIndex||0!=e.position||e.origin||(e.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{if(this._clampTabIndex(this._indexToSelect)===this._selectedIndex){const t=this._tabs.toArray();for(let e=0;e<t.length;e++)if(t[e].isActive){this._indexToSelect=this._selectedIndex=e;break}}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Object(ka.a)(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(t=>t._closestTabGroup===this)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}_focusChanged(t){this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){const e=new ll;return e.index=t,this._tabs&&this._tabs.length&&(e.tab=this._tabs.toArray()[t]),e}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=Object(wa.a)(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t){return`mat-tab-label-${this._groupId}-${t}`}_getTabContentId(t){return`mat-tab-content-${this._groupId}-${t}`}_setTabBodyWrapperHeight(t){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const e=this._tabBodyWrapper.nativeElement;e.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(e.style.height=t+"px")}_removeTabBodyWrapperHeight(){const t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this.animationDone.emit()}_handleClick(t,e,i){t.disabled||(this.selectedIndex=e.focusIndex=i)}_getTabIndex(t,e){return t.disabled?null:this.selectedIndex===e?0:-1}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(s.i),s.Pb(sl,8),s.Pb(va.a,8))},t.\u0275dir=s.Kb({type:t,inputs:{headerPosition:"headerPosition",animationDuration:"animationDuration",disablePagination:"disablePagination",dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[s.Ab]}),t})(),dl=(()=>{class t extends ul{constructor(t,e,i,n){super(t,e,i,n)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(s.i),s.Pb(sl,8),s.Pb(va.a,8))},t.\u0275cmp=s.Jb({type:t,selectors:[["mat-tab-group"]],contentQueries:function(t,e,i){if(1&t&&s.Ib(i,el,!0),2&t){let t;s.tc(t=s.dc())&&(e._allTabs=t)}},viewQuery:function(t,e){if(1&t&&(s.Jc(Ra,!0),s.Jc(ja,!0)),2&t){let t;s.tc(t=s.dc())&&(e._tabBodyWrapper=t.first),s.tc(t=s.dc())&&(e._tabHeader=t.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(t,e){2&t&&s.Hb("mat-tab-group-dynamic-height",e.dynamicHeight)("mat-tab-group-inverted-header","below"===e.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[s.Cb([{provide:tl,useExisting:t}]),s.Ab],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(t,e){1&t&&(s.Vb(0,"mat-tab-header",0,1),s.cc("indexFocused",(function(t){return e._focusChanged(t)}))("selectFocusedIndex",(function(t){return e.selectedIndex=t})),s.Ec(2,Ua,4,14,"div",2),s.Ub(),s.Vb(3,"div",3,4),s.Ec(5,Ga,1,8,"mat-tab-body",5),s.Ub()),2&t&&(s.mc("selectedIndex",e.selectedIndex||0)("disableRipple",e.disableRipple)("disablePagination",e.disablePagination),s.Db(2),s.mc("ngForOf",e._tabs),s.Db(1),s.Hb("_mat-animation-noopable","NoopAnimations"===e._animationMode),s.Db(2),s.mc("ngForOf",e._tabs))},directives:function(){return[yl,n.l,gl,ba.n,pa.d,n.m,ma.c,ol]},styles:[".mat-tab-group{display:flex;flex-direction:column}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),t})();class fl{}const pl=Object(ba.u)(fl);let gl=(()=>{class t extends pl{constructor(t){super(),this.elementRef=t}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m))},t.\u0275dir=s.Kb({type:t,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(t,e){2&t&&(s.Eb("aria-disabled",!!e.disabled),s.Hb("mat-tab-disabled",e.disabled))},inputs:{disabled:"disabled"},features:[s.Ab]}),t})();const ml=Object(Aa.f)({passive:!0});let bl=(()=>{class t{constructor(t,e,i,n,r,o,a){this._elementRef=t,this._changeDetectorRef=e,this._viewportRuler=i,this._dir=n,this._ngZone=r,this._platform=o,this._animationMode=a,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new kt.a,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new kt.a,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new s.p,this.indexFocused=new s.p,r.runOutsideAngular(()=>{Object(_a.a)(t.nativeElement,"mouseleave").pipe(Object(Pt.a)(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){t=Object(Pa.f)(t),this._selectedIndex!=t&&(this._selectedIndexChanged=!0,this._selectedIndex=t,this._keyManager&&this._keyManager.updateActiveItem(t))}ngAfterViewInit(){Object(_a.a)(this._previousPaginator.nativeElement,"touchstart",ml).pipe(Object(Pt.a)(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),Object(_a.a)(this._nextPaginator.nativeElement,"touchstart",ml).pipe(Object(Pt.a)(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const t=this._dir?this._dir.change:Object(xa.a)(null),e=this._viewportRuler.change(150),i=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new pa.e(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(i):i(),Object(wa.a)(t,e,this._items.changes).pipe(Object(Pt.a)(this._destroyed)).subscribe(()=>{Promise.resolve().then(i),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe(Object(Pt.a)(this._destroyed)).subscribe(t=>{this.indexFocused.emit(t),this._setTabFocus(t)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!Object(Ma.q)(t))switch(t.keyCode){case Ma.d:case Ma.l:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t));break;default:this._keyManager.onKeydown(t)}}_onContentChanges(){const t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){this._isValidIndex(t)&&this.focusIndex!==t&&this._keyManager&&this._keyManager.setActiveItem(t)}_isValidIndex(t){if(!this._items)return!0;const e=this._items?this._items.toArray()[t]:null;return!!e&&!e.disabled}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();const e=this._tabListContainer.nativeElement,i=this._getLayoutDirection();e.scrollLeft="ltr"==i?0:e.scrollWidth-e.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const t=this.scrollDistance,e="ltr"===this._getLayoutDirection()?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(e)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){return this._scrollTo(this._scrollDistance+("before"==t?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;const e=this._items?this._items.toArray()[t]:null;if(!e)return;const i=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:n,offsetWidth:r}=e.elementRef.nativeElement;let o,s;"ltr"==this._getLayoutDirection()?(o=n,s=o+r):(s=this._tabList.nativeElement.offsetWidth-n,o=s-r);const a=this.scrollDistance,l=this.scrollDistance+i;o<a?this.scrollDistance-=a-o+60:s>l&&(this.scrollDistance+=s-l+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const t=this._tabList.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;t||(this.scrollDistance=0),t!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=t}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabList.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,e=t?t.elementRef.nativeElement:null;e?this._inkBar.alignToElement(e):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,e){e&&null!=e.button&&0!==e.button||(this._stopInterval(),Object(Sa.a)(650,100).pipe(Object(Pt.a)(Object(wa.a)(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:e,distance:i}=this._scrollHeader(t);(0===i||i>=e)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const e=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(e,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:e,distance:this._scrollDistance}}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(s.i),s.Pb(Ea.e),s.Pb(Ta.b,8),s.Pb(s.B),s.Pb(Aa.a),s.Pb(va.a,8))},t.\u0275dir=s.Kb({type:t,inputs:{disablePagination:"disablePagination"}}),t})(),vl=(()=>{class t extends bl{constructor(t,e,i,n,r,o,s){super(t,e,i,n,r,o,s),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Object(Pa.c)(t)}_itemSelected(t){t.preventDefault()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(s.i),s.Pb(Ea.e),s.Pb(Ta.b,8),s.Pb(s.B),s.Pb(Aa.a),s.Pb(va.a,8))},t.\u0275dir=s.Kb({type:t,inputs:{disableRipple:"disableRipple"},features:[s.Ab]}),t})(),yl=(()=>{class t extends vl{constructor(t,e,i,n,r,o,s){super(t,e,i,n,r,o,s)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.m),s.Pb(s.i),s.Pb(Ea.e),s.Pb(Ta.b,8),s.Pb(s.B),s.Pb(Aa.a),s.Pb(va.a,8))},t.\u0275cmp=s.Jb({type:t,selectors:[["mat-tab-header"]],contentQueries:function(t,e,i){if(1&t&&s.Ib(i,gl,!1),2&t){let t;s.tc(t=s.dc())&&(e._items=t)}},viewQuery:function(t,e){if(1&t&&(s.Ac(Ja,!0),s.Ac(Wa,!0),s.Ac(Ha,!0),s.Jc($a,!0),s.Jc(qa,!0)),2&t){let t;s.tc(t=s.dc())&&(e._inkBar=t.first),s.tc(t=s.dc())&&(e._tabListContainer=t.first),s.tc(t=s.dc())&&(e._tabList=t.first),s.tc(t=s.dc())&&(e._nextPaginator=t.first),s.tc(t=s.dc())&&(e._previousPaginator=t.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(t,e){2&t&&s.Hb("mat-tab-header-pagination-controls-enabled",e._showPaginationControls)("mat-tab-header-rtl","rtl"==e._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[s.Ab],ngContentSelectors:Da,decls:13,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(t,e){1&t&&(s.lc(),s.Vb(0,"div",0,1),s.cc("click",(function(){return e._handlePaginatorClick("before")}))("mousedown",(function(t){return e._handlePaginatorPress("before",t)}))("touchend",(function(){return e._stopInterval()})),s.Qb(2,"div",2),s.Ub(),s.Vb(3,"div",3,4),s.cc("keydown",(function(t){return e._handleKeydown(t)})),s.Vb(5,"div",5,6),s.cc("cdkObserveContent",(function(){return e._onContentChanges()})),s.Vb(7,"div",7),s.kc(8),s.Ub(),s.Qb(9,"mat-ink-bar"),s.Ub(),s.Ub(),s.Vb(10,"div",8,9),s.cc("mousedown",(function(t){return e._handlePaginatorPress("after",t)}))("click",(function(){return e._handlePaginatorClick("after")}))("touchend",(function(){return e._stopInterval()})),s.Qb(12,"div",2),s.Ub()),2&t&&(s.Hb("mat-tab-header-pagination-disabled",e._disableScrollBefore),s.mc("matRippleDisabled",e._disableScrollBefore||e.disableRipple),s.Db(5),s.Hb("_mat-animation-noopable","NoopAnimations"===e._animationMode),s.Db(5),s.Hb("mat-tab-header-pagination-disabled",e._disableScrollAfter),s.mc("matRippleDisabled",e._disableScrollAfter||e.disableRipple))},directives:[ba.n,ga.a,Ja],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),t})(),wl=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[n.c,ba.g,ma.g,ba.o,ga.c,pa.a],ba.g]}),t})();var _l=i("6vhs"),xl=i("9DO8"),Sl=i("fJbr");let Il=(()=>{class t{constructor(t){this.stateHelperService=t}setAvailableFieldsFromJsonFile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.stateHelperService.runAction(new _l.c(t),xl.a.getAvailableFieldsError)}))}setAvailableFieldsFromExcelFile(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.stateHelperService.runAction(new _l.a(t),xl.a.getAvailableFieldsError)}))}getExistingAvailableFields(){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.stateHelperService.runAction(new _l.b,xl.a.getAvailableFieldsError)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(Sl.a))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(o.b)([Object(js.f)(xl.a.getAvailableFields)],t.prototype,"availableFields$",void 0),t})();const kl=["availableFileInput"];function Cl(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",6),s.cc("click",(function(){s.wc(t);const e=s.gc().ngIf;return s.gc().scoreLoadedFile(e)})),s.Gc(1," Score "),s.Ub()}}function Pl(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Cl,2,0,"button",5),s.Sb()),2&t){const t=e.ngIf;s.Db(1),s.mc("ngIf",0==(null==t.parentIds?null:t.parentIds.length)&&"profile"==t.itemType)}}let Al=(()=>{class t{constructor(t,e,i,n){this.availableFieldsStateService=t,this.scoreStateService=e,this.dhDialogService=i,this.profileStateService=n,this.fileTypeToRead="none"}loadAvailableFieldsFromJson(){this.fileTypeToRead="json",this.showFileSelection()}loadAvailableFieldsFromExcel(){this.fileTypeToRead="excel",this.showFileSelection()}loadScoreFile(){this.fileTypeToRead="score",this.showFileSelection()}showFileSelection(){this.availableFileInput.nativeElement.value="",this.availableFileInput.nativeElement.click()}fileLoaded(t){return Object(o.a)(this,void 0,void 0,(function*(){const e=t.target.files[0];this.dhDialogService.showLoading(),(yield this.loadAvailableFieldsFromServer(e))&&this.dhDialogService.showErrorMessage("Could not load available fields from server"),this.dhDialogService.hideLoading()}))}loadAvailableFieldsFromServer(t){return Object(o.a)(this,void 0,void 0,(function*(){switch(this.fileTypeToRead){case"json":return yield this.loadAvailableFieldsForJsonFromServer(t);case"excel":return yield this.loadAvailableFieldsForExcelFromServer(t);case"score":return yield this.scoreFile(t)}}))}loadAvailableFieldsForJsonFromServer(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.availableFieldsStateService.setAvailableFieldsFromJsonFile(t)}))}loadAvailableFieldsForExcelFromServer(t){return Object(o.a)(this,void 0,void 0,(function*(){return yield this.availableFieldsStateService.setAvailableFieldsFromExcelFile(t)}))}scoreLoadedFile(t){this.selectedProfile=t,this.loadScoreFile()}scoreFile(t){return Object(o.a)(this,void 0,void 0,(function*(){const e=yield this.scoreStateService.scoreExcelFile({profileId:this.selectedProfile.id,file:[t]});null!=e&&this.dhDialogService.showErrorMessage("Could not score excel file: "+e)}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Il),s.Pb(Ys.a),s.Pb(ks.a),s.Pb(Gs.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-load-available-button"]],viewQuery:function(t,e){if(1&t&&s.Jc(kl,!0),2&t){let t;s.tc(t=s.dc())&&(e.availableFileInput=t.first)}},decls:9,vars:3,consts:[["mat-raised-button","","color","primary","matTooltip","Load Schema File",1,"mr-4","mb-2",3,"click"],["mat-raised-button","","color","primary","matTooltip","Load Excel Schema File",1,"mr-4","mb-2",3,"click"],[4,"ngIf"],["type","file","name","inputfile","id","inputfile",2,"display","none",3,"change"],["availableFileInput",""],["mat-raised-button","","color","primary","matTooltip","Score selected profile",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","matTooltip","Score selected profile",3,"click"]],template:function(t,e){1&t&&(s.Vb(0,"div"),s.Vb(1,"button",0),s.cc("click",(function(){return e.loadAvailableFieldsFromJson()})),s.Gc(2," Load Json "),s.Ub(),s.Vb(3,"button",1),s.cc("click",(function(){return e.loadAvailableFieldsFromExcel()})),s.Gc(4," Load Excel "),s.Ub(),s.Ec(5,Pl,2,1,"ng-container",2),s.hc(6,"async"),s.Vb(7,"input",3,4),s.cc("change",(function(t){return e.fileLoaded(t)})),s.Ub(),s.Ub()),2&t&&(s.Db(5),s.mc("ngIf",s.ic(6,1,e.profileStateService.selectedProfile$)))},directives:[Ms.b,n.m],pipes:[n.b],styles:[""],changeDetection:0}),t})(),Ml=(()=>{class t{transform(t,e){if(null==t||null==e)return null;var i=e.reduce((t,e)=>("virtual"==e.itemType||"profile"==e.itemType||(t[e.originalId]=!0),t),{});return t.map(t=>this.convertToAvailableTreeWithUse(t,i))}convertToAvailableTreeWithUse(t,e){var i;return Object.assign(Object.assign({},t),{isUsed:!!e[t.id],children:null===(i=t.children)||void 0===i?void 0:i.map(t=>this.convertToAvailableTreeWithUse(t,e))})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"availableFieldsWithUseData",type:t,pure:!0}),t})();function Tl(t,e){if(1&t&&(s.Vb(0,"span"),s.Gc(1),s.Ub()),2&t){const t=e.$implicit;s.Bc("background-color",t.data.isUsed?"green":"inherit"),s.Db(1),s.Hc(t.data.name)}}function El(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"tree-root",1),s.Ec(2,Tl,2,3,"ng-template",null,2,s.Fc),s.Ub(),s.Sb()),2&t){const t=e.ngIf,i=s.gc(2);s.Db(1),s.mc("nodes",t)("options",i.options)}}function Ol(t,e){if(1&t&&(s.Tb(0),s.Ec(1,El,4,2,"ng-container",0),s.hc(2,"availableFieldsWithUseData"),s.hc(3,"async"),s.Sb()),2&t){const t=e.ngIf,i=s.gc();s.Db(1),s.mc("ngIf",s.jc(2,1,s.ic(3,4,i.availableFieldsStateService.availableFields$),t))}}let Dl=(()=>{class t{constructor(t,e){this.availableFieldsStateService=t,this.profileStateService=e,this.options={allowDrag:!0}}ngOnInit(){this.availableFieldsStateService.getExistingAvailableFields()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Il),s.Pb(Gs.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-available-tree"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"nodes","options"],["treeNodeTemplate",""]],template:function(t,e){1&t&&(s.Ec(0,Ol,4,6,"ng-container",0),s.hc(1,"async")),2&t&&s.mc("ngIf",s.ic(1,1,e.profileStateService.profiles$))},directives:[n.m,Cs.a],pipes:[n.b,Ml],styles:[""]}),t})();const zl=["tree"];function Vl(t,e){if(1&t){const t=s.Wb();s.Vb(0,"span",5),s.cc("click",(function(){s.wc(t);const e=s.gc().$implicit;return s.gc(3).editValue(e.data)})),s.Gc(1),s.Ub()}if(2&t){const t=s.gc().$implicit;s.Db(1),s.Ic(": ",t.data.value,"")}}function Bl(t,e){if(1&t&&(s.Vb(0,"span"),s.Gc(1),s.Ec(2,Vl,2,1,"span",4),s.Ub()),2&t){const t=e.$implicit;s.Db(1),s.Hc(t.data.name),s.Db(1),s.mc("ngIf",t.data.value)}}function Rl(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"tree-root",1,2),s.Ec(3,Bl,3,2,"ng-template",null,3,s.Fc),s.Ub(),s.Sb()),2&t){const t=e.ngIf,i=s.gc().ngIf,n=s.gc();s.Db(1),s.mc("nodes",null==t[i]?null:t[i].scoreSourceData)("options",n.options)}}function jl(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Rl,5,2,"ng-container",0),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc();s.Db(1),s.mc("ngIf",s.ic(2,1,t.scoreStateService.scores$))}}let Fl=(()=>{class t{constructor(t,e,i){this.scoreStateService=t,this.profileStateService=e,this.dhDialogService=i,this.options={allowDrag:!1}}go(t){console.log(t)}editValue(t){return Object(o.a)(this,void 0,void 0,(function*(){const e=yield this.dhDialogService.showPrompt({initialValue:t.value,message:`Edit ${t.name}:`,title:"Edit Score Data"}).toPromise();e.continue&&(this.dhDialogService.showLoading(),yield this.scoreStateService.updateScoreSourceItem(t.id,e.value),this.dhDialogService.hideLoading())}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Ys.a),s.Pb(Gs.a),s.Pb(ks.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-score-data-editor"]],viewQuery:function(t,e){if(1&t&&s.Jc(zl,!0),2&t){let t;s.tc(t=s.dc())&&(e.treeComponent=t.first)}},decls:2,vars:3,consts:[[4,"ngIf"],[3,"nodes","options"],["tree",""],["treeNodeTemplate",""],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,e){1&t&&(s.Ec(0,jl,3,3,"ng-container",0),s.hc(1,"async")),2&t&&s.mc("ngIf",s.ic(1,1,e.scoreStateService.scoredProfileId$))},directives:[n.m,Cs.a],pipes:[n.b],styles:[""],changeDetection:0}),t})();var Ll=i("29Wa"),Nl=i("Cd2c");let Ul=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}onNoClick(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(qs.g),s.Pb(qs.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-prompt"]],decls:12,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"w-full"],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(s.Vb(0,"h1",0),s.Gc(1),s.Ub(),s.Vb(2,"div",1),s.Vb(3,"mat-form-field",2),s.Vb(4,"mat-label"),s.Gc(5),s.Ub(),s.Vb(6,"input",3),s.cc("ngModelChange",(function(t){return e.data.inputValue=t})),s.Ub(),s.Ub(),s.Ub(),s.Vb(7,"div",4),s.Vb(8,"button",5),s.cc("click",(function(){return e.onNoClick()})),s.Gc(9,"Cancel"),s.Ub(),s.Vb(10,"button",6),s.Gc(11,"Create"),s.Ub(),s.Ub()),2&t&&(s.Db(1),s.Hc(e.data.title),s.Db(4),s.Hc(e.data.label),s.Db(1),s.mc("ngModel",e.data.inputValue),s.Db(4),s.mc("mat-dialog-close",e.data.inputValue))},directives:[qs.h,qs.e,Ll.b,Ll.e,Nl.a,As.a,As.j,As.m,qs.c,Ms.b,qs.d],styles:[""]}),t})();var Gl=i("SVGO"),Wl=i("Y2X+"),Hl=i("bFHC");let $l=(()=>{class t{constructor(t,e,i){this.dhDialogService=t,this.authStateService=e,this.profileStateService=i}ngOnInit(){}refresh(){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const t=yield this.profileStateService.getProfiles();this.dhDialogService.hideLoading(),"error"==t&&this.dhDialogService.showMessage("error loading profile")}))}addRootProfile(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.dhDialogService.openDialog(Ul,300,{title:"Enter new Root Profile data",label:"Profile Name",inputValue:""}).toPromise();if(null==t)return;this.dhDialogService.showLoading();const e=yield this.profileStateService.addRootProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Root Profile Added.":"Error adding Root Profile.")}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(ks.a),s.Pb(Gl.a),s.Pb(Gs.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile-buttons"]],decls:6,vars:0,consts:[["mat-icon-button","","matTooltip","Refresh data from server",3,"click"],["mat-icon-button","","matTooltip","Create root profile",3,"click"]],template:function(t,e){1&t&&(s.Vb(0,"button",0),s.cc("click",(function(){return e.refresh()})),s.Vb(1,"mat-icon"),s.Gc(2,"refresh"),s.Ub(),s.Ub(),s.Vb(3,"button",1),s.cc("click",(function(){return e.addRootProfile()})),s.Vb(4,"mat-icon"),s.Gc(5,"add"),s.Ub(),s.Ub())},directives:[Ms.b,Wl.a,Hl.a],styles:[""]}),t})(),ql=(()=>{class t{transform(t,e){return null==t||null==e?null:0!=t.indexOf(e)?t:t.substr(e.length+1)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"removeParentIdFromSubProfile",type:t,pure:!0}),t})(),Yl=(()=>{class t{transform(t,e){return null==t||null==e?null:"numeric"==e?t.slice().sort((t,e)=>At(Number(t.name),Number(e.name))):t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"sortProfileItemValues",type:t,pure:!0}),t})();var Jl=i("R7+U");function Xl(t,e){if(1&t&&(s.Vb(0,"mat-option",9),s.Gc(1),s.Ub()),2&t){const t=e.$implicit;s.mc("value",t.value),s.Db(1),s.Ic(" ",t.viewValue," ")}}function Ql(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Tb(1,12),s.Vb(2,"tr"),s.Vb(3,"td",13),s.Vb(4,"mat-form-field",14),s.Vb(5,"mat-label"),s.Gc(6,"Name"),s.Ub(),s.Qb(7,"input",15),s.Ub(),s.Ub(),s.Vb(8,"td",16),s.Vb(9,"mat-form-field",14),s.Vb(10,"mat-label"),s.Gc(11,"Score"),s.Ub(),s.Qb(12,"input",17),s.Ub(),s.Ub(),s.Vb(13,"td",16),s.Vb(14,"button",18),s.cc("click",(function(){s.wc(t);const i=e.index;return s.gc(2).removeItem(i)})),s.Vb(15,"mat-icon"),s.Gc(16,"clear"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Sb(),s.Sb()}if(2&t){const t=e.index;s.Db(1),s.mc("formGroupName",t)}}function Zl(t,e){if(1&t&&(s.Tb(0,10),s.Ec(1,Ql,17,1,"ng-container",11),s.Sb()),2&t){const t=s.gc();s.Db(1),s.mc("ngForOf",t.valueScores.controls)}}let Kl=(()=>{class t{constructor(t){this.formBuilder=t,this.profileItemTypes=[{value:"geo",viewValue:"geo"},{value:"list",viewValue:"list"},{value:"numeric",viewValue:"numeric"},{value:"diff",viewValue:"diff"},{value:"diffpercentage",viewValue:"diffpercentage"}],this.newScoreIndex=1}get profile(){return this._profile}set profile(t){this._profile=t,setTimeout(()=>{this.updateForm()},100)}ngOnInit(){this.profile&&(this.form=this.formBuilder.group({itemType:this.profile.itemType,valueScores:this.formBuilder.array(this.getFormGroupsForValueScores())}))}updateForm(){const t=this.valueScores;t.clear();const e=this.getFormGroupsForValueScores();for(const i of e)t.push(i);this.form.patchValue({itemType:this.profile.itemType})}getFormGroupsForValueScores(){return(new Yl).transform(this.profile.scores,this.profile.itemType).map(t=>this.createFormGroupForRow(t.name,t.score))}removeItem(t){this.valueScores.removeAt(t)}createFormGroupForRow(t,e){return this.formBuilder.group({score:[e,[As.p.required]],name:[t,[As.p.required]]})}get valueScores(){return this.form.get("valueScores")}getProfileItemData(){return{itemType:this.form.value.itemType,valueScores:this.getValueScores()}}getValueScores(){return this.valueScores.controls.map(t=>t.value).map(t=>({name:t.name,score:t.score}))}addRow(){this.valueScores.push(this.createFormGroupForRow(null,0))}insertRow(t,e){this.valueScores.insert(t,this.createFormGroupForRow(this.getNewName(),e))}getNewName(){let t=null;do{t="new"+this.newScoreIndex++}while(this.nameAlreadyExists(t));return t}nameAlreadyExists(t){return this.valueScores.controls.find(e=>e.value.name==t)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(As.c))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile-item-form"]],inputs:{profile:"profile"},decls:17,vars:3,consts:[["ngxsForm","selectionActions.profileItemForm",3,"formGroup"],["appearance","fill"],["formControlName","itemType","name","itemType"],[3,"value",4,"ngFor","ngForOf"],[1,"mb-5","w-full"],[1,"sm:block"],["formArrayName","valueScores","class","mt-10",4,"ngIf"],[1,"flex","justify-center","align-middle"],["mat-icon-button","","aria-label","Add new value/score pairs",3,"click"],[3,"value"],["formArrayName","valueScores",1,"mt-10"],[4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"py-2","inline-block"],["appearance","standard"],["matInput","","placeholder","Name","formControlName","name"],[1,"py-2"],["matInput","","placeholder","Score","formControlName","score","type","number"],["mat-icon-button","","aria-label","Delete score",3,"click"]],template:function(t,e){1&t&&(s.Vb(0,"form",0),s.Vb(1,"div"),s.Vb(2,"mat-form-field",1),s.Vb(3,"mat-label"),s.Gc(4,"Profile Item Type"),s.Ub(),s.Vb(5,"mat-select",2),s.Ec(6,Xl,2,2,"mat-option",3),s.Ub(),s.Ub(),s.Ub(),s.Vb(7,"h2"),s.Gc(8,"Value/Scores"),s.Ub(),s.Vb(9,"div"),s.Vb(10,"table",4),s.Vb(11,"tbody",5),s.Ec(12,Zl,2,1,"ng-container",6),s.Ub(),s.Ub(),s.Ub(),s.Vb(13,"div",7),s.Vb(14,"button",8),s.cc("click",(function(){return e.addRow()})),s.Vb(15,"mat-icon"),s.Gc(16,"add"),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t&&(s.mc("formGroup",e.form),s.Db(6),s.mc("ngForOf",e.profileItemTypes),s.Db(6),s.mc("ngIf",e.valueScores))},directives:[As.q,As.k,Ws.d,As.e,Ll.b,Ll.e,Jl.a,As.j,As.d,n.l,n.m,Ms.b,Hl.a,ba.j,As.b,As.f,Nl.a,As.a,As.n],styles:[""]}),t})(),tc=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.dhDialogService=e,this.formBuilder=i,this.profile={scores:[{name:"",score:null}],childrenIds:[],id:"",itemType:"",name:"",originalId:"",parentIds:[]}}onNoClick(){this.dialogRef.close()}ok(){if(!this.form.invalid&&!this.profileItemForm.form.invalid){var t=this.profileItemForm.getProfileItemData();if(!t.valueScores||t.valueScores.length<0)this.dhDialogService.showMessage("Add some value scores. At least one.");else{var e=Number(this.form.value.weight);isNaN(e)&&(e=1),this.dialogRef.close(Object.assign({name:this.form.value.name,weight:e},t))}}}ngOnInit(){this.form=this.formBuilder.group({name:"",weight:1})}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(qs.g),s.Pb(ks.a),s.Pb(As.c))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-new-profile-item-dialog"]],viewQuery:function(t,e){if(1&t&&s.Jc(Kl,!0),2&t){let t;s.tc(t=s.dc())&&(e.profileItemForm=t.first)}},decls:20,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[1,"w-full"],["matInput","","placeholder","Name","formControlName","name","matInput",""],["matInput","","placeholder","Weight","formControlName","weight","matInput",""],[3,"profile"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(t,e){1&t&&(s.Vb(0,"h1",0),s.Gc(1,"Create New Profile Item"),s.Ub(),s.Vb(2,"div",1),s.Vb(3,"p"),s.Gc(4,"Enter New Profile Item Data"),s.Ub(),s.Vb(5,"form",2),s.Vb(6,"mat-form-field",3),s.Vb(7,"mat-label"),s.Gc(8,"Profile Item Name"),s.Ub(),s.Qb(9,"input",4),s.Ub(),s.Vb(10,"mat-form-field",3),s.Vb(11,"mat-label"),s.Gc(12,"Profile Item Weight"),s.Ub(),s.Qb(13,"input",5),s.Ub(),s.Ub(),s.Qb(14,"dh-profile-item-form",6),s.Ub(),s.Vb(15,"div",7),s.Vb(16,"button",8),s.cc("click",(function(){return e.onNoClick()})),s.Gc(17,"Cancel"),s.Ub(),s.Vb(18,"button",9),s.cc("click",(function(){return e.ok()})),s.Gc(19,"Create"),s.Ub(),s.Ub()),2&t&&(s.Db(5),s.mc("formGroup",e.form),s.Db(9),s.mc("profile",e.profile))},directives:[qs.h,qs.e,As.q,As.k,As.e,Ll.b,Ll.e,Nl.a,As.a,As.j,As.d,Kl,qs.c,Ms.b],styles:[""]}),t})();function ec(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",5),s.cc("click",(function(){return s.wc(t),s.gc().addProfileItem()})),s.Vb(1,"mat-icon"),s.Gc(2,"post_add"),s.Ub(),s.Ub()}}function ic(t,e){if(1&t){const t=s.Wb();s.Vb(0,"button",6),s.cc("click",(function(){return s.wc(t),s.gc().addSubProfile()})),s.Vb(1,"mat-icon"),s.Gc(2,"create_new_folder"),s.Ub(),s.Ub()}}let nc=(()=>{class t{constructor(t,e,i,n){this.dhDialogService=t,this.selectionActionStateService=e,this.profileStateService=i,this.weightStateService=n}ngOnInit(){}saveEdit(){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const t=this.selectionActionStateService.getForms(),e=this.profileStateService.getSelectedProfile(),i=t.profileNameForm.model.name;"profile"==e.itemType?(i!=e.name&&null!=(yield this.profileStateService.updateName(e.id,i))&&this.dhDialogService.showMessage("Failed updating profile name"),yield this.updateProfile(t.subProfileWeightForm,e)):"virtual"==e.itemType?yield this.updateVirtualProfile(e,i):yield this.updateProfileItem(t.profileItemForm,e,i),this.dhDialogService.hideLoading()}))}updateVirtualProfile(t,e){return Object(o.a)(this,void 0,void 0,(function*(){null!=(yield this.profileStateService.updateVirtualProfile({profileId:t.originalParentId,virtualProfileNameUpdateDto:{newName:e,prefix:t.originalName}}))&&this.dhDialogService.showMessage("Failed updating profile item path")}))}updateProfileItem(t,e,i){return Object(o.a)(this,void 0,void 0,(function*(){const n=t.model,r=this.getNewName(e.originalName,i);null!=(yield this.profileStateService.updateProfileItem({profileId:e.originalParentId,profileItemUpdateDto:{itemType:n.itemType,name:e.originalName,values:n.valueScores,newName:r}},e.id,i))&&this.dhDialogService.showMessage("Failed updating profile item")}))}getNewName(t,e){const i=t.lastIndexOf(".");return-1==i?e:t.substring(0,i+1)+e}updateProfile(t,e){return Object(o.a)(this,void 0,void 0,(function*(){const i=yield this.getWeightChanges(t,e);null!=i&&(yield this.weightStateService.updateSubElementsWeights({newWeights:i,profileId:e.id}))&&this.dhDialogService.showMessage("Failed updating sub elements weights")}))}getWeightChanges(t,e){return Object(o.a)(this,void 0,void 0,(function*(){if(null==t.model.subProfiles)return null;const i=t.model.subProfiles.reduce((t,e)=>(t[e.id]=e.weight,t),{}),n=new ql,r=this.weightStateService.getProfileWeights(e.id);var o=new zs,s=yield this.profileStateService.profileMap$.pipe(Object(Vs.a)()).toPromise();const a=o.transform(e,s);return null==a?null:a.reduce((t,o)=>{const s=n.transform(o,e.id),a=i[o];return a!=r[s]&&t.push({newWeight:a,id:o}),t},[])}))}addProfileItem(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.dhDialogService.openDialog(tc,700,null).toPromise();if(null==t)return;this.dhDialogService.showLoading();const e=yield this.profileStateService.addProfileItem({profileId:null,profileItemCreateDto:{name:t.name,itemType:t.itemType,values:t.valueScores}},t.weight);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Profile Item Added.":"Error adding Profile Item.")}))}deleteProfileOrProfileItem(){const t=this.profileStateService.getSelectedProfile();"profile"==t.itemType?this.deleteProfile(t.id):"virtual"==t.itemType?this.deleteVirtualProfileItem(t):this.deleteProfileItem(t)}deleteProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({title:"Confirm Delete",message:"Are you sure you want to delete this profile?"}).toPromise()))return;this.dhDialogService.showLoading();const e=yield this.profileStateService.deleteProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error deleting profile.":"Profile Deleted.")}))}deleteProfileItem(t){return Object(o.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({title:"Confirm Delete",message:"Are you sure you want to delete this Profile Item?"}).toPromise()))return;this.dhDialogService.showLoading();const e=yield this.profileStateService.deleteProfileItem(t.originalParentId,t.originalName,t.originalId);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error deleting profile.":"Profile Deleted.")}))}deleteVirtualProfileItem(t){return Object(o.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({title:"Confirm Delete",message:"Are you sure you want to delete this Virtual Profile Item? All sub items will be deleted too."}).toPromise()))return;this.dhDialogService.showLoading();const e=yield this.profileStateService.deleteVirtualProfileItem(t.originalParentId,t.originalName,t.id);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error deleting virtual profile.":"Virtual Profile Deleted.")}))}addSubProfile(){return Object(o.a)(this,void 0,void 0,(function*(){const t=yield this.dhDialogService.openDialog(Ul,400,{title:"Enter new Sub Profile Name",label:"Profile Name",inputValue:""}).toPromise();if(null==t)return;this.dhDialogService.showLoading();const e=yield this.profileStateService.addSubProfile(null,t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(null==e?"Sub Profile Added.":"Error adding Sub Profile.")}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(ks.a),s.Pb($s),s.Pb(Gs.a),s.Pb(Ns))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile-details-buttons"]],inputs:{selectedProfile:"selectedProfile"},decls:8,vars:3,consts:[["mat-icon-button","","matTooltip","Add Profile Item",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Delete",3,"click"],["color","danger"],["mat-icon-button","","matTooltip","Add New Sub-Profile To Selected Profile",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Save edit",3,"disabled","click"],["mat-icon-button","","matTooltip","Add Profile Item",3,"click"],["mat-icon-button","","matTooltip","Add New Sub-Profile To Selected Profile",3,"click"]],template:function(t,e){1&t&&(s.Ec(0,ec,3,0,"button",0),s.Vb(1,"button",1),s.cc("click",(function(){return e.deleteProfileOrProfileItem()})),s.Vb(2,"mat-icon",2),s.Gc(3,"delete"),s.Ub(),s.Ub(),s.Ec(4,ic,3,0,"button",3),s.Vb(5,"button",4),s.cc("click",(function(){return e.saveEdit()})),s.Vb(6,"mat-icon"),s.Gc(7,"save"),s.Ub(),s.Ub()),2&t&&(s.mc("ngIf","profile"==(null==e.selectedProfile?null:e.selectedProfile.itemType)),s.Db(4),s.mc("ngIf","profile"==(null==e.selectedProfile?null:e.selectedProfile.itemType)),s.Db(1),s.mc("disabled",null==e.selectedProfile))},directives:[n.m,Ms.b,Wl.a,Hl.a],styles:[""]}),t})();var rc=i("cqs0");const oc=["button"],sc=["*"],ac=new s.s("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS"),lc=new s.s("MatButtonToggleGroup"),cc={provide:As.h,useExisting:Object(s.V)(()=>dc),multi:!0};let hc=0;class uc{constructor(t,e){this.source=t,this.value=e}}let dc=(()=>{class t{constructor(t,e){this._changeDetector=t,this._vertical=!1,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+hc++,this.valueChange=new s.p,this.change=new s.p,this.appearance=e&&e.appearance?e.appearance:"standard"}get name(){return this._name}set name(t){this._name=t,this._buttonToggles&&this._buttonToggles.forEach(t=>{t.name=this._name,t._markForCheck()})}get vertical(){return this._vertical}set vertical(t){this._vertical=Object(Pa.c)(t)}get value(){const t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t.map(t=>t.value):t[0]?t[0].value:void 0}set value(t){this._setSelectionByValue(t),this.valueChange.emit(this.value)}get selected(){const t=this._selectionModel?this._selectionModel.selected:[];return this.multiple?t:t[0]||null}get multiple(){return this._multiple}set multiple(t){this._multiple=Object(Pa.c)(t)}get disabled(){return this._disabled}set disabled(t){this._disabled=Object(Pa.c)(t),this._buttonToggles&&this._buttonToggles.forEach(t=>t._markForCheck())}ngOnInit(){this._selectionModel=new rc.c(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(t=>t.checked))}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}_emitChangeEvent(){const t=this.selected,e=Array.isArray(t)?t[t.length-1]:t,i=new uc(e,this.value);this._controlValueAccessorChangeFn(i.value),this.change.emit(i)}_syncButtonToggle(t,e,i=!1,n=!1){this.multiple||!this.selected||t.checked||(this.selected.checked=!1),this._selectionModel?e?this._selectionModel.select(t):this._selectionModel.deselect(t):n=!0,n?Promise.resolve().then(()=>this._updateModelValue(i)):this._updateModelValue(i)}_isSelected(t){return this._selectionModel&&this._selectionModel.isSelected(t)}_isPrechecked(t){return void 0!==this._rawValue&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(e=>null!=t.value&&e===t.value):t.value===this._rawValue)}_setSelectionByValue(t){this._rawValue=t,this._buttonToggles&&(this.multiple&&t?(Array.isArray(t),this._clearSelection(),t.forEach(t=>this._selectValue(t))):(this._clearSelection(),this._selectValue(t)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(t=>t.checked=!1)}_selectValue(t){const e=this._buttonToggles.find(e=>null!=e.value&&e.value===t);e&&(e.checked=!0,this._selectionModel.select(e))}_updateModelValue(t){t&&this._emitChangeEvent(),this.valueChange.emit(this.value)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.i),s.Pb(ac,8))},t.\u0275dir=s.Kb({type:t,selectors:[["mat-button-toggle-group"]],contentQueries:function(t,e,i){if(1&t&&s.Ib(i,gc,!0),2&t){let t;s.tc(t=s.dc())&&(e._buttonToggles=t)}},hostAttrs:["role","group",1,"mat-button-toggle-group"],hostVars:5,hostBindings:function(t,e){2&t&&(s.Eb("aria-disabled",e.disabled),s.Hb("mat-button-toggle-vertical",e.vertical)("mat-button-toggle-group-appearance-standard","standard"===e.appearance))},inputs:{appearance:"appearance",name:"name",vertical:"vertical",value:"value",multiple:"multiple",disabled:"disabled"},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],features:[s.Cb([cc,{provide:lc,useExisting:t}])]}),t})();class fc{}const pc=Object(ba.t)(fc);let gc=(()=>{class t extends pc{constructor(t,e,i,n,r,o){super(),this._changeDetectorRef=e,this._elementRef=i,this._focusMonitor=n,this._isSingleSelector=!1,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new s.p;const a=Number(r);this.tabIndex=a||0===a?a:null,this.buttonToggleGroup=t,this.appearance=o&&o.appearance?o.appearance:"standard"}get buttonId(){return this.id+"-button"}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(t){this._appearance=t}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(t){const e=Object(Pa.c)(t);e!==this._checked&&(this._checked=e,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(t){this._disabled=Object(Pa.c)(t)}ngOnInit(){const t=this.buttonToggleGroup;this._isSingleSelector=t&&!t.multiple,this.id=this.id||"mat-button-toggle-"+hc++,this._isSingleSelector&&(this.name=t.name),t&&(t._isPrechecked(this)?this.checked=!0:t._isSelected(this)!==this._checked&&t._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const t=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),t&&t._isSelected(this)&&t._syncButtonToggle(this,!1,!1,!0)}focus(t){this._buttonElement.nativeElement.focus(t)}_onButtonClick(){const t=!!this._isSingleSelector||!this._checked;t!==this._checked&&(this._checked=t,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.change.emit(new uc(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(lc,8),s.Pb(s.i),s.Pb(s.m),s.Pb(pa.f),s.ac("tabindex"),s.Pb(ac,8))},t.\u0275cmp=s.Jb({type:t,selectors:[["mat-button-toggle"]],viewQuery:function(t,e){if(1&t&&s.Jc(oc,!0),2&t){let t;s.tc(t=s.dc())&&(e._buttonElement=t.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(t,e){1&t&&s.cc("focus",(function(){return e.focus()})),2&t&&(s.Eb("aria-label",null)("aria-labelledby",null)("id",e.id)("name",null),s.Hb("mat-button-toggle-standalone",!e.buttonToggleGroup)("mat-button-toggle-checked",e.checked)("mat-button-toggle-disabled",e.disabled)("mat-button-toggle-appearance-standard","standard"===e.appearance))},inputs:{disableRipple:"disableRipple",ariaLabelledby:["aria-labelledby","ariaLabelledby"],tabIndex:"tabIndex",appearance:"appearance",checked:"checked",disabled:"disabled",id:"id",name:"name",ariaLabel:["aria-label","ariaLabel"],value:"value"},outputs:{change:"change"},exportAs:["matButtonToggle"],features:[s.Ab],ngContentSelectors:sc,decls:6,vars:9,consts:[["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"id","disabled","click"],["button",""],[1,"mat-button-toggle-label-content"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(t,e){if(1&t&&(s.lc(),s.Vb(0,"button",0,1),s.cc("click",(function(){return e._onButtonClick()})),s.Vb(2,"span",2),s.kc(3),s.Ub(),s.Ub(),s.Qb(4,"span",3),s.Qb(5,"span",4)),2&t){const t=s.uc(1);s.mc("id",e.buttonId)("disabled",e.disabled||null),s.Eb("tabindex",e.disabled?-1:e.tabIndex)("aria-pressed",e.checked)("name",e.name||null)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledby),s.Db(5),s.mc("matRippleTrigger",t)("matRippleDisabled",e.disableRipple||e.disabled)}},directives:[ba.n],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;border-radius:2px;-webkit-tap-highlight-color:transparent}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:4px}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:1}.cdk-high-contrast-active .mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:.5}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.04}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.12}.cdk-high-contrast-active .mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:.5}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:inline-block;line-height:36px;padding:0 16px;position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{border-radius:inherit;pointer-events:none;opacity:0;top:0;left:0;right:0;bottom:0;position:absolute}.mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 36px}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}\n"],encapsulation:2,changeDetection:0}),t})(),mc=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[ba.g,ba.o],ba.g]}),t})(),bc=(()=>{class t{constructor(){}pluck(t,e){return null==t?null:t.map((function(t){return t[e]}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),vc=(()=>{class t{constructor(t){this.sharedUtilitiesService=t}getHierarchyForSubGroupGraph(t,e,i,n){const r={children:this.findSubScoresForProfile(t,e).map(t=>{var e;const r=i[t.id].originalId;return{name:r,value:t.score,itemScore:t.score,weight:null!==(e=n[r])&&void 0!==e?e:1}})},o=this.sharedUtilitiesService.pluck(r.children,"weight"),s=this.sumNumberArray(o),a=kr(r);return a.sum(t=>t.weight?t.weight/s:0),{hierarchyForGraph:a,weightSum:s}}findSubScoresForProfile(t,e){return Object.values(e).filter(e=>0==e.id.indexOf(t))}sumNumberArray(t){return null==t?null:function(t,e){let i=0;for(let n of t)(n=+n)&&(i+=n);return i}(t)}getHierarchyForMainGraph(t,e,i){const n={children:Object.values(t).map(t=>Object.assign(Object.assign({},t),{weight:e[t.id],name:i[t.id].name}))},r=this.sharedUtilitiesService.pluck(n.children,"weight"),o=this.sumNumberArray(r),s=kr(n);return s.sum(t=>t.weight?t.weight/o:0),{hierarchyForGraph:s,weightSum:o}}renameMainGraphComponent(t){return t.replace("asset","collateral")}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(bc))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const yc=["chart"],wc=["toolTip"];function _c(t,e){if(1&t){const t=s.Wb();s.Vb(0,"div",3),s.Vb(1,"a",4),s.cc("click",(function(){return s.wc(t),s.gc().showMainGraph()})),s.Qb(2,"span",5),s.Ub(),s.Gc(3),s.Ub()}if(2&t){const t=s.gc();s.Bc("background-color",t.titleBackground),s.mc("title",t.chartTitle),s.Db(1),s.mc("routerLink",null),s.Db(2),s.Ic(" ",t.chartTitle," ")}}let xc=(()=>{class t{constructor(t,e,i){this.bloomaResizeListenerService=t,this.seedScoreBreakdownGraphService=e,this.unsubscribe$=new kt.a,this.viewInitialized=!1,this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.graphConfiguration="main",this.green="#d5fdf4",this.yellow="#fef6e7",this.red="#fee7e6",this.titlecasePipe=new n.v,this.titleDivHeight=32,this.padding=15;const r=new kt.a;r.pipe(Object(Ct.a)(400),Object(Pt.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=r,this.percentPipe=new n.t(i)}get scoreResponse(){return this._seedResponse}set scoreResponse(t){this._seedResponse=t,this.createSubject.next()}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},800)}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Pt.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}createChart(){if(!this.viewInitialized)return;if(this.chartTitle=null,!this.scoreResponse||!this.scoreResponse.map.rootScore.totalScore)return void(this.svg&&this.svg.selectAll(".node").remove());const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.normalizeData(),this.initSvg(),this.setSvgHeight(),this.drawSquares())}normalizeData(){if("main"==this.graphConfiguration){const{hierarchyForGraph:t,weightSum:e}=this.seedScoreBreakdownGraphService.getHierarchyForMainGraph(this.scoreResponse.map.profileScores,this.weights[this.profileId],this.profileMap);this.d3HierarchyForGraph=t,this.weightSum=e,this.mainWeightSum=e}else{const{hierarchyForGraph:t,weightSum:e}=this.seedScoreBreakdownGraphService.getHierarchyForSubGroupGraph(this.selectedProfileScore,this.scoreResponse.map.profileItemScores,this.profileMap,this.weights[this.selectedProfileScore]);this.d3HierarchyForGraph=t,this.weightSum=e}}getSubGraphReason(){return this.scoreResponse.map.profileScores[this.selectedProfileScore]}initSvg(){this.svg||(this.svg=li(this.chartContainer.nativeElement).style("position","relative"))}setSvgHeight(){this.svg.style("height",this.totalComponentHeight).style("width",this.totalComponentWidth)}drawSquares(){this.svg.selectAll(".node").remove();const t="main"==this.graphConfiguration?0:this.titleDivHeight,e=this.totalComponentWidth,i=this.totalComponentHeight-t,n=function(){var t=zr,e=!1,i=1,n=1,r=[0],o=Br,s=Br,a=Br,l=Br,c=Br;function h(t){return t.x0=t.y0=0,t.x1=i,t.y1=n,t.eachBefore(u),r=[0],e&&t.eachBefore(Er),t}function u(e){var i=r[e.depth],n=e.x0+i,h=e.y0+i,u=e.x1-i,d=e.y1-i;u<n&&(n=u=(n+u)/2),d<h&&(h=d=(h+d)/2),e.x0=n,e.y0=h,e.x1=u,e.y1=d,e.children&&(i=r[e.depth+1]=o(e)/2,n+=c(e)-i,h+=s(e)-i,(u-=a(e)-i)<n&&(n=u=(n+u)/2),(d-=l(e)-i)<h&&(h=d=(h+d)/2),t(e,n,h,u,d))}return h.round=function(t){return arguments.length?(e=!!t,h):e},h.size=function(t){return arguments.length?(i=+t[0],n=+t[1],h):[i,n]},h.tile=function(e){return arguments.length?(t=Vr(e),h):t},h.padding=function(t){return arguments.length?h.paddingInner(t).paddingOuter(t):h.paddingInner()},h.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:Rr(+t),h):o},h.paddingOuter=function(t){return arguments.length?h.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):h.paddingTop()},h.paddingTop=function(t){return arguments.length?(s="function"==typeof t?t:Rr(+t),h):s},h.paddingRight=function(t){return arguments.length?(a="function"==typeof t?t:Rr(+t),h):a},h.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:Rr(+t),h):l},h.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:Rr(+t),h):c},h}().size([e,i]);n.padding(5);const r=n(this.d3HierarchyForGraph).descendants();r.shift(),this.setTitle();const o=this.svg.selectAll("div.node").data(r).enter().append("div").attr("class","node").style("overflow","hidden").style("position","absolute").style("left",t=>t.x0+"px").style("top",e=>e.y0+t+"px").style("width",(function(t){return Math.max(0,t.x1-t.x0)+"px"})).style("height",(function(t){return Math.max(0,t.y1-t.y0)+"px"})).style("background-color",t=>t.data.children?"transparent":this.getBackgroundColorForScore(t.data.itemScore));"main"==this.graphConfiguration?(this.setClickActions(o),this.drawMainLabels(o),this.setTooltip(o,t=>`${this.titlecasePipe.transform(this.seedScoreBreakdownGraphService.renameMainGraphComponent(t.data.name))} Analysis (${this.percentPipe.transform(t.data.weight/this.weightSum)}). Score ${t.data.score}`)):(this.drawSubLabels(o),this.setTooltip(o,t=>`${t.data.name}. Score ${t.data.itemScore}`))}getBackgroundColorForScore(t){return t>=80?this.green:t>=60?this.yellow:this.red}setClickActions(t){t.style("cursor","pointer"),t.on("click",(t,e)=>{this.chartTitle=null,this.clickedSubItem=e.data,this.graphConfiguration="subProfile",this.selectedProfileScore=e.data.id,this.createSubject.next()})}drawSubLabels(t){t.append("div").style("color","black").style("padding","5px 10px").style("font-size","1rem").style("font-weight","bold").text(t=>t.data.name),t.append("div").style("color","black").style("padding","5px 10px").style("font-size",".875rem").text(t=>"Score "+t.data.itemScore)}setTitle(){let t=null;"main"!==this.graphConfiguration&&(this.titleBackground=this.getBackgroundColorForScore(this.clickedSubItem.itemScore),t=this.getSubTitle()),setTimeout(()=>{this.chartTitle=t},1)}setMainTitle(){return"Analysis: This is a great deal with low risk."}getSubTitle(){const t=this.clickedSubItem.weight/this.mainWeightSum;return`Dna Score.${this.titlecasePipe.transform(this.seedScoreBreakdownGraphService.renameMainGraphComponent(this.graphConfiguration))} Analysis\n    (${this.percentPipe.transform(t)})`}setTooltip(t,e){t.each((t,i,n)=>{t.data.children||li(n[i]).attr("title",t=>e(t))})}drawMainLabels(t){t.append("div").style("color","black").style("font-size","1rem").style("padding","5px 10px").style("font-weight","bold").text(t=>this.titlecasePipe.transform(this.seedScoreBreakdownGraphService.renameMainGraphComponent(`${t.data.name} Analysis (${this.percentPipe.transform(t.data.weight/this.weightSum)})`))),t.append("div").style("padding","5px 10px").style("color","black").style("font-size",".875rem").text(t=>"Score "+t.data.score)}showMainGraph(){this.graphConfiguration="main",this.createSubject.next()}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Is),s.Pb(vc),s.Pb(s.w))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-seed-score-breakdown-graph"]],viewQuery:function(t,e){if(1&t&&(s.Jc(yc,!0),s.Jc(wc,!0)),2&t){let t;s.tc(t=s.dc())&&(e.chartContainer=t.first),s.tc(t=s.dc())&&(e.tooltipDiv=t.first)}},inputs:{scoreResponse:"scoreResponse",weights:"weights",profileId:"profileId",profileMap:"profileMap"},decls:3,vars:1,consts:[["id","seed-score-breakdown-graph",1,"seed-score-breakdown-graph"],["chart",""],["class","chart-title uk-text-truncate center-center",3,"title","background-color",4,"ngIf"],[1,"chart-title","uk-text-truncate","center-center",3,"title"],["id","ga-link-show-main-chart",3,"routerLink","click"],["uk-icon","arrow-left"]],template:function(t,e){1&t&&(s.Vb(0,"div",0,1),s.Ec(2,_c,4,5,"div",2),s.Ub()),2&t&&(s.Db(2),s.mc("ngIf","main"!=e.graphConfiguration&&null!=e.chartTitle))},directives:[n.m],styles:['.seed-score-breakdown-graph-tooltip-container[_ngcontent-%COMP%]   .seed-score-breakdown-graph-tooltip[_ngcontent-%COMP%]:before{content:"";position:absolute;height:8px;width:8px;background-color:inherit;box-sizing:border-box;transform:rotate(45deg);border-bottom:inherit;border-right:inherit;box-shadow:inherit}.seed-score-breakdown-graph[_ngcontent-%COMP%]{height:inherit;width:inherit;position:relative}.seed-score-breakdown-graph-tooltip-container[_ngcontent-%COMP%]{position:absolute;opacity:0}.seed-score-breakdown-graph-tooltip-container[_ngcontent-%COMP%]   .seed-score-breakdown-graph-tooltip[_ngcontent-%COMP%]{position:absolute;top:-59px;left:-108px;background-color:#000;display:flex;align-items:center;justify-content:center;width:240px;height:44px;padding:6px;font:14px sans-serif;border:0;border-radius:3px;pointer-events:none;flex-direction:column;font-size:11px;color:#fff;z-index:2000}.seed-score-breakdown-graph-tooltip-container[_ngcontent-%COMP%]   .seed-score-breakdown-graph-tooltip[_ngcontent-%COMP%]   .deal-address[_ngcontent-%COMP%]{color:#bbb}.seed-score-breakdown-graph-tooltip-container[_ngcontent-%COMP%]   .seed-score-breakdown-graph-tooltip[_ngcontent-%COMP%]:before{top:52px}.chart-title[_ngcontent-%COMP%]{position:absolute;left:5px;width:calc(100% - 10px);height:32px;display:flex;justify-content:flex-start;align-items:center}.chart-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-flex}.chart-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{height:30px;width:20px;display:flex;justify-content:center;align-items:center}']}),t})();var Sc=i("Meci");const Ic={provide:As.h,useExisting:Object(s.V)(()=>kc),multi:!0};let kc=(()=>{class t{constructor(){this.isDisabled=!1,this.max=100,this.propagateChange=t=>{},this.propagateTouched=t=>{}}writeValue(t){void 0!==t&&(this.value=t,this.propagateChange(this.value),this.propagateTouched(this.value))}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){this.propagateTouched=t}changeMade(t){this.propagateChange(t.value)}setDisabledState(t){this.isDisabled=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-slider-control"]],inputs:{value:"value",max:"max"},features:[s.Cb([Ic])],decls:1,vars:3,consts:[["thumbLabel","","tickInterval","1","min","1",3,"max","ngModel","disabled","ngModelChange","change"]],template:function(t,e){1&t&&(s.Vb(0,"mat-slider",0),s.cc("ngModelChange",(function(t){return e.value=t}))("change",(function(t){return e.changeMade(t)})),s.Ub()),2&t&&s.mc("max",e.max)("ngModel",e.value)("disabled",e.isDisabled)},directives:[Ps.a,As.j,As.m],styles:[""]}),t})(),Cc=(()=>{class t{constructor(t){this.profileStateService=t}transform(t){return Object(o.a)(this,void 0,void 0,(function*(){return null==t?null:(yield this.profileStateService.getProfileMapInState())[t]}))}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Gs.a))},t.\u0275pipe=s.Ob({name:"getProfileElementById",type:t,pure:!0}),t})(),Pc=(()=>{class t{transform(t){return null==t?null:"profile"==t.itemType||"virtual"==t.itemType?t.name:t.originalName}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Ob({name:"getOriginalElementName",type:t,pure:!0}),t})();function Ac(t,e){if(1&t&&(s.Tb(0),s.Vb(1,"div",10),s.hc(2,"getOriginalElementName"),s.Gc(3),s.hc(4,"getOriginalElementName"),s.Ub(),s.Sb()),2&t){const t=e.ngIf;s.Db(1),s.nc("title",s.ic(2,2,t)),s.Db(2),s.Hc(s.ic(4,4,t))}}function Mc(t,e){if(1&t&&(s.Vb(0,"div",4),s.Vb(1,"mat-card"),s.Tb(2,5),s.Ec(3,Ac,5,6,"ng-container",6),s.hc(4,"async"),s.hc(5,"getProfileElementById"),s.Vb(6,"mat-card-content"),s.Vb(7,"mat-form-field",7),s.Vb(8,"mat-label"),s.Gc(9,"Weight"),s.Ub(),s.Qb(10,"input",8),s.Ub(),s.Qb(11,"dh-slider-control",9),s.Ub(),s.Sb(),s.Ub(),s.Ub()),2&t){const t=e.index,i=s.gc();s.Db(2),s.mc("formGroupName",t),s.Db(1),s.mc("ngIf",s.ic(4,6,s.ic(5,8,i.subProfiles.controls[t].get("id").value))),s.Db(7),s.nc("max",i.max),s.mc("value",i.subProfiles.controls[t].value.weight),s.Db(1),s.mc("max",i.max)("value",i.subProfiles.controls[t].value.weight)}}let Tc=(()=>{class t{constructor(t){this.formBuilder=t,this.max=100,this.removeParentIdFromSubProfile=new ql}get ids(){return this._ids}set ids(t){this._ids=t,setTimeout(()=>{this.updateForm()},100)}ngOnInit(){this.form=this.formBuilder.group({subProfiles:this.formBuilder.array(this.getFormGroupsForIds())})}updateForm(){var t=this.subProfiles;t.clear();var e=this.getFormGroupsForIds();for(const i of e)t.push(i)}get subProfiles(){return this.form.get("subProfiles")}getFormGroupsForIds(){return this.ids.map(t=>{var e;const i=this.removeParentIdFromSubProfile.transform(t,this.parentProfileId);return this.formBuilder.group({id:[t,[]],weight:[null!==(e=this.weights[i])&&void 0!==e?e:1,[]],isItem:[i!==t]})})}getChanges(){const t=this.subProfiles.controls.map(t=>t.value).reduce((t,e)=>(t[e.id]=e.weight,t),{});return this.ids.reduce((e,i)=>{const n=this.removeParentIdFromSubProfile.transform(i,this.parentProfileId),r=t[i];return r!=this.weights[n]&&e.push({newWeight:r,id:i}),e},[])}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(As.c))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-sub-profiles-edit"]],inputs:{ids:"ids",parentProfileId:"parentProfileId",weights:"weights"},decls:5,vars:2,consts:[[1,"mt-10"],["ngxsForm","selectionActions.subProfileWeightForm",3,"formGroup"],["formArrayName","subProfiles",1,"mt-10"],["class","mb-10",4,"ngFor","ngForOf"],[1,"mb-10"],[3,"formGroupName"],[4,"ngIf"],[1,"w-full"],["type","number","min","1","matInput","","placeholder","Name","formControlName","weight","matInput","","placeholder","element weight",3,"max","value"],["formControlName","weight",1,"w-full",3,"max","value"],[1,"truncate",3,"title"]],template:function(t,e){1&t&&(s.Vb(0,"h3",0),s.Gc(1,"Sub Element names:"),s.Ub(),s.Tb(2,1),s.Vb(3,"div",2),s.Ec(4,Mc,12,10,"div",3),s.Ub(),s.Sb()),2&t&&(s.Db(2),s.mc("formGroup",e.form),s.Db(2),s.mc("ngForOf",e.subProfiles.controls))},directives:[Ws.d,As.k,As.e,As.b,n.l,Sc.a,As.f,n.m,Sc.b,Ll.b,Ll.e,As.n,Nl.a,As.a,As.j,As.d,kc],pipes:[n.b,Cc,Pc],styles:[""]}),t})();const Ec=["chart"];let Oc=(()=>{class t{constructor(t,e,i){this.bloomaResizeListenerService=t,this.sharedUtilitiesService=e,this.selectionActionStateService=i,this._scores=null,this.readOnly=!1,this.insertNewValueScore=new s.p,this.unsubscribe$=new kt.a,this.viewInitialized=!1,this.margin={top:10,bottom:100,left:30,right:10},this.totalComponentWidth=0,this.isListening=!1,this.totalComponentHeight=0,this.widthOfBarChart=0,this.yAxisWidth=30;const n=new kt.a;n.pipe(Object(Ct.a)(300),Object(Pt.a)(this.unsubscribe$)).subscribe(t=>this.createChart()),this.createSubject=n}get scores(){return this._scores}set scores(t){const e=this.normalizeData(t);this.isDataUpdated(this.scores,e)&&(this._scores=e,this.createSubject.next())}ngOnDestroy(){this.bloomaResizeListenerService.unListenToElementResize(this.chartContainer.nativeElement),this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){}listenToElementSizeChange(t){this.isListening||(this.isListening=!0,this.bloomaResizeListenerService.listenToElementResize(t).pipe(Object(Pt.a)(this.unsubscribe$)).subscribe(t=>{this.createSubject.next()}))}isDataUpdated(t,e){if(null==t&&null!=e)return!0;if(t.length!=e.length)return!0;for(let i=0;i<t.length;i++){if(t[i].name!=e[i].name)return!0;if(t[i].score!=e[i].score)return!0}return!1}ngAfterViewInit(){this.viewInitialized=!0,this.listenToElementSizeChange(this.chartContainer.nativeElement),setTimeout(()=>{this.createSubject.next()},300)}createChart(){if(!this.viewInitialized)return;const t=this.chartContainer.nativeElement;this.totalComponentWidth=t.offsetWidth,this.totalComponentHeight=t.offsetHeight,0!=this.totalComponentHeight&&(this.initSvg(),this.setSvgHeight(),this.widthOfBarChart=this.totalComponentWidth-this.yAxisWidth-this.margin.left-this.margin.right,this.createScales(),this.drawAxes(),this.drawScoresLines(),this.drawScoresArea(),this.drawCircles(),setTimeout(()=>{Object(s.mb)(this)},50))}normalizeData(t){return null==t?null:t.map(t=>({name:t.name,score:Tt([t.score,100])}))}initSvg(){if(!this.svg){const t=li(this.chartContainer.nativeElement).append("svg");this.svg=t}}setSvgHeight(){this.svg.attr("height",this.totalComponentHeight).attr("width",this.totalComponentWidth)}createScales(){const t=this.sharedUtilitiesService.pluck(this.scores,"name"),e=this.margin.left;this.scaleX=function(){return Ur(Nr.apply(null,arguments).paddingInner(1))}().domain(t).range([e,e+this.widthOfBarChart]),this.scaleY=function t(){var e=ro();return e.copy=function(){return no(e,t())},jr.apply(e,arguments),wo(e)}().domain([0,100]).range([this.totalComponentHeight-this.margin.bottom,this.margin.top]).nice()}drawAxes(){const t=(e=this.scaleY,Lt(4,e)).tickSize(-this.widthOfBarChart).tickValues(Et(0,100.5,10));var e;const i=function(t){return Lt(3,t)}(this.scaleX),n=this.getAxes();n.yAxis.transition().call(t),n.yAxis.selectAll(".tick text").attr("dx","-0.5em"),n.xAxis.transition().call(i).selectAll(".tick text").style("font-size",this.totalComponentWidth>686?"18px":"14px"),n.xAxis.style("text-anchor","start"),n.xAxis.selectAll(".tick text").attr("dy","0.5em").attr("dx",8).attr("transform","rotate(90)")}getAxes(){this.svg.select(".axes").remove();const t=this.svg.insert("g").attr("class","axes");return{yAxis:t.append("g").attr("class","axis-y axis").attr("transform","translate("+[this.margin.left,0]+")"),xAxis:t.append("g").attr("class","axis-x axis").attr("transform",`translate(0, ${this.totalComponentHeight-this.margin.bottom})`)}}drawScoresLines(){this.svg.select(".line").remove();const t=this.svg.append("g").attr("class","line");this.line=zo().x(t=>this.scaleX(t.name)).y(t=>this.scaleY(t.score)).curve(No),t.append("path").datum(this.scores).attr("class","data-line").attr("d",this.line)}drawClickableArea(){this.svg.select(".clickable-area").remove(),this.svg.append("g").attr("class","clickable-area").append("rect").attr("x",this.margin.left).attr("y",this.margin.top).attr("fill","white").attr("fill-opacity",.01).attr("width",this.widthOfBarChart).attr("height",this.totalComponentHeight-this.margin.top-this.margin.bottom).on("click",t=>this.addNewValueScore(t))}drawCircles(){this.readOnly||this.drawClickableArea(),this.svg.select(".dots").remove();const t=this.svg.append("g").attr("class","dots").selectAll("circle").data(this.scores).enter().append("circle").attr("class","circle").attr("r",5).attr("id",t=>"c"+t.name).attr("cx",t=>this.scaleX(t.name)).attr("cy",t=>this.scaleY(t.score));if(!this.readOnly){const e=this.createDragBehavior();t.style("cursor","pointer").call(e)}}drawScoresArea(){this.svg.select(".area").remove();const t=this.svg.append("g").attr("class","area");this.area=function(t,e,i){var n=null,r=Mo(!0),o=null,s=Eo,a=null;function l(l){var c,h,u,d,f,p=(l=Ao(l)).length,g=!1,m=new Array(p),b=new Array(p);for(null==o&&(a=s(f=Po())),c=0;c<=p;++c){if(!(c<p&&r(d=l[c],c,l))===g)if(g=!g)h=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),u=c-1;u>=h;--u)a.point(m[u],b[u]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+t(d,c,l),b[c]=+e(d,c,l),a.point(n?+n(d,c,l):m[c],i?+i(d,c,l):b[c]))}if(f)return a=null,f+""||null}function c(){return zo().defined(r).curve(s).context(o)}return t="function"==typeof t?t:void 0===t?Oo:Mo(+t),e="function"==typeof e?e:Mo(void 0===e?0:+e),i="function"==typeof i?i:void 0===i?Do:Mo(+i),l.x=function(e){return arguments.length?(t="function"==typeof e?e:Mo(+e),n=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:Mo(+e),l):t},l.x1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Mo(+t),l):n},l.y=function(t){return arguments.length?(e="function"==typeof t?t:Mo(+t),i=null,l):e},l.y0=function(t){return arguments.length?(e="function"==typeof t?t:Mo(+t),l):e},l.y1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Mo(+t),l):i},l.lineX0=l.lineY0=function(){return c().x(t).y(e)},l.lineY1=function(){return c().x(t).y(i)},l.lineX1=function(){return c().x(n).y(e)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:Mo(!!t),l):r},l.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),l):s},l.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),l):o},l}().x(t=>this.scaleX(t.name)).y(t=>this.scaleY(t.score)).y1(this.scaleY(0)).curve(No),t.append("path").datum(this.scores).attr("class","data-area").attr("d",this.area).attr("fill","rgb(161,195,214)").attr("fill-opacity",.5)}createDragBehavior(){return Sr().on("start",t=>this.dragstarted(t)).on("drag",(t,e,i)=>this.dragged(t,e)).on("end",t=>this.dragended(t))}dragstarted(t){li(t.sourceEvent.target).raise().classed("active",!0)}dragged(t,e){const i=this.scaleY.invert(t.y),n=this.svg.select("circle#c"+e.name),r=this.scaleY.range();t.y>r[0]||t.y<r[1]||(n.attr("cy",t.y),this.updateValueScore(e.name,i),this.refreshLineAndArea())}dragended(t){li(t.sourceEvent.target).classed("active",!1),this.updateRestOfApp()}updateRestOfApp(){this.selectionActionStateService.updateScoreItems(this.scores)}updateValueScore(t,e){null!=this.scores&&(this.scores.find(e=>e.name==t).score=Math.ceil(e))}refreshLineAndArea(){this.svg.select(".data-line").attr("d",this.line),this.svg.select(".data-area").attr("d",this.area)}refreshLineAndCircles(){this.refreshLineAndArea(),this.drawCircles()}addNewValueScore(t){var e=Math.ceil(this.scaleY.invert(t.offsetY)),i=t.offsetX,n=0;0!==this.scores.length&&(n=this.scores.findIndex(t=>{var e=this.scaleX(t.name);return i<e})),this.insertNewValueScore.next({index:n,score:e})}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Is),s.Pb(bc),s.Pb($s))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile-item-score-chart"]],viewQuery:function(t,e){if(1&t&&s.Jc(Ec,!0),2&t){let t;s.tc(t=s.dc())&&(e.chartContainer=t.first)}},inputs:{scores:"scores",readOnly:"readOnly"},outputs:{insertNewValueScore:"insertNewValueScore"},decls:2,vars:0,consts:[["id","profile-item-score-graph",1,"profile-item-score-graph"],["chart",""]],template:function(t,e){1&t&&s.Qb(0,"div",0,1)},styles:["#profile-item-score-graph{height:inherit;width:inherit}#profile-item-score-graph .axis-y path{stroke:none}#profile-item-score-graph .axis-y .tick line,#profile-item-score-graph .axis-y line{stroke:#cccced}#profile-item-score-graph .data-line{stroke:#000;stroke-width:2px;fill:none}#profile-item-score-graph .circle{fill:#4682b4;stroke:#000;stroke-width:2px}"],encapsulation:2}),t})();function Dc(t,e){1&t&&(s.Vb(0,"span"),s.Gc(1,"Item "),s.Ub())}function zc(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Vb(1,"dh-profile-item-score-chart",5),s.cc("insertNewValueScore",(function(e){return s.wc(t),s.gc(3).insertNewValueScore(e)})),s.Ub(),s.Sb()}if(2&t){const t=e.ngIf;s.Db(1),s.mc("scores",t)}}function Vc(t,e){if(1&t&&(s.Tb(0),s.Ec(1,zc,2,1,"ng-container",2),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc(2);s.Db(1),s.mc("ngIf",s.ic(2,1,t.selectionActionStateService.scores$))}}function Bc(t,e){if(1&t&&(s.Tb(0),s.Qb(1,"dh-profile-item-form",4),s.Ec(2,Vc,3,3,"ng-container",2),s.Sb()),2&t){const t=s.gc();s.Db(1),s.mc("profile",t.profile),s.Db(1),s.mc("ngIf",t.showGraph)}}function Rc(t,e){if(1&t&&(s.Tb(0),s.Qb(1,"dh-sub-profiles-edit",6),s.hc(2,"getRealSubItems"),s.hc(3,"getFirstRealParentId"),s.Sb()),2&t){const t=e.ngIf,i=s.gc().ngIf,n=s.gc(2);s.Db(1),s.mc("ids",s.jc(2,3,n.profile,t))("parentProfileId",null==n.profile?null:n.profile.id)("weights",i.weights[s.jc(3,6,null==n.profile?null:n.profile.id,t)])}}function jc(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Rc,4,9,"ng-container",2),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc(2);s.Db(1),s.mc("ngIf",s.ic(2,1,t.profileStateService.profileMap$))}}function Fc(t,e){if(1&t&&(s.Tb(0),s.Ec(1,jc,3,3,"ng-container",2),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc();s.Db(1),s.mc("ngIf",s.ic(2,1,t.weightStateService.weightState$))}}let Lc=(()=>{class t{constructor(t,e,i,n){this.formBuilder=t,this.weightStateService=e,this.profileStateService=i,this.selectionActionStateService=n,this.showGraph=!1}get profile(){return this._profile}set profile(t){this._profile=t,this.updateForm()}ngAfterViewInit(){setTimeout(()=>{this.showGraph=!0},1)}ngOnInit(){this.form=this.formBuilder.group({name:this.profile.name})}updateForm(){var t;null!=this.form&&(null===(t=this.form)||void 0===t||t.patchValue({name:this.profile.name}))}getProfileName(){return this.form.value.name}insertNewValueScore(t){this.profileItemFormComponent.insertRow(t.index,t.score)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(As.c),s.Pb(Ns),s.Pb(Gs.a),s.Pb($s))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile-details-edit"]],viewQuery:function(t,e){if(1&t&&(s.Jc(Tc,!0),s.Jc(Kl,!0)),2&t){let t;s.tc(t=s.dc())&&(e.subProfilesEditComponent=t.first),s.tc(t=s.dc())&&(e.profileItemFormComponent=t.first)}},inputs:{profile:"profile"},decls:9,vars:4,consts:[["ngxsForm","selectionActions.profileNameForm",3,"formGroup"],[1,"w-full"],[4,"ngIf"],["matInput","","placeholder","Name","formControlName","name","matInput","","placeholder","element name"],[3,"profile"],[2,"height","600px",3,"scores","insertNewValueScore"],[3,"ids","parentProfileId","weights"]],template:function(t,e){1&t&&(s.Vb(0,"form",0),s.Vb(1,"mat-form-field",1),s.Vb(2,"mat-label"),s.Gc(3,"Profile "),s.Ec(4,Dc,2,0,"span",2),s.Gc(5,"Name"),s.Ub(),s.Qb(6,"input",3),s.Ub(),s.Ub(),s.Ec(7,Bc,3,2,"ng-container",2),s.Ec(8,Fc,3,3,"ng-container",2)),2&t&&(s.mc("formGroup",e.form),s.Db(4),s.mc("ngIf","profile"!==e.profile.itemType),s.Db(3),s.mc("ngIf",(null==e.profile||null==e.profile.scores?null:e.profile.scores.length)>0),s.Db(1),s.mc("ngIf","virtual"!=e.profile.itemType&&(null==e.profile||null==e.profile.childrenIds?null:e.profile.childrenIds.length)>0))},directives:[As.q,As.k,Ws.d,As.e,Ll.b,Ll.e,n.m,Nl.a,As.a,As.j,As.d,Kl,Oc,Tc],pipes:[n.b,zs,ns],styles:[""]}),t})();function Nc(t,e){if(1&t&&(s.Tb(0),s.Qb(1,"div",2),s.Qb(2,"dh-profile-details-edit",3),s.Sb()),2&t){const t=s.gc();s.Db(2),s.mc("profile",t.profile)}}function Uc(t,e){1&t&&s.Gc(0," No selected profile.\n")}let Gc=(()=>{class t{constructor(t){this.selectionActionStateService=t}}return t.\u0275fac=function(e){return new(e||t)(s.Pb($s))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile-details"]],viewQuery:function(t,e){if(1&t&&s.Jc(Lc,!0),2&t){let t;s.tc(t=s.dc())&&(e.profileDetailsEdit=t.first)}},inputs:{profile:"profile"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noProfile",""],[1,"flex","justify-end","mb-16","mt-3"],[3,"profile"]],template:function(t,e){if(1&t&&(s.Ec(0,Nc,3,1,"ng-container",0),s.Ec(1,Uc,1,0,"ng-template",null,1,s.Fc)),2&t){const t=s.uc(2);s.mc("ngIf",e.profile)("ngIfElse",t)}},directives:[n.m,Lc],styles:[""]}),t})();var Wc=i("e2Vc");function Hc(t,e){if(1&t){const t=s.Wb();s.Vb(0,"mat-button-toggle-group",23,24),s.cc("change",(function(){s.wc(t);const e=s.uc(1);return s.gc(5).onRightSideDisplayTypeChange(e.value)})),s.Vb(2,"mat-button-toggle",25),s.Vb(3,"mat-icon"),s.Gc(4,"insights"),s.Ub(),s.Ub(),s.Vb(5,"mat-button-toggle",26),s.Vb(6,"mat-icon"),s.Gc(7,"dehaze"),s.Ub(),s.Ub(),s.Ub()}if(2&t){const t=s.gc(5);s.mc("value",t.rightSideViewType)}}function $c(t,e){if(1&t&&(s.Vb(0,"div",27),s.Qb(1,"dh-seed-score-breakdown-graph",28),s.Ub()),2&t){const t=s.gc(2).ngIf,e=s.gc().ngIf,i=s.gc().ngIf;s.Db(1),s.mc("scoreResponse",t[null==i.selectedProfile?null:i.selectedProfile.id])("weights",e.weights)("profileMap",i.profileMap)("profileId",null==i.selectedProfile?null:i.selectedProfile.id)}}function qc(t,e){if(1&t&&s.Qb(0,"dh-profile-details",29),2&t){const t=s.gc(4).ngIf;s.mc("profile",t.selectedProfile)}}function Yc(t,e){if(1&t){const t=s.Wb();s.Tb(0),s.Vb(1,"as-split",1),s.Vb(2,"as-split-area",2),s.Vb(3,"div",3),s.Vb(4,"mat-tab-group",4),s.Vb(5,"mat-tab",5),s.Vb(6,"div",6),s.Vb(7,"span",7),s.Gc(8,"Available Fields"),s.Ub(),s.Qb(9,"dh-load-available-button"),s.Ub(),s.Vb(10,"div",8),s.Qb(11,"dh-available-tree",9),s.Ub(),s.Ub(),s.Vb(12,"mat-tab",10),s.Qb(13,"dh-score-data-editor"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(14,"as-split-area",11),s.Vb(15,"div",3),s.Vb(16,"div",12),s.Vb(17,"span",13),s.Gc(18,"Profile hierarchy"),s.Ub(),s.Qb(19,"dh-profile-buttons"),s.Ub(),s.Vb(20,"div",14),s.Vb(21,"dh-hierarchy",15),s.cc("profileSelected",(function(e){s.wc(t);const i=s.gc(3).ngIf;return s.gc().selectProfile(e,i.selectedProfile)}))("itemWeightChanged",(function(e){return s.wc(t),s.gc(4).itemWeightValueChanged(e)}))("childProfileWeightChanged",(function(e){return s.wc(t),s.gc(4).childProfileWeightValueChanged(e)}))("disconnectLinkClicked",(function(e){return s.wc(t),s.gc(4).disconnectLinkClicked(e)}))("addSubProfileToProfile",(function(e){return s.wc(t),s.gc(4).addSubProfileToProfile(e)}))("addProfileItemToProfile",(function(e){return s.wc(t),s.gc(4).addProfileItemToProfile(e)}))("addVirtualProfileItemToProfile",(function(e){return s.wc(t),s.gc(4).addVirtualProfileItemToProfile(e)}))("treeItemDropped",(function(e){return s.wc(t),s.gc(4).treeItemDropped(e)})),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Vb(22,"as-split-area",16),s.Vb(23,"div",3),s.Vb(24,"div",17),s.Vb(25,"span",7),s.Gc(26),s.Ub(),s.Qb(27,"dh-profile-details-buttons",18),s.Ub(),s.Vb(28,"div",19),s.Ec(29,Hc,8,1,"mat-button-toggle-group",20),s.hc(30,"keyvalue"),s.Ec(31,$c,2,4,"div",21),s.Ec(32,qc,1,1,"dh-profile-details",22),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Sb()}if(2&t){const t=e.ngIf,i=s.gc().ngIf,n=s.gc().ngIf,r=s.gc().ngIf,o=s.gc();s.Db(1),s.mc("restrictMove",!0),s.Db(3),s.mc("dynamicHeight",!0),s.Db(17),s.mc("data",r.profiles)("profileMap",r.profileMap)("weights",n.weights)("selectedProfileId",t.hasValue?t.value:r.selectedProfile)("scores",i),s.Db(5),s.Ic("",null==r.selectedProfile?null:r.selectedProfile.name," Details"),s.Db(1),s.mc("selectedProfile",r.selectedProfile),s.Db(2),s.mc("ngIf",s.ic(30,12,i).length>0),s.Db(2),s.mc("ngIf","breakdown"==o.rightSideViewType),s.Db(1),s.mc("ngIf","details"==o.rightSideViewType&&r.selectedProfile)}}function Jc(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Yc,33,14,"ng-container",0),s.hc(2,"nullToEmptyNullString"),s.hc(3,"async"),s.Sb()),2&t){const t=s.gc(3);s.Db(1),s.mc("ngIf",s.ic(2,1,s.ic(3,3,t.scoreStateService.scoredProfileId$)))}}function Xc(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Jc,4,5,"ng-container",0),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc(2);s.Db(1),s.mc("ngIf",s.ic(2,1,t.scoreStateService.scores$))}}function Qc(t,e){if(1&t&&(s.Tb(0),s.Ec(1,Xc,3,3,"ng-container",0),s.hc(2,"async"),s.Sb()),2&t){const t=s.gc();s.Db(1),s.mc("ngIf",s.ic(2,1,t.profileVsService.weightState$))}}const Zc=[{path:"",component:(()=>{class t{constructor(t,e,i,n,r,o,s,a,l,c,h){this.profileVsService=t,this.weightStateService=e,this.dhDialogService=i,this.breakpointObserver=n,this.profileStateService=r,this.selectionActionStateService=o,this.dialog=s,this.scoreStateService=a,this.routerAdapterService=l,this.apiKeyStateService=c,this.activatedRoute=h,this.fairlyBigScreen=!0,this.rightSideViewType="details",this.unsubscribe$=new kt.a,this.breakpointObserver.observe("(max-width: 1200px)").subscribe(t=>{this.fairlyBigScreen=0==t.matches})}ngOnInit(){return Object(o.a)(this,void 0,void 0,(function*(){yield this.setAuth(),yield this.loadProfile(),this.scoreStateService.profileScored$.pipe(Object(Pt.a)(this.unsubscribe$)).subscribe(()=>{this.rightSideViewType="breakdown"})}))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}setAuth(){return Object(o.a)(this,void 0,void 0,(function*(){this.apiKeyStateService.setAuth(this.activatedRoute.snapshot.params[Bs.a.profileId])}))}loadProfile(){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading(),this.profileStateService.clearSelection(),this.scoreStateService.clearScores();const t=yield this.profileStateService.getProfiles();this.dhDialogService.hideLoading(),"error"==t&&this.dhDialogService.showMessage("error loading profile")}))}onRightSideDisplayTypeChange(t){this.rightSideViewType=t}selectProfile(t,e){return Object(o.a)(this,void 0,void 0,(function*(){t.selectedNodeId!=(null==e?void 0:e.id)&&(yield this.selectionActionStateService.clearForms(),this.rightSideViewType="details",yield this.profileVsService.selectProfile(t.selectedNodeId),Object(s.mb)(this))}))}itemWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const e=yield this.weightStateService.updateItemLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating item weight":"Item weight updated")}))}childProfileWeightValueChanged(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const e=yield this.profileVsService.updateChildProfileLinkWeight(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error updating child profile weight":"Child profile weight updated")}))}disconnectLinkClicked(t){return Object(o.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({title:"Disconnect Sub Profile",message:"Are you sure you want to disconnect these profiles?"}).toPromise()))return;this.dhDialogService.showLoading();const e=yield this.profileVsService.disconectSubProfile(t);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error disconnecting sub profile":"Sub Profile Disconnected")}))}addSubProfileToProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const e=yield this.profileStateService.conectSubProfile(t.parentProfileId,t.subProfileId);this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error connecting sub profile":"Sub Profile Connected")}))}addProfileItemToProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const e=yield this.profileStateService.addMultipleItems({profileId:t.profileId,multipleProfileItemCreateDto:[{name:t.profileItemName}]});this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(e?"Error adding profile item to profile":"profile item added to profile")}))}addVirtualProfileItemToProfile(t){return Object(o.a)(this,void 0,void 0,(function*(){if(null==t.virtualProfileItem||null==t.profileId)return;this.dhDialogService.showLoading();const e=yield this.getProfileItemsNamesUnderVirtualProfileId(t.virtualProfileItem);if(null==e||e.length<1)return;const i=yield this.profileStateService.addMultipleItems({profileId:t.profileId,multipleProfileItemCreateDto:e});this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(i?"Error adding profile item to profile":"profile item added to profile")}))}getProfileItemsNamesUnderVirtualProfileId(t){return Object(o.a)(this,void 0,void 0,(function*(){const e=new zs,i=yield this.profileStateService.profileMap$.pipe(Object(Vs.a)()).toPromise();return e.transform(t,i).map(t=>({name:i[t].originalName}))}))}treeItemDropped(t){return Object(o.a)(this,void 0,void 0,(function*(){const e=[];for(const n of t.droppedData)this.getMultipleItemsRequestFromData(n,e);if(0==e.length)return void this.dhDialogService.showErrorMessage("No items added.");this.dhDialogService.showLoading();const i=yield this.profileStateService.addMultipleItems({profileId:t.dropTargetId,multipleProfileItemCreateDto:e});this.dhDialogService.hideLoading(),this.dhDialogService.showMessage(i?"Error adding multiple items.":"Multiple items added.")}))}getMultipleItemsRequestFromData(t,e){if(null!=t&&null!=e)if(t.isEdge)e.push({name:t.fullPath});else if(null!=(null==t?void 0:t.children))for(const i of null==t?void 0:t.children)this.getMultipleItemsRequestFromData(i,e)}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(Rs.a),s.Pb(Ns),s.Pb(ks.a),s.Pb(Us.a),s.Pb(Gs.a),s.Pb($s),s.Pb(qs.b),s.Pb(Ys.a),s.Pb(Js.a),s.Pb(Xs.a),s.Pb(r.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["dh-profile"]],viewQuery:function(t,e){if(1&t&&s.Jc(Ds,!0),2&t){let t;s.tc(t=s.dc())&&(e.hierarchyComponent=t.first)}},decls:2,vars:3,consts:[[4,"ngIf"],["unit","percent","gutterSize","10",3,"restrictMove"],["size","25","minSize","5","maxSize","40"],[1,"h-full","p-4"],["animationDuration","0ms",3,"dynamicHeight"],["label","Available Fields"],[1,"flex","justify-between","mt-10"],[1,"text-2xl","leading-8"],[1,"p-4","overflow-y-auto",2,"height","calc( 100% - 50px)"],[1,"block","h-auto"],["label","Data Source"],["size","50","minSize","10","maxSize","90"],[1,"flex",2,"height","30px"],[1,"text-2xl","leading-8","flex-1"],[1,"p-4",2,"height","calc( 100% - 30px)"],[1,"block","flex-1","overflow-hidden","h-full",3,"data","profileMap","weights","selectedProfileId","scores","profileSelected","itemWeightChanged","childProfileWeightChanged","disconnectLinkClicked","addSubProfileToProfile","addProfileItemToProfile","addVirtualProfileItemToProfile","treeItemDropped"],["size","25","minSize","5","maxSize","40","id","uuuu"],[1,"flex","justify-between",2,"height","30px"],[3,"selectedProfile"],[1,"xl:p-4","overflow-y-auto",2,"height","calc( 100% - 30px)"],[3,"value","change",4,"ngIf"],["class","mt-20",4,"ngIf"],["class","block px-4 text-base",3,"profile",4,"ngIf"],[3,"value","change"],["group","matButtonToggleGroup"],["value","breakdown","aria-label","Score breakdown"],["value","details","aria-label","Profile details"],[1,"mt-20"],[2,"height","300px",3,"scoreResponse","weights","profileMap","profileId"],[1,"block","px-4","text-base",3,"profile"]],template:function(t,e){1&t&&(s.Ec(0,Qc,3,3,"ng-container",0),s.hc(1,"async")),2&t&&s.mc("ngIf",s.ic(1,1,e.profileVsService.profileState$))},directives:[n.m,ua,da,dl,el,Al,Dl,Fl,$l,Ds,nc,dc,gc,Hl.a,xc,Gc],pipes:[n.b,Wc.a,n.g],styles:[".full-height-without-top-bar[_ngcontent-%COMP%]{height:calc(100vh - 76px)}"]}),t})()}];let Kc=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[r.e.forChild(Zc)],r.e]}),t})();var th=i("W1gw");i("9bRT"),i("C05f"),i("J+dc"),i("xVbo");let eh=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)}}),t})();i("YtkY");let ih=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[eh,ba.g],ba.g]}),t})();var nh=i("evil"),rh=i("Yclt"),oh=i("lQ7A"),sh=i("aYrn"),ah=i("3h9P"),lh=i("9Xeq");let ch=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},providers:[ks.a],imports:[[Ws.a,n.c,Kc,As.g,As.o,Ps.b,Ms.c,Ll.d,Nl.b,th.b,ih,Hl.b,qs.f,nh.a,Jl.b,rh.a,Cs.c,oh.d,Sc.c,fa,sh.a,mc,Wl.b,wl,ah.a,lh.a]]}),t})()}}]);