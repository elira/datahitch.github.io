(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"r/eb":function(t,e,o){"use strict";o.r(e),o.d(e,"AccountUsersModule",(function(){return N}));var c=o("2kYt"),i=o("sEIs"),s=o("D57K"),r=o("EM62"),n=o("iAde"),a=o("cePI"),u=o("FlRo"),d=o("xJCX"),l=o("OZ4H"),h=o("nKqi"),b=o("NAEz"),m=o("EmTj"),f=o("PBFl"),g=o("nIj0");function v(t,e){if(1&t&&(r.Vb(0,"mat-list-option",9),r.Gc(1),r.Ub()),2&t){const t=e.$implicit;r.mc("value",t),r.Db(1),r.Ic(" ",t.email," ")}}function S(t,e){if(1&t){const t=r.Wb();r.Vb(0,"mat-selection-list",6,7),r.cc("ngModelChange",(function(e){return r.wc(t),r.gc().selectedUsers=e})),r.Ec(2,v,2,2,"mat-list-option",8),r.Ub()}if(2&t){const t=r.gc();r.mc("ngModel",t.selectedUsers),r.Db(2),r.mc("ngForOf",t.users)}}let p=(()=>{class t{constructor(t,e,o,c){this.dialogRef=t,this.data=e,this.usersStateService=o,this.dhDialogService=c,this.ready=!1,this.title=(null==e?void 0:e.title)||"Select User",this.message=(null==e?void 0:e.message)||"User will be added to account"}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.usersStateService.getAllusers())?this.dhDialogService.showErrorMessage("Could not load users."):(this.users=this.usersStateService.getUsersInState(),this.ready=!0,Object(r.mb)(this))}))}onConfirm(){console.log(this.matSelectionList.selectedOptions),console.log(this.selectedUsers),this.dialogRef.close({continue:!0,users:this.selectedUsers})}onDismiss(){this.dialogRef.close({continue:!1})}}return t.\u0275fac=function(e){return new(e||t)(r.Pb(l.g),r.Pb(l.a),r.Pb(b.a),r.Pb(m.a))},t.\u0275cmp=r.Jb({type:t,selectors:[["dh-select-user-modal"]],viewQuery:function(t,e){if(1&t&&r.Jc(h.c,!0),2&t){let t;r.tc(t=r.dc())&&(e.matSelectionList=t.first)}},decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"ngModel","ngModelChange"],["userList",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(r.Vb(0,"h1",0),r.Gc(1),r.Ub(),r.Vb(2,"div",1),r.Vb(3,"p"),r.Gc(4),r.Ub(),r.Ub(),r.Ec(5,S,3,2,"mat-selection-list",2),r.Vb(6,"div",3),r.Vb(7,"button",4),r.cc("click",(function(){return e.onDismiss()})),r.Gc(8,"Cancel"),r.Ub(),r.Vb(9,"button",5),r.cc("click",(function(){return e.onConfirm()})),r.Gc(10,"Ok"),r.Ub(),r.Ub()),2&t&&(r.Db(1),r.Ic(" ",e.title,"\n"),r.Db(3),r.Hc(e.message),r.Db(1),r.mc("ngIf",e.ready))},directives:[c.m,f.b,h.c,g.j,g.m,c.l,h.b],styles:[""],changeDetection:0}),t})();var U=o("yDe4"),D=o("88VA"),w=o("ftZj"),y=o("fJbr");let A=(()=>{class t{constructor(t,e){this.store=t,this.stateHelperService=e}getAccountUsersFromStore(){return this.store.selectSnapshot(w.a.getAccountUsers)}callGetAccountsAction(t){return Object(s.a)(this,void 0,void 0,(function*(){return yield this.stateHelperService.runAction(new D.a(t),w.a.getAccountUsersError)}))}}return t.\u0275fac=function(e){return new(e||t)(r.Zb(U.j),r.Zb(y.a))},t.\u0275prov=r.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),Object(s.b)([Object(U.f)(w.a.getAccountUsers)],t.prototype,"accountUsers$",void 0),t})();var C=o("4Uo2");function I(t,e){1&t&&(r.Vb(0,"th",16),r.Gc(1," ID "),r.Ub())}function E(t,e){if(1&t&&(r.Vb(0,"td",17),r.Gc(1),r.Ub()),2&t){const t=e.$implicit;r.Db(1),r.Ic(" ",t.id," ")}}function V(t,e){1&t&&(r.Vb(0,"th",16),r.Gc(1," user Name "),r.Ub())}function j(t,e){if(1&t&&(r.Vb(0,"td",17),r.Gc(1),r.Ub()),2&t){const t=e.$implicit;r.Db(1),r.Ic(" ",t.userName," ")}}function O(t,e){1&t&&(r.Vb(0,"th",16),r.Gc(1," Email "),r.Ub())}function M(t,e){if(1&t&&(r.Vb(0,"td",17),r.Gc(1),r.Ub()),2&t){const t=e.$implicit;r.Db(1),r.Ic(" ",t.email," ")}}function R(t,e){1&t&&r.Qb(0,"th",18)}function F(t,e){if(1&t){const t=r.Wb();r.Vb(0,"td",17),r.Vb(1,"button",19),r.cc("click",(function(){r.wc(t);const o=e.$implicit;return r.gc(2).showRomevoUserFromAccountModal(o)})),r.Gc(2,"Remove User From Account"),r.Ub(),r.Ub()}}function G(t,e){1&t&&r.Qb(0,"tr",20)}function P(t,e){1&t&&r.Qb(0,"tr",21)}const k=function(){return[5,10,25,100]};function T(t,e){if(1&t&&(r.Vb(0,"div",4),r.Vb(1,"table",5),r.Tb(2,6),r.Ec(3,I,2,0,"th",7),r.Ec(4,E,2,1,"td",8),r.Sb(),r.Tb(5,9),r.Ec(6,V,2,0,"th",7),r.Ec(7,j,2,1,"td",8),r.Sb(),r.Tb(8,10),r.Ec(9,O,2,0,"th",7),r.Ec(10,M,2,1,"td",8),r.Sb(),r.Tb(11,11),r.Ec(12,R,1,0,"th",12),r.Ec(13,F,3,0,"td",8),r.Sb(),r.Ec(14,G,1,0,"tr",13),r.Ec(15,P,1,0,"tr",14),r.Ub(),r.Qb(16,"mat-paginator",15),r.Ub()),2&t){const t=r.gc();r.Db(1),r.mc("dataSource",t.dataSource),r.Db(13),r.mc("matHeaderRowDef",t.displayedColumns),r.Db(1),r.mc("matRowDefColumns",t.displayedColumns),r.Db(1),r.mc("pageSizeOptions",r.oc(4,k))}}const L=[{path:"",component:(()=>{class t{constructor(t,e,o,c,i,s){this.usersStateService=t,this.dialog=e,this.dhDialogService=o,this.accountUsersStateService=c,this.activatedRoute=i,this.accountStateService=s,this.ready=!1,this.displayedColumns=["id","userName","email","actions"],this.usersRoute=d.a.users}getAccountId(){return this.activatedRoute.snapshot.params[d.a.accountId]}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){this.fillDataSource()}))}fillDataSource(){return Object(s.a)(this,void 0,void 0,(function*(){this.ready=!1;const t=yield this.getUsersForAccount();this.dataSource=new u.k(t),this.ready=!0,setTimeout(()=>{this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort},10),Object(r.mb)(this)}))}getUsersForAccount(){return Object(s.a)(this,void 0,void 0,(function*(){this.dhDialogService.showLoading();const t=this.getAccountId();if(yield this.accountUsersStateService.callGetAccountsAction(t))return this.dhDialogService.showErrorMessage("Could not load account users."),[];var e=(yield this.accountUsersStateService.getAccountUsersFromStore())[t];return null!=e&&0!=e.length||(e=[]),this.dhDialogService.hideLoading(),e}))}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}showAddUserToAccountModal(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.dialog.open(p,{data:{}}).afterClosed().toPromise();if(!(null==t?void 0:t.continue))return;this.dhDialogService.showLoading();const e=this.getAccountId();let o=[];for(const c of t.users)(yield this.usersStateService.addUserToAccount({userId:c.id,addUserToAccountDto:{accountId:e}}))&&o.push(c);o.length>0&&this.dhDialogService.showErrorMessage("some users were not added to account"),this.update()}))}showRomevoUserFromAccountModal(t){return Object(s.a)(this,void 0,void 0,(function*(){if(!(yield this.dhDialogService.showConfirmation({message:"Are you sure you want to remove user from account",title:"Remove User"}).toPromise()))return;this.dhDialogService.showLoading();const e=this.getAccountId();if(yield this.usersStateService.deleteUserFromAccount({userId:t.id,addUserToAccountDto:{accountId:e}}))return this.dhDialogService.showErrorMessage("Could not remove User."),void this.dhDialogService.hideLoading();this.dhDialogService.showMessage("User Removed."),yield this.update()}))}update(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield this.getUsersForAccount();this.dataSource.data=t}))}}return t.\u0275fac=function(e){return new(e||t)(r.Pb(b.a),r.Pb(l.b),r.Pb(m.a),r.Pb(A),r.Pb(i.a),r.Pb(C.a))},t.\u0275cmp=r.Jb({type:t,selectors:[["dh-account-users"]],viewQuery:function(t,e){if(1&t&&(r.Jc(n.a,!0),r.Jc(a.a,!0)),2&t){let t;r.tc(t=r.dc())&&(e.paginator=t.first),r.tc(t=r.dc())&&(e.sort=t.first)}},decls:5,vars:1,consts:[[1,"p-4"],[1,"flex","justify-between"],["mat-raised-button","","color","primary",1,"mb-2",3,"click"],["class","mat-elevation-z8",4,"ngIf"],[1,"mat-elevation-z8"],["mat-table","","matSort","",1,"w-full",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","userName"],["matColumnDef","email"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-raised-button","","color","warn",1,"ml-2",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(r.Vb(0,"div",0),r.Vb(1,"div",1),r.Vb(2,"button",2),r.cc("click",(function(){return e.showAddUserToAccountModal()})),r.Gc(3,"Add User To Account"),r.Ub(),r.Ub(),r.Ec(4,T,17,5,"div",3),r.Ub()),2&t&&(r.Db(4),r.mc("ngIf",e.ready))},directives:[f.b,c.m,u.j,u.c,u.e,u.b,u.g,u.i,n.a,u.d,u.a,u.f,u.h],styles:[""]}),t})()}];let J=(()=>{class t{}return t.\u0275mod=r.Nb({type:t}),t.\u0275inj=r.Mb({factory:function(e){return new(e||t)},imports:[[i.e.forChild(L)],i.e]}),t})();var H=o("29Wa");let N=(()=>{class t{}return t.\u0275mod=r.Nb({type:t}),t.\u0275inj=r.Mb({factory:function(e){return new(e||t)},imports:[[c.c,J,H.d,u.l,n.b,f.c]]}),t})()}}]);